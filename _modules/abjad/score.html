

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>abjad.score &mdash; Abjad 3.28 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/abjad.css?v=1f187528" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../_static/uqbar.css?v=e6773f5c" />
      <link rel="stylesheet" type="text/css" href="../../_static/lightbox2/css/lightbox.css?v=d2ef71d2" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="canonical" href="https://abjad.github.io_modules/abjad/score.html"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=159d94a3"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/ga.js?v=c455bbd5"></script>
      <script src="../../_static/toggleprompt.js?v=5801b3bb"></script>
      <script defer="defer" src="../../_static/lightbox2/js/lightbox.js?v=bc25c2e6"></script>
      <script src="../../_static/inject-autosummary-fqns.js?v=49afa734"></script>
      <script src="../../_static/inject-fqns.js?v=c5423c1b"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #22CC66" >


    <a href="../../index.html" class="icon icon-home" alt="Documentation
    Home"> Abjad 3.28



</a>




<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">First steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/audience.html">Audience</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/macos.html">macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/linux.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/windows.html">Windows</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers-basic-operations-on.html">Containers, basic operations on</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers-retrieving-by-name.html">Containers, retrieving by name</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers-time-interpretation-of.html">Containers, time interpretation of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/contexts-lilypond-type-of.html">Contexts, LilyPond type of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/indicators.html">Indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/lilypond-files-preamble-of.html">LilyPond files, preamble of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/lilypond-format-of-abjad-objects.html">LilyPond format, of Abjad objects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/corpus-selection.html">Corpus, figure selection from</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/design-by-dyads.html">Design, by dyads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/enumeration.html">Enumeration, of rhythmic cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/magic-square-from-twelve-tone-row.html">Magic square, from twelve-tone row</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/scales-diatonic.html">Scales, diatonic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/score-fragment-piano.html">Score fragment, piano</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All classes &amp; functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">Abjad API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/best-practices.html">Best practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/changes.html">Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/developer-installation.html">Developer installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/lilypond-context-concatenation.html">LilyPond context concatenation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/publications.html">Publications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Score gallery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../gallery-2020.html">2016-present</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery-2015.html">2015-11</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery-2010.html">2010-00</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #22CC66" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Abjad</a>
      </nav>

      <div class="wy-nav-content">

<div class="rst-content style-external-links">

    


    <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    <div itemprop="articleBody">
    
  <h1>Source code for abjad.score</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Classes to model score components.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">collections</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">fractions</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">functools</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">typing</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">_contributions</span><span class="p">,</span> <span class="n">_indentlib</span><span class="p">,</span> <span class="n">_updatelib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">duration</span> <span class="k">as</span> <span class="n">_duration</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">enums</span> <span class="k">as</span> <span class="n">_enums</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">exceptions</span> <span class="k">as</span> <span class="n">_exceptions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="nb">format</span> <span class="k">as</span> <span class="n">_format</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">indicators</span> <span class="k">as</span> <span class="n">_indicators</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">lyconst</span> <span class="k">as</span> <span class="n">_lyconst</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">lyproxy</span> <span class="k">as</span> <span class="n">_lyproxy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">math</span> <span class="k">as</span> <span class="n">_math</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">overrides</span> <span class="k">as</span> <span class="n">_overrides</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">pitch</span> <span class="k">as</span> <span class="n">_pitch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">tag</span> <span class="k">as</span> <span class="n">_tag</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">timespan</span> <span class="k">as</span> <span class="n">_timespan</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">tweaks</span> <span class="k">as</span> <span class="n">_tweaks</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_indent_strings</span><span class="p">(</span><span class="n">strings</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">strings</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">string</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_indentlib</span><span class="o">.</span><span class="n">INDENT</span> <span class="o">+</span> <span class="n">string</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">result</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>


<div class="viewcode-block" id="Component">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Component">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Component</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Component.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="n">_allowable_sites</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_indicators_are_current&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_is_forbidden_to_update&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_overrides&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_lilypond_setting_name_manager&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_measure_number&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_offsets_are_current&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_offsets_in_seconds_are_current&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_parent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_start_offset&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_start_offset_in_seconds&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_stop_offset&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_stop_offset_in_seconds&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_tag&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_timespan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_wrappers&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">_is_abstract</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_lilypond_string</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s2">&quot;english&quot;</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.parsers.parse</span><span class="w"> </span><span class="kn">import</span> <span class="n">parse</span>

        <span class="k">return</span> <span class="n">parse</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicators_are_current</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_forbidden_to_update</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_measure_number</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_offsets_are_current</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_offsets_in_seconds_are_current</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_overrides</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lilypond_setting_name_manager</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset_in_seconds</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset_in_seconds</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tag</span> <span class="o">=</span> <span class="n">tag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timespan</span> <span class="o">=</span> <span class="n">_timespan</span><span class="o">.</span><span class="n">Timespan</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wrappers</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1">### SPECIAL METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arguments</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shallow copies component.</span>

<span class="sd">        Copies indicators.</span>

<span class="sd">        Does not copy spanners.</span>

<span class="sd">        Does not copy children.</span>

<span class="sd">        Returns new component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">component</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__getnewargs__</span><span class="p">(),</span> <span class="n">tag</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;identifier&quot;</span><span class="p">):</span>
            <span class="n">component</span><span class="o">.</span><span class="n">set_identifier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;lilypond_type&quot;</span><span class="p">):</span>
            <span class="n">component</span><span class="o">.</span><span class="n">set_lilypond_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lilypond_type</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">):</span>
            <span class="n">component</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;simultaneous&quot;</span><span class="p">):</span>
            <span class="n">component</span><span class="o">.</span><span class="n">set_simultaneous</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simultaneous</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_overrides&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">component</span><span class="o">.</span><span class="n">_overrides</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_overrides</span><span class="o">.</span><span class="n">override</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_lilypond_setting_name_manager&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">component</span><span class="o">.</span><span class="n">_lilypond_setting_name_manager</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
                <span class="n">_overrides</span><span class="o">.</span><span class="n">setting</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">wrapper</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrappers</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">annotation</span><span class="p">():</span>
                <span class="k">continue</span>
            <span class="n">wrapper_</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>
            <span class="n">wrapper_</span><span class="o">.</span><span class="n">_component</span> <span class="o">=</span> <span class="n">component</span>
            <span class="n">wrapper_</span><span class="o">.</span><span class="n">_bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">wrapper</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_wrappers</span><span class="p">():</span>
            <span class="n">wrapper_</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>
            <span class="n">wrapper_</span><span class="o">.</span><span class="n">_component</span> <span class="o">=</span> <span class="n">component</span>
            <span class="n">wrapper_</span><span class="o">.</span><span class="n">_bind_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">component</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets new arguments.</span>

<span class="sd">        Returns tuple.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">()</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_cache_named_children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name_dictionary</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_named_children&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">children</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_named_children</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">name_dictionary</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">children</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">name_dictionary</span><span class="p">:</span>
                <span class="n">name_dictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">()]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">name_dictionary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">()]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">name_dictionary</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_for_cycles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">components</span><span class="p">):</span>
        <span class="n">parentage</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
        <span class="k">while</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parentage</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">_parent</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">parentage</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_absolute_after_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">absolute_after</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="n">AfterGraceContainer</span> <span class="o">|</span> <span class="n">BeforeGraceContainer</span> <span class="o">|</span> <span class="n">Leaf</span>
            <span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_absolute_before_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">absolute_before</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_components</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">Component</span><span class="p">):</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">argument</span><span class="o">.</span><span class="n">_get_subtree</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">Component</span><span class="o">.</span><span class="n">_get_components</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_descendants_starting_with</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_descendants_stopping_with</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_preprolated_duration</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">duration</span>
        <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_get_parentage</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s2">&quot;_get_prolation&quot;</span><span class="p">):</span>
                <span class="n">prolation</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">_get_prolation</span><span class="p">()</span>
                <span class="n">duration</span> <span class="o">*=</span> <span class="n">prolation</span>
        <span class="k">return</span> <span class="n">duration</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_indicators</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">wrappers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_wrappers</span><span class="p">(</span><span class="n">prototype</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">)</span>
        <span class="n">indicators</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">wrapper_</span> <span class="ow">in</span> <span class="n">wrappers</span><span class="p">:</span>
            <span class="n">indicators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wrapper_</span><span class="o">.</span><span class="n">unbundle_indicator</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">indicators</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_lilypond_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">_updatelib</span><span class="o">.</span><span class="n">_update_now</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indicators</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">_format</span><span class="o">.</span><span class="n">format_component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_markup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">wrappers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_wrappers</span><span class="p">(</span><span class="n">_indicators</span><span class="o">.</span><span class="n">Markup</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="ow">is</span> <span class="n">_enums</span><span class="o">.</span><span class="n">UP</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">indicator</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">wrappers</span> <span class="k">if</span> <span class="n">_</span><span class="o">.</span><span class="n">direction</span><span class="p">()</span> <span class="ow">is</span> <span class="n">_enums</span><span class="o">.</span><span class="n">UP</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">direction</span> <span class="ow">is</span> <span class="n">_enums</span><span class="o">.</span><span class="n">DOWN</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span>
                <span class="n">_</span><span class="o">.</span><span class="n">indicator</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">wrappers</span> <span class="k">if</span> <span class="n">_</span><span class="o">.</span><span class="n">direction</span><span class="p">()</span> <span class="ow">is</span> <span class="n">_enums</span><span class="o">.</span><span class="n">DOWN</span>
            <span class="p">)</span>
        <span class="n">indicators</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="o">.</span><span class="n">indicator</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">wrappers</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">indicators</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_parentage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parentage</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">while</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parentage</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s2">&quot;_main_leaf&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">parent</span><span class="o">.</span><span class="n">_main_leaf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">_main_leaf</span><span class="o">.</span><span class="n">_parent</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">_parent</span>
        <span class="k">return</span> <span class="n">parentage</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_sibling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">simultaneous</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_seconds</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">in_seconds</span><span class="p">:</span>
            <span class="n">_updatelib</span><span class="o">.</span><span class="n">_update_now</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offsets_in_seconds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_offset_in_seconds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">_exceptions</span><span class="o">.</span><span class="n">MissingMetronomeMarkError</span>
            <span class="k">return</span> <span class="n">_timespan</span><span class="o">.</span><span class="n">Timespan</span><span class="p">(</span>
                <span class="n">start_offset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_start_offset_in_seconds</span><span class="p">,</span>
                <span class="n">stop_offset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop_offset_in_seconds</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_updatelib</span><span class="o">.</span><span class="n">_update_now</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offsets</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timespan</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_wrappers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">prototype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prototype</span> <span class="o">=</span> <span class="nb">object</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prototype</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">prototype</span> <span class="o">=</span> <span class="p">(</span><span class="n">prototype</span><span class="p">,)</span>
        <span class="n">prototype_objects</span><span class="p">,</span> <span class="n">prototype_classes</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">indicator_prototype</span> <span class="ow">in</span> <span class="n">prototype</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indicator_prototype</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
                <span class="n">prototype_classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_prototype</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prototype_objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indicator_prototype</span><span class="p">)</span>
        <span class="n">prototype_objects</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">prototype_objects</span><span class="p">)</span>
        <span class="n">prototype_classes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">prototype_classes</span><span class="p">)</span>
        <span class="n">wrappers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">wrapper</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrappers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">annotation</span><span class="p">():</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wrapper</span><span class="p">,</span> <span class="n">prototype_classes</span><span class="p">):</span>
                <span class="n">wrappers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">wrapper</span> <span class="o">==</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">prototype_objects</span><span class="p">):</span>
                <span class="n">wrappers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wrapper</span><span class="o">.</span><span class="n">unbundle_indicator</span><span class="p">(),</span> <span class="n">prototype_classes</span><span class="p">):</span>
                <span class="n">wrappers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">wrapper</span><span class="o">.</span><span class="n">indicator</span><span class="p">()</span> <span class="o">==</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">prototype_objects</span><span class="p">):</span>
                <span class="n">wrappers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">wrapper</span><span class="o">.</span><span class="n">unbundle_indicator</span><span class="p">()</span> <span class="o">==</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">prototype_objects</span><span class="p">):</span>
                <span class="n">wrappers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">attributes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">wrappers_</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">wrapper</span> <span class="ow">in</span> <span class="n">wrappers</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">wrapper</span><span class="o">.</span><span class="n">unbundle_indicator</span><span class="p">(),</span> <span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">!=</span> <span class="n">value</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">wrappers_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>
            <span class="n">wrappers</span> <span class="o">=</span> <span class="n">wrappers_</span>
        <span class="k">return</span> <span class="n">wrappers</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_has_indicator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">indicators</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_indicators</span><span class="p">(</span><span class="n">prototype</span><span class="o">=</span><span class="n">prototype</span><span class="p">,</span> <span class="n">attributes</span><span class="o">=</span><span class="n">attributes</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">indicators</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_remove_from_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_later</span><span class="p">(</span><span class="n">offsets</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_parentage</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="s2">&quot;_lilypond_type&quot;</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">wrapper</span> <span class="ow">in</span> <span class="n">component</span><span class="o">.</span><span class="n">_dependent_wrappers</span><span class="p">[:]:</span>
                <span class="k">if</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">component</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">:</span>
                    <span class="n">component</span><span class="o">.</span><span class="n">_dependent_wrappers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_remove_named_children_from_parentage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name_dictionary</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name_dictionary</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_parentage</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">named_children</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">_named_children</span>
                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">name_dictionary</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">name_dictionary</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
                        <span class="n">named_children</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">named_children</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
                        <span class="k">del</span> <span class="n">named_children</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_restore_named_children_to_parentage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name_dictionary</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name_dictionary</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_parentage</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">named_children</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">_named_children</span>
                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">name_dictionary</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">named_children</span><span class="p">:</span>
                        <span class="n">named_children</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">name_dictionary</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">named_children</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">name_dictionary</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_parent</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Not composer-safe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">named_children</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_named_children</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_remove_named_children_from_parentage</span><span class="p">(</span><span class="n">named_children</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_remove_from_parent</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">new_parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_restore_named_children_to_parentage</span><span class="p">(</span><span class="n">named_children</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_later</span><span class="p">(</span><span class="n">offsets</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_sibling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_parentage</span><span class="p">():</span>
            <span class="n">sibling</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">_get_sibling</span><span class="p">(</span><span class="n">_math</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">sibling</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">sibling</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_tag_strings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strings</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">strings</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">double_tag</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">strings</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_later</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offsets</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">offsets_in_seconds</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">offsets</span> <span class="ow">or</span> <span class="n">offsets_in_seconds</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_parentage</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">offsets</span><span class="p">:</span>
                <span class="n">component</span><span class="o">.</span><span class="n">_offsets_are_current</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">offsets_in_seconds</span><span class="p">:</span>
                <span class="n">component</span><span class="o">.</span><span class="n">_offsets_in_seconds_are_current</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="Component.tag">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Component.tag">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">tag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets component tag.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tag</span><span class="p">,</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tag</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag</span></div>


<div class="viewcode-block" id="Component.set_tag">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Component.set_tag">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets component tag.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">argument</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tag</span> <span class="o">=</span> <span class="n">argument</span></div>
</div>



<div class="viewcode-block" id="Leaf">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Leaf">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Leaf</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Leaf.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ##</span>

    <span class="n">_allowable_sites</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;absolute_before&quot;</span><span class="p">,</span>
        <span class="s2">&quot;before&quot;</span><span class="p">,</span>
        <span class="s2">&quot;after&quot;</span><span class="p">,</span>
        <span class="s2">&quot;absolute_after&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_after_grace_container&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_before_grace_container&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_multiplier&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_written_duration&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">written_duration</span><span class="p">:</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">multiplier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Component</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_after_grace_container</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_before_grace_container</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_multiplier</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_written_duration</span><span class="p">(</span><span class="n">written_duration</span><span class="p">)</span>

    <span class="c1">### SPECIAL METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arguments</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shallow copies leaf.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">leaf</span> <span class="o">=</span> <span class="n">Component</span><span class="o">.</span><span class="n">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arguments</span><span class="p">)</span>
        <span class="n">leaf</span><span class="o">.</span><span class="n">set_multiplier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">())</span>
        <span class="n">before_grace_container</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_before_grace_container</span>
        <span class="k">if</span> <span class="n">before_grace_container</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">grace_container</span> <span class="o">=</span> <span class="n">before_grace_container</span><span class="o">.</span><span class="n">_copy_with_children</span><span class="p">()</span>
            <span class="n">grace_container</span><span class="o">.</span><span class="n">_attach</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span>
        <span class="n">after_grace_container</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_grace_container</span>
        <span class="k">if</span> <span class="n">after_grace_container</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">grace_container</span> <span class="o">=</span> <span class="n">after_grace_container</span><span class="o">.</span><span class="n">_copy_with_children</span><span class="p">()</span>
            <span class="n">grace_container</span><span class="o">.</span><span class="n">_attach</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">leaf</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets new arguments.</span>

<span class="sd">        Returns tuple.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">written_duration</span><span class="p">(),)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets repr.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_compact_representation</span><span class="p">()</span><span class="si">!r}</span><span class="s2">)&quot;</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_copy_override_and_set_from_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">leaf</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="s2">&quot;_overrides&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_overrides</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_overrides</span><span class="o">.</span><span class="n">override</span><span class="p">(</span><span class="n">leaf</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="s2">&quot;_lilypond_setting_name_manager&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lilypond_setting_name_manager</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_overrides</span><span class="o">.</span><span class="n">setting</span><span class="p">(</span><span class="n">leaf</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">wrapper</span> <span class="ow">in</span> <span class="n">leaf</span><span class="o">.</span><span class="n">_wrappers</span><span class="p">:</span>
            <span class="n">wrapper_</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>
            <span class="n">wrapper_</span><span class="o">.</span><span class="n">_component</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="n">wrapper_</span><span class="o">.</span><span class="n">_bind_component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_after_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">after</span><span class="o">.</span><span class="n">stem_tremolos</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">STEM_TREMOLOS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">after</span><span class="o">.</span><span class="n">articulations</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">ARTICULATIONS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">after</span><span class="o">.</span><span class="n">markup</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">MARKUP</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">after</span><span class="o">.</span><span class="n">spanner_stops</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">SPANNER_STOPS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">after</span><span class="o">.</span><span class="n">start_beam</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">START_BEAM</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">after</span><span class="o">.</span><span class="n">stop_beam</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">STOP_BEAM</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">after</span><span class="o">.</span><span class="n">spanner_starts</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">SPANNER_STARTS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="c1"># NOTE: LilyPond demands \startTrillSpan appear after almost all</span>
        <span class="c1">#       other contributions; pitched trills dangerously</span>
        <span class="c1">#       suppress markup and the starts of other spanners when</span>
        <span class="c1">#       \startTrillSpan appears lexically prior to those commands;</span>
        <span class="c1">#       but \startTrillSpan must appear before calls to \set.</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">after</span><span class="o">.</span><span class="n">trill_spanner_starts</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">TRILL_SPANNER_STARTS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">after</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">after</span><span class="o">.</span><span class="n">leak</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">LEAK</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">after</span><span class="o">.</span><span class="n">leaks</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">LEAKS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_grace_container</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_grace_container</span><span class="o">.</span><span class="n">_get_lilypond_format</span><span class="p">()</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_before_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_before_grace_container</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_before_grace_container</span><span class="o">.</span><span class="n">_get_lilypond_format</span><span class="p">()</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">before</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">grob_reverts</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">GROB_REVERTS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">grob_overrides</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">GROB_OVERRIDES</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">context_settings</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">CONTEXT_SETTINGS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_closing_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">closing</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_indent_strings</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_contents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_leaf_nucleus</span><span class="p">()</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_leaf_nucleus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_body</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">()</span><span class="o">.</span><span class="n">string</span><span class="p">:</span>
            <span class="n">strings</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">double_tag</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">strings</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_opening_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">opening</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_grace_container</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_followed_by_after_grace_container</span><span class="p">()</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\afterGrace&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_grace_container</span><span class="o">.</span><span class="n">fraction</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_grace_container</span><span class="o">.</span><span class="n">fraction</span><span class="p">()</span>
                <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_followed_by_after_grace_container</span><span class="p">():</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_grace_container</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_after_grace_container</span>
            <span class="p">)</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\afterGrace&quot;</span>
            <span class="n">container</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_following_after_grace_container</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">container</span><span class="o">.</span><span class="n">fraction</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="n">fraction</span><span class="p">()</span>
                <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">before</span><span class="o">.</span><span class="n">pitched_trill</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">PITCHED_TRILL</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_compact_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_duration</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_following_after_grace_container</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">component</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">IndependentAfterGraceContainer</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">component</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_formatted_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span><span class="o">.</span><span class="n">lilypond_duration_string</span><span class="p">()]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot; * &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_preprolated_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">*=</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">duration</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_subtree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_before_grace_container</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_before_grace_container</span><span class="o">.</span><span class="n">_get_subtree</span><span class="p">())</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_after_grace_container</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_after_grace_container</span><span class="o">.</span><span class="n">_get_subtree</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_followed_by_after_grace_container</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">component</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">IndependentAfterGraceContainer</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_process_contribution_packet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contribution_packet</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">contributor</span><span class="p">,</span> <span class="n">contributions</span> <span class="ow">in</span> <span class="n">contribution_packet</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">contributions</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contributor</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="n">contributor</span> <span class="o">=</span> <span class="n">_indentlib</span><span class="o">.</span><span class="n">INDENT</span> <span class="o">+</span> <span class="n">contributor</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">contributor</span> <span class="o">=</span> <span class="n">_indentlib</span><span class="o">.</span><span class="n">INDENT</span> <span class="o">+</span> <span class="n">contributor</span> <span class="o">+</span> <span class="s2">&quot;:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="n">contributor</span>
                <span class="k">for</span> <span class="n">contribution</span> <span class="ow">in</span> <span class="n">contributions</span><span class="p">:</span>
                    <span class="n">contribution</span> <span class="o">=</span> <span class="p">(</span><span class="n">_indentlib</span><span class="o">.</span><span class="n">INDENT</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">contribution</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">result</span> <span class="o">+=</span> <span class="n">contribution</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="n">self_written_duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span> <span class="o">*</span> <span class="n">multiplier</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_written_duration</span><span class="p">(</span><span class="n">self_written_duration</span><span class="p">)</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

<div class="viewcode-block" id="Leaf.multiplier">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Leaf.multiplier">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">multiplier</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets leaf duration multiplier.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multiplier</span></div>


<div class="viewcode-block" id="Leaf.set_multiplier">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Leaf.set_multiplier">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_multiplier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets leaf duration multiplier.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">argument</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_multiplier</span> <span class="o">=</span> <span class="n">argument</span></div>


<div class="viewcode-block" id="Leaf.written_duration">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Leaf.written_duration">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">written_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets leaf written duration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_written_duration</span></div>


<div class="viewcode-block" id="Leaf.set_written_duration">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Leaf.set_written_duration">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_written_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">duration</span><span class="o">.</span><span class="n">is_assignable</span><span class="p">():</span>
            <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;not assignable duration: </span><span class="si">{</span><span class="n">duration</span><span class="si">!r}</span><span class="s2">.&quot;</span>
            <span class="k">raise</span> <span class="n">_exceptions</span><span class="o">.</span><span class="n">AssignabilityError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_written_duration</span> <span class="o">=</span> <span class="n">duration</span></div>
</div>



<div class="viewcode-block" id="Container">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Container">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Container</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Container.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Intializes from string:</span>

<span class="sd">        &gt;&gt;&gt; container = abjad.Container(&quot;c&#39;4 e&#39;4 d&#39;4 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;8</span>
<span class="sd">                f&#39;8</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Intializes from components:</span>

<span class="sd">        &gt;&gt;&gt; notes = [</span>
<span class="sd">        ...     abjad.Note(&quot;c&#39;4&quot;),</span>
<span class="sd">        ...     abjad.Note(&quot;e&#39;4&quot;),</span>
<span class="sd">        ...     abjad.Note(&quot;d&#39;4&quot;),</span>
<span class="sd">        ...     abjad.Note(&quot;e&#39;8&quot;),</span>
<span class="sd">        ...     abjad.Note(&quot;f&#39;8&quot;),</span>
<span class="sd">        ... ]</span>
<span class="sd">        &gt;&gt;&gt; container = abjad.Container(notes)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;8</span>
<span class="sd">                f&#39;8</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Containers are iterables:</span>

<span class="sd">        &gt;&gt;&gt; import collections</span>
<span class="sd">        &gt;&gt;&gt; container = abjad.Container(&quot;c&#39;4 e&#39;4 d&#39;4 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; isinstance(container, collections.abc.Iterable)</span>
<span class="sd">        True</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Containers are not sequences because containers do not implement</span>
<span class="sd">        reverse:</span>

<span class="sd">        &gt;&gt;&gt; container = abjad.Container(&quot;c&#39;4 e&#39;4 d&#39;4 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; isinstance(container, collections.abc.Sequence)</span>
<span class="sd">        False</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Formatting positions contributions strictly one-per-line:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(abjad.Articulation(&#39;^&#39;), staff[0])</span>
<span class="sd">        &gt;&gt;&gt; markup = abjad.Markup(r&#39;\markup Allegro&#39;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(markup, staff[0], direction=abjad.UP)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(abjad.StemTremolo(), staff[0])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        &gt;&gt;&gt; string = abjad.lilypond(staff)</span>
<span class="sd">        &gt;&gt;&gt; print(string)</span>
<span class="sd">        \new Staff</span>
<span class="sd">        {</span>
<span class="sd">            c&#39;4</span>
<span class="sd">            :16</span>
<span class="sd">            - \marcato</span>
<span class="sd">            ^ \markup Allegro</span>
<span class="sd">            d&#39;4</span>
<span class="sd">            e&#39;4</span>
<span class="sd">            f&#39;4</span>
<span class="sd">        }</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="n">_allowable_sites</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;absolute_before&quot;</span><span class="p">,</span>
        <span class="s2">&quot;before&quot;</span><span class="p">,</span>
        <span class="s2">&quot;opening&quot;</span><span class="p">,</span>
        <span class="s2">&quot;closing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;after&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_identifier&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_components&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_formatter&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_named_children&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_is_simultaneous&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">simultaneous</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">components</span> <span class="o">=</span> <span class="n">components</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">prototype</span> <span class="o">=</span> <span class="p">(</span><span class="n">Component</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">prototype</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">components</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
        <span class="n">Component</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_named_children</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_simultaneous</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># sets name temporarily for _find_correct_effective_context:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_components</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_identifier</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_simultaneous</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="n">simultaneous</span><span class="p">))</span>
        <span class="c1"># sets name permanently after _initalize_components:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="c1">### SPECIAL METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when ``argument`` appears in container.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">argument</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_named_children</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">component</span> <span class="ow">is</span> <span class="n">argument</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes components(s) at index ``i`` in container.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Deletes first tuplet in voice:</span>

<span class="sd">            &gt;&gt;&gt; voice = abjad.Voice()</span>
<span class="sd">            &gt;&gt;&gt; voice.append(abjad.Tuplet(&quot;6:4&quot;, &quot;c&#39;4 d&#39;4 e&#39;4&quot;))</span>
<span class="sd">            &gt;&gt;&gt; voice.append(abjad.Tuplet(&quot;3:2&quot;, &quot;e&#39;4 d&#39;4 c&#39;4&quot;))</span>
<span class="sd">            &gt;&gt;&gt; leaves = abjad.select.leaves(voice)</span>
<span class="sd">            &gt;&gt;&gt; abjad.slur(leaves)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \new Voice</span>
<span class="sd">                {</span>
<span class="sd">                    \tuplet 6/4</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        (</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tuplet 3/2</span>
<span class="sd">                    {</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        )</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet_1 = voice[0]</span>
<span class="sd">            &gt;&gt;&gt; del(voice[0])</span>
<span class="sd">            &gt;&gt;&gt; start_slur = abjad.StartSlur()</span>
<span class="sd">            &gt;&gt;&gt; leaf = abjad.select.leaf(voice, 0)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(start_slur, leaf)</span>

<span class="sd">            First tuplet no longer appears in voice:</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \new Voice</span>
<span class="sd">                {</span>
<span class="sd">                    \tuplet 3/2</span>
<span class="sd">                    {</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                        (</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        )</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; abjad.wf.is_wellformed(voice)</span>
<span class="sd">            True</span>

<span class="sd">            First tuplet must have start slur removed:</span>

<span class="sd">            &gt;&gt;&gt; abjad.detach(abjad.StartSlur, tuplet_1[0])</span>
<span class="sd">            (StartSlur(),)</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet_1) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet_1)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tuplet 6/4</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; abjad.wf.is_wellformed(tuplet_1)</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">wrappers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_components</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
            <span class="n">wrappers_</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">_get_wrappers</span><span class="p">()</span>
            <span class="n">wrappers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">wrappers_</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">Component</span><span class="p">):</span>
            <span class="n">result</span><span class="o">.</span><span class="n">_set_parent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                <span class="n">component</span><span class="o">.</span><span class="n">_set_parent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">wrapper</span> <span class="ow">in</span> <span class="n">wrappers</span><span class="p">:</span>
            <span class="n">wrapper</span><span class="o">.</span><span class="n">_update_effective_context</span><span class="p">()</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">SupportsIndex</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Component</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="nb">slice</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Component</span><span class="p">]:</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">SupportsIndex</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">slice</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Component</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">Component</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets top-level item or slice identified by ``argument``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">()</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">()</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">argument</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_named_children</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;can not find component named </span><span class="si">{</span><span class="n">argument</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_named_children</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">argument</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multiple components named </span><span class="si">{</span><span class="n">argument</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_named_children</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">argument</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;can not get container at </span><span class="si">{</span><span class="n">argument</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets new container arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">([],)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterates container.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Abjad containers are iterables:</span>

<span class="sd">            &gt;&gt;&gt; import collections</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.Container()</span>
<span class="sd">            &gt;&gt;&gt; isinstance(container, collections.abc.Iterable)</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Abjad containers are not sequences:</span>

<span class="sd">            &gt;&gt;&gt; import collections</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.Container()</span>
<span class="sd">            &gt;&gt;&gt; isinstance(container, collections.abc.Sequence)</span>
<span class="sd">            False</span>

<span class="sd">        Yields container elements.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets number of components in container.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets repr.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_contents_summary</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">string</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">string</span><span class="si">!r}</span><span class="s2">)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">()&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets container ``i`` equal to ``argument``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_string</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
                <span class="n">argument</span> <span class="o">=</span> <span class="n">argument</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">wrappers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_components</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
            <span class="n">wrappers_</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">_get_wrappers</span><span class="p">()</span>
            <span class="n">wrappers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">wrappers_</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="p">[</span><span class="n">argument</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span>
            <span class="n">i</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">new_argument</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s2">&quot;_items&quot;</span><span class="p">):</span>
                <span class="n">new_argument</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_argument</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">argument</span> <span class="o">=</span> <span class="n">new_argument</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">Component</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="s2">&quot;_main_leaf&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;must attach grace container to note or chord.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_for_cycles</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">_exceptions</span><span class="o">.</span><span class="n">ParentageError</span><span class="p">(</span><span class="s2">&quot;attempted to induce cycles.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">i</span><span class="o">.</span><span class="n">start</span> <span class="o">==</span> <span class="n">i</span><span class="o">.</span><span class="n">stop</span>
            <span class="ow">and</span> <span class="n">i</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">i</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">i</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">stride</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">start</span><span class="p">),</span> <span class="n">argument</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">:</span>
            <span class="n">component</span><span class="o">.</span><span class="n">_set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">wrapper</span> <span class="ow">in</span> <span class="n">wrappers</span><span class="p">:</span>
            <span class="n">wrapper</span><span class="o">.</span><span class="n">_update_effective_context</span><span class="p">()</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_copy_with_children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_container</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">new_component</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">_copy_with_children</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_component</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
            <span class="n">new_container</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_component</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_container</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_after_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">after</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_before_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">before</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_close_brackets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">simultaneous</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">():</span>
                <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&gt;&gt;  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&gt;&gt;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">():</span>
                <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">}}</span><span class="s2">   </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;}&quot;</span>
        <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">strings</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">double_tag</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">())</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_closing_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">grob_reverts</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">GROB_REVERTS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">closing</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_indent_strings</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_content_pieces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">():</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">_get_lilypond_format</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">string</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
                    <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">string</span> <span class="o">=</span> <span class="n">_indentlib</span><span class="o">.</span><span class="n">INDENT</span> <span class="o">+</span> <span class="n">string</span>
                <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">strings</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_contents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_content_pieces</span><span class="p">()</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_open_brackets_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">simultaneous</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">():</span>
                <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;&lt;  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&lt;&lt;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">():</span>
                <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2">   </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;{&quot;</span>
        <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">strings</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">double_tag</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">())</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_opening_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">opening</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">grob_overrides</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">GROB_OVERRIDES</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">context_settings</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">CONTEXT_SETTINGS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_indent_strings</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_abbreviated_string_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">simultaneous</span><span class="p">():</span>
            <span class="n">open_bracket_string</span><span class="p">,</span> <span class="n">close_bracket_string</span> <span class="o">=</span> <span class="s2">&quot;&lt;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;&gt;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">open_bracket_string</span><span class="p">,</span> <span class="n">close_bracket_string</span> <span class="o">=</span> <span class="s2">&quot;{&quot;</span><span class="p">,</span> <span class="s2">&quot;}&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;-&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_lilypond_type&quot;</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&lt;</span><span class="si">{}{}{}{}{}</span><span class="s2">&gt;&quot;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lilypond_type</span><span class="p">(),</span>
                <span class="n">name</span><span class="p">,</span>
                <span class="n">open_bracket_string</span><span class="p">,</span>
                <span class="n">summary</span><span class="p">,</span>
                <span class="n">close_bracket_string</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&lt;</span><span class="si">{}{}{}{}</span><span class="s2">&gt;&quot;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">open_bracket_string</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">close_bracket_string</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_compact_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;{ }&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_contents_summary</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="se">}}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_contents_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">simultaneous</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">max</span><span class="p">(</span>
                <span class="p">[</span><span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="n">_</span><span class="o">.</span><span class="n">_get_preprolated_duration</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="n">duration</span> <span class="o">+=</span> <span class="n">component</span><span class="o">.</span><span class="n">_get_preprolated_duration</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">duration</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_contents_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="s2">&quot;_get_compact_representation&quot;</span><span class="p">):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">_get_compact_representation</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">component</span><span class="p">))</span>
            <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_descendants_starting_with</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">simultaneous</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">_get_descendants_starting_with</span><span class="p">())</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_get_descendants_starting_with</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_descendants_stopping_with</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">simultaneous</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">_get_descendants_stopping_with</span><span class="p">())</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">_get_descendants_stopping_with</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_preprolated_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_contents_duration</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_subtree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">_get_subtree</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_components</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="n">components</span><span class="p">,</span> <span class="nb">str</span>
        <span class="p">):</span>
            <span class="n">components_</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">parsed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_string</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
                    <span class="n">components_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Component</span><span class="p">)</span>
                    <span class="n">components_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">components</span> <span class="o">=</span> <span class="n">components_</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">Component</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">components</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">parsed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_string</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_components</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_simultaneous</span><span class="p">(</span><span class="n">parsed</span><span class="o">.</span><span class="n">simultaneous</span><span class="p">())</span>
            <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">parsed</span><span class="p">[:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">component</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;must not have parent: </span><span class="si">{</span><span class="n">component</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_components</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="n">component</span><span class="o">.</span><span class="n">_set_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_one_of_my_first_leaves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">leaf</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_descendants_starting_with</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_one_of_my_last_leaves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">leaf</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_descendants_stopping_with</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s2">&quot;english&quot;</span><span class="p">):</span>
        <span class="n">user_input</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">user_input</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&lt;&lt;&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">user_input</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&quot;</span><span class="p">):</span>
            <span class="n">user_input</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="n">user_input</span><span class="si">}</span><span class="s2"> </span><span class="se">}}</span><span class="s2">&quot;</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_lilypond_string</span><span class="p">(</span><span class="n">user_input</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parsed</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">parsed</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">item</span><span class="o">.</span><span class="n">_scale</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

<div class="viewcode-block" id="Container.components">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Container.components">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets components in container.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">)</span></div>


<div class="viewcode-block" id="Container.identifier">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Container.identifier">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets bracket comment.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; container = abjad.Container(</span>
<span class="sd">            ...     &quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;,</span>
<span class="sd">            ...     identifier=&#39;%*% AB&#39;,</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            {   %*% AB</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }   %*% AB</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identifier</span></div>


<div class="viewcode-block" id="Container.set_identifier">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Container.set_identifier">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets bracket comment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_identifier</span> <span class="o">=</span> <span class="n">argument</span></div>


<div class="viewcode-block" id="Container.name">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Container.name">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets name of container.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets container name:</span>

<span class="sd">            &gt;&gt;&gt; container = abjad.Container(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; container.name() is None</span>
<span class="sd">            True</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span></div>


<div class="viewcode-block" id="Container.set_name">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Container.set_name">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets name of container.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; container = abjad.Container(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;, name=&#39;Special&#39;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; container.name()</span>
<span class="sd">            &#39;Special&#39;</span>

<span class="sd">            Container name does not appear in LilyPond output:</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">old_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
        <span class="k">while</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">named_children</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">_named_children</span>
            <span class="k">if</span> <span class="n">old_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">named_children</span><span class="p">[</span><span class="n">old_name</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">named_children</span><span class="p">[</span><span class="n">old_name</span><span class="p">]:</span>
                    <span class="k">del</span> <span class="n">named_children</span><span class="p">[</span><span class="n">old_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">argument</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">argument</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">named_children</span><span class="p">:</span>
                    <span class="n">named_children</span><span class="p">[</span><span class="n">argument</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">named_children</span><span class="p">[</span><span class="n">argument</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">_parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">argument</span></div>


<div class="viewcode-block" id="Container.simultaneous">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Container.simultaneous">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">simultaneous</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets container ``simultaneous`` flag.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets simultaneity status of container:</span>

<span class="sd">            &gt;&gt;&gt; container = abjad.Container()</span>
<span class="sd">            &gt;&gt;&gt; container.append(abjad.Voice(&quot;c&#39;8 d&#39;8 e&#39;8&quot;))</span>
<span class="sd">            &gt;&gt;&gt; container.append(abjad.Voice(&#39;g4.&#39;))</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                {</span>
<span class="sd">                    \new Voice</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Voice</span>
<span class="sd">                    {</span>
<span class="sd">                        g4.</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; container.simultaneous()</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Sets simultaneity status of container:</span>

<span class="sd">            &gt;&gt;&gt; container = abjad.Container()</span>
<span class="sd">            &gt;&gt;&gt; container.append(abjad.Voice(&quot;c&#39;8 d&#39;8 e&#39;8&quot;))</span>
<span class="sd">            &gt;&gt;&gt; container.append(abjad.Voice(&#39;g4.&#39;))</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                {</span>
<span class="sd">                    \new Voice</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Voice</span>
<span class="sd">                    {</span>
<span class="sd">                        g4.</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; container.set_simultaneous(True)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new Voice</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Voice</span>
<span class="sd">                    {</span>
<span class="sd">                        g4.</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_simultaneous</span></div>


<div class="viewcode-block" id="Container.set_simultaneous">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Container.set_simultaneous">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_simultaneous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets container ``simultaneous`` flag.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">argument</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">argument</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">):</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;simultaneous containers must contain&quot;</span>
            <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot; only other containers.&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_simultaneous</span> <span class="o">=</span> <span class="n">argument</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_later</span><span class="p">(</span><span class="n">offsets</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


    <span class="c1">### PUBLIC METHODS ###</span>

<div class="viewcode-block" id="Container.append">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Container.append">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appends ``component`` to container.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Appends note to container:</span>

<span class="sd">            &gt;&gt;&gt; container = abjad.Container(&quot;c&#39;4 ( d&#39;4 f&#39;4 )&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    (</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    )</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; container.append(abjad.Note(&quot;e&#39;4&quot;))</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    (</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    )</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">components</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_string</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">components</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="n">component</span> <span class="o">=</span> <span class="n">components</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Component</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)),</span> <span class="p">[</span><span class="n">component</span><span class="p">])</span></div>


<div class="viewcode-block" id="Container.extend">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Container.extend">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extends container with ``argument``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Extends container with three notes:</span>

<span class="sd">            &gt;&gt;&gt; container = abjad.Container(&quot;c&#39;4 ( d&#39;4 f&#39;4 )&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    (</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    )</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; notes = [abjad.Note(&quot;e&#39;32&quot;), abjad.Note(&quot;d&#39;32&quot;), abjad.Note(&quot;e&#39;16&quot;)]</span>
<span class="sd">            &gt;&gt;&gt; container.extend(notes)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    (</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    )</span>
<span class="sd">                    e&#39;32</span>
<span class="sd">                    d&#39;32</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_string</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span>
            <span class="nb">slice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)),</span>
            <span class="n">argument</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">argument</span><span class="p">))),</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Container.index">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Container.index">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns index of ``component`` in container.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets index of last element in container:</span>

<span class="sd">            &gt;&gt;&gt; container = abjad.Container(&quot;c&#39;4 d&#39;4 f&#39;4 e&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; note = container[-1]</span>
<span class="sd">            &gt;&gt;&gt; note</span>
<span class="sd">            Note(&quot;e&#39;4&quot;)</span>

<span class="sd">            &gt;&gt;&gt; container.index(note)</span>
<span class="sd">            3</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">element</span> <span class="ow">is</span> <span class="n">component</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">i</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;component </span><span class="si">{</span><span class="n">component</span><span class="si">!r}</span><span class="s2"> not in container </span><span class="si">{</span><span class="bp">self</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Container.insert">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Container.insert">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">insert</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Component</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Inserts ``component`` at index ``i`` in container.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Inserts note:</span>

<span class="sd">            &gt;&gt;&gt; container = abjad.Container([])</span>
<span class="sd">            &gt;&gt;&gt; container.extend(&quot;fs16 cs&#39; e&#39; a&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; container.extend(&quot;cs&#39;&#39;16 e&#39;&#39; cs&#39;&#39; a&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; container.extend(&quot;fs&#39;16 e&#39; cs&#39; fs&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                {</span>
<span class="sd">                    fs16</span>
<span class="sd">                    cs&#39;16</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                    a&#39;16</span>
<span class="sd">                    cs&#39;&#39;16</span>
<span class="sd">                    e&#39;&#39;16</span>
<span class="sd">                    cs&#39;&#39;16</span>
<span class="sd">                    a&#39;16</span>
<span class="sd">                    fs&#39;16</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                    cs&#39;16</span>
<span class="sd">                    fs16</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; container.insert(-4, abjad.Note(&quot;e&#39;4&quot;))</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                {</span>
<span class="sd">                    fs16</span>
<span class="sd">                    cs&#39;16</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                    a&#39;16</span>
<span class="sd">                    cs&#39;&#39;16</span>
<span class="sd">                    e&#39;&#39;16</span>
<span class="sd">                    cs&#39;&#39;16</span>
<span class="sd">                    a&#39;16</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    fs&#39;16</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                    cs&#39;16</span>
<span class="sd">                    fs16</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">components</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_string</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">components</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
            <span class="n">component</span> <span class="o">=</span> <span class="n">components</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Component</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="p">[</span><span class="n">component</span><span class="p">])</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="Container.pop">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Container.pop">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Component</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pops component from container at index ``i``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Pops last element from container:</span>

<span class="sd">            &gt;&gt;&gt; container = abjad.Container(&quot;c&#39;4 ( d&#39;4 f&#39;4 ) e&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    (</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    )</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; container.pop()</span>
<span class="sd">            Note(&quot;e&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    (</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    )</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">component</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">component</span></div>


<div class="viewcode-block" id="Container.remove">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Container.remove">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="n">Component</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes ``component`` from container.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Removes note from container:</span>

<span class="sd">            &gt;&gt;&gt; container = abjad.Container(&quot;c&#39;4 d&#39;4 f&#39;4 e&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; note = container[2]</span>
<span class="sd">            &gt;&gt;&gt; note</span>
<span class="sd">            Note(&quot;f&#39;4&quot;)</span>

<span class="sd">            &gt;&gt;&gt; container.remove(note)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(container) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(container)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Component</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>
</div>



<div class="viewcode-block" id="AfterGraceContainer">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.AfterGraceContainer">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">AfterGraceContainer</span><span class="p">(</span><span class="n">Container</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    After grace container.</span>

<span class="sd">    After grace notes are played in the last moments of duration of the note</span>
<span class="sd">    they follow.</span>

<span class="sd">    Fill after grace containers with notes, rests or chords.</span>

<span class="sd">    Attach after grace containers to notes, rests or chords.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        LilyPond positions after grace notes at a point 3/4 of the way after</span>
<span class="sd">        the note they follow. The resulting spacing is usually too loose.</span>
<span class="sd">        Customize ``fraction`` as shown here:</span>

<span class="sd">        &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; notes = [abjad.Note(&quot;c&#39;16&quot;), abjad.Note(&quot;d&#39;16&quot;)]</span>
<span class="sd">        &gt;&gt;&gt; after_grace_container = abjad.AfterGraceContainer(notes, fraction=(15, 16))</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(after_grace_container, voice[1])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Voice</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                \afterGrace 15/16</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                }</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        REGRESSION. After grace containers format correctly with main note</span>
<span class="sd">        articulations and markup:</span>

<span class="sd">        &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; container = abjad.AfterGraceContainer(&quot;c&#39;16 d&#39;16&quot;, fraction=(15, 16))</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">        &gt;&gt;&gt; leaves = abjad.select.leaves(voice, grace=None)</span>
<span class="sd">        &gt;&gt;&gt; markup = abjad.Markup(r&#39;\markup Allegro&#39;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(markup, leaves[1], direction=abjad.UP)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(abjad.Articulation(&quot;.&quot;), leaves[1])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Voice</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                \afterGrace 15/16</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                - \staccato</span>
<span class="sd">                ^ \markup Allegro</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                }</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        REGRESSION #1074. After grace containers format correctly with chords</span>
<span class="sd">        and overrides. It is important here that the ``\afterGrace`` command</span>
<span class="sd">        appear lexically after the ``\override`` command:</span>

<span class="sd">        &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 &lt;d&#39; f&#39;&gt;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; container = abjad.AfterGraceContainer(&quot;c&#39;16 d&#39;16&quot;, fraction=(15, 16))</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(voice[1]).NoteHead.color = &quot;#red&quot;</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Voice</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                \once \override NoteHead.color = #red</span>
<span class="sd">                \afterGrace 15/16</span>
<span class="sd">                &lt;d&#39; f&#39;&gt;4</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                }</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_fraction&quot;</span><span class="p">,</span> <span class="s2">&quot;_main_leaf&quot;</span><span class="p">)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">fraction</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># NOTE: _main_leaf must be initialized before container initialization</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_main_leaf</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">Container</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_fraction</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>

    <span class="c1">### SPECIAL METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets new after grace container arguments.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.AfterGraceContainer(&quot;d&#39;8&quot;, fraction=(15, 16)).__getnewargs__()</span>
<span class="sd">            ((15, 16),)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fraction</span><span class="p">(),)</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_attach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">leaf</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="s2">&quot;written_duration&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;must attach to leaf (not </span><span class="si">{</span><span class="n">leaf</span><span class="si">!r}</span><span class="s2">).&quot;</span><span class="p">)</span>
        <span class="n">leaf</span><span class="o">.</span><span class="n">_after_grace_container</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_main_leaf</span> <span class="o">=</span> <span class="n">leaf</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detach</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_main_leaf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">main_leaf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_main_leaf</span>
            <span class="n">main_leaf</span><span class="o">.</span><span class="n">_after_grace_container</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_main_leaf</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_open_brackets_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;{&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">result</span>

<div class="viewcode-block" id="AfterGraceContainer.fraction">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.AfterGraceContainer.fraction">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets LilyPond `\afterGraceFraction`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fraction</span></div>


<div class="viewcode-block" id="AfterGraceContainer.set_fraction">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.AfterGraceContainer.set_fraction">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fraction</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets LilyPond `\afterGraceFraction`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fraction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fraction</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fraction</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fraction</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fraction</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fraction</span> <span class="o">=</span> <span class="n">fraction</span></div>
</div>



<div class="viewcode-block" id="BeforeGraceContainer">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.BeforeGraceContainer">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">BeforeGraceContainer</span><span class="p">(</span><span class="n">Container</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Grace container.</span>

<span class="sd">    LilyPond provides four types of left-positioned grace music: acciaccaturas,</span>
<span class="sd">    appoggiaturas, grace notes and slashed grace notes; see</span>
<span class="sd">    ``abjad.BeforeGraceContainer.command`` to choose between these. LilyPond&#39;s</span>
<span class="sd">    left-positioned grace music contrasts with &quot;right-positioned&quot; after-grace</span>
<span class="sd">    music; see ``abjad.AfterGraceContainer``.</span>

<span class="sd">    Note that neither LilyPond nor Abjad attempts to model the ways that</span>
<span class="sd">    different categories of grace music have been performed historically.</span>
<span class="sd">    Typographic differences in slurring and slashing are provided. But</span>
<span class="sd">    distinctions between (for example) on-the-beat versus before-the-beat</span>
<span class="sd">    performance are left implicit.</span>

<span class="sd">    .. container:: example</span>

<span class="sd">        Grace container models LilyPond&#39;s different types of &quot;left-positioned&quot;</span>
<span class="sd">        grace music:</span>

<span class="sd">        &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cs&#39;16 ds&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Voice</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                \grace {</span>
<span class="sd">                    cs&#39;16</span>
<span class="sd">                    ds&#39;16</span>
<span class="sd">                }</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Fill grace containers with notes, rests or chords:</span>

<span class="sd">        &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;&lt;cs&#39; ds&#39;&gt;16 e&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Voice</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                \grace {</span>
<span class="sd">                    &lt;cs&#39; ds&#39;&gt;16</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                }</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Detach grace containers like this:</span>

<span class="sd">        &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;&lt;cs&#39; ds&#39;&gt;16 e&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Voice</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                \grace {</span>
<span class="sd">                    &lt;cs&#39; ds&#39;&gt;16</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                }</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">        &gt;&gt;&gt; abjad.detach(abjad.BeforeGraceContainer, voice[1])</span>
<span class="sd">        (BeforeGraceContainer(&quot;&lt;cs&#39; ds&#39;&gt;16 e&#39;16&quot;),)</span>

<span class="sd">        &gt;&gt;&gt; abjad.detach(abjad.BeforeGraceContainer, voice[1])</span>
<span class="sd">        ()</span>

<span class="sd">        &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Voice</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Move grace containers like this:</span>

<span class="sd">        &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;&lt;cs&#39; ds&#39;&gt;16 e&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Voice</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                \grace {</span>
<span class="sd">                    &lt;cs&#39; ds&#39;&gt;16</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                }</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">        &gt;&gt;&gt; result = abjad.detach(abjad.BeforeGraceContainer, voice[1])</span>
<span class="sd">        &gt;&gt;&gt; container = result[0]</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(container, voice[3])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Voice</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                \grace {</span>
<span class="sd">                    &lt;cs&#39; ds&#39;&gt;16</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                }</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_command&quot;</span><span class="p">,</span> <span class="s2">&quot;_main_leaf&quot;</span><span class="p">)</span>

    <span class="n">_commands</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;\acciaccatura&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;\appoggiatura&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;\grace&quot;</span><span class="p">,</span>
        <span class="sa">r</span><span class="s2">&quot;\slashedGrace&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\grace&quot;</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">command</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_commands</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;unknown command: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot;  must be in </span><span class="si">{self._commands}</span><span class="s2">&quot;</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_command</span> <span class="o">=</span> <span class="n">command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_main_leaf</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">Container</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>

    <span class="c1">### SPECIAL METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets new grace container arguments.</span>

<span class="sd">        Returns tuple of single empty list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">([],)</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_attach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">leaf</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="s2">&quot;written_duration&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;must attach to leaf </span><span class="si">{</span><span class="n">leaf</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">leaf</span><span class="o">.</span><span class="n">_before_grace_container</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_main_leaf</span> <span class="o">=</span> <span class="n">leaf</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_detach</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_main_leaf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">main_leaf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_main_leaf</span>
            <span class="n">main_leaf</span><span class="o">.</span><span class="n">_before_grace_container</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_main_leaf</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_open_brackets_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="se">{{</span><span class="s2">&quot;</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">string</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

<div class="viewcode-block" id="BeforeGraceContainer.command">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.BeforeGraceContainer.command">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets command. Chooses between LilyPond&#39;s four types of left-positioned</span>
<span class="sd">        grace music.</span>

<span class="sd">        .. container:: example</span>

<span class="sd">            **(Vanilla) grace notes.** LilyPond formats single grace notes with</span>
<span class="sd">            neither a slash nor a slur:</span>

<span class="sd">            &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cs&#39;16&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \new Voice</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \grace {</span>
<span class="sd">                        cs&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            LilyPond likewise formats runs of grace notes with neither a slash</span>
<span class="sd">            nor a slur:</span>

<span class="sd">            &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cs&#39;16 ds&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \new Voice</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \grace {</span>
<span class="sd">                        cs&#39;16</span>
<span class="sd">                        ds&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>

<span class="sd">        .. container:: example</span>

<span class="sd">            **Acciaccaturas.** LilyPond formats single acciaccaturas with both</span>
<span class="sd">            a slash and a slur:</span>

<span class="sd">            &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.BeforeGraceContainer(</span>
<span class="sd">            ...     &quot;cs&#39;16&quot;, command=r&quot;\acciaccatura&quot;</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \new Voice</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \acciaccatura {</span>
<span class="sd">                        cs&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            ..  container:: example exception</span>

<span class="sd">                But LilyPond fails to slash runs of acciaccaturas. This</span>
<span class="sd">                behavior is a longstanding LilyPond bug:</span>

<span class="sd">                &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.BeforeGraceContainer(</span>
<span class="sd">                ...     &quot;cs&#39;16 ds&#39;&quot;, command=r&quot;\acciaccatura&quot;</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">                ..  docs::</span>

<span class="sd">                    &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">                    &gt;&gt;&gt; print(string)</span>
<span class="sd">                    \new Voice</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \acciaccatura {</span>
<span class="sd">                            cs&#39;16</span>
<span class="sd">                            ds&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                        f&#39;4</span>
<span class="sd">                    }</span>

<span class="sd">                ..  note:: LilyPond fails to slash runs of acciaccaturas.</span>

<span class="sd">        .. container:: example</span>

<span class="sd">            **Appoggiaturas.** LilyPond formats single appoggiaturas with only</span>
<span class="sd">            a slur; no slash is included:</span>

<span class="sd">            &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.BeforeGraceContainer(</span>
<span class="sd">            ...     &quot;cs&#39;16&quot;, command=r&quot;\appoggiatura&quot;</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \new Voice</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \appoggiatura {</span>
<span class="sd">                        cs&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            LilyPond likewise formats runs of appoggiaturas with only a slur:</span>

<span class="sd">            &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.BeforeGraceContainer(</span>
<span class="sd">            ...     &quot;cs&#39;16 ds&#39;&quot;, command=r&quot;\appoggiatura&quot;</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \new Voice</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \appoggiatura {</span>
<span class="sd">                        cs&#39;16</span>
<span class="sd">                        ds&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>

<span class="sd">        .. container:: example</span>

<span class="sd">            **Slashed grace notes.** LilyPond formats single slashed grace</span>
<span class="sd">            notes with only a slash; no slur is included:</span>

<span class="sd">            &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.BeforeGraceContainer(</span>
<span class="sd">            ...     &quot;cs&#39;16&quot;, command=r&quot;\slashedGrace&quot;</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \new Voice</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \slashedGrace {</span>
<span class="sd">                        cs&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            ..  container:: example exception</span>

<span class="sd">                But LilyPond fails to slash runs of &quot;slashed&quot; grace notes. This</span>
<span class="sd">                is a longstanding LilyPond bug:</span>

<span class="sd">                &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.BeforeGraceContainer(</span>
<span class="sd">                ...     &quot;cs&#39;16 ds&#39;&quot;, command=r&quot;\slashedGrace&quot;</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">                ..  docs::</span>

<span class="sd">                    &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">                    &gt;&gt;&gt; print(string)</span>
<span class="sd">                    \new Voice</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \slashedGrace {</span>
<span class="sd">                            cs&#39;16</span>
<span class="sd">                            ds&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                        f&#39;4</span>
<span class="sd">                    }</span>

<span class="sd">                ..  note:: LilyPond fails to slash runs of &quot;slashed&quot; grace notes.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            LilyPond ``\acciaccatura``, ``\appoggiatura`` are syntactic sugar.</span>

<span class="sd">            .. container:: example</span>

<span class="sd">                **Grace notes with slur may be used instead of appoggiatura:**</span>

<span class="sd">                &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cs&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">                &gt;&gt;&gt; leaves = abjad.select.leaves(voice)[1:3]</span>
<span class="sd">                &gt;&gt;&gt; abjad.slur(leaves)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">                ..  docs::</span>

<span class="sd">                    &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">                    &gt;&gt;&gt; print(string)</span>
<span class="sd">                    \new Voice</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            cs&#39;16</span>
<span class="sd">                            (</span>
<span class="sd">                        }</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        )</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                        f&#39;4</span>
<span class="sd">                    }</span>

<span class="sd">            .. container:: example</span>

<span class="sd">                **Slashed grace notes with slur may be used instead of</span>
<span class="sd">                acciaccatura:**</span>

<span class="sd">                &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.BeforeGraceContainer(</span>
<span class="sd">                ...     &quot;cs&#39;16&quot;, command=r&quot;\slashedGrace&quot;</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">                &gt;&gt;&gt; leaves = abjad.select.leaves(voice)[1:3]</span>
<span class="sd">                &gt;&gt;&gt; abjad.slur(leaves)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">                ..  docs::</span>

<span class="sd">                    &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">                    &gt;&gt;&gt; print(string)</span>
<span class="sd">                    \new Voice</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \slashedGrace {</span>
<span class="sd">                            cs&#39;16</span>
<span class="sd">                            (</span>
<span class="sd">                        }</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        )</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                        f&#39;4</span>
<span class="sd">                    }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_command</span></div>
</div>



<div class="viewcode-block" id="Chord">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Chord">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Chord</span><span class="p">(</span><span class="n">Leaf</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Chord.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; chord = abjad.Chord(&quot;&lt;e&#39; cs&#39;&#39; f&#39;&#39;&gt;4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(chord)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            &lt;e&#39; cs&#39;&#39; f&#39;&#39;&gt;4</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_note_heads&quot;</span><span class="p">,)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">arguments</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">multiplier</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_note_heads</span> <span class="o">=</span> <span class="n">NoteHeadList</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">}}</span><span class="s2">&quot;</span>
            <span class="n">parsed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_lilypond_string</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parsed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Leaf</span><span class="p">)</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">parsed</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="n">are_cautionary</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">are_forced</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">are_parenthesized</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Leaf</span><span class="p">):</span>
            <span class="n">leaf</span> <span class="o">=</span> <span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">written_pitches</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">written_duration</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">multiplier</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">multiplier</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span>
            <span class="c1"># TODO: move to dedicated from_note() constructor:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">Note</span><span class="p">)</span> <span class="ow">and</span> <span class="n">leaf</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">written_pitches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leaf</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">())</span>
                <span class="n">are_cautionary</span> <span class="o">=</span> <span class="p">[</span><span class="n">leaf</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span><span class="o">.</span><span class="n">is_cautionary</span><span class="p">()]</span>
                <span class="n">are_forced</span> <span class="o">=</span> <span class="p">[</span><span class="n">leaf</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span><span class="o">.</span><span class="n">is_forced</span><span class="p">()]</span>
                <span class="n">are_parenthesized</span> <span class="o">=</span> <span class="p">[</span><span class="n">leaf</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span><span class="o">.</span><span class="n">is_parenthesized</span><span class="p">()]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">Chord</span><span class="p">):</span>
                <span class="n">written_pitches</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">leaf</span><span class="o">.</span><span class="n">note_heads</span><span class="p">())</span>
                <span class="n">are_cautionary</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="o">.</span><span class="n">is_cautionary</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">leaf</span><span class="o">.</span><span class="n">note_heads</span><span class="p">()]</span>
                <span class="n">are_forced</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="o">.</span><span class="n">is_forced</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">leaf</span><span class="o">.</span><span class="n">note_heads</span><span class="p">()]</span>
                <span class="n">are_parenthesized</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="o">.</span><span class="n">is_parenthesized</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">leaf</span><span class="o">.</span><span class="n">note_heads</span><span class="p">()]</span>
        <span class="c1"># TODO: move to dedicated constructor:</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">written_pitches</span><span class="p">,</span> <span class="n">written_duration</span> <span class="o">=</span> <span class="n">arguments</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">written_pitches</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">written_pitches</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">written_pitches</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">if</span> <span class="n">_</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">written_pitches</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
                <span class="n">written_pitches</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">written_pitches</span><span class="o">.</span><span class="n">written_pitches</span><span class="p">())</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">written_pitches</span> <span class="o">=</span> <span class="p">[</span><span class="n">_pitch</span><span class="o">.</span><span class="n">NamedPitch</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span>
            <span class="n">written_duration</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;can not initialize chord from </span><span class="si">{</span><span class="n">arguments</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">Leaf</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">written_duration</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">=</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">are_cautionary</span><span class="p">:</span>
            <span class="n">are_cautionary</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">written_pitches</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">are_forced</span><span class="p">:</span>
            <span class="n">are_forced</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">written_pitches</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">are_parenthesized</span><span class="p">:</span>
            <span class="n">are_parenthesized</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">written_pitches</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">written_pitch</span><span class="p">,</span> <span class="n">is_cautionary</span><span class="p">,</span> <span class="n">is_forced</span><span class="p">,</span> <span class="n">is_parenthesized</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">written_pitches</span><span class="p">,</span> <span class="n">are_cautionary</span><span class="p">,</span> <span class="n">are_forced</span><span class="p">,</span> <span class="n">are_parenthesized</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_cautionary</span><span class="p">:</span>
                <span class="n">is_cautionary</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_forced</span><span class="p">:</span>
                <span class="n">is_forced</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_parenthesized</span><span class="p">:</span>
                <span class="n">is_parenthesized</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">written_pitch</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_lyconst</span><span class="o">.</span><span class="n">drums</span><span class="p">:</span>
                <span class="n">note_head</span> <span class="o">=</span> <span class="n">NoteHead</span><span class="p">(</span>
                    <span class="n">written_pitch</span><span class="o">=</span><span class="n">written_pitch</span><span class="p">,</span>
                    <span class="n">is_cautionary</span><span class="o">=</span><span class="n">is_cautionary</span><span class="p">,</span>
                    <span class="n">is_forced</span><span class="o">=</span><span class="n">is_forced</span><span class="p">,</span>
                    <span class="n">is_parenthesized</span><span class="o">=</span><span class="n">is_parenthesized</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">written_pitch</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">written_pitch</span><span class="p">)</span>
                <span class="n">note_head</span> <span class="o">=</span> <span class="n">DrumNoteHead</span><span class="p">(</span>
                    <span class="n">written_pitch</span><span class="o">=</span><span class="n">written_pitch</span><span class="p">,</span>
                    <span class="n">is_cautionary</span><span class="o">=</span><span class="n">is_cautionary</span><span class="p">,</span>
                    <span class="n">is_forced</span><span class="o">=</span><span class="n">is_forced</span><span class="p">,</span>
                    <span class="n">is_parenthesized</span><span class="o">=</span><span class="n">is_parenthesized</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">written_pitch</span><span class="p">,</span> <span class="n">NoteHead</span><span class="p">):</span>
                <span class="n">note_head</span><span class="o">.</span><span class="n">tweaks</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">written_pitch</span><span class="o">.</span><span class="n">tweaks</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_note_heads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">note_head</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Leaf</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_copy_override_and_set_from_leaf</span><span class="p">(</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1">### SPECIAL METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arguments</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Chord&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Copies chord.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_chord</span> <span class="o">=</span> <span class="n">Leaf</span><span class="o">.</span><span class="n">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arguments</span><span class="p">)</span>
        <span class="n">new_chord</span><span class="o">.</span><span class="n">note_heads</span><span class="p">()[:]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">note_head</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">note_heads</span><span class="p">():</span>
            <span class="n">note_head</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">note_head</span><span class="p">)</span>
            <span class="n">new_chord</span><span class="o">.</span><span class="n">note_heads</span><span class="p">()</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">note_head</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_chord</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__getnewargs__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">_pitch</span><span class="o">.</span><span class="n">NamedPitch</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets new chord arguments.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.Chord(&quot;&lt;c&#39; d&#39;&gt;4&quot;).__getnewargs__()</span>
<span class="sd">            ((NamedPitch(&quot;c&#39;&quot;), NamedPitch(&quot;d&#39;&quot;)), Duration(1, 4))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">written_pitches</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_before_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_before_grace_container</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_before_grace_container</span><span class="o">.</span><span class="n">_get_lilypond_format</span><span class="p">()</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">before</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">grob_overrides</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">GROB_OVERRIDES</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">context_settings</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">CONTEXT_SETTINGS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_leaf_nucleus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">note_heads</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">note_heads</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">_</span><span class="o">.</span><span class="n">_get_lilypond_format</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">note_heads</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">note_head</span> <span class="ow">in</span> <span class="n">note_heads</span><span class="p">:</span>
                <span class="n">current_format</span> <span class="o">=</span> <span class="n">note_head</span><span class="o">.</span><span class="n">_get_lilypond_format</span><span class="p">()</span>
                <span class="n">format_list</span> <span class="o">=</span> <span class="n">current_format</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">format_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">_indentlib</span><span class="o">.</span><span class="n">INDENT</span> <span class="o">+</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">format_list</span><span class="p">]</span>
                <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">format_list</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_duration</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">_</span><span class="o">.</span><span class="n">_get_lilypond_format</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">note_heads</span><span class="p">])</span>
            <span class="n">pitches</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_duration</span><span class="p">()</span>
            <span class="n">result</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="n">pitches</span><span class="si">}</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">duration</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="c1"># single string, but wrapped in list bc contribution</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_compact_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_summary</span><span class="p">()</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_duration</span><span class="p">()</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="n">summary</span><span class="si">}</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">duration</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_</span><span class="o">.</span><span class="n">_get_chord_string</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">note_heads</span><span class="p">()])</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

<div class="viewcode-block" id="Chord.note_heads">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Chord.note_heads">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">note_heads</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;NoteHeadList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets note-heads in chord.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets note-heads in chord:</span>

<span class="sd">            &gt;&gt;&gt; chord = abjad.Chord(&quot;&lt;g&#39; c&#39;&#39; e&#39;&#39;&gt;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>
<span class="sd">            &gt;&gt;&gt; for _ in chord.note_heads(): _</span>
<span class="sd">            NoteHead(&quot;g&#39;&quot;)</span>
<span class="sd">            NoteHead(&quot;c&#39;&#39;&quot;)</span>
<span class="sd">            NoteHead(&quot;e&#39;&#39;&quot;)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Sets note-heads with pitch names:</span>

<span class="sd">            &gt;&gt;&gt; chord = abjad.Chord(&quot;&lt;g&#39; c&#39;&#39; e&#39;&#39;&gt;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; chord.set_note_heads(&quot;c&#39; d&#39; fs&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(chord)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                &lt;c&#39; d&#39; fs&#39;&gt;4</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Sets note-heads with pitch numbers:</span>

<span class="sd">                &gt;&gt;&gt; chord = abjad.Chord(&quot;&lt;g&#39; c&#39;&#39; e&#39;&#39;&gt;4&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; chord.set_note_heads([16, 17, 19])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(chord)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                &lt;e&#39;&#39; f&#39;&#39; g&#39;&#39;&gt;4</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_note_heads</span></div>


<div class="viewcode-block" id="Chord.set_note_heads">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Chord.set_note_heads">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_note_heads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">note_heads</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets note-heads in chord.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_note_heads</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">note_heads</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">note_heads</span> <span class="o">=</span> <span class="n">note_heads</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">note_heads</span><span class="p">()</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">note_heads</span><span class="p">)</span></div>


<div class="viewcode-block" id="Chord.written_duration">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Chord.written_duration">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">written_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets and sets written duration of chord.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Get written duration:</span>

<span class="sd">            &gt;&gt;&gt; chord = abjad.Chord(&quot;&lt;e&#39; cs&#39;&#39; f&#39;&#39;&gt;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; chord.written_duration()</span>
<span class="sd">            Duration(1, 4)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Set written duration:</span>

<span class="sd">            &gt;&gt;&gt; chord = abjad.Chord(&quot;&lt;e&#39; cs&#39;&#39; f&#39;&#39;&gt;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; chord.set_written_duration(abjad.Duration(1, 16))</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span></div>


<div class="viewcode-block" id="Chord.set_written_duration">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Chord.set_written_duration">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_written_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="n">Leaf</span><span class="o">.</span><span class="n">set_written_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span></div>


<div class="viewcode-block" id="Chord.written_pitches">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Chord.written_pitches">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">written_pitches</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_pitch</span><span class="o">.</span><span class="n">NamedPitch</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Written pitches in chord.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Get written pitches:</span>

<span class="sd">            &gt;&gt;&gt; chord = abjad.Chord(&quot;&lt;g&#39; c&#39;&#39; e&#39;&#39;&gt;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; chord.written_pitches()</span>
<span class="sd">            (NamedPitch(&quot;g&#39;&quot;), NamedPitch(&quot;c&#39;&#39;&quot;), NamedPitch(&quot;e&#39;&#39;&quot;))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Set written pitches with pitch names:</span>

<span class="sd">            &gt;&gt;&gt; chord = abjad.Chord(&quot;&lt;e&#39; g&#39; c&#39;&#39;&gt;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; chord.set_written_pitches(&quot;f&#39; b&#39; d&#39;&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(chord)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                &lt;f&#39; b&#39; d&#39;&#39;&gt;4</span>

<span class="sd">            &gt;&gt;&gt; chord.written_pitches()</span>
<span class="sd">            (NamedPitch(&quot;f&#39;&quot;), NamedPitch(&quot;b&#39;&quot;), NamedPitch(&quot;d&#39;&#39;&quot;))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">note_heads</span><span class="p">())</span></div>


<div class="viewcode-block" id="Chord.set_written_pitches">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Chord.set_written_pitches">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_written_pitches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pitches</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_note_heads</span><span class="p">(</span><span class="n">pitches</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="Cluster">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Cluster">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Cluster</span><span class="p">(</span><span class="n">Container</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cluster.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; cluster = abjad.Cluster(&quot;c&#39;8 &lt;d&#39; g&#39;&gt;8 b&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(cluster) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(cluster)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \makeClusters {</span>
<span class="sd">                c&#39;8</span>
<span class="sd">                &lt;d&#39; g&#39;&gt;8</span>
<span class="sd">                b&#39;8</span>
<span class="sd">            }</span>

<span class="sd">        &gt;&gt;&gt; cluster</span>
<span class="sd">        Cluster(&quot;c&#39;8 &lt;d&#39; g&#39;&gt;8 b&#39;8&quot;)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_open_brackets_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">simultaneous</span><span class="p">():</span>
            <span class="n">brackets_open</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&lt;&lt;&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">brackets_open</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;{&quot;</span><span class="p">]</span>
        <span class="n">string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\makeClusters </span><span class="si">{</span><span class="n">brackets_open</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>



<div class="viewcode-block" id="Context">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Context">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Context</span><span class="p">(</span><span class="n">Container</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LilyPond context.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; context = abjad.Context(lilypond_type=&#39;GlobalContext&#39;, name=&#39;Meter_Voice&#39;)</span>
<span class="sd">        &gt;&gt;&gt; context</span>
<span class="sd">        Context(lilypond_type=&#39;GlobalContext&#39;, name=&#39;Meter_Voice&#39;)</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(context)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context GlobalContext = &quot;Meter_Voice&quot;</span>
<span class="sd">            {</span>
<span class="sd">            }</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_lilypond_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_consists_commands&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_dependent_wrappers&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_remove_commands&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">_default_lilypond_type</span> <span class="o">=</span> <span class="s2">&quot;Voice&quot;</span>

    <span class="n">lilypond_types</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;Score&quot;</span><span class="p">,</span>
        <span class="s2">&quot;StaffGroup&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ChoirStaff&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GrandStaff&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PianoStaff&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Staff&quot;</span><span class="p">,</span>
        <span class="s2">&quot;RhythmicStaff&quot;</span><span class="p">,</span>
        <span class="s2">&quot;TabStaff&quot;</span><span class="p">,</span>
        <span class="s2">&quot;DrumStaff&quot;</span><span class="p">,</span>
        <span class="s2">&quot;VaticanaStaff&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MensuralStaff&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Voice&quot;</span><span class="p">,</span>
        <span class="s2">&quot;VaticanaVoice&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MensuralVoice&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Lyrics&quot;</span><span class="p">,</span>
        <span class="s2">&quot;DrumVoice&quot;</span><span class="p">,</span>
        <span class="s2">&quot;FiguredBass&quot;</span><span class="p">,</span>
        <span class="s2">&quot;TabVoice&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CueVoice&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ChordNames&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">lilypond_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Context&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">simultaneous</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_consists_commands</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dependent_wrappers</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_remove_commands</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_lilypond_type</span><span class="p">(</span><span class="n">lilypond_type</span><span class="p">)</span>
        <span class="n">Container</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">simultaneous</span><span class="o">=</span><span class="n">simultaneous</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1">### SPECIAL METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arguments</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shallow copies context.</span>

<span class="sd">        Copies indicators.</span>

<span class="sd">        Does not copy children.</span>

<span class="sd">        Returns new component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_context</span> <span class="o">=</span> <span class="n">Container</span><span class="o">.</span><span class="n">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">new_context</span><span class="o">.</span><span class="n">_consists_commands</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">consists_commands</span><span class="p">())</span>
        <span class="n">new_context</span><span class="o">.</span><span class="n">_remove_commands</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_commands</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">new_context</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets new context arguments.</span>

<span class="sd">        Returns tuple.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">([],)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets interpreter representation of context.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; context = abjad.Context(</span>
<span class="sd">            ...     lilypond_type=&#39;GlobalContext&#39;,</span>
<span class="sd">            ...     name=&#39;Meter_Voice&#39;,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; repr(context)</span>
<span class="sd">            &quot;Context(lilypond_type=&#39;GlobalContext&#39;, name=&#39;Meter_Voice&#39;)&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">():</span>
            <span class="n">string</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_contents_summary</span><span class="p">())</span>
            <span class="n">parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lilypond_type</span><span class="p">()</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span>
            <span class="n">parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;lilypond_type=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lilypond_type</span><span class="p">()</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">():</span>
            <span class="n">parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">()</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">simultaneous</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;simultaneous=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">simultaneous</span><span class="p">()</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_closing_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">closing</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_indent_strings</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_consists_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">engraver</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">consists_commands</span><span class="p">():</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\consists </span><span class="si">{</span><span class="n">engraver</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_invocation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s1">&#39;\context </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lilypond_type</span><span class="p">()</span><span class="si">}</span><span class="s1"> = &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">()</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\new </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lilypond_type</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_open_brackets_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">simultaneous</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">():</span>
                <span class="n">open_bracket</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;&lt;  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">open_bracket</span> <span class="o">=</span> <span class="s2">&quot;&lt;&lt;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">():</span>
                <span class="n">open_bracket</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2">   </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">open_bracket</span> <span class="o">=</span> <span class="s2">&quot;{&quot;</span>
        <span class="n">brackets_open</span> <span class="o">=</span> <span class="p">[</span><span class="n">open_bracket</span><span class="p">]</span>
        <span class="n">remove_commands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_remove_commands</span><span class="p">()</span>
        <span class="n">consists_commands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_consists_commands</span><span class="p">()</span>
        <span class="n">overrides</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">grob_overrides</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">context_settings</span>
        <span class="k">if</span> <span class="n">remove_commands</span> <span class="ow">or</span> <span class="n">consists_commands</span> <span class="ow">or</span> <span class="n">overrides</span> <span class="ow">or</span> <span class="n">settings</span><span class="p">:</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_format_invocation</span><span class="p">(),</span> <span class="sa">r</span><span class="s2">&quot;\with&quot;</span><span class="p">,</span> <span class="s2">&quot;{&quot;</span><span class="p">]</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_strings</span><span class="p">(</span><span class="n">contributions</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">contributions</span><span class="p">)</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="p">[</span><span class="n">_indentlib</span><span class="o">.</span><span class="n">INDENT</span> <span class="o">+</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">remove_commands</span><span class="p">]</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_strings</span><span class="p">(</span><span class="n">contributions</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">contributions</span><span class="p">)</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="p">[</span><span class="n">_indentlib</span><span class="o">.</span><span class="n">INDENT</span> <span class="o">+</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">consists_commands</span><span class="p">]</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_strings</span><span class="p">(</span><span class="n">contributions</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">contributions</span><span class="p">)</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="p">[</span><span class="n">_indentlib</span><span class="o">.</span><span class="n">INDENT</span> <span class="o">+</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">overrides</span><span class="p">]</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_strings</span><span class="p">(</span><span class="n">contributions</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">contributions</span><span class="p">)</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="p">[</span><span class="n">_indentlib</span><span class="o">.</span><span class="n">INDENT</span> <span class="o">+</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">settings</span><span class="p">]</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_strings</span><span class="p">(</span><span class="n">contributions</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">contributions</span><span class="p">)</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">}}</span><span class="s2"> </span><span class="si">{</span><span class="n">brackets_open</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="n">open_bracket</span><span class="p">]</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_strings</span><span class="p">(</span><span class="n">contributions</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">contributions</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">contribution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_invocation</span><span class="p">()</span>
            <span class="n">contribution</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">brackets_open</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="p">[</span><span class="n">contribution</span><span class="p">]</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_format_invocation</span><span class="p">(),</span> <span class="n">open_bracket</span><span class="p">]</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_strings</span><span class="p">(</span><span class="n">contributions</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">contributions</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_opening_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">opening</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_indent_strings</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_remove_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">engraver</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_commands</span><span class="p">():</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\remove </span><span class="si">{</span><span class="n">engraver</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

<div class="viewcode-block" id="Context.consists_commands">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Context.consists_commands">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">consists_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unordered set of LilyPond engravers to include in context definition.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Manage with add, update, other standard set commands:</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff([])</span>
<span class="sd">            &gt;&gt;&gt; staff.consists_commands().append(&quot;Horizontal_bracket_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(staff)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \consists Horizontal_bracket_engraver</span>
<span class="sd">            }</span>
<span class="sd">            {</span>
<span class="sd">            }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_consists_commands</span></div>


<div class="viewcode-block" id="Context.lilypond_context">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Context.lilypond_context">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">lilypond_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets ``LilyPondContext`` associated with context.</span>

<span class="sd">        Returns LilyPond context instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lilypond_context</span> <span class="o">=</span> <span class="n">_lyproxy</span><span class="o">.</span><span class="n">LilyPondContext</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lilypond_type</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
            <span class="n">lilypond_context</span> <span class="o">=</span> <span class="n">_lyproxy</span><span class="o">.</span><span class="n">LilyPondContext</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_lilypond_type</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">lilypond_context</span></div>


<div class="viewcode-block" id="Context.lilypond_type">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Context.lilypond_type">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">lilypond_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets LilyPond type of context.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; context = abjad.Context(</span>
<span class="sd">            ...     lilypond_type=&quot;ViolinStaff&quot;,</span>
<span class="sd">            ...     name=&quot;MyViolinStaff&quot;,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; context.lilypond_type()</span>
<span class="sd">            &#39;ViolinStaff&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lilypond_type</span></div>


<div class="viewcode-block" id="Context.set_lilypond_type">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Context.set_lilypond_type">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_lilypond_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets LilyPond type of context.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">argument</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lilypond_type</span> <span class="o">=</span> <span class="n">argument</span></div>


<div class="viewcode-block" id="Context.remove_commands">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Context.remove_commands">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Unordered set of LilyPond engravers to remove from context.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Manage with add, update, other standard set commands:</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff([])</span>
<span class="sd">            &gt;&gt;&gt; staff.remove_commands().append(&quot;Time_signature_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(staff)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \remove Time_signature_engraver</span>
<span class="sd">            }</span>
<span class="sd">            {</span>
<span class="sd">            }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_remove_commands</span></div>
</div>



<div class="viewcode-block" id="IndependentAfterGraceContainer">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.IndependentAfterGraceContainer">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">IndependentAfterGraceContainer</span><span class="p">(</span><span class="n">Container</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Independent after grace container.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        LilyPond positions after grace notes at a point 3/4 of the way after</span>
<span class="sd">        the note they follow. The resulting spacing is usually too loose.</span>
<span class="sd">        Customize ``fraction`` as shown:</span>

<span class="sd">        &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; notes = [abjad.Note(&quot;c&#39;16&quot;), abjad.Note(&quot;d&#39;16&quot;)]</span>
<span class="sd">        &gt;&gt;&gt; container = abjad.IndependentAfterGraceContainer(notes, fraction=(15, 16))</span>
<span class="sd">        &gt;&gt;&gt; voice.insert(2, container)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Voice</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                \afterGrace 15/16</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                }</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_fraction&quot;</span><span class="p">,)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">fraction</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Container</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_fraction</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets new after grace container arguments.</span>

<span class="sd">        Returns tuple of single empty list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">([],)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_open_brackets_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;{&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_preprolated_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<div class="viewcode-block" id="IndependentAfterGraceContainer.fraction">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.IndependentAfterGraceContainer.fraction">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets LilyPond `\afterGraceFraction`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fraction</span></div>


<div class="viewcode-block" id="IndependentAfterGraceContainer.set_fraction">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.IndependentAfterGraceContainer.set_fraction">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fraction</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets LilyPond `\afterGraceFraction`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fraction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fraction</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fraction</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fraction</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fraction</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fraction</span> <span class="o">=</span> <span class="n">fraction</span></div>
</div>



<div class="viewcode-block" id="MultimeasureRest">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.MultimeasureRest">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">MultimeasureRest</span><span class="p">(</span><span class="n">Leaf</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Multimeasure rest.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; rest = abjad.MultimeasureRest(&quot;R1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(rest) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(rest)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            R1</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">arguments</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">multiplier</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),)</span>
        <span class="n">rest</span> <span class="o">=</span> <span class="n">Rest</span><span class="p">(</span><span class="o">*</span><span class="n">arguments</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
        <span class="n">Leaf</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rest</span><span class="o">.</span><span class="n">written_duration</span><span class="p">(),</span> <span class="n">multiplier</span><span class="o">=</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_body</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets body of multimeasure rest as list of strings.</span>
<span class="sd">        Picked up as contribution at format-time.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;R&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_duration</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_compact_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;R</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_duration</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span></div>



<div class="viewcode-block" id="NoteHead">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHead">[docs]</a>
<span class="nd">@functools</span><span class="o">.</span><span class="n">total_ordering</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NoteHead</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Note-head.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; note = abjad.Note(&quot;cs&#39;&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">        &gt;&gt;&gt; note.note_head()</span>
<span class="sd">        NoteHead(&quot;cs&#39;&#39;&quot;)</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; note_head = abjad.NoteHead(&quot;cs&#39;&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(note_head, r&quot;\tweak color #red&quot;)</span>
<span class="sd">        &gt;&gt;&gt; note_head.tweaks</span>
<span class="sd">        (Tweak(string=&#39;\\tweak color #red&#39;, i=None, tag=None),)</span>

<span class="sd">        &gt;&gt;&gt; string = abjad.lilypond(note_head)</span>
<span class="sd">        &gt;&gt;&gt; print(string)</span>
<span class="sd">        \tweak color #red</span>
<span class="sd">        cs&#39;&#39;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; chord = abjad.Chord([0, 2, 10], (1, 4))</span>

<span class="sd">        &gt;&gt;&gt; abjad.tweak(chord.note_heads()[0], r&quot;\tweak color #red&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(chord.note_heads()[0], r&quot;\tweak thickness 2&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(chord.note_heads()[1], r&quot;\tweak color #red&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(chord.note_heads()[1], r&quot;\tweak thickness 2&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(chord.note_heads()[2], r&quot;\tweak color #blue&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(chord)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            &lt;</span>
<span class="sd">                \tweak color #red</span>
<span class="sd">                \tweak thickness 2</span>
<span class="sd">                c&#39;</span>
<span class="sd">                \tweak color #red</span>
<span class="sd">                \tweak thickness 2</span>
<span class="sd">                d&#39;</span>
<span class="sd">                \tweak color #blue</span>
<span class="sd">                bf&#39;</span>
<span class="sd">            &gt;4</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_alternative&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_is_cautionary&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_is_forced&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_is_parenthesized&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_written_pitch&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tweaks&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">written_pitch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">is_cautionary</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">is_forced</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">is_parenthesized</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tweaks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alternative</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">tweaks_</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">written_pitch</span><span class="p">,</span> <span class="n">NoteHead</span><span class="p">):</span>
            <span class="n">note_head</span> <span class="o">=</span> <span class="n">written_pitch</span>
            <span class="n">tweaks_</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">note_head</span><span class="o">.</span><span class="n">tweaks</span><span class="p">)</span>
            <span class="n">written_pitch</span> <span class="o">=</span> <span class="n">note_head</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span>
            <span class="n">is_cautionary</span> <span class="o">=</span> <span class="n">note_head</span><span class="o">.</span><span class="n">is_cautionary</span><span class="p">()</span>
            <span class="n">is_forced</span> <span class="o">=</span> <span class="n">note_head</span><span class="o">.</span><span class="n">is_forced</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">written_pitch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">written_pitch</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_written_pitch</span><span class="p">(</span><span class="n">written_pitch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_is_cautionary</span><span class="p">(</span><span class="n">is_cautionary</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_is_forced</span><span class="p">(</span><span class="n">is_forced</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_is_parenthesized</span><span class="p">(</span><span class="n">is_parenthesized</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tweaks</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">tweaks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_tweaks</span><span class="o">.</span><span class="n">Tweak</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tweaks</span><span class="p">)</span>
            <span class="n">tweaks_</span> <span class="o">=</span> <span class="n">tweaks_</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">tweaks</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tweaks</span> <span class="o">=</span> <span class="n">tweaks_</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arguments</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;NoteHead&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Copies note-head.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; import copy</span>
<span class="sd">            &gt;&gt;&gt; note_head = abjad.NoteHead(13)</span>
<span class="sd">            &gt;&gt;&gt; copy.copy(note_head)</span>
<span class="sd">            NoteHead(&quot;cs&#39;&#39;&quot;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">(),</span>
            <span class="n">is_cautionary</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_cautionary</span><span class="p">(),</span>
            <span class="n">is_forced</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_forced</span><span class="p">(),</span>
            <span class="n">is_parenthesized</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_parenthesized</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">tweaks</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tweaks</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">tweaks</span> <span class="o">=</span> <span class="n">tweaks</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when ```argument`` is a note-head with written pitch equal to that of</span>
<span class="sd">        this note-head.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span> <span class="o">==</span> <span class="n">argument</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span> <span class="o">==</span> <span class="n">argument</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Hashes note-head.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__hash__</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when ``argument`` is a note-head with written pitch greater than that of</span>
<span class="sd">        this note-head.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">argument</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">argument</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets interpreter representation of note-head.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; note_head = abjad.NoteHead(13)</span>
<span class="sd">            &gt;&gt;&gt; note_head</span>
<span class="sd">            NoteHead(&quot;cs&#39;&#39;&quot;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">(),</span> <span class="n">_pitch</span><span class="o">.</span><span class="n">NamedPitch</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>
        <span class="c1"># drum note head:</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">(),</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">())</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_cautionary</span><span class="p">():</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;is_cautionary=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">is_cautionary</span><span class="p">()</span><span class="si">!r}</span><span class="s2">&quot;</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_forced</span><span class="p">():</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;is_forced=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">is_forced</span><span class="p">()</span><span class="si">!r}</span><span class="s2">&quot;</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parenthesized</span><span class="p">():</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;is_parenthesized=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">is_parenthesized</span><span class="p">()</span><span class="si">!r}</span><span class="s2">&quot;</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tweaks</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;tweaks=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tweaks</span><span class="si">!r}</span><span class="s2">&quot;</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_chord_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_forced</span><span class="p">():</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;!&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_cautionary</span><span class="p">():</span>
                <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;?&quot;</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_note_head_strings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parenthesized</span><span class="p">():</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\parenthesize&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">tweak</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tweaks</span><span class="p">):</span>
            <span class="n">strings</span> <span class="o">=</span> <span class="n">tweak</span><span class="o">.</span><span class="n">_list_contributions</span><span class="p">()</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">written_pitch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">written_pitch</span><span class="p">,</span> <span class="n">_pitch</span><span class="o">.</span><span class="n">NamedPitch</span><span class="p">):</span>
            <span class="n">written_pitch</span> <span class="o">=</span> <span class="n">written_pitch</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">written_pitch</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
        <span class="c1"># drum note head:</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">written_pitch</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">written_pitch</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_forced</span><span class="p">():</span>
            <span class="n">kernel</span> <span class="o">+=</span> <span class="s2">&quot;!&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_cautionary</span><span class="p">():</span>
            <span class="n">kernel</span> <span class="o">+=</span> <span class="s2">&quot;?&quot;</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kernel</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_lilypond_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">pieces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_note_head_strings</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pieces</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pieces</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">duration</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alternative</span><span class="p">():</span>
            <span class="n">pieces</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">double_tag</span><span class="p">(</span><span class="n">pieces</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alternative</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">pieces_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alternative</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_get_note_head_strings</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">pieces_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pieces_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">duration</span>
            <span class="n">pieces_</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">double_tag</span><span class="p">(</span><span class="n">pieces_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alternative</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="n">deactivate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">pieces</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pieces_</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

<div class="viewcode-block" id="NoteHead.alternative">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHead.alternative">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">alternative</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="s2">&quot;NoteHead&quot;</span><span class="p">,</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span><span class="p">,</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets note-head alternative.</span>

<span class="sd">        &gt;&gt;&gt; import copy</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; note = abjad.Note(&quot;c&#39;&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; alternative = copy.copy(note.note_head())</span>
<span class="sd">            &gt;&gt;&gt; alternative.set_is_forced(True)</span>
<span class="sd">            &gt;&gt;&gt; triple = (alternative, abjad.Tag(&quot;-PARTS&quot;), abjad.Tag(&quot;+PARTS&quot;))</span>
<span class="sd">            &gt;&gt;&gt; note.note_head().set_alternative(triple)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(note, tags=True)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            %! +PARTS</span>
<span class="sd">            c&#39;&#39;4</span>
<span class="sd">            %! -PARTS</span>
<span class="sd">            %@% c&#39;&#39;!4</span>

<span class="sd">            Survives pitch reassignment:</span>

<span class="sd">            &gt;&gt;&gt; note.set_written_pitch(&quot;D5&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(note, tags=True)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            %! +PARTS</span>
<span class="sd">            d&#39;&#39;4</span>
<span class="sd">            %! -PARTS</span>
<span class="sd">            %@% d&#39;&#39;!4</span>

<span class="sd">            Clear with none:</span>

<span class="sd">            &gt;&gt;&gt; note.note_head().set_alternative(None)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(note, tags=True)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            d&#39;&#39;4</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; chord = abjad.Chord(&quot;&lt;c&#39; d&#39; bf&#39;&#39;&gt;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; alternative = copy.copy(chord.note_heads()[0])</span>
<span class="sd">            &gt;&gt;&gt; alternative.set_is_forced(True)</span>
<span class="sd">            &gt;&gt;&gt; triple = (alternative, abjad.Tag(&quot;-PARTS&quot;), abjad.Tag(&quot;+PARTS&quot;))</span>
<span class="sd">            &gt;&gt;&gt; chord.note_heads()[0].set_alternative(triple)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(chord, tags=True)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            &lt;</span>
<span class="sd">                %! +PARTS</span>
<span class="sd">                c&#39;</span>
<span class="sd">                %! -PARTS</span>
<span class="sd">                %@% c&#39;!</span>
<span class="sd">                d&#39;</span>
<span class="sd">                bf&#39;&#39;</span>
<span class="sd">            &gt;4</span>

<span class="sd">            Suvives pitch reassignment:</span>

<span class="sd">            &gt;&gt;&gt; chord.note_heads()[0].set_written_pitch(&quot;B3&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(chord, tags=True)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            &lt;</span>
<span class="sd">                %! +PARTS</span>
<span class="sd">                b</span>
<span class="sd">                %! -PARTS</span>
<span class="sd">                %@% b!</span>
<span class="sd">                d&#39;</span>
<span class="sd">                bf&#39;&#39;</span>
<span class="sd">            &gt;4</span>

<span class="sd">            Clear with none:</span>

<span class="sd">            &gt;&gt;&gt; chord.note_heads()[0].set_alternative(None)</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(chord, tags=True)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            &lt;b d&#39; bf&#39;&#39;&gt;4</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alternative</span></div>


<div class="viewcode-block" id="NoteHead.set_alternative">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHead.set_alternative">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_alternative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets note-head alternative.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">argument</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">NoteHead</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">argument</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">alternative</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alternative</span> <span class="o">=</span> <span class="n">argument</span></div>


<div class="viewcode-block" id="NoteHead.is_cautionary">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHead.is_cautionary">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_cautionary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets cautionary accidental flag.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; note = abjad.Note(&quot;c&#39;&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; note.note_head().set_is_cautionary(True)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(note)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                c&#39;&#39;?4</span>

<span class="sd">            &gt;&gt;&gt; note = abjad.Note(&quot;cs&#39;&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; note.note_head().set_is_cautionary(True)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(note)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                cs&#39;&#39;?4</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_cautionary</span></div>


<div class="viewcode-block" id="NoteHead.set_is_cautionary">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHead.set_is_cautionary">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_is_cautionary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets cautionary accidental flag.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_cautionary</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span></div>


<div class="viewcode-block" id="NoteHead.is_forced">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHead.is_forced">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_forced</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets forced accidental flag.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; note = abjad.Note(&quot;c&#39;&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; note.note_head().set_is_forced(True)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(note)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                c&#39;&#39;!4</span>

<span class="sd">            &gt;&gt;&gt; note = abjad.Note(&quot;cs&#39;&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; note.note_head().set_is_forced(True)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(note)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                cs&#39;&#39;!4</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_forced</span></div>


<div class="viewcode-block" id="NoteHead.set_is_forced">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHead.set_is_forced">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_is_forced</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets forced accidental flag.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">argument</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_forced</span> <span class="o">=</span> <span class="n">argument</span></div>


<div class="viewcode-block" id="NoteHead.is_parenthesized">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHead.is_parenthesized">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_parenthesized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets parenthesized accidental flag.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; note = abjad.Note(&quot;c&#39;&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; note.note_head().set_is_parenthesized(True)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(note)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \parenthesize</span>
<span class="sd">                c&#39;&#39;4</span>

<span class="sd">            &gt;&gt;&gt; note = abjad.Note(&quot;cs&#39;&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; note.note_head().set_is_parenthesized(True)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(note)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \parenthesize</span>
<span class="sd">                cs&#39;&#39;4</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_parenthesized</span></div>


<div class="viewcode-block" id="NoteHead.set_is_parenthesized">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHead.set_is_parenthesized">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_is_parenthesized</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets parenthesized accidental flag.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">argument</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_parenthesized</span> <span class="o">=</span> <span class="n">argument</span></div>


<div class="viewcode-block" id="NoteHead.written_pitch">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHead.written_pitch">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">written_pitch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_pitch</span><span class="o">.</span><span class="n">NamedPitch</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets and sets written pitch of note-head.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; note_head = abjad.NoteHead(&quot;cs&#39;&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; note_head.written_pitch()</span>
<span class="sd">            NamedPitch(&quot;cs&#39;&#39;&quot;)</span>

<span class="sd">            &gt;&gt;&gt; note_head = abjad.NoteHead(&quot;cs&#39;&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; note_head.set_written_pitch(&quot;d&#39;&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; note_head.written_pitch()</span>
<span class="sd">            NamedPitch(&quot;d&#39;&#39;&quot;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_written_pitch</span></div>


<div class="viewcode-block" id="NoteHead.set_written_pitch">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHead.set_written_pitch">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_written_pitch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets written pitch.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">written_pitch</span> <span class="o">=</span> <span class="n">_pitch</span><span class="o">.</span><span class="n">NamedPitch</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_written_pitch</span> <span class="o">=</span> <span class="n">written_pitch</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alternative</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alternative</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_written_pitch</span><span class="p">(</span><span class="n">written_pitch</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="DrumNoteHead">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.DrumNoteHead">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DrumNoteHead</span><span class="p">(</span><span class="n">NoteHead</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Drum note-head.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; note_head = abjad.DrumNoteHead(&quot;snare&quot;)</span>
<span class="sd">        &gt;&gt;&gt; note_head</span>
<span class="sd">        DrumNoteHead(&#39;snare&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">written_pitch</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;snare&quot;</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">is_cautionary</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">is_forced</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">is_parenthesized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">tweaks</span><span class="p">:</span> <span class="n">_tweaks</span><span class="o">.</span><span class="n">Tweak</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">NoteHead</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">written_pitch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">is_cautionary</span><span class="o">=</span><span class="n">is_cautionary</span><span class="p">,</span>
            <span class="n">is_forced</span><span class="o">=</span><span class="n">is_forced</span><span class="p">,</span>
            <span class="n">is_parenthesized</span><span class="o">=</span><span class="n">is_parenthesized</span><span class="p">,</span>
            <span class="n">tweaks</span><span class="o">=</span><span class="n">tweaks</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">written_pitch</span><span class="p">)</span> <span class="ow">in</span> <span class="n">_lyconst</span><span class="o">.</span><span class="n">drums</span>
        <span class="n">drum_pitch</span> <span class="o">=</span> <span class="n">_lyconst</span><span class="o">.</span><span class="n">drums</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">written_pitch</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_written_pitch</span> <span class="o">=</span> <span class="n">drum_pitch</span></div>



<div class="viewcode-block" id="NoteHeadList">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHeadList">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">NoteHeadList</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Note-head list.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; for _ in abjad.NoteHeadList([11, 10, 9]): _</span>
<span class="sd">        NoteHead(&quot;a&#39;&quot;)</span>
<span class="sd">        NoteHead(&quot;bf&#39;&quot;)</span>
<span class="sd">        NoteHead(&quot;b&#39;&quot;)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="o">=</span><span class="p">()):</span>
        <span class="n">note_heads</span> <span class="o">=</span> <span class="p">[</span><span class="n">NoteHead</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">]</span>
        <span class="nb">list</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">note_heads</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Coerces ``argument`` and sets at ``i``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">new_item</span> <span class="o">=</span> <span class="n">NoteHead</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="nb">list</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">new_item</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">new_items</span> <span class="o">=</span> <span class="p">[</span><span class="n">NoteHead</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">]</span>
            <span class="nb">list</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">new_items</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<div class="viewcode-block" id="NoteHeadList.append">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHeadList.append">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Coerces ``item`` and appends note-head.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">NoteHead</span><span class="p">):</span>
            <span class="n">note_head</span> <span class="o">=</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">note_head</span> <span class="o">=</span> <span class="n">NoteHead</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">note_head</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span></div>


<div class="viewcode-block" id="NoteHeadList.extend">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHeadList.extend">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extends note-heads.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; chord = abjad.Chord(&quot;&lt;ef&#39;&gt;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(chord)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                &lt;ef&#39;&gt;4</span>

<span class="sd">            &gt;&gt;&gt; note_heads = []</span>
<span class="sd">            &gt;&gt;&gt; note_head = abjad.NoteHead(&quot;cs&#39;&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(note_head, r&quot;\tweak color #blue&quot;)</span>
<span class="sd">            &gt;&gt;&gt; note_heads.append(note_head)</span>
<span class="sd">            &gt;&gt;&gt; note_head = abjad.NoteHead(&quot;f&#39;&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(note_head, r&quot;\tweak color #green&quot;)</span>
<span class="sd">            &gt;&gt;&gt; note_heads.append(note_head)</span>
<span class="sd">            &gt;&gt;&gt; chord.note_heads().extend(note_heads)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(chord)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                &lt;</span>
<span class="sd">                    ef&#39;</span>
<span class="sd">                    \tweak color #blue</span>
<span class="sd">                    cs&#39;&#39;</span>
<span class="sd">                    \tweak color #green</span>
<span class="sd">                    f&#39;&#39;</span>
<span class="sd">                &gt;4</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">note_heads</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">NoteHead</span><span class="p">)</span> <span class="k">else</span> <span class="n">NoteHead</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">items</span><span class="p">]</span>
        <span class="nb">list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">note_heads</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span></div>


<div class="viewcode-block" id="NoteHeadList.get">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHeadList.get">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pitch</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NoteHead</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets note-head by ``pitch``.</span>

<span class="sd">        Raises missing note-head error when chord contains no note-head with</span>
<span class="sd">        ``pitch``.</span>

<span class="sd">        Raises extra note-head error when chord contains more than one</span>
<span class="sd">        note-head with ``pitch``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets note-head by pitch name:</span>

<span class="sd">            &gt;&gt;&gt; chord = abjad.Chord(&quot;&lt;e&#39; cs&#39;&#39; f&#39;&#39;&gt;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; note_head = chord.note_heads().get(&quot;e&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(note_head, r&quot;\tweak color #red&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(chord)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                &lt;</span>
<span class="sd">                    \tweak color #red</span>
<span class="sd">                    e&#39;</span>
<span class="sd">                    cs&#39;&#39;</span>
<span class="sd">                    f&#39;&#39;</span>
<span class="sd">                &gt;4</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets note-head by pitch number:</span>

<span class="sd">            &gt;&gt;&gt; chord = abjad.Chord(&quot;&lt;e&#39; cs&#39;&#39; f&#39;&#39;&gt;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; note_head = chord.note_heads().get(4)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(note_head, r&quot;\tweak color #red&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(chord)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                &lt;</span>
<span class="sd">                    \tweak color #red</span>
<span class="sd">                    e&#39;</span>
<span class="sd">                    cs&#39;&#39;</span>
<span class="sd">                    f&#39;&#39;</span>
<span class="sd">                &gt;4</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">pitch</span> <span class="o">=</span> <span class="n">_pitch</span><span class="o">.</span><span class="n">NamedPitch</span><span class="p">(</span><span class="n">pitch</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">note_head</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">note_head</span><span class="p">,</span> <span class="n">NoteHead</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">note_head</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">note_head</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span> <span class="o">==</span> <span class="n">pitch</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">note_head</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;missing note-head.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">note_head</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">note_head</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;extra note-head.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="NoteHeadList.pop">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHeadList.pop">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NoteHead</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pops note-head ``i``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; chord = abjad.Chord(&quot;&lt;ef&#39; c&#39;&#39; f&#39;&#39;&gt;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(chord)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                &lt;ef&#39; c&#39;&#39; f&#39;&#39;&gt;4</span>

<span class="sd">            &gt;&gt;&gt; chord.note_heads().pop(1)</span>
<span class="sd">            NoteHead(&quot;c&#39;&#39;&quot;)</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(chord)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                &lt;ef&#39; f&#39;&#39;&gt;4</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span></div>


<div class="viewcode-block" id="NoteHeadList.remove">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.NoteHeadList.remove">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes ``item``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; chord = abjad.Chord(&quot;&lt;ef&#39; c&#39;&#39; f&#39;&#39;&gt;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(chord)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                &lt;ef&#39; c&#39;&#39; f&#39;&#39;&gt;4</span>

<span class="sd">            &gt;&gt;&gt; note_head = chord.note_heads()[1]</span>
<span class="sd">            &gt;&gt;&gt; chord.note_heads().remove(note_head)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(chord) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(chord)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                &lt;ef&#39; f&#39;&#39;&gt;4</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">NoteHead</span><span class="p">):</span>
            <span class="n">note_head</span> <span class="o">=</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">note_head</span> <span class="o">=</span> <span class="n">NoteHead</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="nb">list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">note_head</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="Note">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Note">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Note</span><span class="p">(</span><span class="n">Leaf</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Note.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; note = abjad.Note(&quot;cs&#39;&#39;8.&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(note)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            cs&#39;&#39;8.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_note_head&quot;</span><span class="p">,)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">arguments</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">multiplier</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">}}</span><span class="s2">&quot;</span>
            <span class="n">parsed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_lilypond_string</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parsed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Leaf</span><span class="p">)</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">parsed</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="n">written_pitch</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">is_cautionary</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">is_forced</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">is_parenthesized</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Leaf</span><span class="p">):</span>
            <span class="n">leaf</span> <span class="o">=</span> <span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">written_pitch</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">written_duration</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">multiplier</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">multiplier</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">Note</span><span class="p">)</span> <span class="ow">and</span> <span class="n">leaf</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">written_pitch</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span>
                <span class="n">is_cautionary</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span><span class="o">.</span><span class="n">is_cautionary</span><span class="p">()</span>
                <span class="n">is_forced</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span><span class="o">.</span><span class="n">is_forced</span><span class="p">()</span>
                <span class="n">is_parenthesized</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span><span class="o">.</span><span class="n">is_parenthesized</span><span class="p">()</span>
            <span class="c1"># TODO: move into separate from_chord() constructor:</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">Chord</span><span class="p">):</span>
                <span class="n">written_pitches</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">leaf</span><span class="o">.</span><span class="n">note_heads</span><span class="p">()]</span>
                <span class="k">if</span> <span class="n">written_pitches</span><span class="p">:</span>
                    <span class="n">written_pitch</span> <span class="o">=</span> <span class="n">written_pitches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">is_cautionary</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">note_heads</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_cautionary</span><span class="p">()</span>
                    <span class="n">is_forced</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">note_heads</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_forced</span><span class="p">()</span>
                    <span class="n">is_parenthesized</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">note_heads</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_parenthesized</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">written_pitch</span><span class="p">,</span> <span class="n">written_duration</span> <span class="o">=</span> <span class="n">arguments</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">written_pitch</span> <span class="o">=</span> <span class="n">_pitch</span><span class="o">.</span><span class="n">NamedPitch</span><span class="p">(</span><span class="s2">&quot;C4&quot;</span><span class="p">)</span>
            <span class="n">written_duration</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;can not initialize note from </span><span class="si">{</span><span class="n">arguments</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">Leaf</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">written_duration</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">=</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">written_pitch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">written_pitch</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_lyconst</span><span class="o">.</span><span class="n">drums</span><span class="p">:</span>
                <span class="n">note_head</span> <span class="o">=</span> <span class="n">NoteHead</span><span class="p">(</span>
                    <span class="n">written_pitch</span><span class="o">=</span><span class="n">written_pitch</span><span class="p">,</span>
                    <span class="n">is_cautionary</span><span class="o">=</span><span class="n">is_cautionary</span><span class="p">,</span>
                    <span class="n">is_forced</span><span class="o">=</span><span class="n">is_forced</span><span class="p">,</span>
                    <span class="n">is_parenthesized</span><span class="o">=</span><span class="n">is_parenthesized</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_note_head</span><span class="p">(</span><span class="n">note_head</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">written_pitch</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">written_pitch</span><span class="p">)</span>
                <span class="n">note_head</span> <span class="o">=</span> <span class="n">DrumNoteHead</span><span class="p">(</span>
                    <span class="n">written_pitch</span><span class="o">=</span><span class="n">written_pitch</span><span class="p">,</span>
                    <span class="n">is_cautionary</span><span class="o">=</span><span class="n">is_cautionary</span><span class="p">,</span>
                    <span class="n">is_forced</span><span class="o">=</span><span class="n">is_forced</span><span class="p">,</span>
                    <span class="n">is_parenthesized</span><span class="o">=</span><span class="n">is_parenthesized</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_note_head</span><span class="p">(</span><span class="n">note_head</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">written_pitch</span><span class="p">,</span> <span class="n">NoteHead</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span><span class="o">.</span><span class="n">tweaks</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">written_pitch</span><span class="o">.</span><span class="n">tweaks</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;must have note-head&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Leaf</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_copy_override_and_set_from_leaf</span><span class="p">(</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1">### SPECIAL METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arguments</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Note&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Copies note.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_note</span> <span class="o">=</span> <span class="n">Leaf</span><span class="o">.</span><span class="n">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arguments</span><span class="p">)</span>
        <span class="n">note_head</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">note_head</span><span class="p">())</span>
        <span class="n">new_note</span><span class="o">.</span><span class="n">set_note_head</span><span class="p">(</span><span class="n">note_head</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_note</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets new arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">written_duration</span><span class="p">())</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_body</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_duration</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span><span class="o">.</span><span class="n">_get_lilypond_format</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">duration</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">string</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_compact_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_body</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

<div class="viewcode-block" id="Note.note_head">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Note.note_head">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">note_head</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NoteHead</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets note-head.</span>

<span class="sd">        .. container:: example</span>

<span class="sd">            &gt;&gt;&gt; note = abjad.Note(&quot;cs&#39;&#39;8.&quot;)</span>
<span class="sd">            &gt;&gt;&gt; note.note_head()</span>
<span class="sd">            NoteHead(&quot;cs&#39;&#39;&quot;)</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(note)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                cs&#39;&#39;8.</span>

<span class="sd">            &gt;&gt;&gt; note.set_note_head(&quot;D5&quot;)</span>
<span class="sd">            &gt;&gt;&gt; note.note_head()</span>
<span class="sd">            NoteHead(&quot;d&#39;&#39;&quot;)</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(note)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                d&#39;&#39;8.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_note_head</span></div>


<div class="viewcode-block" id="Note.set_note_head">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Note.set_note_head">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_note_head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets note-head.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_note_head</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">NoteHead</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_note_head</span> <span class="o">=</span> <span class="n">argument</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">note_head</span> <span class="o">=</span> <span class="n">NoteHead</span><span class="p">(</span><span class="n">written_pitch</span><span class="o">=</span><span class="n">argument</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_note_head</span> <span class="o">=</span> <span class="n">note_head</span></div>


<div class="viewcode-block" id="Note.written_duration">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Note.written_duration">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">written_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets and sets written duration.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; note = abjad.Note(&quot;cs&#39;&#39;8.&quot;)</span>
<span class="sd">            &gt;&gt;&gt; note.written_duration()</span>
<span class="sd">            Duration(3, 16)</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(note)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                cs&#39;&#39;8.</span>

<span class="sd">            &gt;&gt;&gt; note.set_written_duration((1, 16))</span>
<span class="sd">            &gt;&gt;&gt; note.written_duration()</span>
<span class="sd">            Duration(1, 16)</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(note)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                cs&#39;&#39;16</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span></div>


<div class="viewcode-block" id="Note.set_written_duration">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Note.set_written_duration">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_written_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Leaf</span><span class="o">.</span><span class="n">set_written_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span></div>


    <span class="c1"># TODO: change Note always to have a note head</span>
<div class="viewcode-block" id="Note.written_pitch">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Note.written_pitch">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">written_pitch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_pitch</span><span class="o">.</span><span class="n">NamedPitch</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets and sets written pitch.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; note = abjad.Note(&quot;cs&#39;&#39;8.&quot;)</span>
<span class="sd">            &gt;&gt;&gt; note.written_pitch()</span>
<span class="sd">            NamedPitch(&quot;cs&#39;&#39;&quot;)</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(note)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                cs&#39;&#39;8.</span>

<span class="sd">            &gt;&gt;&gt; note.set_written_pitch(&quot;D5&quot;)</span>
<span class="sd">            &gt;&gt;&gt; note.written_pitch()</span>
<span class="sd">            NamedPitch(&quot;d&#39;&#39;&quot;)</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(note)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                d&#39;&#39;8.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Note.set_written_pitch">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Note.set_written_pitch">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_written_pitch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">argument</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span><span class="o">.</span><span class="n">set_written_pitch</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">note_head</span> <span class="o">=</span> <span class="n">NoteHead</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">written_pitch</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_note_head</span><span class="p">(</span><span class="n">note_head</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pitch</span> <span class="o">=</span> <span class="n">_pitch</span><span class="o">.</span><span class="n">NamedPitch</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">note_head</span><span class="p">()</span><span class="o">.</span><span class="n">set_written_pitch</span><span class="p">(</span><span class="n">pitch</span><span class="p">)</span></div>


    <span class="c1">### PUBLIC METHODS ###</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_pitch_and_duration</span><span class="p">(</span><span class="n">pitch</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Note&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Makes note from ``pitch`` and ``duration``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; note = abjad.Note.from_pitch_and_duration(&quot;C#5&quot;, (3, 16))</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(note) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(note)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                cs&#39;&#39;8.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">note</span> <span class="o">=</span> <span class="n">Note</span><span class="p">(</span><span class="n">pitch</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">note</span></div>



<div class="viewcode-block" id="Rest">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Rest">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Rest</span><span class="p">(</span><span class="n">Leaf</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rest.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; rest = abjad.Rest(&quot;r8.&quot;)</span>
<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff([rest])</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff], name=&quot;Score&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((3, 16)), rest)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(staff)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                \time 3/16</span>
<span class="sd">                r8.</span>
<span class="sd">            }</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">written_duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">multiplier</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">original_input</span> <span class="o">=</span> <span class="n">written_duration</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">written_duration</span><span class="p">,</span> <span class="n">Leaf</span><span class="p">):</span>
            <span class="n">multiplier</span> <span class="o">=</span> <span class="n">written_duration</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">written_duration</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="n">written_duration</span><span class="si">}</span><span class="s2"> </span><span class="se">}}</span><span class="s2">&quot;</span>
            <span class="n">parsed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_lilypond_string</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parsed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Leaf</span><span class="p">)</span>
            <span class="n">written_duration</span> <span class="o">=</span> <span class="n">parsed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">written_duration</span><span class="p">,</span> <span class="n">Leaf</span><span class="p">):</span>
            <span class="n">written_duration</span> <span class="o">=</span> <span class="n">written_duration</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">written_duration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">written_duration</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">written_duration</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">written_duration</span><span class="p">)</span>
        <span class="n">Leaf</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">written_duration</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">=</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">original_input</span><span class="p">,</span> <span class="n">Leaf</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_copy_override_and_set_from_leaf</span><span class="p">(</span><span class="n">original_input</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_body</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_compact_representation</span><span class="p">()]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_compact_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;r</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_duration</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span></div>



<div class="viewcode-block" id="Score">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Score">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Score</span><span class="p">(</span><span class="n">Context</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Score.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; staff_1 = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; staff_2 = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff_1, staff_2])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="n">_default_lilypond_type</span> <span class="o">=</span> <span class="s2">&quot;Score&quot;</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">lilypond_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Score&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">simultaneous</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Context</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span>
            <span class="n">lilypond_type</span><span class="o">=</span><span class="n">lilypond_type</span><span class="p">,</span>
            <span class="n">simultaneous</span><span class="o">=</span><span class="n">simultaneous</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span></div>



<div class="viewcode-block" id="Skip">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Skip">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Skip</span><span class="p">(</span><span class="n">Leaf</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LilyPond skip.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; skip = abjad.Skip(&quot;s1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; skip</span>
<span class="sd">        Skip(&#39;s1&#39;)</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(skip)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            s1</span>

<span class="sd">        &gt;&gt;&gt; skip = abjad.Skip(&quot;s1&quot;, multiplier=(5, 4))</span>
<span class="sd">        &gt;&gt;&gt; skip</span>
<span class="sd">        Skip(&#39;s1 * 5/4&#39;)</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(skip)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            s1 * 5/4</span>

<span class="sd">        &gt;&gt;&gt; note = abjad.Note(&quot;c&#39;4&quot;, multiplier=(5, 4))</span>
<span class="sd">        &gt;&gt;&gt; skip = abjad.Skip(note)</span>
<span class="sd">        &gt;&gt;&gt; skip</span>
<span class="sd">        Skip(&#39;s4 * 5/4&#39;)</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(skip)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            s4 * 5/4</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_measure_initial_grace_note&quot;</span><span class="p">,)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">arguments</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">multiplier</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">input_leaf</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">}}</span><span class="s2">&quot;</span>
            <span class="n">parsed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_lilypond_string</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parsed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Leaf</span><span class="p">)</span>
            <span class="n">input_leaf</span> <span class="o">=</span> <span class="n">parsed</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">written_duration</span> <span class="o">=</span> <span class="n">input_leaf</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Leaf</span><span class="p">):</span>
            <span class="n">input_leaf</span> <span class="o">=</span> <span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">written_duration</span> <span class="o">=</span> <span class="n">input_leaf</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span>
            <span class="n">multiplier</span> <span class="o">=</span> <span class="n">input_leaf</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">written_duration</span> <span class="o">=</span> <span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">written_duration</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;can not initialize skip from </span><span class="si">{</span><span class="n">arguments</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">Leaf</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">written_duration</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">=</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">input_leaf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_copy_override_and_set_from_leaf</span><span class="p">(</span><span class="n">input_leaf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_measure_initial_grace_note</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_body</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_measure_initial_grace_note&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">grace_strings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_measure_initial_grace_note</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grace_strings</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">grace_strings</span><span class="p">)</span>
            <span class="k">assert</span> <span class="s2">&quot;grace&quot;</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">grace_strings</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">grace_strings</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">grace_strings</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;s</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_duration</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_compact_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;s</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_duration</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span></div>



<div class="viewcode-block" id="Staff">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Staff">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Staff</span><span class="p">(</span><span class="n">Context</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Staff.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(staff)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;8</span>
<span class="sd">                d&#39;8</span>
<span class="sd">                e&#39;8</span>
<span class="sd">                f&#39;8</span>
<span class="sd">            }</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="n">_default_lilypond_type</span> <span class="o">=</span> <span class="s2">&quot;Staff&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">lilypond_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Staff&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">simultaneous</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Context</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span>
            <span class="n">lilypond_type</span><span class="o">=</span><span class="n">lilypond_type</span><span class="p">,</span>
            <span class="n">simultaneous</span><span class="o">=</span><span class="n">simultaneous</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span></div>



<div class="viewcode-block" id="StaffGroup">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.StaffGroup">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">StaffGroup</span><span class="p">(</span><span class="n">Context</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Staff group.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; staff_1 = abjad.Staff(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4 g&#39;1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; staff_2 = abjad.Staff(&quot;g2 f2 e1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; staff_group = abjad.StaffGroup([staff_1, staff_2])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff_group) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(staff_group)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new StaffGroup</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    g&#39;1</span>
<span class="sd">                }</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    g2</span>
<span class="sd">                    f2</span>
<span class="sd">                    e1</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="n">_default_lilypond_type</span> <span class="o">=</span> <span class="s2">&quot;StaffGroup&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">lilypond_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;StaffGroup&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">simultaneous</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Context</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span>
            <span class="n">lilypond_type</span><span class="o">=</span><span class="n">lilypond_type</span><span class="p">,</span>
            <span class="n">simultaneous</span><span class="o">=</span><span class="n">simultaneous</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span></div>



<div class="viewcode-block" id="TremoloContainer">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.TremoloContainer">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TremoloContainer</span><span class="p">(</span><span class="n">Container</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tremolo container.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff()</span>
<span class="sd">        &gt;&gt;&gt; staff.append(abjad.TremoloContainer(2, &quot;c&#39;16 e&#39;&quot;))</span>
<span class="sd">        &gt;&gt;&gt; staff.append(&quot;cs&#39;4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; staff.append(abjad.TremoloContainer(2, &quot;d&#39;16 f&#39;&quot;))</span>
<span class="sd">        &gt;&gt;&gt; staff.append(&quot;ds&#39;4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(staff)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                \repeat tremolo 2</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                }</span>
<span class="sd">                cs&#39;4</span>
<span class="sd">                \repeat tremolo 2</span>
<span class="sd">                {</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    f&#39;16</span>
<span class="sd">                }</span>
<span class="sd">                ds&#39;4</span>
<span class="sd">            }</span>

<span class="sd">        Duration of container equal to contents duration multiplied by count:</span>

<span class="sd">        &gt;&gt;&gt; abjad.get.duration(staff[0])</span>
<span class="sd">        Duration(1, 4)</span>

<span class="sd">        Duration of each leaf equal to written duration multiplied by count:</span>

<span class="sd">        &gt;&gt;&gt; abjad.get.duration(staff[0][0])</span>
<span class="sd">        Duration(1, 8)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_count&quot;</span><span class="p">,)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">_math</span><span class="o">.</span><span class="n">is_assignable_integer</span><span class="p">(</span><span class="n">count</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">=</span> <span class="n">count</span>
        <span class="n">Container</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;must contain 2 leaves (not </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets new arguments of tremolo container.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">(),)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_open_brackets_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;\repeat tremolo </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_preprolated_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_prolation</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_contents_duration</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_prolation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>

<div class="viewcode-block" id="TremoloContainer.count">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.TremoloContainer.count">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets count.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; tremolo_container = abjad.TremoloContainer(2, &quot;&lt;c&#39; d&#39;&gt;16 e&#39;16&quot;)</span>
<span class="sd">            &gt;&gt;&gt; tremolo_container.count()</span>
<span class="sd">            2</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count</span></div>
</div>



<div class="viewcode-block" id="Tuplet">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Tuplet">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Tuplet</span><span class="p">(</span><span class="n">Container</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tuplet.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        A tuplet:</span>

<span class="sd">        &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;6:4&quot;, &quot;c&#39;8 d&#39;8 e&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \tuplet 6/4</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;8</span>
<span class="sd">                d&#39;8</span>
<span class="sd">                e&#39;8</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Tweak tuplets like this:</span>

<span class="sd">        &gt;&gt;&gt; tuplet_1 = abjad.Tuplet(&quot;3:2&quot;, &quot;c&#39;4 ( d&#39;4 e&#39;4 )&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(tuplet_1, r&quot;\tweak color #red&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(tuplet_1, r&quot;\tweak staff-padding 2&quot;)</span>

<span class="sd">        &gt;&gt;&gt; tuplet_2 = abjad.Tuplet(&quot;3:2&quot;, &quot;c&#39;4 ( d&#39;4 e&#39;4 )&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(tuplet_2, r&quot;\tweak color #green&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(tuplet_2, r&quot;\tweak staff-padding 2&quot;)</span>

<span class="sd">        &gt;&gt;&gt; tuplet_3 = abjad.Tuplet(&quot;4:5&quot;, [tuplet_1, tuplet_2])</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(tuplet_3, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(tuplet_3, r&quot;\tweak color #blue&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(tuplet_3, r&quot;\tweak staff-padding 4&quot;)</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(r&quot;\time 6/4 r4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; staff.append(tuplet_3)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff], name=&quot;Score&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(staff)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                \time 6/4</span>
<span class="sd">                r4</span>
<span class="sd">                \tweak color #blue</span>
<span class="sd">                \tweak staff-padding 4</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 4/5</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak color #red</span>
<span class="sd">                    \tweak staff-padding 2</span>
<span class="sd">                    \tuplet 3/2</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        (</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                        )</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak color #green</span>
<span class="sd">                    \tweak staff-padding 2</span>
<span class="sd">                    \tuplet 3/2</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        (</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                        )</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            }</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_ratio&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tweaks&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ratio</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Ratio</span> <span class="o">=</span> <span class="s2">&quot;3:2&quot;</span><span class="p">,</span>
        <span class="n">components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tweaks</span><span class="p">:</span> <span class="n">_tweaks</span><span class="o">.</span><span class="n">Tweak</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Container</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tweaks</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_tweaks</span><span class="o">.</span><span class="n">Tweak</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ratio</span><span class="p">,</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Ratio</span><span class="p">):</span>
            <span class="n">ratio_</span> <span class="o">=</span> <span class="n">ratio</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ratio</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">assert</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">ratio</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
            <span class="n">strings</span> <span class="o">=</span> <span class="n">ratio</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
            <span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">strings</span><span class="p">]</span>
            <span class="n">ratio_</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Ratio</span><span class="p">(</span><span class="o">*</span><span class="n">numbers</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;tuplet ratio must be ratio or string (not </span><span class="si">{</span><span class="n">ratio</span><span class="si">!r}</span><span class="s2">).&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ratio</span><span class="p">(</span><span class="n">ratio_</span><span class="p">)</span>

    <span class="c1">### SPECIAL METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__getnewargs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets new arguments of tuplet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">string</span><span class="p">,)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets interpreter representation of tuplet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_contents_summary</span><span class="p">()</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">())</span><span class="si">!r}</span><span class="s2">, </span><span class="si">{</span><span class="n">string</span><span class="si">!r}</span><span class="s2">)&quot;</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_after_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">grob_reverts</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">GROB_REVERTS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">after</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_before_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">before</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">grob_overrides</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">GROB_OVERRIDES</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">context_settings</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">CONTEXT_SETTINGS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_close_brackets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;}&quot;</span><span class="p">]</span>
        <span class="n">self_tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">self_tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">double_tag</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">self_tag</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_closing_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">closing</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_indent_strings</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_open_brackets_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">contributions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">tweak</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tweaks</span><span class="p">):</span>
            <span class="n">strings</span> <span class="o">=</span> <span class="n">tweak</span><span class="o">.</span><span class="n">_list_contributions</span><span class="p">()</span>
            <span class="n">contributions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">tuplet_command_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_tuplet_command_string</span><span class="p">()</span>
        <span class="n">contributions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tuplet_command_string</span><span class="p">)</span>
        <span class="n">contributions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">)</span>
        <span class="n">self_tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">self_tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">contributions</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">double_tag</span><span class="p">(</span><span class="n">contributions</span><span class="p">,</span> <span class="n">self_tag</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">contributions</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_opening_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contributions</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="n">contributions</span><span class="o">.</span><span class="n">alphabetize</span><span class="p">(</span><span class="n">contributions</span><span class="o">.</span><span class="n">opening</span><span class="o">.</span><span class="n">commands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">_contributions</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">COMMANDS</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_indent_strings</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_compact_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">())</span><span class="si">}</span><span class="s2"> </span><span class="se">}}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">())</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_contents_summary</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="se">}}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_preprolated_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_contents_duration</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_prolation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">()])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_tuplet_command_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\tuplet </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">()</span><span class="o">.</span><span class="n">numerator</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">()</span><span class="o">.</span><span class="n">denominator</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[:]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Leaf</span><span class="p">):</span>
                <span class="n">component</span><span class="o">.</span><span class="n">_scale</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normalize_ratio</span><span class="p">()</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

<div class="viewcode-block" id="Tuplet.ratio">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Tuplet.ratio">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Ratio</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets and sets tuplet ratio.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;3:2&quot;, &quot;c&#39;8 d&#39;8 e&#39;8&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(tuplet, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 3/2</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.ratio()</span>
<span class="sd">            Ratio(numerator=3, denominator=2)</span>

<span class="sd">            &gt;&gt;&gt; tuplet.set_ratio(abjad.Ratio(6, 4))</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 6/4</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ratio</span></div>


<div class="viewcode-block" id="Tuplet.set_ratio">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Tuplet.set_ratio">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ratio</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets tuplet ratio.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ratio</span><span class="p">,</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Ratio</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">ratio</span><span class="o">.</span><span class="n">denominator</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ratio</span> <span class="o">=</span> <span class="n">ratio</span></div>


    <span class="c1">### PUBLIC METHODS ###</span>

<div class="viewcode-block" id="Tuplet.append">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Tuplet.append">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">append</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">component</span><span class="p">:</span> <span class="n">Component</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">preserve_duration</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appends ``component`` to tuplet.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Appends note to tuplet:</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;3:2&quot;, &quot;c&#39;4 ( d&#39;4 f&#39;4 )&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tuplet 3/2</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    (</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    )</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.append(abjad.Note(&quot;e&#39;4&quot;))</span>
<span class="sd">            &gt;&gt;&gt; abjad.makers.tweak_tuplet_bracket_edge_height(tuplet)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak edge-height #&#39;(0.7 . 0)</span>
<span class="sd">                \tuplet 3/2</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    (</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    )</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Appends note to tuplet and changes tuplet ratio to preserve tuplet</span>
<span class="sd">            duration:</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;3:2&quot;, &quot;c&#39;4 ( d&#39;4 f&#39;4 )&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(tuplet, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">            &gt;&gt;&gt; voice = abjad.Voice([tuplet])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \new Voice</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \tuplet 3/2</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        (</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        f&#39;4</span>
<span class="sd">                        )</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.append(abjad.Note(&quot;e&#39;4&quot;), preserve_duration=True)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \new Voice</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \tuplet 2/1</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        (</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        f&#39;4</span>
<span class="sd">                        )</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">preserve_duration</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">old_duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_duration</span><span class="p">()</span>
        <span class="n">Container</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">preserve_duration</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">new_duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_contents_duration</span><span class="p">()</span>
            <span class="n">multiplier</span> <span class="o">=</span> <span class="n">old_duration</span> <span class="o">/</span> <span class="n">new_duration</span>
            <span class="n">ratio</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Ratio</span><span class="p">(</span><span class="n">multiplier</span><span class="o">.</span><span class="n">denominator</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">.</span><span class="n">numerator</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_ratio</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_duration</span><span class="p">()</span> <span class="o">==</span> <span class="n">old_duration</span></div>


<div class="viewcode-block" id="Tuplet.extend">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Tuplet.extend">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">extend</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span> <span class="n">preserve_duration</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extends tuplet with ``argument``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Extends tuplet with three notes:</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;3:2&quot;, &quot;c&#39;4 ( d&#39;4 f&#39;4 )&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tuplet 3/2</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    (</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    )</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; notes = [abjad.Note(&quot;e&#39;32&quot;), abjad.Note(&quot;d&#39;32&quot;), abjad.Note(&quot;e&#39;16&quot;)]</span>
<span class="sd">            &gt;&gt;&gt; tuplet.extend(notes)</span>
<span class="sd">            &gt;&gt;&gt; abjad.makers.tweak_tuplet_bracket_edge_height(tuplet)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak edge-height #&#39;(0.7 . 0)</span>
<span class="sd">                \tuplet 3/2</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    (</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    )</span>
<span class="sd">                    e&#39;32</span>
<span class="sd">                    d&#39;32</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Extends tuplet with three notes and preserves tuplet duration:</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;3:2&quot;, &quot;c&#39;4 ( d&#39;4 f&#39;4 )&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tuplet 3/2</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    (</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    )</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; notes = [abjad.Note(&quot;e&#39;32&quot;), abjad.Note(&quot;d&#39;32&quot;), abjad.Note(&quot;e&#39;16&quot;)]</span>
<span class="sd">            &gt;&gt;&gt; tuplet.extend(notes, preserve_duration=True)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tuplet 7/4</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    (</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    )</span>
<span class="sd">                    e&#39;32</span>
<span class="sd">                    d&#39;32</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">preserve_duration</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">old_duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_duration</span><span class="p">()</span>
        <span class="n">Container</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">preserve_duration</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">new_duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_contents_duration</span><span class="p">()</span>
            <span class="n">multiplier</span> <span class="o">=</span> <span class="n">old_duration</span> <span class="o">/</span> <span class="n">new_duration</span>
            <span class="n">ratio</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Ratio</span><span class="p">(</span><span class="n">multiplier</span><span class="o">.</span><span class="n">denominator</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">.</span><span class="n">numerator</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_ratio</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_duration</span><span class="p">()</span> <span class="o">==</span> <span class="n">old_duration</span></div>


<div class="viewcode-block" id="Tuplet.is_rest_filled">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Tuplet.is_rest_filled">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_rest_filled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when tuplet is rest-filled.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;3:2&quot;, &quot;r2 r2 r2&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tuplet 3/2</span>
<span class="sd">                {</span>
<span class="sd">                    r2</span>
<span class="sd">                    r2</span>
<span class="sd">                    r2</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.is_rest_filled()</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">Rest</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="Tuplet.is_trivial">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Tuplet.is_trivial">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_trivial</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when tuplet ratio reduces to 1:1.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;1:1&quot;, &quot;c&#39;8 d&#39;8 e&#39;8&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(tuplet, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 1/1</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.is_trivial()</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is false when duration multiplier attaches to leaf in tuplet:</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;1:1&quot;, &quot;c&#39;8 d&#39;8 e&#39;8&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(tuplet, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">            &gt;&gt;&gt; tuplet[0].set_multiplier((2, 1))</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 1/1</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8 * 2/1</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.is_trivial()</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">()</span><span class="o">.</span><span class="n">is_trivial</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Tuplet</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="s2">&quot;written_duration&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">component</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="Tuplet.is_trivializable">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Tuplet.is_trivializable">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_trivializable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when tuplet can be rewritten with a ratio of 1:1.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;4:3&quot;, &quot;c&#39;4 c&#39;4 c&#39;4 c&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(tuplet, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff([tuplet])</span>
<span class="sd">            &gt;&gt;&gt; score = abjad.Score([staff], name=&quot;Score&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((3, 4)), tuplet[0])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 4/3</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.is_trivializable()</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; tuplet.trivialize()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 1/1</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;5:3&quot;, &quot;c&#39;4 c&#39;4 c&#39;4 c&#39;4 c&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(tuplet, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff([tuplet])</span>
<span class="sd">            &gt;&gt;&gt; score = abjad.Score([staff], name=&quot;Score&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((3, 4)), tuplet[0])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(staff)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \tuplet 5/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.is_trivializable()</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Tuplet</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Leaf</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span> <span class="o">*</span> <span class="n">component</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">duration</span><span class="o">.</span><span class="n">is_assignable</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="Tuplet.multiplier">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Tuplet.multiplier">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">multiplier</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets tuplet multiplier.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.Tuplet(&quot;6:4&quot;, &quot;c&#39;4 d&#39;4 e&#39;4&quot;).multiplier()</span>
<span class="sd">            Fraction(2, 3)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">()</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span><span class="o">.</span><span class="n">as_fraction</span><span class="p">()</span></div>


<div class="viewcode-block" id="Tuplet.normalize_ratio">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Tuplet.normalize_ratio">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">normalize_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalizes tuplet ratio.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;3:1&quot;, &quot;c&#39;4 d&#39; e&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tuplet 3/1</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.ratio().is_normalized()</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; tuplet.normalize_ratio()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tuplet 3/2</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.ratio().is_normalized()</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;3:8&quot;, &quot;c&#39;32 d&#39;32 e&#39;32&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(tuplet, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 3/8</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;32</span>
<span class="sd">                    d&#39;32</span>
<span class="sd">                    e&#39;32</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.ratio().is_normalized()</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; tuplet.normalize_ratio()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 3/4</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.ratio().is_normalized()</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;12:5&quot;, &quot;c&#39;4 d&#39;4 e&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(tuplet, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 12/5</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.ratio().is_normalized()</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; tuplet.normalize_ratio()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 6/5</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.ratio().is_normalized()</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">multiplier_</span> <span class="o">=</span> <span class="n">_math</span><span class="o">.</span><span class="n">greatest_power_of_two_less_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">())</span>
        <span class="n">multiplier</span> <span class="o">=</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">(</span><span class="n">multiplier_</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Leaf</span><span class="p">):</span>
                <span class="n">component</span><span class="o">.</span><span class="n">_scale</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="n">multiplier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span> <span class="o">/</span> <span class="n">multiplier</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Ratio</span><span class="p">(</span><span class="n">multiplier</span><span class="o">.</span><span class="n">denominator</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">.</span><span class="n">numerator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ratio</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">()</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">()</span></div>


<div class="viewcode-block" id="Tuplet.rewrite_dots">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Tuplet.rewrite_dots">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rewrite_dots</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rewrites dots of leaves in tuplet.</span>

<span class="sd">        Not implemented for multiply nested tuplets.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Rewrites single dots as 3:2 prolation:</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;1:1&quot;, &quot;c&#39;8. c&#39;8.&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(tuplet, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 1/1</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.rewrite_dots()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 2/3</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Rewrites double dots as 7:4 prolation:</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;1:1&quot;, &quot;c&#39;8.. c&#39;8..&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(tuplet, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 1/1</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8..</span>
<span class="sd">                    c&#39;8..</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.rewrite_dots()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 4/7</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Does nothing when dot counts differ:</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;1:1&quot;, &quot;c&#39;8. d&#39;8. e&#39;8&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(tuplet, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 1/1</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    d&#39;8.</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.rewrite_dots()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 1/1</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    d&#39;8.</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Does nothing when leaves carry no dots:</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;2:3&quot;, &quot;c&#39;8 d&#39; e&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(tuplet, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 2/3</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.rewrite_dots()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 2/3</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dot_counts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Tuplet</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">dot_count</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span><span class="o">.</span><span class="n">dot_count</span><span class="p">()</span>
            <span class="n">dot_counts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">dot_count</span><span class="p">)</span>
        <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">dot_counts</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">dot_counts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="n">global_dot_count</span> <span class="o">=</span> <span class="n">dot_counts</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">global_dot_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">dot_multiplier</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">fraction_from_dot_count</span><span class="p">(</span><span class="n">global_dot_count</span><span class="p">)</span>
        <span class="n">multiplier</span> <span class="o">=</span> <span class="n">dot_multiplier</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Ratio</span><span class="p">(</span><span class="n">multiplier</span><span class="o">.</span><span class="n">denominator</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">.</span><span class="n">numerator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ratio</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
        <span class="n">dot_multiplier_duration</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">dot_multiplier</span><span class="p">)</span>
        <span class="n">dot_multiplier_reciprocal_duration</span> <span class="o">=</span> <span class="n">dot_multiplier_duration</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">component_written_duration</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span>
            <span class="n">component_written_duration</span> <span class="o">*=</span> <span class="n">dot_multiplier_reciprocal_duration</span>
            <span class="n">component</span><span class="o">.</span><span class="n">set_written_duration</span><span class="p">(</span><span class="n">component_written_duration</span><span class="p">)</span></div>


<div class="viewcode-block" id="Tuplet.toggle_prolation">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Tuplet.toggle_prolation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">toggle_prolation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Toggles tuplet prolation.</span>

<span class="sd">        Not implemented for nested tuplets.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Changes augmented tuplet to diminished; that is, multiplies the</span>
<span class="sd">            written duration of the leaves in tuplet by the least power of</span>
<span class="sd">            ``2`` necessary to diminshed tuplet:</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;3:4&quot;, &quot;c&#39;8 d&#39;8 e&#39;8&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(tuplet, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 3/4</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.toggle_prolation()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 3/2</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Changes diminished tuplet to augmented; that is, divides the</span>
<span class="sd">            written duration of the leaves in tuplet by the least power of</span>
<span class="sd">            ``2`` necessary to diminshed tuplet.</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;3:2&quot;, &quot;c&#39;4 d&#39;4 e&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tuplet 3/2</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.toggle_prolation()</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(tuplet, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 3/4</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Leaves trivial tuplets unchanged:</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;1:1&quot;, &quot;c&#39;4 d&#39;4 e&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(tuplet, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 1/1</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.toggle_prolation()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(tuplet) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 1/1</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">()</span><span class="o">.</span><span class="n">is_diminished</span><span class="p">():</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">()</span><span class="o">.</span><span class="n">is_diminished</span><span class="p">():</span>
                <span class="n">multiplier</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span>
                <span class="n">ratio</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Ratio</span><span class="p">(</span><span class="n">multiplier</span><span class="o">.</span><span class="n">denominator</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">.</span><span class="n">numerator</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_ratio</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_subtree</span><span class="p">():</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Leaf</span><span class="p">):</span>
                        <span class="n">component_written_duration</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span>
                        <span class="n">component_written_duration</span> <span class="o">/=</span> <span class="mi">2</span>
                        <span class="n">component</span><span class="o">.</span><span class="n">set_written_duration</span><span class="p">(</span><span class="n">component_written_duration</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">()</span><span class="o">.</span><span class="n">is_augmented</span><span class="p">():</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratio</span><span class="p">()</span><span class="o">.</span><span class="n">is_diminished</span><span class="p">():</span>
                <span class="n">multiplier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="n">ratio</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Ratio</span><span class="p">(</span><span class="n">multiplier</span><span class="o">.</span><span class="n">denominator</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">.</span><span class="n">numerator</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_ratio</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_subtree</span><span class="p">():</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Leaf</span><span class="p">):</span>
                        <span class="n">component_written_duration</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span>
                        <span class="n">component_written_duration</span> <span class="o">*=</span> <span class="mi">2</span>
                        <span class="n">component</span><span class="o">.</span><span class="n">set_written_duration</span><span class="p">(</span><span class="n">component_written_duration</span><span class="p">)</span></div>


<div class="viewcode-block" id="Tuplet.trivialize">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Tuplet.trivialize">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">trivialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rewrites tuplet with ratio of 1:1.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; tuplet = abjad.Tuplet(&quot;4:3&quot;, &quot;c&#39;4 c&#39;4 c&#39;4 c&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(tuplet, r&quot;\tweak text #tuplet-number::calc-fraction-text&quot;)</span>
<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff([tuplet])</span>
<span class="sd">            &gt;&gt;&gt; score = abjad.Score([staff], name=&quot;Score&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((3, 4)), tuplet[0])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 4/3</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; tuplet.is_trivializable()</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; tuplet.trivialize()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(tuplet)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                \tuplet 1/1</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_trivializable</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Tuplet</span><span class="p">):</span>
                <span class="n">multiplier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span> <span class="o">*</span> <span class="n">component</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span>
                <span class="n">ratio</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Ratio</span><span class="p">(</span><span class="n">multiplier</span><span class="o">.</span><span class="n">denominator</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">.</span><span class="n">numerator</span><span class="p">)</span>
                <span class="n">component</span><span class="o">.</span><span class="n">set_ratio</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Leaf</span><span class="p">):</span>
                <span class="n">component_written_duration</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">written_duration</span><span class="p">()</span>
                <span class="n">component_written_duration</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiplier</span><span class="p">()</span>
                <span class="n">component</span><span class="o">.</span><span class="n">set_written_duration</span><span class="p">(</span><span class="n">component_written_duration</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ratio</span><span class="p">(</span><span class="n">_duration</span><span class="o">.</span><span class="n">Ratio</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span></div>
</div>



<div class="viewcode-block" id="Voice">
<a class="viewcode-back" href="../../api/abjad/score.html#abjad.score.Voice">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Voice</span><span class="p">(</span><span class="n">Context</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Voice.</span>

<span class="sd">    Voice-contexted indicators like dynamics work with nested voices.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(voice)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Voice</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;8</span>
<span class="sd">                d&#39;8</span>
<span class="sd">                e&#39;8</span>
<span class="sd">                f&#39;8</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forte affects all red notes:</span>

<span class="sd">        &gt;&gt;&gt; outer_red_voice = abjad.Voice(&quot;e&#39;&#39;8 d&#39;&#39;&quot;, name=&#39;Red_Voice&#39;)</span>
<span class="sd">        &gt;&gt;&gt; inner_red_voice = abjad.Voice(&quot;c&#39;&#39;4 b&#39; c&#39;&#39;8&quot;, name=&#39;Red_Voice&#39;)</span>
<span class="sd">        &gt;&gt;&gt; inner_blue_voice = abjad.Voice(&quot;e&#39;4 f&#39; e&#39;8&quot;, name=&#39;Blue_Voice&#39;)</span>
<span class="sd">        &gt;&gt;&gt; container = abjad.Container(</span>
<span class="sd">        ...     [inner_red_voice, inner_blue_voice],</span>
<span class="sd">        ...     simultaneous=True,</span>
<span class="sd">        ...     )</span>
<span class="sd">        &gt;&gt;&gt; outer_red_voice.append(container)</span>
<span class="sd">        &gt;&gt;&gt; outer_red_voice.extend(&quot;d&#39;&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(outer_red_voice).NoteHead.color = &quot;#red&quot;</span>
<span class="sd">        &gt;&gt;&gt; command = abjad.VoiceNumber(1)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(command, outer_red_voice[0])</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(inner_blue_voice).NoteHead.color = &quot;#blue&quot;</span>
<span class="sd">        &gt;&gt;&gt; command = abjad.VoiceNumber(2)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(command, inner_blue_voice[0])</span>
<span class="sd">        &gt;&gt;&gt; dynamic = abjad.Dynamic(&#39;f&#39;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(dynamic, outer_red_voice[0])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(outer_red_voice) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(outer_red_voice)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Voice = &quot;Red_Voice&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override NoteHead.color = #red</span>
<span class="sd">            }</span>
<span class="sd">            {</span>
<span class="sd">                \voiceOne</span>
<span class="sd">                e&#39;&#39;8</span>
<span class="sd">                \f</span>
<span class="sd">                d&#39;&#39;8</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \context Voice = &quot;Red_Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;&#39;4</span>
<span class="sd">                        b&#39;4</span>
<span class="sd">                        c&#39;&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \context Voice = &quot;Blue_Voice&quot;</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override NoteHead.color = #blue</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \voiceTwo</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                        f&#39;4</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>
<span class="sd">                d&#39;&#39;8</span>
<span class="sd">            }</span>

<span class="sd">        &gt;&gt;&gt; for leaf in abjad.iterate.leaves(outer_red_voice):</span>
<span class="sd">        ...     dynamic = abjad.get.effective_indicator(leaf, abjad.Dynamic)</span>
<span class="sd">        ...     print(leaf, dynamic)</span>
<span class="sd">        ...</span>
<span class="sd">        Note(&quot;e&#39;&#39;8&quot;) Dynamic(name=&#39;f&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;d&#39;&#39;8&quot;) Dynamic(name=&#39;f&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;c&#39;&#39;4&quot;) Dynamic(name=&#39;f&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;b&#39;4&quot;) Dynamic(name=&#39;f&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;c&#39;&#39;8&quot;) Dynamic(name=&#39;f&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;e&#39;4&quot;) None</span>
<span class="sd">        Note(&quot;f&#39;4&quot;) None</span>
<span class="sd">        Note(&quot;e&#39;8&quot;) None</span>
<span class="sd">        Note(&quot;d&#39;&#39;8&quot;) Dynamic(name=&#39;f&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Piano affects all blue notes:</span>

<span class="sd">        &gt;&gt;&gt; outer_red_voice = abjad.Voice(&quot;e&#39;&#39;8 d&#39;&#39;&quot;, name=&#39;Red_Voice&#39;)</span>
<span class="sd">        &gt;&gt;&gt; inner_red_voice = abjad.Voice(&quot;c&#39;&#39;4 b&#39; c&#39;&#39;8&quot;, name=&#39;Red_Voice&#39;)</span>
<span class="sd">        &gt;&gt;&gt; inner_blue_voice = abjad.Voice(&quot;e&#39;4 f&#39; e&#39;8&quot;, name=&#39;Blue_Voice&#39;)</span>
<span class="sd">        &gt;&gt;&gt; container = abjad.Container(</span>
<span class="sd">        ...     [inner_red_voice, inner_blue_voice],</span>
<span class="sd">        ...     simultaneous=True,</span>
<span class="sd">        ...     )</span>
<span class="sd">        &gt;&gt;&gt; outer_red_voice.append(container)</span>
<span class="sd">        &gt;&gt;&gt; outer_red_voice.extend(&quot;d&#39;&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(outer_red_voice).NoteHead.color = &quot;#red&quot;</span>
<span class="sd">        &gt;&gt;&gt; command = abjad.VoiceNumber(1)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(command, outer_red_voice[0])</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(inner_blue_voice).NoteHead.color = &quot;#blue&quot;</span>
<span class="sd">        &gt;&gt;&gt; command = abjad.VoiceNumber(2)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(command, inner_blue_voice[0])</span>
<span class="sd">        &gt;&gt;&gt; dynamic = abjad.Dynamic(&#39;p&#39;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(dynamic, inner_blue_voice[0])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(outer_red_voice) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(outer_red_voice)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Voice = &quot;Red_Voice&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override NoteHead.color = #red</span>
<span class="sd">            }</span>
<span class="sd">            {</span>
<span class="sd">                \voiceOne</span>
<span class="sd">                e&#39;&#39;8</span>
<span class="sd">                d&#39;&#39;8</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \context Voice = &quot;Red_Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;&#39;4</span>
<span class="sd">                        b&#39;4</span>
<span class="sd">                        c&#39;&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \context Voice = &quot;Blue_Voice&quot;</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override NoteHead.color = #blue</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \voiceTwo</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                        \p</span>
<span class="sd">                        f&#39;4</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>
<span class="sd">                d&#39;&#39;8</span>
<span class="sd">            }</span>

<span class="sd">        &gt;&gt;&gt; for leaf in abjad.iterate.leaves(outer_red_voice):</span>
<span class="sd">        ...     dynamic = abjad.get.effective_indicator(leaf, abjad.Dynamic)</span>
<span class="sd">        ...     print(leaf, dynamic)</span>
<span class="sd">        ...</span>
<span class="sd">        Note(&quot;e&#39;&#39;8&quot;) None</span>
<span class="sd">        Note(&quot;d&#39;&#39;8&quot;) None</span>
<span class="sd">        Note(&quot;c&#39;&#39;4&quot;) None</span>
<span class="sd">        Note(&quot;b&#39;4&quot;) None</span>
<span class="sd">        Note(&quot;c&#39;&#39;8&quot;) None</span>
<span class="sd">        Note(&quot;e&#39;4&quot;) Dynamic(name=&#39;p&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;f&#39;4&quot;) Dynamic(name=&#39;p&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;e&#39;8&quot;) Dynamic(name=&#39;p&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;d&#39;&#39;8&quot;) None</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Mezzoforte affects red notes from C4 forward:</span>

<span class="sd">        &gt;&gt;&gt; outer_red_voice = abjad.Voice(&quot;e&#39;&#39;8 d&#39;&#39;&quot;, name=&#39;Red_Voice&#39;)</span>
<span class="sd">        &gt;&gt;&gt; inner_red_voice = abjad.Voice(&quot;c&#39;&#39;4 b&#39; c&#39;&#39;8&quot;, name=&#39;Red_Voice&#39;)</span>
<span class="sd">        &gt;&gt;&gt; inner_blue_voice = abjad.Voice(&quot;e&#39;4 f&#39; e&#39;8&quot;, name=&#39;Blue_Voice&#39;)</span>
<span class="sd">        &gt;&gt;&gt; container = abjad.Container(</span>
<span class="sd">        ...     [inner_red_voice, inner_blue_voice],</span>
<span class="sd">        ...     simultaneous=True,</span>
<span class="sd">        ...     )</span>
<span class="sd">        &gt;&gt;&gt; outer_red_voice.append(container)</span>
<span class="sd">        &gt;&gt;&gt; outer_red_voice.extend(&quot;d&#39;&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(outer_red_voice).NoteHead.color = &quot;#red&quot;</span>
<span class="sd">        &gt;&gt;&gt; command = abjad.VoiceNumber(1)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(command, outer_red_voice[0])</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(inner_blue_voice).NoteHead.color = &quot;#blue&quot;</span>
<span class="sd">        &gt;&gt;&gt; command = abjad.VoiceNumber(2)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(command, inner_blue_voice[0])</span>
<span class="sd">        &gt;&gt;&gt; dynamic = abjad.Dynamic(&#39;mf&#39;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(dynamic, inner_red_voice[0])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(outer_red_voice) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(outer_red_voice)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Voice = &quot;Red_Voice&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override NoteHead.color = #red</span>
<span class="sd">            }</span>
<span class="sd">            {</span>
<span class="sd">                \voiceOne</span>
<span class="sd">                e&#39;&#39;8</span>
<span class="sd">                d&#39;&#39;8</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \context Voice = &quot;Red_Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;&#39;4</span>
<span class="sd">                        \mf</span>
<span class="sd">                        b&#39;4</span>
<span class="sd">                        c&#39;&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \context Voice = &quot;Blue_Voice&quot;</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override NoteHead.color = #blue</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \voiceTwo</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                        f&#39;4</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>
<span class="sd">                d&#39;&#39;8</span>
<span class="sd">            }</span>

<span class="sd">        &gt;&gt;&gt; for leaf in abjad.iterate.leaves(outer_red_voice):</span>
<span class="sd">        ...     dynamic = abjad.get.effective_indicator(leaf, abjad.Dynamic)</span>
<span class="sd">        ...     print(leaf, dynamic)</span>
<span class="sd">        ...</span>
<span class="sd">        Note(&quot;e&#39;&#39;8&quot;) None</span>
<span class="sd">        Note(&quot;d&#39;&#39;8&quot;) None</span>
<span class="sd">        Note(&quot;c&#39;&#39;4&quot;) Dynamic(name=&#39;mf&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;b&#39;4&quot;) Dynamic(name=&#39;mf&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;c&#39;&#39;8&quot;) Dynamic(name=&#39;mf&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;e&#39;4&quot;) None</span>
<span class="sd">        Note(&quot;f&#39;4&quot;) None</span>
<span class="sd">        Note(&quot;e&#39;8&quot;) None</span>
<span class="sd">        Note(&quot;d&#39;&#39;8&quot;) Dynamic(name=&#39;mf&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Mezzoforte and piano set at the same time:</span>

<span class="sd">        &gt;&gt;&gt; outer_red_voice = abjad.Voice(&quot;e&#39;&#39;8 d&#39;&#39;&quot;, name=&#39;Red_Voice&#39;)</span>
<span class="sd">        &gt;&gt;&gt; inner_red_voice = abjad.Voice(&quot;c&#39;&#39;4 b&#39; c&#39;&#39;8&quot;, name=&#39;Red_Voice&#39;)</span>
<span class="sd">        &gt;&gt;&gt; inner_blue_voice = abjad.Voice(&quot;e&#39;4 f&#39; e&#39;8&quot;, name=&#39;Blue_Voice&#39;)</span>
<span class="sd">        &gt;&gt;&gt; container = abjad.Container(</span>
<span class="sd">        ...     [inner_red_voice, inner_blue_voice],</span>
<span class="sd">        ...     simultaneous=True,</span>
<span class="sd">        ...     )</span>
<span class="sd">        &gt;&gt;&gt; outer_red_voice.append(container)</span>
<span class="sd">        &gt;&gt;&gt; outer_red_voice.extend(&quot;d&#39;&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(outer_red_voice).NoteHead.color = &quot;#red&quot;</span>
<span class="sd">        &gt;&gt;&gt; command = abjad.VoiceNumber(1)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(command, outer_red_voice[0])</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(inner_blue_voice).NoteHead.color = &quot;#blue&quot;</span>
<span class="sd">        &gt;&gt;&gt; command = abjad.VoiceNumber(2)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(command, inner_blue_voice[0])</span>
<span class="sd">        &gt;&gt;&gt; dynamic = abjad.Dynamic(&#39;mf&#39;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(dynamic, inner_red_voice[0])</span>
<span class="sd">        &gt;&gt;&gt; dynamic = abjad.Dynamic(&#39;p&#39;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(dynamic, inner_blue_voice[0])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(outer_red_voice) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(outer_red_voice)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Voice = &quot;Red_Voice&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override NoteHead.color = #red</span>
<span class="sd">            }</span>
<span class="sd">            {</span>
<span class="sd">                \voiceOne</span>
<span class="sd">                e&#39;&#39;8</span>
<span class="sd">                d&#39;&#39;8</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \context Voice = &quot;Red_Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;&#39;4</span>
<span class="sd">                        \mf</span>
<span class="sd">                        b&#39;4</span>
<span class="sd">                        c&#39;&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \context Voice = &quot;Blue_Voice&quot;</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override NoteHead.color = #blue</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \voiceTwo</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                        \p</span>
<span class="sd">                        f&#39;4</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>
<span class="sd">                d&#39;&#39;8</span>
<span class="sd">            }</span>

<span class="sd">        &gt;&gt;&gt; for leaf in abjad.iterate.leaves(outer_red_voice):</span>
<span class="sd">        ...     dynamic = abjad.get.effective_indicator(leaf, abjad.Dynamic)</span>
<span class="sd">        ...     print(leaf, dynamic)</span>
<span class="sd">        ...</span>
<span class="sd">        Note(&quot;e&#39;&#39;8&quot;) None</span>
<span class="sd">        Note(&quot;d&#39;&#39;8&quot;) None</span>
<span class="sd">        Note(&quot;c&#39;&#39;4&quot;) Dynamic(name=&#39;mf&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;b&#39;4&quot;) Dynamic(name=&#39;mf&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;c&#39;&#39;8&quot;) Dynamic(name=&#39;mf&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;e&#39;4&quot;) Dynamic(name=&#39;p&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;f&#39;4&quot;) Dynamic(name=&#39;p&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;e&#39;8&quot;) Dynamic(name=&#39;p&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>
<span class="sd">        Note(&quot;d&#39;&#39;8&quot;) Dynamic(name=&#39;mf&#39;, command=None, leak=False, name_is_textual=False, ordinal=None)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="n">_default_lilypond_type</span> <span class="o">=</span> <span class="s2">&quot;Voice&quot;</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;english&quot;</span><span class="p">,</span>
        <span class="n">lilypond_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Voice&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">simultaneous</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Context</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">components</span><span class="o">=</span><span class="n">components</span><span class="p">,</span>
            <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span>
            <span class="n">lilypond_type</span><span class="o">=</span><span class="n">lilypond_type</span><span class="p">,</span>
            <span class="n">simultaneous</span><span class="o">=</span><span class="n">simultaneous</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span></div>

</pre></div>

    </div>
    
    </div>
    

<footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2008-2025, Trevor Bača &amp; Joséphine Oberholtzer.
      <span class="lastupdated">
        Last updated on Jul 30, 2025.
      </span>

    </p>
  </div> 

</footer>

</div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>