

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>abjad.lilypondfile &mdash; Abjad 3.2 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/abjad.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/uqbar.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/lightbox2/css/lightbox.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  
    <link rel="canonical" href="https://abjad.github.io_modules/abjad/lilypondfile.html"/>
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script defer="defer" src="../../_static/copybutton.js"></script>
        <script src="../../_static/ga.js"></script>
        <script defer="defer" src="../../_static/lightbox2/js/lightbox.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #cc3300" >
          


    <a href="../../index.html" class="icon icon-home" alt="Documentation
    Home"> Abjad 3.2



    <img src="../../_static/abjad-logo.png" class="logo" alt="Logo"/>

</a>




<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">First steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/audience.html">Audience</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/macos.html">macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/linux.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/windows.html">Windows</a></li>
</ul>
<p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/about_the_docs.html">About the docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers_basic_operations_on.html">Containers, basic operations on</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers_retrieving_by_name.html">Containers, retrieving by name</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers_time_interpretation_of.html">Containers, time interpretation of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/contexts_lilypond_type_of.html">Contexts, LilyPond type of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/indicators.html">Indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/lilypond_files_preamble_of.html">LilyPond files, preamble of</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/corpus_selection.html">Corpus, figure selection from</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/design_by_dyads.html">Design, by dyads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/enumeration.html">Enumeration, of rhythmic cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/scales_diatonic.html">Scales, diatonic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/score_fragment_piano.html">Score fragment, piano</a></li>
</ul>
<p class="caption"><span class="caption-text">All classes &amp; functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">Abjad API</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/best_practices.html">Best practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/changes.html">Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/developer_installation.html">Developer installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/lilypond_context_concatenation.html">LilyPond context concatenation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/publications.html">Publications</a></li>
</ul>
<p class="caption"><span class="caption-text">Score gallery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../gallery_2020.html">2020-16</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery_2015.html">2015-11</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery_2010.html">2010-00</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Abjad</a>
        
      </nav>


      <div class="wy-nav-content">

<div class="rst-content">

    


    <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    <div itemprop="articleBody">
    
  <h1>Source code for abjad.lilypondfile</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">importlib</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">numbers</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_inspect</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">tag</span> <span class="k">as</span> <span class="n">_tag</span>
<span class="kn">from</span> <span class="nn">.attach</span> <span class="kn">import</span> <span class="n">attach</span>
<span class="kn">from</span> <span class="nn">.bundle</span> <span class="kn">import</span> <span class="n">LilyPondFormatBundle</span>
<span class="kn">from</span> <span class="nn">.configuration</span> <span class="kn">import</span> <span class="n">Configuration</span>
<span class="kn">from</span> <span class="nn">.contextmanagers</span> <span class="kn">import</span> <span class="n">TemporaryDirectoryChange</span>
<span class="kn">from</span> <span class="nn">.indicators.LilyPondComment</span> <span class="kn">import</span> <span class="n">LilyPondComment</span>
<span class="kn">from</span> <span class="nn">.indicators.TimeSignature</span> <span class="kn">import</span> <span class="n">TimeSignature</span>
<span class="kn">from</span> <span class="nn">.iterate</span> <span class="kn">import</span> <span class="n">Iteration</span>
<span class="kn">from</span> <span class="nn">.lilypond</span> <span class="kn">import</span> <span class="n">lilypond</span>
<span class="kn">from</span> <span class="nn">.markups</span> <span class="kn">import</span> <span class="n">Markup</span>
<span class="kn">from</span> <span class="nn">.overrides</span> <span class="kn">import</span> <span class="n">LilyPondLiteral</span><span class="p">,</span> <span class="n">override</span><span class="p">,</span> <span class="n">setting</span>
<span class="kn">from</span> <span class="nn">.pitch.pitches</span> <span class="kn">import</span> <span class="n">NamedPitch</span>
<span class="kn">from</span> <span class="nn">.scheme</span> <span class="kn">import</span> <span class="n">Scheme</span><span class="p">,</span> <span class="n">SpacingVector</span>
<span class="kn">from</span> <span class="nn">.score</span> <span class="kn">import</span> <span class="n">Component</span><span class="p">,</span> <span class="n">Container</span><span class="p">,</span> <span class="n">Context</span><span class="p">,</span> <span class="n">Leaf</span><span class="p">,</span> <span class="n">Score</span><span class="p">,</span> <span class="n">Skip</span><span class="p">,</span> <span class="n">Staff</span><span class="p">,</span> <span class="n">Voice</span>
<span class="kn">from</span> <span class="nn">.select</span> <span class="kn">import</span> <span class="n">Selection</span>
<span class="kn">from</span> <span class="nn">.sequence</span> <span class="kn">import</span> <span class="n">Sequence</span>
<span class="kn">from</span> <span class="nn">.storage</span> <span class="kn">import</span> <span class="n">FormatSpecification</span><span class="p">,</span> <span class="n">StorageFormatManager</span>

<span class="n">configuration</span> <span class="o">=</span> <span class="n">Configuration</span><span class="p">()</span>


<div class="viewcode-block" id="Block"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.Block">[docs]</a><span class="k">class</span> <span class="nc">Block</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LilyPond file block.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        REGRESSION. Blocks remember attribute assignment order.</span>

<span class="sd">        Here right margin precedes left margin even though left margin</span>
<span class="sd">        alphabetizes before right margin:</span>

<span class="sd">        &gt;&gt;&gt; block = abjad.Block(name=&quot;paper&quot;)</span>
<span class="sd">        &gt;&gt;&gt; block.right_margin = abjad.LilyPondDimension(2, &quot;cm&quot;)</span>
<span class="sd">        &gt;&gt;&gt; block.left_margin = abjad.LilyPondDimension(2, &quot;cm&quot;)</span>
<span class="sd">        &gt;&gt;&gt; block</span>
<span class="sd">        &lt;Block(name=&#39;paper&#39;)&gt;</span>

<span class="sd">        &gt;&gt;&gt; abjad.f(block)</span>
<span class="sd">        \paper {</span>
<span class="sd">            right-margin = 2\cm</span>
<span class="sd">            left-margin = 2\cm</span>
<span class="sd">        }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; block = abjad.Block(name=&#39;score&#39;)</span>
<span class="sd">        &gt;&gt;&gt; markup = abjad.Markup(&#39;foo&#39;)</span>
<span class="sd">        &gt;&gt;&gt; block.items.append(markup)</span>
<span class="sd">        &gt;&gt;&gt; block</span>
<span class="sd">        &lt;Block(name=&#39;score&#39;)&gt;</span>

<span class="sd">        &gt;&gt;&gt; abjad.f(block)</span>
<span class="sd">        \score {</span>
<span class="sd">            {</span>
<span class="sd">                \markup { foo }</span>
<span class="sd">            }</span>
<span class="sd">        }</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;score&quot;</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">escaped_name</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_escaped_name</span> <span class="o">=</span> <span class="n">escaped_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_public_attribute_names</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="Block.__delattr__"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.Block.__delattr__">[docs]</a>    <span class="k">def</span> <span class="fm">__delattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes block attribute with ``name``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; header_block = abjad.Block(name=&quot;header&quot;)</span>
<span class="sd">            &gt;&gt;&gt; header_block.tagline = False</span>
<span class="sd">            &gt;&gt;&gt; header_block.tagline</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; delattr(header_block, &quot;tagline&quot;)</span>
<span class="sd">            &gt;&gt;&gt; hasattr(header_block, &quot;tagline&quot;)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_public_attribute_names</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="nb">object</span><span class="o">.</span><span class="fm">__delattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Block.__getitem__"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.Block.__getitem__">[docs]</a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets item with ``name``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets score with name ``&#39;Red Example Score&#39;`` in score block:</span>

<span class="sd">            &gt;&gt;&gt; block = abjad.Block(name=&quot;score&quot;)</span>
<span class="sd">            &gt;&gt;&gt; score = abjad.Score(name=&quot;Red_Example_Score&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.items.append(score)</span>

<span class="sd">            &gt;&gt;&gt; block[&quot;Red_Example_Score&quot;]</span>
<span class="sd">            Score(simultaneous=True, name=&#39;Red_Example_Score&#39;)</span>

<span class="sd">        Returns item.</span>

<span class="sd">        Raises key error when no item with ``name`` is found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">item</span>
        <span class="k">raise</span> <span class="ne">KeyError</span></div>

<div class="viewcode-block" id="Block.__repr__"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.Block.__repr__">[docs]</a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets interpreter representation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StorageFormatManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_repr_format</span><span class="p">()</span></div>

<div class="viewcode-block" id="Block.__setattr__"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.Block.__setattr__">[docs]</a>    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets block ``name`` to ``value``.</span>

<span class="sd">        Returns none.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_public_attribute_names</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_public_attribute_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets state of block.</span>

<span class="sd">        Returns none.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_public_attribute_names&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_public_attribute_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_format_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">indent</span> <span class="o">=</span> <span class="n">LilyPondFormatBundle</span><span class="o">.</span><span class="n">indent</span> <span class="o">*</span> <span class="n">depth</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="s2">&quot;{&quot;</span><span class="p">)</span>
            <span class="n">depth_</span> <span class="o">=</span> <span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                <span class="n">pieces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_item</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">depth_</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
                <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="n">item</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s2">&quot;_get_format_pieces&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pieces</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">_get_format_pieces</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="n">pieces</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">_get_format_pieces</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">piece</span> <span class="ow">in</span> <span class="n">pieces</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">piece</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
                    <span class="n">piece</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">piece</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="n">piece</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">piece</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_formatted_context_blocks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">context_blocks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">ContextBlock</span><span class="p">):</span>
                <span class="n">context_blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">context_block</span> <span class="ow">in</span> <span class="n">context_blocks</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">context_block</span><span class="o">.</span><span class="n">_get_format_pieces</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_get_format_pieces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">indent</span> <span class="o">=</span> <span class="n">LilyPondFormatBundle</span><span class="o">.</span><span class="n">indent</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_user_attributes</span><span class="p">()</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;contexts&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;context_blocks&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_escaped_name</span><span class="si">}</span><span class="s2"> </span><span class="se">{{}}</span><span class="s2">&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_escaped_name</span><span class="si">}</span><span class="s2"> </span><span class="se">{{</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">strings</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">tag</span><span class="p">([</span><span class="n">string</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">strings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">ContextBlock</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="n">Leaf</span><span class="p">,</span> <span class="n">Markup</span><span class="p">)):</span>
                <span class="n">item</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">]</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_format_item</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
        <span class="n">formatted_attributes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_user_attributes</span><span class="p">()</span>
        <span class="n">formatted_attributes</span> <span class="o">=</span> <span class="p">[</span><span class="n">indent</span> <span class="o">+</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">formatted_attributes</span><span class="p">]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">formatted_attributes</span><span class="p">)</span>
        <span class="n">formatted_context_blocks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_formatted_context_blocks</span><span class="p">()</span>
        <span class="n">formatted_context_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">indent</span> <span class="o">+</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">formatted_context_blocks</span><span class="p">]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">formatted_context_blocks</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;}&quot;</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">strings</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">tag</span><span class="p">([</span><span class="n">string</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">strings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_get_format_specification</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">FormatSpecification</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">repr_is_bracketed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">repr_is_indented</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_formatted_user_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">prototype</span> <span class="o">=</span> <span class="n">Scheme</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">prototype</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lilypond</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="n">prototype</span> <span class="o">=</span> <span class="p">(</span><span class="n">LilyPondDimension</span><span class="p">,</span> <span class="n">Scheme</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_public_attribute_names</span><span class="p">:</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="c1"># format subkeys via double underscore</span>
            <span class="n">formatted_key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">formatted_key</span><span class="p">):</span>
                <span class="n">formatted_key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;#&#39;</span><span class="si">{</span><span class="n">formatted_key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="n">formatted_key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">string</span>
            <span class="n">formatted_key</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">formatted_key</span><span class="p">)</span>
            <span class="c1"># format value</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Markup</span><span class="p">):</span>
                <span class="n">formatted_value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">_get_format_pieces</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">prototype</span><span class="p">):</span>
                <span class="n">formatted_value</span> <span class="o">=</span> <span class="p">[</span><span class="n">lilypond</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">formatted_value</span> <span class="o">=</span> <span class="n">Scheme</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="n">formatted_value</span> <span class="o">=</span> <span class="n">lilypond</span><span class="p">(</span><span class="n">formatted_value</span><span class="p">)</span>
                <span class="n">formatted_value</span> <span class="o">=</span> <span class="p">[</span><span class="n">formatted_value</span><span class="p">]</span>
            <span class="n">setting</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_key</span><span class="si">!s}</span><span class="s2"> = </span><span class="si">{</span><span class="n">formatted_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">!s}</span><span class="s2">&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">setting</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">formatted_value</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_get_lilypond_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_format_pieces</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">))</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets items in block.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; block = abjad.Block(name=&quot;score&quot;)</span>
<span class="sd">            &gt;&gt;&gt; markup = abjad.Markup(&quot;foo&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.items.append(markup)</span>

<span class="sd">            &gt;&gt;&gt; block.items</span>
<span class="sd">            [Markup(contents=[&#39;foo&#39;])]</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Accepts strings:</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; score_block = abjad.Block(name=&quot;score&quot;)</span>
<span class="sd">            &gt;&gt;&gt; score_block.items.append(&quot;&lt;&lt;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; score_block.items.append(r&#39;{ \include &quot;layout.ly&quot; }&#39;)</span>
<span class="sd">            &gt;&gt;&gt; score_block.items.append(staff)</span>
<span class="sd">            &gt;&gt;&gt; score_block.items.append(&quot;&gt;&gt;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile(</span>
<span class="sd">            ...     lilypond_language_token=False,</span>
<span class="sd">            ...     lilypond_version_token=False,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.items.append(score_block)</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(lilypond_file)</span>
<span class="sd">            \score { %! abjad.LilyPondFile._get_formatted_blocks()</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                { \include &quot;layout.ly&quot; }</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>
<span class="sd">                &gt;&gt;</span>
<span class="sd">            } %! abjad.LilyPondFile._get_formatted_blocks()</span>

<span class="sd">        Returns list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_items</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets name of block.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; block = abjad.Block(name=&quot;score&quot;)</span>
<span class="sd">            &gt;&gt;&gt; markup = abjad.Markup(&quot;foo&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.items.append(markup)</span>

<span class="sd">            &gt;&gt;&gt; block.name</span>
<span class="sd">            &#39;score&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="c1">### PUBLIC METHODS ###</span>

<div class="viewcode-block" id="Block.empty"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.Block.empty">[docs]</a>    <span class="k">def</span> <span class="nf">empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when block contains no items and has no user attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_user_attributes</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div></div>


<div class="viewcode-block" id="ContextBlock"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.ContextBlock">[docs]</a><span class="k">class</span> <span class="nc">ContextBlock</span><span class="p">(</span><span class="n">Block</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LilyPond file ``\context`` block.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; block = abjad.ContextBlock(</span>
<span class="sd">        ...     source_lilypond_type=&quot;Staff&quot;,</span>
<span class="sd">        ...     name=&quot;FluteStaff&quot;,</span>
<span class="sd">        ...     type_=&quot;Engraver_group&quot;,</span>
<span class="sd">        ...     alias=&quot;Staff&quot;,</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; block.remove_commands.append(&quot;Forbid_line_break_engraver&quot;)</span>
<span class="sd">        &gt;&gt;&gt; block.consists_commands.append(&quot;Horizontal_bracket_engraver&quot;)</span>
<span class="sd">        &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteUpperVoice&quot;)</span>
<span class="sd">        &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteLowerVoice&quot;)</span>
<span class="sd">        &gt;&gt;&gt; block.items.append(r&quot;\accidentalStyle dodecaphonic&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(block).beam.positions = (-4, -4)</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(block).stem.stem_end_position = -6</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(block).auto_beaming = False</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(block).tuplet_full_length = True</span>
<span class="sd">        &gt;&gt;&gt; block</span>
<span class="sd">        &lt;ContextBlock(source_lilypond_type=&#39;Staff&#39;, name=&#39;FluteStaff&#39;, type_=&#39;Engraver_group&#39;, alias=&#39;Staff&#39;)&gt;</span>

<span class="sd">        &gt;&gt;&gt; print(abjad.lilypond(block))</span>
<span class="sd">        \context {</span>
<span class="sd">            \Staff</span>
<span class="sd">            \name FluteStaff</span>
<span class="sd">            \type Engraver_group</span>
<span class="sd">            \alias Staff</span>
<span class="sd">            \remove Forbid_line_break_engraver</span>
<span class="sd">            \consists Horizontal_bracket_engraver</span>
<span class="sd">            \accepts FluteUpperVoice</span>
<span class="sd">            \accepts FluteLowerVoice</span>
<span class="sd">            \override Beam.positions = #&#39;(-4 . -4)</span>
<span class="sd">            \override Stem.stem-end-position = #-6</span>
<span class="sd">            autoBeaming = ##f</span>
<span class="sd">            tupletFullLength = ##t</span>
<span class="sd">            \accidentalStyle dodecaphonic</span>
<span class="sd">        }</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_lilypond_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">Block</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;context&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_source_lilypond_type</span> <span class="o">=</span> <span class="n">source_lilypond_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_type_</span> <span class="o">=</span> <span class="n">type_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alias</span> <span class="o">=</span> <span class="n">alias</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_accepts_commands</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_consists_commands</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_remove_commands</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_get_format_pieces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">indent</span> <span class="o">=</span> <span class="n">LilyPondFormatBundle</span><span class="o">.</span><span class="n">indent</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_escaped_name</span><span class="si">}</span><span class="s2"> </span><span class="se">{{</span><span class="s2">&quot;</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="c1"># CAUTION: source context name must come before type_ to allow</span>
        <span class="c1"># context redefinition.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_lilypond_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="sa">rf</span><span class="s2">&quot;\</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">source_lilypond_type</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="sa">rf</span><span class="s2">&quot;\name </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="sa">rf</span><span class="s2">&quot;\type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type_</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alias</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="sa">rf</span><span class="s2">&quot;\alias </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">alias</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">statement</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_commands</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="sa">rf</span><span class="s2">&quot;\remove </span><span class="si">{</span><span class="n">statement</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="c1"># CAUTION: LilyPond \consists statements are order-significant!</span>
        <span class="k">for</span> <span class="n">statement</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">consists_commands</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="sa">rf</span><span class="s2">&quot;\consists </span><span class="si">{</span><span class="n">statement</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">statement</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">accepts_commands</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="sa">rf</span><span class="s2">&quot;\accepts </span><span class="si">{</span><span class="n">statement</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="n">overrides</span> <span class="o">=</span> <span class="n">override</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_list_format_contributions</span><span class="p">(</span><span class="s2">&quot;override&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">statement</span> <span class="ow">in</span> <span class="n">overrides</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="n">statement</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="n">setting_contributions</span> <span class="o">=</span> <span class="n">setting</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_format_in_with_block</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">setting_contribution</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">setting_contributions</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="n">setting_contribution</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s2">&quot;_get_format_pieces&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">piece</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">_get_format_pieces</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">piece</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
                        <span class="n">piece</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">piece</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="n">piece</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">piece</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">accepts_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets arguments of LilyPond ``\accepts`` commands.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; block = abjad.ContextBlock(</span>
<span class="sd">            ...     source_lilypond_type=&quot;Staff&quot;,</span>
<span class="sd">            ...     name=&quot;FluteStaff&quot;,</span>
<span class="sd">            ...     type_=&quot;Engraver_group&quot;,</span>
<span class="sd">            ...     alias=&quot;Staff&quot;,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; block.remove_commands.append(&quot;Forbid_line_break_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.consists_commands.append(&quot;Horizontal_bracket_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteUpperVoice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteLowerVoice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.items.append(r&quot;\accidentalStyle dodecaphonic&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(block).beam.positions = (-4, -4)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(block).stem.stem_end_position = -6</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(block).auto_beaming = False</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(block).tuplet_full_length = True</span>

<span class="sd">            &gt;&gt;&gt; block.accepts_commands</span>
<span class="sd">            [&#39;FluteUpperVoice&#39;, &#39;FluteLowerVoice&#39;]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accepts_commands</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">alias</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets and sets argument of LilyPond ``\alias`` command.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; block = abjad.ContextBlock(</span>
<span class="sd">            ...     source_lilypond_type=&quot;Staff&quot;,</span>
<span class="sd">            ...     name=&quot;FluteStaff&quot;,</span>
<span class="sd">            ...     type_=&quot;Engraver_group&quot;,</span>
<span class="sd">            ...     alias=&quot;Staff&quot;,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; block.remove_commands.append(&quot;Forbid_line_break_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.consists_commands.append(&quot;Horizontal_bracket_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteUpperVoice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteLowerVoice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.items.append(r&quot;\accidentalStyle dodecaphonic&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(block).beam.positions = (-4, -4)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(block).stem.stem_end_position = -6</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(block).auto_beaming = False</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(block).tuplet_full_length = True</span>

<span class="sd">            &gt;&gt;&gt; block.alias</span>
<span class="sd">            &#39;Staff&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alias</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">consists_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets arguments of LilyPond ``\consists`` commands.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; block = abjad.ContextBlock(</span>
<span class="sd">            ...     source_lilypond_type=&quot;Staff&quot;,</span>
<span class="sd">            ...     name=&quot;FluteStaff&quot;,</span>
<span class="sd">            ...     type_=&quot;Engraver_group&quot;,</span>
<span class="sd">            ...     alias=&quot;Staff&quot;,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; block.remove_commands.append(&quot;Forbid_line_break_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.consists_commands.append(&quot;Horizontal_bracket_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteUpperVoice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteLowerVoice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.items.append(r&quot;\accidentalStyle dodecaphonic&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(block).beam.positions = (-4, -4)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(block).stem.stem_end_position = -6</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(block).auto_beaming = False</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(block).tuplet_full_length = True</span>

<span class="sd">            &gt;&gt;&gt; block.consists_commands</span>
<span class="sd">            [&#39;Horizontal_bracket_engraver&#39;]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_consists_commands</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets items in context block.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; block = abjad.ContextBlock(</span>
<span class="sd">            ...     source_lilypond_type=&quot;Staff&quot;,</span>
<span class="sd">            ...     name=&quot;FluteStaff&quot;,</span>
<span class="sd">            ...     type_=&quot;Engraver_group&quot;,</span>
<span class="sd">            ...     alias=&quot;Staff&quot;,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; block.remove_commands.append(&quot;Forbid_line_break_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.consists_commands.append(&quot;Horizontal_bracket_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteUpperVoice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteLowerVoice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.items.append(r&quot;\accidentalStyle dodecaphonic&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(block).beam.positions = (-4, -4)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(block).stem.stem_end_position = -6</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(block).auto_beaming = False</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(block).tuplet_full_length = True</span>

<span class="sd">            &gt;&gt;&gt; block.items</span>
<span class="sd">            [&#39;\\accidentalStyle dodecaphonic&#39;]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_items</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets and sets argument of LilyPond ``\name`` command.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; block = abjad.ContextBlock(</span>
<span class="sd">            ...     source_lilypond_type=&quot;Staff&quot;,</span>
<span class="sd">            ...     name=&quot;FluteStaff&quot;,</span>
<span class="sd">            ...     type_=&quot;Engraver_group&quot;,</span>
<span class="sd">            ...     alias=&quot;Staff&quot;,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; block.remove_commands.append(&quot;Forbid_line_break_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.consists_commands.append(&quot;Horizontal_bracket_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteUpperVoice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteLowerVoice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.items.append(r&quot;\accidentalStyle dodecaphonic&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(block).beam.positions = (-4, -4)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(block).stem.stem_end_position = -6</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(block).auto_beaming = False</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(block).tuplet_full_length = True</span>

<span class="sd">            &gt;&gt;&gt; block.name</span>
<span class="sd">            &#39;FluteStaff&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">remove_commands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets arguments of LilyPond ``\remove`` commands.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; block = abjad.ContextBlock(</span>
<span class="sd">            ...     source_lilypond_type=&quot;Staff&quot;,</span>
<span class="sd">            ...     name=&quot;FluteStaff&quot;,</span>
<span class="sd">            ...     type_=&quot;Engraver_group&quot;,</span>
<span class="sd">            ...     alias=&quot;Staff&quot;,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; block.remove_commands.append(&quot;Forbid_line_break_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.consists_commands.append(&quot;Horizontal_bracket_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteUpperVoice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteLowerVoice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.items.append(r&quot;\accidentalStyle dodecaphonic&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(block).beam.positions = (-4, -4)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(block).stem.stem_end_position = -6</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(block).auto_beaming = False</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(block).tuplet_full_length = True</span>

<span class="sd">            &gt;&gt;&gt; block.remove_commands</span>
<span class="sd">            [&#39;Forbid_line_break_engraver&#39;]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_remove_commands</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">source_lilypond_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets and sets source context name.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; block = abjad.ContextBlock(</span>
<span class="sd">            ...     source_lilypond_type=&quot;Staff&quot;,</span>
<span class="sd">            ...     name=&quot;FluteStaff&quot;,</span>
<span class="sd">            ...     type_=&quot;Engraver_group&quot;,</span>
<span class="sd">            ...     alias=&quot;Staff&quot;,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; block.remove_commands.append(&quot;Forbid_line_break_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.consists_commands.append(&quot;Horizontal_bracket_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteUpperVoice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteLowerVoice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.items.append(r&quot;\accidentalStyle dodecaphonic&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(block).beam.positions = (-4, -4)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(block).stem.stem_end_position = -6</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(block).auto_beaming = False</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(block).tuplet_full_length = True</span>

<span class="sd">            &gt;&gt;&gt; block.source_lilypond_type</span>
<span class="sd">            &#39;Staff&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source_lilypond_type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets and sets argument of LilyPond ``\type`` command.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; block = abjad.ContextBlock(</span>
<span class="sd">            ...     source_lilypond_type=&quot;Staff&quot;,</span>
<span class="sd">            ...     name=&quot;FluteStaff&quot;,</span>
<span class="sd">            ...     type_=&quot;Engraver_group&quot;,</span>
<span class="sd">            ...     alias=&quot;Staff&quot;,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; block.remove_commands.append(&quot;Forbid_line_break_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.consists_commands.append(&quot;Horizontal_bracket_engraver&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteUpperVoice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.accepts_commands.append(&quot;FluteLowerVoice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; block.items.append(r&quot;\accidentalStyle dodecaphonic&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(block).beam.positions = (-4, -4)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(block).stem.stem_end_position = -6</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(block).auto_beaming = False</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(block).tuplet_full_length = True</span>

<span class="sd">            &gt;&gt;&gt; block.type_</span>
<span class="sd">            &#39;Engraver_group&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type_</span></div>


<div class="viewcode-block" id="DateTimeToken"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.DateTimeToken">[docs]</a><span class="k">class</span> <span class="nc">DateTimeToken</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LilyPond file date / time token.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; abjad.DateTimeToken()</span>
<span class="sd">        DateTimeToken()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_date_string&quot;</span><span class="p">,)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date_string</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">date_string</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_date_string</span> <span class="o">=</span> <span class="n">date_string</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="DateTimeToken.__repr__"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.DateTimeToken.__repr__">[docs]</a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets interpreter representation of date / time token.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.DateTimeToken()</span>
<span class="sd">            DateTimeToken()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">date_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_date_string</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">date_string</span><span class="si">}</span><span class="s2">)&quot;</span></div>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_get_lilypond_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_string</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">date_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets date string of date / time token.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; token = abjad.DateTimeToken()</span>
<span class="sd">            &gt;&gt;&gt; token.date_string # doctest: +SKIP</span>
<span class="sd">            &#39;2014-01-23 12:21&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">date_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_date_string</span> <span class="ow">or</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">date_string</span></div>


<div class="viewcode-block" id="LilyPondDimension"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.LilyPondDimension">[docs]</a><span class="k">class</span> <span class="nc">LilyPondDimension</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LilyPond file ``\paper`` block dimension.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; abjad.LilyPondDimension(2, &quot;in&quot;)</span>
<span class="sd">        LilyPondDimension(value=2, unit=&#39;in&#39;)</span>

<span class="sd">    Use for LilyPond file ``\paper`` block attributes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_unit&quot;</span><span class="p">,</span> <span class="s2">&quot;_value&quot;</span><span class="p">)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;cm&quot;</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span>
        <span class="k">assert</span> <span class="n">unit</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;cm&quot;</span><span class="p">,</span> <span class="s2">&quot;in&quot;</span><span class="p">,</span> <span class="s2">&quot;mm&quot;</span><span class="p">,</span> <span class="s2">&quot;pt&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unit</span> <span class="o">=</span> <span class="n">unit</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="LilyPondDimension.__repr__"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.LilyPondDimension.__repr__">[docs]</a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets interpreter representation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StorageFormatManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_repr_format</span><span class="p">()</span></div>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_get_format_pieces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="sa">rf</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">\</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_get_lilypond_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_format_pieces</span><span class="p">())</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">unit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets unit of LilyPond dimension.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; dimension = abjad.LilyPondDimension(2, &quot;in&quot;)</span>
<span class="sd">            &gt;&gt;&gt; dimension.unit</span>
<span class="sd">            &#39;in&#39;</span>

<span class="sd">        Returns ``&#39;cm&#39;``, ``&#39;in&#39;``, ``&#39;mm&#39;`` or ``&#39;pt&#39;``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unit</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets value of LilyPond dimension.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; dimension = abjad.LilyPondDimension(2, &quot;in&quot;)</span>
<span class="sd">            &gt;&gt;&gt; dimension.value</span>
<span class="sd">            2</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>


<div class="viewcode-block" id="LilyPondLanguageToken"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.LilyPondLanguageToken">[docs]</a><span class="k">class</span> <span class="nc">LilyPondLanguageToken</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LilyPond file ``\language`` token.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; abjad.LilyPondLanguageToken()</span>
<span class="sd">        LilyPondLanguageToken()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="LilyPondLanguageToken.__repr__"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.LilyPondLanguageToken.__repr__">[docs]</a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets interpreter representation of LilyPond language token.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; token = abjad.LilyPondLanguageToken()</span>
<span class="sd">            &gt;&gt;&gt; token</span>
<span class="sd">            LilyPondLanguageToken()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">()&quot;</span></div>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_get_lilypond_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\language &quot;english&quot;&#39;</span>
        <span class="k">return</span> <span class="n">string</span></div>


<div class="viewcode-block" id="LilyPondVersionToken"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.LilyPondVersionToken">[docs]</a><span class="k">class</span> <span class="nc">LilyPondVersionToken</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LilyPond file ``\version`` token.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_version_string&quot;</span><span class="p">,)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">version_string</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">version_string</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">version_string</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">version_string</span> <span class="o">=</span> <span class="n">configuration</span><span class="o">.</span><span class="n">get_lilypond_version_string</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_version_string</span> <span class="o">=</span> <span class="n">version_string</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="LilyPondVersionToken.__repr__"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.LilyPondVersionToken.__repr__">[docs]</a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets interpreter representation of LilyPond version_string token.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; token = abjad.LilyPondVersionToken()</span>
<span class="sd">            &gt;&gt;&gt; token # doctest: +SKIP</span>
<span class="sd">            LilyPondVersionToken(&#39;2.19.84&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">version_string</span><span class="si">!r}</span><span class="s2">)&quot;</span></div>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_get_lilypond_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">rf</span><span class="s1">&#39;\version &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">version_string</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">version_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets version string of LilyPond version token.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets version string from install environment:</span>

<span class="sd">            &gt;&gt;&gt; token = abjad.LilyPondVersionToken(</span>
<span class="sd">            ...     version_string=None,</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; token.version_string # doctest: +SKIP</span>
<span class="sd">            &#39;2.19.84&#39;</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets version string from explicit input:</span>

<span class="sd">            &gt;&gt;&gt; token = abjad.LilyPondVersionToken(</span>
<span class="sd">            ...     version_string=&quot;2.19.84&quot;,</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; token.version_string</span>
<span class="sd">            &#39;2.19.84&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_version_string</span></div>


<div class="viewcode-block" id="PackageGitCommitToken"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.PackageGitCommitToken">[docs]</a><span class="k">class</span> <span class="nc">PackageGitCommitToken</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Python package git commit token.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; token = abjad.PackageGitCommitToken(&quot;abjad&quot;)</span>
<span class="sd">        &gt;&gt;&gt; token</span>
<span class="sd">        PackageGitCommitToken(package_name=&#39;abjad&#39;)</span>

<span class="sd">        &gt;&gt;&gt; print(abjad.lilypond(token))  # doctest: +SKIP</span>
<span class="sd">        package &quot;abjad&quot; @ b6a48a7 [implement-lpf-git-token] (2016-02-02 13:36:25)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_package_name&quot;</span><span class="p">,)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_package_name</span> <span class="o">=</span> <span class="n">package_name</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="PackageGitCommitToken.__repr__"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.PackageGitCommitToken.__repr__">[docs]</a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets interpreter representation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StorageFormatManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_repr_format</span><span class="p">()</span></div>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_get_commit_timestamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">commit_hash</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;git show -s --format=%ci </span><span class="si">{</span><span class="n">commit_hash</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_git_branch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;git rev-parse --abbrev-ref HEAD&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_git_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;git rev-parse HEAD&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_command</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_lilypond_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_package_path</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">TemporaryDirectoryChange</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">git_branch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_git_branch</span><span class="p">()</span>
            <span class="n">git_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_git_hash</span><span class="p">()</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_commit_timestamp</span><span class="p">(</span><span class="n">git_hash</span><span class="p">)</span>
        <span class="n">date</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">timestamp</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">return</span> <span class="s1">&#39;package &quot;</span><span class="si">{}</span><span class="s1">&quot; @ </span><span class="si">{}</span><span class="s1"> [</span><span class="si">{}</span><span class="s1">] (</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_package_name</span><span class="p">,</span> <span class="n">git_hash</span><span class="p">[:</span><span class="mi">7</span><span class="p">],</span> <span class="n">git_branch</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">time</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_package_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_package_name</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">__path__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span>

    <span class="k">def</span> <span class="nf">_run_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">):</span>
        <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
            <span class="n">command</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span>
        <span class="p">)</span>
        <span class="n">process</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">process</span><span class="o">.</span><span class="n">returncode</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">package_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets package name of package git commit token.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; token = abjad.PackageGitCommitToken(&quot;abjad&quot;)</span>
<span class="sd">            &gt;&gt;&gt; token.package_name</span>
<span class="sd">            &#39;abjad&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_package_name</span></div>


<div class="viewcode-block" id="LilyPondFile"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.LilyPondFile">[docs]</a><span class="k">class</span> <span class="nc">LilyPondFile</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LilyPond file.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; comments = [</span>
<span class="sd">        ...     &quot;File construct as an example.&quot;,</span>
<span class="sd">        ...     &quot;Parts shown here for positioning.&quot;,</span>
<span class="sd">        ... ]</span>
<span class="sd">        &gt;&gt;&gt; includes = [</span>
<span class="sd">        ...     &quot;external-settings-file-1.ily&quot;,</span>
<span class="sd">        ...     &quot;external-settings-file-2.ily&quot;,</span>
<span class="sd">        ... ]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new(</span>
<span class="sd">        ...     music=staff,</span>
<span class="sd">        ...     default_paper_size=(&quot;a5&quot;, &quot;portrait&quot;),</span>
<span class="sd">        ...     comments=comments,</span>
<span class="sd">        ...     includes=includes,</span>
<span class="sd">        ...     global_staff_size=16,</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; lilypond_file.header_block.composer = abjad.Markup(&quot;Josquin&quot;)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file.header_block.title = abjad.Markup(&quot;Missa sexti tonus&quot;)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file.layout_block.indent = 0</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file.layout_block.left_margin = 15</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ::</span>

<span class="sd">            &gt;&gt;&gt; print(abjad.lilypond(lilypond_file)) # doctest: +SKIP</span>
<span class="sd">            % 2004-01-14 17:29</span>

<span class="sd">            % File construct as an example.</span>
<span class="sd">            % Parts shown here for positioning.</span>

<span class="sd">            \version &quot;2.19.0&quot;</span>
<span class="sd">            \language &quot;english&quot;</span>

<span class="sd">            \include &quot;external-settings-file-1.ily&quot;</span>
<span class="sd">            \include &quot;external-settings-file-2.ily&quot;</span>

<span class="sd">            #(set-default-paper-size &quot;a5&quot; &#39;portrait)</span>
<span class="sd">            #(set-global-staff-size 16)</span>

<span class="sd">            \header {</span>
<span class="sd">                composer = \markup { Josquin }</span>
<span class="sd">                title = \markup { Missa sexti toni }</span>
<span class="sd">            }</span>

<span class="sd">            \layout {</span>
<span class="sd">                indent = #0</span>
<span class="sd">                left-margin = #15</span>
<span class="sd">            }</span>

<span class="sd">            \paper {</span>
<span class="sd">            }</span>

<span class="sd">            \new Staff {</span>
<span class="sd">                c&#39;8</span>
<span class="sd">                d&#39;8</span>
<span class="sd">                e&#39;8</span>
<span class="sd">                f&#39;8</span>
<span class="sd">            }</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_comments&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_date_time_token&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_default_paper_size&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_global_staff_size&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_includes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_items&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_lilypond_language_token&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_lilypond_version_token&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_tag&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_use_relative_includes&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">comments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">date_time_token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">default_paper_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">global_staff_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">includes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">items</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">lilypond_language_token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">lilypond_version_token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">use_relative_includes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">comments</span> <span class="o">=</span> <span class="n">comments</span> <span class="ow">or</span> <span class="p">()</span>
        <span class="n">comments</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">comments</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_comments</span> <span class="o">=</span> <span class="n">comments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_date_time_token</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">date_time_token</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_date_time_token</span> <span class="o">=</span> <span class="n">DateTimeToken</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_paper_size</span> <span class="o">=</span> <span class="n">default_paper_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_global_staff_size</span> <span class="o">=</span> <span class="n">global_staff_size</span>
        <span class="n">includes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">includes</span> <span class="ow">or</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_includes</span> <span class="o">=</span> <span class="n">includes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">items</span> <span class="ow">or</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lilypond_language_token</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">lilypond_language_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">language</span> <span class="o">=</span> <span class="n">LilyPondLanguageToken</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lilypond_language_token</span> <span class="o">=</span> <span class="n">language</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lilypond_version_token</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">lilypond_version_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">version</span> <span class="o">=</span> <span class="n">LilyPondVersionToken</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lilypond_version_token</span> <span class="o">=</span> <span class="n">version</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tag</span> <span class="o">=</span> <span class="n">tag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_use_relative_includes</span> <span class="o">=</span> <span class="n">use_relative_includes</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="LilyPondFile.__contains__"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.LilyPondFile.__contains__">[docs]</a>    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when LilyPond file contains ``argument``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new(staff)</span>

<span class="sd">            &gt;&gt;&gt; staff in lilypond_file</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; abjad.Staff in lilypond_file</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; &quot;Allegro&quot; in lilypond_file</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; 0 in lilypond_file</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">argument</span><span class="p">]</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">AssertionError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="LilyPondFile.__getitem__"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.LilyPondFile.__getitem__">[docs]</a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets item with ``name``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets header block:</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new()</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file[&quot;header&quot;]</span>
<span class="sd">            &lt;Block(name=&#39;header&#39;)&gt;</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Searches score:</span>

<span class="sd">            &gt;&gt;&gt; voice_1 = abjad.Voice(&quot;c&#39;&#39;4 b&#39; a&#39; g&#39;&quot;, name=&quot;Custom_Voice_1&quot;)</span>
<span class="sd">            &gt;&gt;&gt; literal = abjad.LilyPondLiteral(r&quot;\voiceOne&quot;, &quot;opening&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(literal, voice_1)</span>
<span class="sd">            &gt;&gt;&gt; voice_2 = abjad.Voice(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;, name=&quot;Custom_Voice_2&quot;)</span>
<span class="sd">            &gt;&gt;&gt; literal = abjad.LilyPondLiteral(r&quot;\voiceTwo&quot;, &quot;opening&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(literal, voice_2)</span>
<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(</span>
<span class="sd">            ...     [voice_1, voice_2],</span>
<span class="sd">            ...     simultaneous=True,</span>
<span class="sd">            ...     name=&quot;Custom_Staff&quot;,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; score = abjad.Score([staff], name=&quot;Custom_Score&quot;)</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new(score)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(score)</span>
<span class="sd">                \context Score = &quot;Custom_Score&quot;</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \context Staff = &quot;Custom_Staff&quot;</span>
<span class="sd">                    &lt;&lt;</span>
<span class="sd">                        \context Voice = &quot;Custom_Voice_1&quot;</span>
<span class="sd">                        {</span>
<span class="sd">                            \voiceOne</span>
<span class="sd">                            c&#39;&#39;4</span>
<span class="sd">                            b&#39;4</span>
<span class="sd">                            a&#39;4</span>
<span class="sd">                            g&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                        \context Voice = &quot;Custom_Voice_2&quot;</span>
<span class="sd">                        {</span>
<span class="sd">                            \voiceTwo</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            d&#39;4</span>
<span class="sd">                            e&#39;4</span>
<span class="sd">                            f&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                    &gt;&gt;</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file[&quot;score&quot;]</span>
<span class="sd">            &lt;Block(name=&#39;score&#39;)&gt;</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file[&quot;Custom_Score&quot;]</span>
<span class="sd">            &lt;Score-&quot;Custom_Score&quot;&lt;&lt;1&gt;&gt;&gt;</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file[abjad.Score]</span>
<span class="sd">            &lt;Score-&quot;Custom_Score&quot;&lt;&lt;1&gt;&gt;&gt;</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file[&quot;Custom_Staff&quot;]</span>
<span class="sd">            &lt;Staff-&quot;Custom_Staff&quot;&lt;&lt;2&gt;&gt;&gt;</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file[abjad.Staff]</span>
<span class="sd">            &lt;Staff-&quot;Custom_Staff&quot;&lt;&lt;2&gt;&gt;&gt;</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file[&quot;Custom_Voice_1&quot;]</span>
<span class="sd">            Voice(&quot;c&#39;&#39;4 b&#39;4 a&#39;4 g&#39;4&quot;, name=&#39;Custom_Voice_1&#39;)</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file[&quot;Custom_Voice_2&quot;]</span>
<span class="sd">            Voice(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;, name=&#39;Custom_Voice_2&#39;)</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file[abjad.Voice]</span>
<span class="sd">            Voice(&quot;c&#39;&#39;4 b&#39;4 a&#39;4 g&#39;4&quot;, name=&#39;Custom_Voice_1&#39;)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            REGRESSION. Works when score block contains parallel container:</span>

<span class="sd">                &gt;&gt;&gt; include_container = abjad.Container()</span>
<span class="sd">                &gt;&gt;&gt; string = r&#39;\include &quot;layout.ly&quot;&#39;</span>
<span class="sd">                &gt;&gt;&gt; literal = abjad.LilyPondLiteral(string, &quot;opening&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(literal, include_container)</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;, name=&quot;Custom_Staff&quot;)</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.Container(</span>
<span class="sd">                ...     [include_container, staff],</span>
<span class="sd">                ...     simultaneous=True,</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new(</span>
<span class="sd">                ...     container,</span>
<span class="sd">                ...     lilypond_language_token=False,</span>
<span class="sd">                ...     lilypond_version_token=False,</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt; del(lilypond_file.items[:3])</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(lilypond_file)</span>
<span class="sd">                \score { %! abjad.LilyPondFile._get_formatted_blocks()</span>
<span class="sd">                    &lt;&lt;</span>
<span class="sd">                        {</span>
<span class="sd">                            \include &quot;layout.ly&quot;</span>
<span class="sd">                        }</span>
<span class="sd">                        \context Staff = &quot;Custom_Staff&quot;</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            d&#39;4</span>
<span class="sd">                            e&#39;4</span>
<span class="sd">                            f&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                    &gt;&gt;</span>
<span class="sd">                } %! abjad.LilyPondFile._get_formatted_blocks()</span>

<span class="sd">                &gt;&gt;&gt; lilypond_file[abjad.Staff]</span>
<span class="sd">                Staff(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;, name=&#39;Custom_Staff&#39;)</span>

<span class="sd">                &gt;&gt;&gt; lilypond_file[&#39;Custom_Staff&#39;]</span>
<span class="sd">                Staff(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;, name=&#39;Custom_Staff&#39;)</span>

<span class="sd">        Returns item.</span>

<span class="sd">        Raises key error when no item with ``name`` is found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                <span class="k">assert</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Component</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Component</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">score</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_block</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_block</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_block</span><span class="o">.</span><span class="n">items</span>
            <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">Iteration</span><span class="p">(</span><span class="n">items</span><span class="p">)</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">Container</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">Context</span><span class="p">):</span>
                    <span class="n">score</span> <span class="o">=</span> <span class="n">container</span>
                    <span class="k">break</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">item</span>
            <span class="k">if</span> <span class="n">score</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">score</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">score</span>
                <span class="n">context</span> <span class="o">=</span> <span class="n">score</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">context</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;can not find item with name </span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Component</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="n">name</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">item</span>
            <span class="k">if</span> <span class="n">score</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">score</span> <span class="ow">is</span> <span class="n">name</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">score</span>
                <span class="n">prototype</span> <span class="o">=</span> <span class="n">Context</span>
                <span class="k">for</span> <span class="n">context</span> <span class="ow">in</span> <span class="n">Iteration</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">prototype</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="n">name</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">context</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;can not find </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Component</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">item</span>
            <span class="k">if</span> <span class="n">score</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">score</span>
                <span class="n">prototype</span> <span class="o">=</span> <span class="n">Context</span>
                <span class="k">for</span> <span class="n">context</span> <span class="ow">in</span> <span class="n">Iteration</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">prototype</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">context</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;can not find item of class </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="LilyPondFile.__illustrate__"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.LilyPondFile.__illustrate__">[docs]</a>    <span class="k">def</span> <span class="nf">__illustrate__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;LilyPondFile&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Illustrates LilyPond file.</span>

<span class="sd">        Returns LilyPond file unchanged.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="LilyPondFile.__repr__"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.LilyPondFile.__repr__">[docs]</a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets interpreter representation of LilyPond file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StorageFormatManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_repr_format</span><span class="p">()</span></div>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_get_format_pieces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_time_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">date_time_token</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_comments</span><span class="p">())</span>
        <span class="n">includes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lilypond_version_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lilypond_version_token</span><span class="o">.</span><span class="n">_get_lilypond_format</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">includes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lilypond_language_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lilypond_language_token</span><span class="o">.</span><span class="n">_get_lilypond_format</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">includes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="s2">&quot;abjad.LilyPondFile._get_format_pieces()&quot;</span><span class="p">)</span>
        <span class="n">includes</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">includes</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">))</span>
        <span class="n">includes</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">includes</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">includes</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">includes</span><span class="p">)</span>
        <span class="n">postincludes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_relative_includes</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;#(ly:set-option &#39;relative-includes #t)&quot;</span>
            <span class="n">postincludes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="n">postincludes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_includes</span><span class="p">())</span>
        <span class="n">postincludes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_scheme_settings</span><span class="p">())</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">postincludes</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_formatted_blocks</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_get_format_specification</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">FormatSpecification</span><span class="p">(</span><span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_formatted_blocks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="s2">&quot;abjad.LilyPondFile._get_formatted_blocks()&quot;</span><span class="p">)</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;_get_lilypond_format&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">string</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">_get_lilypond_format</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">string</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">_get_lilypond_format</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">string</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_get_formatted_comments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">comment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">comments</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;_get_lilypond_format&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">comment</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">lilypond_format</span> <span class="o">=</span> <span class="n">comment</span><span class="o">.</span><span class="n">_get_lilypond_format</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">lilypond_format</span><span class="p">:</span>
                    <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">comment</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;% </span><span class="si">{</span><span class="n">comment</span><span class="si">!s}</span><span class="s2">&quot;</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_get_formatted_includes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="s2">&quot;abjad.LilyPondFile._get_formatted_includes()&quot;</span><span class="p">)</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">include</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">includes</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">include</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s1">&#39;\include &quot;</span><span class="si">{</span><span class="n">include</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">include</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">):</span>
                <span class="n">string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s1">&#39;\include &quot;</span><span class="si">{</span><span class="n">include</span><span class="si">!s}</span><span class="s1">&quot;&#39;</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">include</span><span class="p">,</span> <span class="n">LilyPondLiteral</span><span class="p">):</span>
                <span class="n">string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">include</span><span class="o">.</span><span class="n">argument</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">include</span><span class="o">.</span><span class="n">_get_lilypond_format</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_get_formatted_scheme_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="s2">&quot;abjad.LilyPondFile._get_formatted_scheme_settings()&quot;</span><span class="p">)</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
        <span class="n">default_paper_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_paper_size</span>
        <span class="k">if</span> <span class="n">default_paper_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dimension</span><span class="p">,</span> <span class="n">orientation</span> <span class="o">=</span> <span class="n">default_paper_size</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;#(set-default-paper-size &quot;</span><span class="si">{</span><span class="n">dimension</span><span class="si">}</span><span class="s1">&quot; </span><span class="se">\&#39;</span><span class="si">{</span><span class="n">orientation</span><span class="si">}</span><span class="s1">)&#39;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="n">global_staff_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_staff_size</span>
        <span class="k">if</span> <span class="n">global_staff_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;#(set-global-staff-size </span><span class="si">{</span><span class="n">global_staff_size</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_get_lilypond_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_format_pieces</span><span class="p">())</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_make_global_context_block</span><span class="p">(</span><span class="n">font_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">minimum_distance</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">font_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">padding</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span>
        <span class="n">block</span> <span class="o">=</span> <span class="n">ContextBlock</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Global_Context&quot;</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="s2">&quot;Engraver_group&quot;</span><span class="p">)</span>
        <span class="n">block</span><span class="o">.</span><span class="n">consists_commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Axis_group_engraver&quot;</span><span class="p">)</span>
        <span class="n">block</span><span class="o">.</span><span class="n">consists_commands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Time_signature_engraver&quot;</span><span class="p">)</span>
        <span class="n">time_signature_grob</span> <span class="o">=</span> <span class="n">override</span><span class="p">(</span><span class="n">block</span><span class="p">)</span><span class="o">.</span><span class="n">time_signature</span>
        <span class="n">time_signature_grob</span><span class="o">.</span><span class="n">X_extent</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">time_signature_grob</span><span class="o">.</span><span class="n">X_offset</span> <span class="o">=</span> <span class="n">Scheme</span><span class="p">(</span>
            <span class="s2">&quot;ly:self-alignment-interface::x-aligned-on-self&quot;</span>
        <span class="p">)</span>
        <span class="n">time_signature_grob</span><span class="o">.</span><span class="n">Y_extent</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">time_signature_grob</span><span class="o">.</span><span class="n">break_align_symbol</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">time_signature_grob</span><span class="o">.</span><span class="n">break_visibility</span> <span class="o">=</span> <span class="n">Scheme</span><span class="p">(</span><span class="s2">&quot;end-of-line-invisible&quot;</span><span class="p">)</span>
        <span class="n">time_signature_grob</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">font_size</span>
        <span class="n">time_signature_grob</span><span class="o">.</span><span class="n">self_alignment_X</span> <span class="o">=</span> <span class="n">Scheme</span><span class="p">(</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
        <span class="n">spacing_vector</span> <span class="o">=</span> <span class="n">SpacingVector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">minimum_distance</span><span class="p">,</span> <span class="n">padding</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">grob</span> <span class="o">=</span> <span class="n">override</span><span class="p">(</span><span class="n">block</span><span class="p">)</span><span class="o">.</span><span class="n">vertical_axis_group</span>
        <span class="n">grob</span><span class="o">.</span><span class="n">default_staff_staff_spacing</span> <span class="o">=</span> <span class="n">spacing_vector</span>
        <span class="k">return</span> <span class="n">block</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">comments</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">LilyPondComment</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets comments of Lilypond file.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new()</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.comments</span>
<span class="sd">            []</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comments</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">date_time_token</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">DateTimeToken</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets date-time token.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new(date_time_token=True)</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.date_time_token</span>
<span class="sd">            DateTimeToken()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_date_time_token</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">default_paper_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets default paper size of LilyPond file.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new()</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.default_paper_size is None</span>
<span class="sd">            True</span>

<span class="sd">        Returns pair or none.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_paper_size</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">global_staff_size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets global staff size of LilyPond file.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new()</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.global_staff_size is None</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_staff_size</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">header_block</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">Block</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets header block.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new()</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.header_block</span>
<span class="sd">            &lt;Block(name=&#39;header&#39;)&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Block</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;header&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">item</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">includes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets includes of LilyPond file.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new()</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.includes</span>
<span class="sd">            []</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_includes</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets items in LilyPond file.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new()</span>
<span class="sd">            &gt;&gt;&gt; for item in lilypond_file.items:</span>
<span class="sd">            ...     item</span>
<span class="sd">            ...</span>
<span class="sd">            &lt;Block(name=&#39;header&#39;)&gt;</span>
<span class="sd">            &lt;Block(name=&#39;layout&#39;)&gt;</span>
<span class="sd">            &lt;Block(name=&#39;paper&#39;)&gt;</span>
<span class="sd">            &lt;Block(name=&#39;score&#39;)&gt;</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Accepts strings:</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; score_block = abjad.Block(name=&quot;score&quot;)</span>
<span class="sd">            &gt;&gt;&gt; score_block.items.append(staff)</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile(</span>
<span class="sd">            ...     lilypond_language_token=False,</span>
<span class="sd">            ...     lilypond_version_token=False,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; string = r&quot;\customCommand&quot;</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.items.append(string)</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.items.append(score_block)</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(lilypond_file)</span>
<span class="sd">            \customCommand</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">            \score { %! abjad.LilyPondFile._get_formatted_blocks()</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>
<span class="sd">            } %! abjad.LilyPondFile._get_formatted_blocks()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_items</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">layout_block</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">Block</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets layout block.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new()</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.layout_block</span>
<span class="sd">            &lt;Block(name=&#39;layout&#39;)&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Block</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;layout&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">item</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lilypond_language_token</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">LilyPondLanguageToken</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets LilyPond language token.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new()</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.lilypond_language_token</span>
<span class="sd">            LilyPondLanguageToken()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lilypond_language_token</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lilypond_version_token</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">LilyPondVersionToken</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets LilyPond version token.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new()</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.lilypond_version_token # doctest: +SKIP</span>
<span class="sd">            LilyPondVersionToken(&#39;2.19.35&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lilypond_version_token</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">paper_block</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">Block</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets paper block.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets paper block:</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new()</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.paper_block</span>
<span class="sd">            &lt;Block(name=&#39;paper&#39;)&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Block</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;paper&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">item</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">score_block</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">Block</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets score block.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new()</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.score_block</span>
<span class="sd">            &lt;Block(name=&#39;score&#39;)&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Block</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;score&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">item</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">use_relative_includes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when LilyPond file should use relative includes.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new()</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.use_relative_includes is None</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_relative_includes</span>

    <span class="c1">### PUBLIC METHODS ###</span>

<div class="viewcode-block" id="LilyPondFile.get_tag"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.LilyPondFile.get_tag">[docs]</a>    <span class="k">def</span> <span class="nf">get_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets tag.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tag</span><span class="p">)</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tag</span></div>

<div class="viewcode-block" id="LilyPondFile.new"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.LilyPondFile.new">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">new</span><span class="p">(</span>
        <span class="n">class_</span><span class="p">,</span>
        <span class="n">music</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">date_time_token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">default_paper_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">comments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">includes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">global_staff_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">lilypond_language_token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">lilypond_version_token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">use_relative_includes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;LilyPondFile&quot;</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Makes basic LilyPond file.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Makes basic LilyPond file:</span>

<span class="sd">            &gt;&gt;&gt; score = abjad.Score([abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)])</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.new(score)</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.header_block.title = abjad.Markup(&quot;Missa sexti tonus&quot;)</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.header_block.composer = abjad.Markup(&quot;Josquin&quot;)</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.layout_block.indent = 0</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.paper_block.top_margin = 15</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file.paper_block.left_margin = 15</span>

<span class="sd">            ::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(lilypond_file) # doctest: +SKIP</span>
<span class="sd">                \header {</span>
<span class="sd">                    composer = \markup { Josquin }</span>
<span class="sd">                    title = \markup { Missa sexti tonus }</span>
<span class="sd">                }</span>

<span class="sd">                \layout {</span>
<span class="sd">                    indent = #0</span>
<span class="sd">                }</span>

<span class="sd">                \paper {</span>
<span class="sd">                    left-margin = #15</span>
<span class="sd">                    top-margin = #15</span>
<span class="sd">                }</span>

<span class="sd">                \score {</span>
<span class="sd">                    \new Score &lt;&lt;</span>
<span class="sd">                        \new Staff {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            d&#39;8</span>
<span class="sd">                            e&#39;8</span>
<span class="sd">                            f&#39;8</span>
<span class="sd">                        }</span>
<span class="sd">                    &gt;&gt;</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        Wraps ``music`` in LilyPond ``\score`` block.</span>

<span class="sd">        Adds LilyPond ``\header``, ``\layout``, ``\paper`` and ``\score`` blocks to</span>
<span class="sd">        LilyPond file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">music</span><span class="p">,</span> <span class="n">LilyPondFile</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">music</span>
        <span class="n">lilypond_file</span> <span class="o">=</span> <span class="n">class_</span><span class="p">(</span>
            <span class="n">date_time_token</span><span class="o">=</span><span class="n">date_time_token</span><span class="p">,</span>
            <span class="n">default_paper_size</span><span class="o">=</span><span class="n">default_paper_size</span><span class="p">,</span>
            <span class="n">comments</span><span class="o">=</span><span class="n">comments</span><span class="p">,</span>
            <span class="n">includes</span><span class="o">=</span><span class="n">includes</span><span class="p">,</span>
            <span class="n">items</span><span class="o">=</span><span class="p">[</span>
                <span class="n">Block</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;header&quot;</span><span class="p">),</span>
                <span class="n">Block</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;layout&quot;</span><span class="p">),</span>
                <span class="n">Block</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;paper&quot;</span><span class="p">),</span>
                <span class="n">Block</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;score&quot;</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="n">global_staff_size</span><span class="o">=</span><span class="n">global_staff_size</span><span class="p">,</span>
            <span class="n">lilypond_language_token</span><span class="o">=</span><span class="n">lilypond_language_token</span><span class="p">,</span>
            <span class="n">lilypond_version_token</span><span class="o">=</span><span class="n">lilypond_version_token</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
            <span class="n">use_relative_includes</span><span class="o">=</span><span class="n">use_relative_includes</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="n">lilypond_file</span><span class="o">.</span><span class="n">header_block</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">lilypond_file</span><span class="o">.</span><span class="n">header_block</span><span class="o">.</span><span class="n">tagline</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">music</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">lilypond_file</span><span class="o">.</span><span class="n">score_block</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">lilypond_file</span><span class="o">.</span><span class="n">score_block</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">music</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lilypond_file</span></div>

<div class="viewcode-block" id="LilyPondFile.rhythm"><a class="viewcode-back" href="../../api/abjad/lilypondfile.html#abjad.lilypondfile.LilyPondFile.rhythm">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">rhythm</span><span class="p">(</span>
        <span class="n">class_</span><span class="p">,</span>
        <span class="n">selections</span><span class="p">,</span>
        <span class="n">divisions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">attach_lilypond_voice_commands</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">implicit_scaling</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">pitched_staff</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">simultaneous_selections</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">time_signatures</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;LilyPondFile&quot;</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Makes rhythm-styled LilyPond file.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Makes rhythmic staff:</span>

<span class="sd">            &gt;&gt;&gt; divisions = [(3, 4), (4, 8), (1, 4)]</span>
<span class="sd">            &gt;&gt;&gt; maker = abjad.NoteMaker()</span>
<span class="sd">            &gt;&gt;&gt; selections = [</span>
<span class="sd">            ...     maker(6 * [0], [(1, 8)]),</span>
<span class="sd">            ...     maker(8 * [0], [(1, 16)]),</span>
<span class="sd">            ...     maker(2 * [0], [(1, 8)]),</span>
<span class="sd">            ... ]</span>
<span class="sd">            &gt;&gt;&gt; for selection in selections:</span>
<span class="sd">            ...     abjad.beam(selection[:])</span>
<span class="sd">            ...</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.rhythm(</span>
<span class="sd">            ...     selections,</span>
<span class="sd">            ...     divisions,</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; score = lilypond_file[abjad.Score]</span>
<span class="sd">                &gt;&gt;&gt; abjad.f(score)</span>
<span class="sd">                \new Score</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new GlobalContext</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/4</span>
<span class="sd">                        s1 * 3/4</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        s1 * 1/2</span>
<span class="sd">                        \time 1/4</span>
<span class="sd">                        s1 * 1/4</span>
<span class="sd">                    }</span>
<span class="sd">                    \new RhythmicStaff</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Set time signatures explicitly:</span>

<span class="sd">            &gt;&gt;&gt; divisions = [(3, 4), (4, 8), (1, 4)]</span>
<span class="sd">            &gt;&gt;&gt; maker = abjad.NoteMaker()</span>
<span class="sd">            &gt;&gt;&gt; selections = [</span>
<span class="sd">            ...     maker(6 * [0], [(1, 8)]),</span>
<span class="sd">            ...     maker(8 * [0], [(1, 16)]),</span>
<span class="sd">            ...     maker(2 * [0], [(1, 8)]),</span>
<span class="sd">            ... ]</span>
<span class="sd">            &gt;&gt;&gt; for selection in selections:</span>
<span class="sd">            ...     abjad.beam(selection[:])</span>
<span class="sd">            ...</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.rhythm(</span>
<span class="sd">            ...     selections,</span>
<span class="sd">            ...     [(6, 8), (4, 8), (2, 8)],</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; score = lilypond_file[abjad.Score]</span>
<span class="sd">                &gt;&gt;&gt; abjad.f(score)</span>
<span class="sd">                \new Score</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new GlobalContext</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/8</span>
<span class="sd">                        s1 * 3/4</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        s1 * 1/2</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        s1 * 1/4</span>
<span class="sd">                    }</span>
<span class="sd">                    \new RhythmicStaff</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Makes pitched staff:</span>

<span class="sd">            &gt;&gt;&gt; divisions = [(3, 4), (4, 8), (1, 4)]</span>
<span class="sd">            &gt;&gt;&gt; maker = abjad.NoteMaker()</span>
<span class="sd">            &gt;&gt;&gt; selections = [</span>
<span class="sd">            ...     maker(6 * [0], [(1, 8)]),</span>
<span class="sd">            ...     maker(8 * [0], [(1, 16)]),</span>
<span class="sd">            ...     maker(2 * [0], [(1, 8)]),</span>
<span class="sd">            ... ]</span>
<span class="sd">            &gt;&gt;&gt; for selection in selections:</span>
<span class="sd">            ...     abjad.beam(selection[:])</span>
<span class="sd">            ...</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.rhythm(</span>
<span class="sd">            ...     selections,</span>
<span class="sd">            ...     divisions,</span>
<span class="sd">            ...     pitched_staff=True,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(lilypond_file[abjad.Score])</span>
<span class="sd">                \new Score</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new GlobalContext</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/4</span>
<span class="sd">                        s1 * 3/4</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        s1 * 1/2</span>
<span class="sd">                        \time 1/4</span>
<span class="sd">                        s1 * 1/4</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Makes simultaneous voices:</span>

<span class="sd">            &gt;&gt;&gt; divisions = [(3, 4), (4, 8), (1, 4)]</span>
<span class="sd">            &gt;&gt;&gt; maker = abjad.NoteMaker()</span>
<span class="sd">            &gt;&gt;&gt; selections = [</span>
<span class="sd">            ...     maker(6 * [0], [(1, 8)]),</span>
<span class="sd">            ...     maker(8 * [0], [(1, 16)]),</span>
<span class="sd">            ...     maker(2 * [0], [(1, 8)]),</span>
<span class="sd">            ... ]</span>
<span class="sd">            &gt;&gt;&gt; for selection in selections:</span>
<span class="sd">            ...     abjad.beam(selection[:])</span>
<span class="sd">            ...</span>
<span class="sd">            &gt;&gt;&gt; for note in abjad.iterate(selections).components(abjad.Note):</span>
<span class="sd">            ...     note.written_pitch = abjad.NamedPitch(&quot;e&#39;&quot;)</span>
<span class="sd">            ...</span>
<span class="sd">            &gt;&gt;&gt; selection_1 = selections[0] + selections[1] + selections[2]</span>
<span class="sd">            &gt;&gt;&gt; selections = [</span>
<span class="sd">            ...     maker(12 * [0], [(1, 16)]),</span>
<span class="sd">            ...     maker(16 * [0], [(1, 32)]),</span>
<span class="sd">            ...     maker(4 * [0], [(1, 16)]),</span>
<span class="sd">            ... ]</span>
<span class="sd">            &gt;&gt;&gt; for selection in selections:</span>
<span class="sd">            ...     abjad.beam(selection[:])</span>
<span class="sd">            ...</span>
<span class="sd">            &gt;&gt;&gt; selection_2 = selections[0] + selections[1] + selections[2]</span>
<span class="sd">            &gt;&gt;&gt; selections = {</span>
<span class="sd">            ...     &quot;Voice_1&quot;: selection_1,</span>
<span class="sd">            ...     &quot;Voice_2&quot;: selection_2,</span>
<span class="sd">            ... }</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.rhythm(</span>
<span class="sd">            ...     selections,</span>
<span class="sd">            ...     divisions,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; voice_1 = lilypond_file[&quot;Voice_1&quot;]</span>
<span class="sd">            &gt;&gt;&gt; literal = abjad.LilyPondLiteral(r&quot;\voiceOne&quot;, &quot;opening&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(literal, voice_1)</span>
<span class="sd">            &gt;&gt;&gt; voice_2 = lilypond_file[&quot;Voice_2&quot;]</span>
<span class="sd">            &gt;&gt;&gt; literal = abjad.LilyPondLiteral(r&quot;\voiceTwo&quot;, &quot;opening&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(literal, voice_2)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(lilypond_file[abjad.Score])</span>
<span class="sd">                \new Score</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new GlobalContext</span>
<span class="sd">                    {</span>
<span class="sd">                        s1 * 3/4</span>
<span class="sd">                        s1 * 1/2</span>
<span class="sd">                        s1 * 1/4</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    &lt;&lt;</span>
<span class="sd">                        \context Voice = &quot;Voice_1&quot;</span>
<span class="sd">                        {</span>
<span class="sd">                            \voiceOne</span>
<span class="sd">                            e&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            e&#39;8</span>
<span class="sd">                            e&#39;8</span>
<span class="sd">                            e&#39;8</span>
<span class="sd">                            e&#39;8</span>
<span class="sd">                            e&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                            e&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            e&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \context Voice = &quot;Voice_2&quot;</span>
<span class="sd">                        {</span>
<span class="sd">                            \voiceTwo</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            ]</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                    &gt;&gt;</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selections</span><span class="p">,</span> <span class="n">Selection</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selections</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">selection</span> <span class="ow">in</span> <span class="n">selections</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">Selection</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;must be selection: </span><span class="si">{</span><span class="n">selection</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selections</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">selection</span> <span class="ow">in</span> <span class="n">selections</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">Selection</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;must be selection: </span><span class="si">{</span><span class="n">selection</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;must be list or dictionary: </span><span class="si">{</span><span class="n">selections</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">Score</span><span class="p">()</span>
        <span class="n">lilypond_file</span> <span class="o">=</span> <span class="n">LilyPondFile</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
            <span class="n">score</span><span class="p">,</span> <span class="n">includes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;default.ily&quot;</span><span class="p">,</span> <span class="s2">&quot;rhythm-maker-docs.ily&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">pitched_staff</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selections</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">Selection</span><span class="p">)):</span>
                <span class="n">selections_</span> <span class="o">=</span> <span class="n">selections</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selections</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">selections_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">selections</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span>
            <span class="n">notes</span> <span class="o">=</span> <span class="n">Selection</span><span class="p">(</span><span class="n">selections_</span><span class="p">)</span><span class="o">.</span><span class="n">notes</span><span class="p">()</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">notes</span><span class="p">,</span> <span class="n">Selection</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">notes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">note</span><span class="o">.</span><span class="n">written_pitch</span> <span class="o">!=</span> <span class="n">NamedPitch</span><span class="p">(</span><span class="s2">&quot;c&#39;&quot;</span><span class="p">):</span>
                    <span class="n">pitched_staff</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
            <span class="n">chords</span> <span class="o">=</span> <span class="n">Selection</span><span class="p">(</span><span class="n">selections_</span><span class="p">)</span><span class="o">.</span><span class="n">chords</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">chords</span><span class="p">:</span>
                <span class="n">pitched_staff</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selections</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">Selection</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">divisions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">duration</span> <span class="o">=</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">_get_duration</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span>
                <span class="n">divisions</span> <span class="o">=</span> <span class="p">[</span><span class="n">duration</span><span class="p">]</span>
            <span class="n">time_signatures</span> <span class="o">=</span> <span class="n">time_signatures</span> <span class="ow">or</span> <span class="n">divisions</span>
            <span class="n">time_signatures</span> <span class="o">=</span> <span class="p">[</span><span class="n">TimeSignature</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">time_signatures</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">pitched_staff</span><span class="p">:</span>
                <span class="n">staff</span> <span class="o">=</span> <span class="n">Staff</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">staff</span> <span class="o">=</span> <span class="n">Staff</span><span class="p">(</span><span class="n">lilypond_type</span><span class="o">=</span><span class="s2">&quot;RhythmicStaff&quot;</span><span class="p">)</span>
            <span class="n">staff</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selections</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">voices</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">voice_name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">selections</span><span class="p">):</span>
                <span class="n">selections_</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="n">voice_name</span><span class="p">]</span>
                <span class="n">selections_</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">(</span><span class="n">selections_</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">depth</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">selections_</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">selections_</span><span class="p">)</span>
                <span class="n">voice</span> <span class="o">=</span> <span class="n">Voice</span><span class="p">(</span><span class="n">selections_</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">voice_name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">attach_lilypond_voice_commands</span><span class="p">:</span>
                    <span class="n">voice_name_to_command_string</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s2">&quot;Voice_1&quot;</span><span class="p">:</span> <span class="s2">&quot;voiceOne&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Voice_2&quot;</span><span class="p">:</span> <span class="s2">&quot;voiceTwo&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Voice_3&quot;</span><span class="p">:</span> <span class="s2">&quot;voiceThree&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Voice_4&quot;</span><span class="p">:</span> <span class="s2">&quot;voiceFour&quot;</span><span class="p">,</span>
                    <span class="p">}</span>
                    <span class="n">command_string</span> <span class="o">=</span> <span class="n">voice_name_to_command_string</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">voice_name</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">command_string</span><span class="p">:</span>
                        <span class="n">command</span> <span class="o">=</span> <span class="n">LilyPondLiteral</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">command_string</span><span class="p">)</span>
                        <span class="n">attach</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">voice</span><span class="p">)</span>
                <span class="n">voices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">voice</span><span class="p">)</span>
            <span class="n">staff</span> <span class="o">=</span> <span class="n">Staff</span><span class="p">(</span><span class="n">voices</span><span class="p">,</span> <span class="n">simultaneous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">divisions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">duration</span> <span class="o">=</span> <span class="n">staff</span><span class="o">.</span><span class="n">_get_duration</span><span class="p">()</span>
                <span class="n">divisions</span> <span class="o">=</span> <span class="p">[</span><span class="n">duration</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;must be list or dictionary of selections:&quot;</span>
            <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">selections</span><span class="si">!r}</span><span class="s2">.&quot;</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="n">score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">staff</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">divisions</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">divisions</span><span class="p">)</span>
        <span class="n">time_signatures</span> <span class="o">=</span> <span class="n">time_signatures</span> <span class="ow">or</span> <span class="n">divisions</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">lilypond_type</span><span class="o">=</span><span class="s2">&quot;GlobalContext&quot;</span><span class="p">)</span>
        <span class="n">skips</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">time_signature</span> <span class="ow">in</span> <span class="n">time_signatures</span><span class="p">:</span>
            <span class="n">skip</span> <span class="o">=</span> <span class="n">Skip</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">skip</span><span class="o">.</span><span class="n">multiplier</span> <span class="o">=</span> <span class="n">time_signature</span>
            <span class="n">attach</span><span class="p">(</span><span class="n">time_signature</span><span class="p">,</span> <span class="n">skip</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s2">&quot;Score&quot;</span><span class="p">)</span>
            <span class="n">skips</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">skip</span><span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">skips</span><span class="p">)</span>
        <span class="n">score</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lilypond_file</span></div></div>
</pre></div>

    </div>
    
    </div>
    

<footer>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

</div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>