

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>abjad.timespan &mdash; Abjad 3.26 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/abjad.css?v=1f187528" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../_static/uqbar.css?v=e6773f5c" />
      <link rel="stylesheet" type="text/css" href="../../_static/lightbox2/css/lightbox.css?v=d2ef71d2" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="canonical" href="https://abjad.github.io_modules/abjad/timespan.html"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=59ffb378"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/ga.js?v=c455bbd5"></script>
      <script src="../../_static/toggleprompt.js?v=5801b3bb"></script>
      <script defer="defer" src="../../_static/lightbox2/js/lightbox.js?v=bc25c2e6"></script>
      <script src="../../_static/inject-autosummary-fqns.js?v=49afa734"></script>
      <script src="../../_static/inject-fqns.js?v=c5423c1b"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #CC8844" >


    <a href="../../index.html" class="icon icon-home" alt="Documentation
    Home"> Abjad 3.26



</a>




<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">First steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/audience.html">Audience</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/macos.html">macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/linux.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/windows.html">Windows</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers-basic-operations-on.html">Containers, basic operations on</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers-retrieving-by-name.html">Containers, retrieving by name</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers-time-interpretation-of.html">Containers, time interpretation of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/contexts-lilypond-type-of.html">Contexts, LilyPond type of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/indicators.html">Indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/lilypond-files-preamble-of.html">LilyPond files, preamble of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/lilypond-format-of-abjad-objects.html">LilyPond format, of Abjad objects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/corpus-selection.html">Corpus, figure selection from</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/design-by-dyads.html">Design, by dyads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/enumeration.html">Enumeration, of rhythmic cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/magic-square-from-twelve-tone-row.html">Magic square, from twelve-tone row</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/scales-diatonic.html">Scales, diatonic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/score-fragment-piano.html">Score fragment, piano</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All classes &amp; functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">Abjad API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/best-practices.html">Best practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/changes.html">Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/developer-installation.html">Developer installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/lilypond-context-concatenation.html">LilyPond context concatenation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/publications.html">Publications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Score gallery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../gallery-2020.html">2016-present</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery-2015.html">2015-11</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery-2010.html">2010-00</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #CC8844" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Abjad</a>
      </nav>

      <div class="wy-nav-content">

<div class="rst-content style-external-links">

    


    <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    <div itemprop="articleBody">
    
  <h1>Source code for abjad.timespan</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Classes to work with timespans.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">collections</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dataclasses</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">fractions</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">typing</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">duration</span> <span class="k">as</span> <span class="n">_duration</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">enums</span> <span class="k">as</span> <span class="n">_enums</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">indicators</span> <span class="k">as</span> <span class="n">_indicators</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">math</span> <span class="k">as</span> <span class="n">_math</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">sequence</span> <span class="k">as</span> <span class="n">_sequence</span>

<span class="n">infinity</span> <span class="o">=</span> <span class="n">_math</span><span class="o">.</span><span class="n">Infinity</span><span class="p">()</span>
<span class="n">negative_infinity</span> <span class="o">=</span> <span class="n">_math</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">()</span>


<div class="viewcode-block" id="OffsetCounter">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.OffsetCounter">[docs]</a>
<span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">OffsetCounter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Offset counter.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">        ...     abjad.Timespan(0, 16),</span>
<span class="sd">        ...     abjad.Timespan(5, 12),</span>
<span class="sd">        ...     abjad.Timespan(-2, 8),</span>
<span class="sd">        ... ])</span>
<span class="sd">        &gt;&gt;&gt; timespan_operand = abjad.Timespan(6, 10)</span>
<span class="sd">        &gt;&gt;&gt; timespans = timespans - timespan_operand</span>
<span class="sd">        &gt;&gt;&gt; offset_counter = abjad.OffsetCounter(timespans)</span>
<span class="sd">        &gt;&gt;&gt; for item in offset_counter.items.items(): item</span>
<span class="sd">        (Offset((-2, 1)), 1)</span>
<span class="sd">        (Offset((0, 1)), 1)</span>
<span class="sd">        (Offset((5, 1)), 1)</span>
<span class="sd">        (Offset((6, 1)), 3)</span>
<span class="sd">        (Offset((10, 1)), 2)</span>
<span class="sd">        (Offset((12, 1)), 1)</span>
<span class="sd">        (Offset((16, 1)), 1)</span>

<span class="sd">        &gt;&gt;&gt; abjad.show(offset_counter, scale=0.5) # doctest: +SKIP</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">items</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">item_class</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_class</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="n">offsets</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">offsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">start_offset</span><span class="p">)</span>
                    <span class="n">offsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s2">&quot;_get_timespan&quot;</span><span class="p">):</span>
                        <span class="n">timespan</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">()</span>
                        <span class="n">offsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="o">.</span><span class="n">start_offset</span><span class="p">)</span>
                        <span class="n">offsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">offset</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                        <span class="n">offsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="n">offsets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_coerce_item</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span>
        <span class="n">sorted_item_to_count</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sorted_items</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">sorted_items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">sorted_items</span><span class="p">:</span>
            <span class="n">sorted_item_to_count</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="n">sorted_item_to_count</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_coerce_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_make_markup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">range_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_indicators</span><span class="o">.</span><span class="n">Markup</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Illustrates offset counter.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; timespan_operand = abjad.Timespan(6, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespans = timespans - timespan_operand</span>
<span class="sd">            &gt;&gt;&gt; offset_counter = abjad.OffsetCounter(timespans)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(offset_counter, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; markup = offset_counter._make_markup()</span>
<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(markup)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \markup</span>
<span class="sd">                \overlay</span>
<span class="sd">                {</span>
<span class="sd">                \postscript</span>
<span class="sd">                #&quot;</span>
<span class="sd">                0.2 setlinewidth</span>
<span class="sd">                [ 2 1 ] 0 setdash</span>
<span class="sd">                1 -1 moveto</span>
<span class="sd">                0 -2 rlineto</span>
<span class="sd">                stroke</span>
<span class="sd">                17.666666666666668 -1 moveto</span>
<span class="sd">                0 -2 rlineto</span>
<span class="sd">                stroke</span>
<span class="sd">                59.33333333333334 -1 moveto</span>
<span class="sd">                0 -2 rlineto</span>
<span class="sd">                stroke</span>
<span class="sd">                67.66666666666667 -1 moveto</span>
<span class="sd">                0 -8 rlineto</span>
<span class="sd">                stroke</span>
<span class="sd">                101.00000000000001 -1 moveto</span>
<span class="sd">                0 -5 rlineto</span>
<span class="sd">                stroke</span>
<span class="sd">                117.66666666666667 -1 moveto</span>
<span class="sd">                0 -2 rlineto</span>
<span class="sd">                stroke</span>
<span class="sd">                151 -1 moveto</span>
<span class="sd">                0 -2 rlineto</span>
<span class="sd">                stroke</span>
<span class="sd">                &quot;</span>
<span class="sd">                \translate #&#39;(1.0 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction -2 1</span>
<span class="sd">                \translate #&#39;(17.666666666666668 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 0 1</span>
<span class="sd">                \translate #&#39;(59.33333333333334 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 5 1</span>
<span class="sd">                \translate #&#39;(67.66666666666667 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 6 1</span>
<span class="sd">                \translate #&#39;(101.00000000000001 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 10 1</span>
<span class="sd">                \translate #&#39;(117.66666666666667 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 12 1</span>
<span class="sd">                \translate #&#39;(151.0 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 16 1</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_indicators</span><span class="o">.</span><span class="n">Markup</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\markup \null&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">range_</span><span class="p">,</span> <span class="n">Timespan</span><span class="p">):</span>
            <span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span> <span class="o">=</span> <span class="n">range_</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">range_</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">elif</span> <span class="n">range_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span> <span class="o">=</span> <span class="n">range_</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span>
        <span class="n">minimum_float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">minimum</span><span class="p">))</span>
        <span class="n">maximum_float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">maximum</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">scale</span>
        <span class="n">postscript_scale</span> <span class="o">=</span> <span class="mf">150.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">maximum_float</span> <span class="o">-</span> <span class="n">minimum_float</span><span class="p">)</span>
        <span class="n">postscript_scale</span> <span class="o">*=</span> <span class="nb">float</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
        <span class="n">postscript_x_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">minimum_float</span> <span class="o">*</span> <span class="n">postscript_scale</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">postscript_strings</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;0.2 setlinewidth&quot;</span><span class="p">,</span>
            <span class="s2">&quot;[ 2 1 ] 0 setdash&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">offset</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="o">*</span> <span class="n">postscript_scale</span>
            <span class="n">offset</span> <span class="o">-=</span> <span class="n">postscript_x_offset</span>
            <span class="n">postscript_strings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span><span class="si">}</span><span class="s2"> -1 moveto&quot;</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;0 </span><span class="si">{</span><span class="n">_fpa</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> rlineto&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;stroke&quot;</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">r</span><span class="s2">&quot;\markup&quot;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s2">&quot;\overlay&quot;</span><span class="p">,</span>
            <span class="s2">&quot;{&quot;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s2">&quot;\postscript&quot;</span><span class="p">,</span>
            <span class="s1">&#39;#&quot;&#39;</span><span class="p">,</span>
            <span class="o">*</span><span class="n">postscript_strings</span><span class="p">,</span>
            <span class="s1">&#39;&quot;&#39;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">):</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
            <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">offset</span><span class="o">.</span><span class="n">numerator</span><span class="p">,</span> <span class="n">offset</span><span class="o">.</span><span class="n">denominator</span>
            <span class="n">x_translation</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="o">*</span> <span class="n">postscript_scale</span>
            <span class="n">x_translation</span> <span class="o">-=</span> <span class="n">postscript_x_offset</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\translate #&#39;(</span><span class="si">{</span><span class="n">x_translation</span><span class="si">}</span><span class="s2"> . 1)&quot;</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\sans \fontsize #-3 \center-align \fraction </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">markup</span> <span class="o">=</span> <span class="n">_indicators</span><span class="o">.</span><span class="n">Markup</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">markup</span></div>



<div class="viewcode-block" id="Timespan">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.Timespan">[docs]</a>
<span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unsafe_hash</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Timespan</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Timespan.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">        &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">        &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>
<span class="sd">        &gt;&gt;&gt; timespan_4 = abjad.Timespan(10, 20)</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Annotations work like this:</span>

<span class="sd">        &gt;&gt;&gt; annotated_timespan = abjad.Timespan(</span>
<span class="sd">        ...     annotation=[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;foo&quot;],</span>
<span class="sd">        ...     start_offset=(1, 4),</span>
<span class="sd">        ...     stop_offset=(7, 8),</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; annotated_timespan.annotation</span>
<span class="sd">        [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;foo&#39;]</span>

<span class="sd">        Annotated timespans maintain their annotations duration mutation:</span>

<span class="sd">        &gt;&gt;&gt; left, right = annotated_timespan.split_at_offset((1, 2))</span>
<span class="sd">        &gt;&gt;&gt; left.annotation.append(&quot;foo&quot;)</span>
<span class="sd">        &gt;&gt;&gt; right</span>
<span class="sd">        Timespan(Offset((1, 2)), Offset((7, 8)), annotation=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;foo&#39;, &#39;foo&#39;])</span>

<span class="sd">    Timespans are closed-open intervals.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">start_offset</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">stop_offset</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;can not initialize from timespan.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;can not initialize from timespan.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">=</span> <span class="n">negative_infinity</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">=</span> <span class="n">infinity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_offset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_offset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="c1">### SPECIAL METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Logical AND of two timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>
<span class="sd">            &gt;&gt;&gt; timespan_4 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 &amp; timespan_2</span>
<span class="sd">            TimespanList([Timespan(Offset((5, 1)), Offset((10, 1)))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 &amp; timespan_3</span>
<span class="sd">            TimespanList([Timespan(Offset((0, 1)), Offset((2, 1)))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 &amp; timespan_4</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 &amp; timespan_3</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 &amp; timespan_4</span>
<span class="sd">            TimespanList([Timespan(Offset((10, 1)), Offset((12, 1)))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_3 &amp; timespan_4</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">argument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;=</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="ow">and</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="n">TimespanList</span><span class="p">()</span>
        <span class="n">new_start_offset</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span><span class="p">)</span>
        <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="n">timespan</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">TimespanList</span><span class="p">([</span><span class="n">timespan</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan contains ``argument``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Works with offsets:</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(0, (1, 4))</span>

<span class="sd">            &gt;&gt;&gt; -1 in timespan</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; 0 in timespan</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; abjad.Offset(1, 8) in timespan</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; abjad.Offset(1, 4) in timespan</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; abjad.Offset(1, 2) in timespan</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Works with other timespans:</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(0, (1, 4))</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(0, (1, 4)) in timespan</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan((1, 16), (2, 16)) in timespan</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(0, (1, 2)) in timespan</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">argument</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">argument</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">timespan</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="ow">and</span> <span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compares ``start_offset``, ``stop_offset``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(1, 3) == abjad.Timespan(1, 3)</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(1, 3) == abjad.Timespan(2, 3)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">==</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">==</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when ``argument`` start offset is greater or equal to timespan start</span>
<span class="sd">        offset.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 &gt;= timespan_3</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 &gt;= timespan_2</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">(</span>
            <span class="n">expr_start_offset</span><span class="p">,</span>
            <span class="n">expr_stop_offset</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_start_offset_and_maybe_stop_offset</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expr_stop_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&gt;=</span> <span class="n">expr_start_offset</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">==</span> <span class="n">expr_start_offset</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&gt;=</span> <span class="n">expr_stop_offset</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&gt;=</span> <span class="n">expr_start_offset</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when ``argument`` start offset is greater than timespan start offset.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 &gt; timespan_3</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 &gt; timespan_2</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">(</span>
            <span class="n">expr_start_offset</span><span class="p">,</span>
            <span class="n">expr_stop_offset</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_start_offset_and_maybe_stop_offset</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expr_stop_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&gt;</span> <span class="n">expr_start_offset</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">==</span> <span class="n">expr_start_offset</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&gt;</span> <span class="n">expr_stop_offset</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&gt;</span> <span class="n">expr_start_offset</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when ``argument`` start offset is less than or equal to timespan start</span>
<span class="sd">        offset.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 &lt;= timespan_3</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 &lt;= timespan_2</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">(</span>
            <span class="n">expr_start_offset</span><span class="p">,</span>
            <span class="n">expr_stop_offset</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_start_offset_and_maybe_stop_offset</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expr_stop_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;=</span> <span class="n">expr_start_offset</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">==</span> <span class="n">expr_start_offset</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&lt;=</span> <span class="n">expr_stop_offset</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;=</span> <span class="n">expr_start_offset</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Defined equal to ``1`` for all timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(0, 10)</span>

<span class="sd">            &gt;&gt;&gt; len(timespan)</span>
<span class="sd">            1</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when ``argument`` start offset is less than timespan start offset.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 &lt; timespan_2</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 &lt; timespan_3</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">(</span>
            <span class="n">expr_start_offset</span><span class="p">,</span>
            <span class="n">expr_stop_offset</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_start_offset_and_maybe_stop_offset</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expr_stop_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">expr_start_offset</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">==</span> <span class="n">expr_start_offset</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&lt;</span> <span class="n">expr_stop_offset</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">expr_start_offset</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Logical OR of two timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>
<span class="sd">            &gt;&gt;&gt; timespan_4 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespan_1 | timespan_2</span>
<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((12, 1)))</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespan_1 | timespan_3</span>
<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((10, 1)))</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespan_1 | timespan_4</span>
<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((20, 1)))</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespan_2 | timespan_3</span>
<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((2, 1)))</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((12, 1)))</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespan_2 | timespan_4</span>
<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((20, 1)))</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespan_3 | timespan_4</span>
<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((2, 1)))</span>
<span class="sd">            Timespan(Offset((10, 1)), Offset((20, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">argument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span> <span class="o">&amp;</span> <span class="n">argument</span><span class="p">)</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">==</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
        <span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">TimespanList</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">])</span>
            <span class="n">result</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="n">new_start_offset</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span><span class="p">)</span>
        <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="n">timespan</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">TimespanList</span><span class="p">([</span><span class="n">timespan</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets repr.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="si">!r}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="si">!r}</span><span class="s2">)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="si">!r}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="si">!r}</span><span class="s2">, annotation=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">annotation</span><span class="si">!r}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Subtract ``argument`` from timespan.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>
<span class="sd">            &gt;&gt;&gt; timespan_4 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 - timespan_1</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 - timespan_2</span>
<span class="sd">            TimespanList([Timespan(Offset((0, 1)), Offset((5, 1)))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 - timespan_3</span>
<span class="sd">            TimespanList([Timespan(Offset((2, 1)), Offset((10, 1)))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 - timespan_4</span>
<span class="sd">            TimespanList([Timespan(Offset((0, 1)), Offset((10, 1)))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 - timespan_1</span>
<span class="sd">            TimespanList([Timespan(Offset((10, 1)), Offset((12, 1)))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 - timespan_2</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 - timespan_3</span>
<span class="sd">            TimespanList([Timespan(Offset((5, 1)), Offset((12, 1)))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_2 - timespan_4</span>
<span class="sd">            TimespanList([Timespan(Offset((5, 1)), Offset((10, 1)))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_3 - timespan_3</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">            &gt;&gt;&gt; timespan_3 - timespan_1</span>
<span class="sd">            TimespanList([Timespan(Offset((-2, 1)), Offset((0, 1)))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_3 - timespan_2</span>
<span class="sd">            TimespanList([Timespan(Offset((-2, 1)), Offset((2, 1)))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_3 - timespan_4</span>
<span class="sd">            TimespanList([Timespan(Offset((-2, 1)), Offset((2, 1)))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_4 - timespan_4</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">            &gt;&gt;&gt; timespan_4 - timespan_1</span>
<span class="sd">            TimespanList([Timespan(Offset((10, 1)), Offset((20, 1)))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_4 - timespan_2</span>
<span class="sd">            TimespanList([Timespan(Offset((12, 1)), Offset((20, 1)))])</span>

<span class="sd">            &gt;&gt;&gt; timespan_4 - timespan_3</span>
<span class="sd">            TimespanList([Timespan(Offset((10, 1)), Offset((20, 1)))])</span>

<span class="sd">        Returns timespan list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">argument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="n">TimespanList</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span> <span class="o">&amp;</span> <span class="n">argument</span><span class="p">):</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="ow">and</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="p">):</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span>
                <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span>
                <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span>
            <span class="ow">and</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="p">):</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span>
                <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;=</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="ow">and</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&lt;</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="p">):</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span>
                <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="ow">and</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="p">):</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span>
                <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span>
        <span class="p">):</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span>
                <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">timespans</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Logical XOR of two timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 12)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(-2, 2)</span>
<span class="sd">            &gt;&gt;&gt; timespan_4 = abjad.Timespan(10, 20)</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespan_1 ^ timespan_2</span>
<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((5, 1)))</span>
<span class="sd">            Timespan(Offset((10, 1)), Offset((12, 1)))</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespan_1 ^ timespan_3</span>
<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((0, 1)))</span>
<span class="sd">            Timespan(Offset((2, 1)), Offset((10, 1)))</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespan_1 ^ timespan_4</span>
<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((10, 1)))</span>
<span class="sd">            Timespan(Offset((10, 1)), Offset((20, 1)))</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespan_2 ^ timespan_3</span>
<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((2, 1)))</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((12, 1)))</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespan_2 ^ timespan_4</span>
<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((10, 1)))</span>
<span class="sd">            Timespan(Offset((12, 1)), Offset((20, 1)))</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespan_3 ^ timespan_4</span>
<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((2, 1)))</span>
<span class="sd">            Timespan(Offset((10, 1)), Offset((20, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">argument</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span> <span class="o">&amp;</span> <span class="n">argument</span><span class="p">)</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">==</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
        <span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">TimespanList</span><span class="p">()</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">argument</span><span class="p">))</span>
            <span class="n">result</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">TimespanList</span><span class="p">()</span>
        <span class="n">start_offsets</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span><span class="p">]</span>
        <span class="n">stop_offsets</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">]</span>
        <span class="n">start_offsets</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">stop_offsets</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">timespan_1</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">start_offsets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">start_offsets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">timespan_2</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">stop_offsets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">stop_offsets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">timespan_1</span><span class="o">.</span><span class="n">is_wellformed</span><span class="p">():</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan_1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">timespan_2</span><span class="o">.</span><span class="n">is_wellformed</span><span class="p">():</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan_2</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_as_postscript</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">postscript_x_offset</span><span class="p">,</span> <span class="n">postscript_y_offset</span><span class="p">,</span> <span class="n">postscript_scale</span>
    <span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">)</span> <span class="o">*</span> <span class="n">postscript_scale</span>
        <span class="n">start</span> <span class="o">-=</span> <span class="n">postscript_x_offset</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span> <span class="o">*</span> <span class="n">postscript_scale</span>
        <span class="n">stop</span> <span class="o">-=</span> <span class="n">postscript_x_offset</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">start</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">postscript_y_offset</span><span class="p">)</span><span class="si">}</span><span class="s2"> moveto&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">stop</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">postscript_y_offset</span><span class="p">)</span><span class="si">}</span><span class="s2"> lineto&quot;</span><span class="p">,</span>
            <span class="s2">&quot;stroke&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">start</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">postscript_y_offset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.75</span><span class="p">)</span><span class="si">}</span><span class="s2"> moveto&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">start</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">postscript_y_offset</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.75</span><span class="p">)</span><span class="si">}</span><span class="s2"> lineto&quot;</span><span class="p">,</span>
            <span class="s2">&quot;stroke&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">stop</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">postscript_y_offset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.75</span><span class="p">)</span><span class="si">}</span><span class="s2"> moveto&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">stop</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">postscript_y_offset</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.75</span><span class="p">)</span><span class="si">}</span><span class="s2"> lineto&quot;</span><span class="p">,</span>
            <span class="s2">&quot;stroke&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">strings</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_can_fuse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span> <span class="o">&amp;</span> <span class="n">argument</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">==</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_offsets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">Timespan</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;timespan&quot;</span><span class="p">):</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">timespan</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;_get_timespan&quot;</span><span class="p">):</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_start_offset_and_maybe_stop_offset</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">Timespan</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;timespan&quot;</span><span class="p">):</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">timespan</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;_get_timespan&quot;</span><span class="p">):</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">()</span>
        <span class="n">start_offset</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;start_offset&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">start_offset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="n">stop_offset</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;stop_offset&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">Timespan</span><span class="p">):</span>
            <span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">offsets</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;timespan&quot;</span><span class="p">):</span>
            <span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">timespan</span><span class="o">.</span><span class="n">offsets</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;_get_timespan&quot;</span><span class="p">):</span>
            <span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">()</span><span class="o">.</span><span class="n">offsets</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">stop_offset</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_implements_timespan_interface</span><span class="p">(</span><span class="n">timespan</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">timespan</span><span class="p">,</span> <span class="s2">&quot;start_offset&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;foo&quot;</span>
            <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">timespan</span><span class="p">,</span> <span class="s2">&quot;stop_offset&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;foo&quot;</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">timespan</span><span class="p">,</span> <span class="s2">&quot;_get_timespan&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">timespan</span><span class="p">,</span> <span class="s2">&quot;timespan&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;foo&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">offset</span> <span class="ow">in</span> <span class="p">(</span><span class="n">negative_infinity</span><span class="p">,</span> <span class="n">infinity</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">offset</span>
        <span class="k">return</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">axis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets arithmetic mean of timespan start- and stop-offsets.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(0, 10).axis</span>
<span class="sd">            Offset((5, 1))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets duration of timespan.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(0, 10).duration</span>
<span class="sd">            Duration(10, 1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">,</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets offsets.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(0, 10).offsets</span>
<span class="sd">            (Offset((0, 1)), Offset((10, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>

    <span class="c1">### PUBLIC METHODS ###</span>

<div class="viewcode-block" id="Timespan.divide_by_ratio">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.Timespan.divide_by_ratio">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">divide_by_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="s2">&quot;Timespan&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Divides timespan by ``ratio``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan((1, 2), (3, 2))</span>

<span class="sd">            &gt;&gt;&gt; for x in timespan.divide_by_ratio((1, 2, 1)):</span>
<span class="sd">            ...     x</span>
<span class="sd">            ...</span>
<span class="sd">            Timespan(Offset((1, 2)), Offset((3, 4)))</span>
<span class="sd">            Timespan(Offset((3, 4)), Offset((5, 4)))</span>
<span class="sd">            Timespan(Offset((5, 4)), Offset((3, 2)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ratio</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">ratio</span> <span class="o">=</span> <span class="n">ratio</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
        <span class="n">unit_duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
        <span class="n">part_durations</span> <span class="o">=</span> <span class="p">[</span><span class="n">numerator</span> <span class="o">*</span> <span class="n">unit_duration</span> <span class="k">for</span> <span class="n">numerator</span> <span class="ow">in</span> <span class="n">ratio</span><span class="p">]</span>
        <span class="n">start_offsets</span> <span class="o">=</span> <span class="n">_math</span><span class="o">.</span><span class="n">cumulative_sums</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">]</span> <span class="o">+</span> <span class="n">part_durations</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">offset_pairs</span> <span class="o">=</span> <span class="n">_sequence</span><span class="o">.</span><span class="n">nwise</span><span class="p">(</span><span class="n">start_offsets</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="o">*</span><span class="n">offset_pair</span><span class="p">)</span> <span class="k">for</span> <span class="n">offset_pair</span> <span class="ow">in</span> <span class="n">offset_pairs</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>


<div class="viewcode-block" id="Timespan.get_overlap_with_timespan">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.Timespan.get_overlap_with_timespan">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_overlap_with_timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets duration of overlap with ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan_1 = abjad.Timespan(0, 15)</span>
<span class="sd">            &gt;&gt;&gt; timespan_2 = abjad.Timespan(5, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespan_3 = abjad.Timespan(6, 6)</span>
<span class="sd">            &gt;&gt;&gt; timespan_4 = abjad.Timespan(12, 22)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.get_overlap_with_timespan(timespan_1)</span>
<span class="sd">            Duration(15, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.get_overlap_with_timespan(timespan_2)</span>
<span class="sd">            Duration(5, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.get_overlap_with_timespan(timespan_3)</span>
<span class="sd">            Duration(0, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_1.get_overlap_with_timespan(timespan_4)</span>
<span class="sd">            Duration(3, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_2.get_overlap_with_timespan(timespan_2)</span>
<span class="sd">            Duration(5, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_2.get_overlap_with_timespan(timespan_3)</span>
<span class="sd">            Duration(0, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_2.get_overlap_with_timespan(timespan_4)</span>
<span class="sd">            Duration(0, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_3.get_overlap_with_timespan(timespan_3)</span>
<span class="sd">            Duration(0, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_3.get_overlap_with_timespan(timespan_4)</span>
<span class="sd">            Duration(0, 1)</span>

<span class="sd">            &gt;&gt;&gt; timespan_4.get_overlap_with_timespan(timespan_4)</span>
<span class="sd">            Duration(10, 1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_implements_timespan_interface</span><span class="p">(</span><span class="n">timespan</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">duration</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span> <span class="o">&amp;</span> <span class="n">timespan</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Timespan.is_wellformed">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.Timespan.is_wellformed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_wellformed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespan start offset preceeds timespan stop offset.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(0, 10).is_wellformed()</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span></div>


<div class="viewcode-block" id="Timespan.reflect">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.Timespan.reflect">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">reflect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Timespan&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reflects timespan about ``axis``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Reverse timespan about timespan axis:</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(3, 6).reflect()</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((6, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Reverse timespan about arbitrary axis:</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(3, 6).reflect(axis=abjad.Offset(10))</span>
<span class="sd">            Timespan(Offset((14, 1)), Offset((17, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>
        <span class="n">start_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">-</span> <span class="n">axis</span>
        <span class="n">stop_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">-</span> <span class="n">axis</span>
        <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">axis</span> <span class="o">-</span> <span class="n">stop_distance</span>
        <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="n">axis</span> <span class="o">-</span> <span class="n">start_distance</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">(</span><span class="n">new_start_offset</span><span class="p">,</span> <span class="n">new_stop_offset</span><span class="p">)</span></div>


<div class="viewcode-block" id="Timespan.round_offsets">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.Timespan.round_offsets">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">round_offsets</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">_enums</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">must_be_wellformed</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Timespan&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rounds timespan offsets to multiple of ``multiplier``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan((1, 5), (4, 5))</span>

<span class="sd">            &gt;&gt;&gt; timespan.round_offsets(1)</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((1, 1)))</span>

<span class="sd">            &gt;&gt;&gt; timespan.round_offsets(2)</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((2, 1)))</span>

<span class="sd">            &gt;&gt;&gt; timespan.round_offsets(2, anchor=abjad.RIGHT)</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((0, 1)))</span>

<span class="sd">            &gt;&gt;&gt; timespan.round_offsets(</span>
<span class="sd">            ...     2, anchor=abjad.RIGHT, must_be_wellformed=False</span>
<span class="sd">            ... )</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((0, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">multiplier</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">(</span><span class="n">multiplier</span><span class="p">))</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">multiplier</span>
        <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">/</span> <span class="n">multiplier</span><span class="p">))</span> <span class="o">*</span> <span class="n">multiplier</span>
        <span class="p">)</span>
        <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">/</span> <span class="n">multiplier</span><span class="p">))</span> <span class="o">*</span> <span class="n">multiplier</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">new_start_offset</span> <span class="o">==</span> <span class="n">new_stop_offset</span><span class="p">)</span> <span class="ow">and</span> <span class="n">must_be_wellformed</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">anchor</span> <span class="ow">is</span> <span class="n">_enums</span><span class="o">.</span><span class="n">LEFT</span><span class="p">:</span>
                <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="n">new_stop_offset</span> <span class="o">+</span> <span class="n">multiplier</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">new_start_offset</span> <span class="o">-</span> <span class="n">multiplier</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="Timespan.scale">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.Timespan.scale">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">_enums</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Timespan&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scales timespan by ``multiplier``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(3, 6)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Scale timespan relative to timespan start offset:</span>

<span class="sd">            &gt;&gt;&gt; timespan.scale(abjad.Fraction(2))</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((9, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Scale timespan relative to timespan stop offset:</span>

<span class="sd">            &gt;&gt;&gt; timespan.scale(abjad.Fraction(2), anchor=abjad.RIGHT)</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((6, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">multiplier</span> <span class="o">=</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">multiplier</span>
        <span class="n">new_duration</span> <span class="o">=</span> <span class="n">multiplier</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span>
        <span class="k">if</span> <span class="n">anchor</span> <span class="o">==</span> <span class="n">_enums</span><span class="o">.</span><span class="n">LEFT</span><span class="p">:</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">+</span> <span class="n">new_duration</span>
        <span class="k">elif</span> <span class="n">anchor</span> <span class="o">==</span> <span class="n">_enums</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">:</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">-</span> <span class="n">new_duration</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unknown anchor direction: </span><span class="si">{</span><span class="n">anchor</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="Timespan.set_duration">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.Timespan.set_duration">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Timespan&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets timespan duration to ``duration``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan((1, 2), (3, 2))</span>

<span class="sd">            &gt;&gt;&gt; timespan.set_duration((3, 5))</span>
<span class="sd">            Timespan(Offset((1, 2)), Offset((11, 10)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
        <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">+</span> <span class="n">duration</span>
        <span class="k">return</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span><span class="p">)</span></div>


<div class="viewcode-block" id="Timespan.set_offsets">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.Timespan.set_offsets">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Timespan&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets timespan start offset to ``start_offset`` and stop offset to</span>
<span class="sd">        ``stop_offset``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan((1, 2), (3, 2))</span>

<span class="sd">            &gt;&gt;&gt; timespan.set_offsets(stop_offset=(7, 8))</span>
<span class="sd">            Timespan(Offset((1, 2)), Offset((7, 8)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Subtracts negative ``start_offset`` from existing stop offset:</span>

<span class="sd">            &gt;&gt;&gt; timespan.set_offsets(start_offset=(-1, 2))</span>
<span class="sd">            Timespan(Offset((1, 1)), Offset((3, 2)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Subtracts negative ``stop_offset`` from existing stop offset:</span>

<span class="sd">            &gt;&gt;&gt; timespan.set_offsets(stop_offset=(-1, 2))</span>
<span class="sd">            Timespan(Offset((1, 2)), Offset((1, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">start_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">start_offset</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">start_offset</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">stop_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">stop_offset</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">start_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">start_offset</span><span class="p">:</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">start_offset</span>
        <span class="k">elif</span> <span class="n">start_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">start_offset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">+</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">start_offset</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
        <span class="k">if</span> <span class="n">stop_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">stop_offset</span><span class="p">:</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="n">stop_offset</span>
        <span class="k">elif</span> <span class="n">stop_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">stop_offset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">+</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="Timespan.split_at_offset">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.Timespan.split_at_offset">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">split_at_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Split into two parts when ``offset`` happens during timespan.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(0, 5)</span>

<span class="sd">            &gt;&gt;&gt; left, right = timespan.split_at_offset((2, 1))</span>

<span class="sd">            &gt;&gt;&gt; left</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((2, 1)))</span>

<span class="sd">            &gt;&gt;&gt; right</span>
<span class="sd">            Timespan(Offset((2, 1)), Offset((5, 1)))</span>

<span class="sd">            Otherwise return a copy of timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespan.split_at_offset((12, 1))[0]</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((5, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">TimespanList</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">:</span>
            <span class="n">left</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">offset</span>
            <span class="p">)</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
            <span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="Timespan.split_at_offsets">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.Timespan.split_at_offsets">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">split_at_offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offsets</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Split into one or more parts when ``offsets`` happens during timespan.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(0, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespan.split_at_offsets((1, 3, 7))</span>
<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((1, 1)))</span>
<span class="sd">            Timespan(Offset((1, 1)), Offset((3, 1)))</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((7, 1)))</span>
<span class="sd">            Timespan(Offset((7, 1)), Offset((10, 1)))</span>

<span class="sd">            Otherwise return a timespan list containing a copy of timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespan.split_at_offsets((-100,))</span>
<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((10, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="p">[</span><span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">]</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">offset</span>
            <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="n">offsets</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="p">]</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">offsets</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">TimespanList</span><span class="p">()</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">:</span>
            <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">right</span><span class="o">.</span><span class="n">split_at_offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="Timespan.stretch">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.Timespan.stretch">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">stretch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Timespan&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stretches timespan by ``multiplier`` relative to ``anchor``.</span>

<span class="sd">        .. container:: example</span>

<span class="sd">            Stretch relative to timespan start offset:</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(3, 10).stretch(abjad.Fraction(2))</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((17, 1)))</span>

<span class="sd">        .. container:: example</span>

<span class="sd">            Stretch relative to timespan stop offset:</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(3, 10).stretch(abjad.Fraction(2), abjad.Offset(10))</span>
<span class="sd">            Timespan(Offset((-4, 1)), Offset((10, 1)))</span>

<span class="sd">        .. container:: example</span>

<span class="sd">            Stretch relative to offset prior to timespan:</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(3, 10).stretch(abjad.Fraction(2), abjad.Offset(0, 1))</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((20, 1)))</span>

<span class="sd">        .. container:: example</span>

<span class="sd">            Stretch relative to offset after timespan:</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(3, 10).stretch(abjad.Fraction(3), abjad.Offset(12))</span>
<span class="sd">            Timespan(Offset((-15, 1)), Offset((6, 1)))</span>

<span class="sd">        .. container:: example</span>

<span class="sd">            Stretch relative to offset that happens during timespan:</span>

<span class="sd">            &gt;&gt;&gt; abjad.Timespan(3, 10).stretch(abjad.Fraction(2), abjad.Offset(4))</span>
<span class="sd">            Timespan(Offset((2, 1)), Offset((16, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">multiplier</span> <span class="o">=</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">multiplier</span>
        <span class="k">if</span> <span class="n">anchor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
        <span class="n">new_start_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">multiplier</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">-</span> <span class="n">anchor</span><span class="p">))</span> <span class="o">+</span> <span class="n">anchor</span>
        <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">multiplier</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">-</span> <span class="n">anchor</span><span class="p">))</span> <span class="o">+</span> <span class="n">anchor</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="Timespan.translate">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.Timespan.translate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">translation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Timespan&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Translates timespan by ``translation``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(5, 10)</span>

<span class="sd">            &gt;&gt;&gt; timespan.translate(2)</span>
<span class="sd">            Timespan(Offset((7, 1)), Offset((12, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">translate_offsets</span><span class="p">(</span><span class="n">translation</span><span class="p">,</span> <span class="n">translation</span><span class="p">)</span></div>


<div class="viewcode-block" id="Timespan.translate_offsets">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.Timespan.translate_offsets">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">translate_offsets</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset_translation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stop_offset_translation</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Timespan&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Translates timespan start offset by ``start_offset_translation`` and</span>
<span class="sd">        stop offset by ``stop_offset_translation``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan((1, 2), (3, 2))</span>

<span class="sd">            &gt;&gt;&gt; timespan.translate_offsets(start_offset_translation=(-1, 8))</span>
<span class="sd">            Timespan(Offset((3, 8)), Offset((3, 2)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_offset_translation</span> <span class="o">=</span> <span class="n">start_offset_translation</span> <span class="ow">or</span> <span class="mi">0</span>
        <span class="n">stop_offset_translation</span> <span class="o">=</span> <span class="n">stop_offset_translation</span> <span class="ow">or</span> <span class="mi">0</span>
        <span class="n">start_offset_translation</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">start_offset_translation</span><span class="p">)</span>
        <span class="n">stop_offset_translation</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">stop_offset_translation</span><span class="p">)</span>
        <span class="n">new_start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">+</span> <span class="n">start_offset_translation</span>
        <span class="n">new_stop_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">+</span> <span class="n">stop_offset_translation</span>
        <span class="k">return</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="o">=</span><span class="n">new_stop_offset</span>
        <span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TimespanList">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList">[docs]</a>
<span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TimespanList</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Timespan list.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Contiguous timespan list:</span>

<span class="sd">        &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">        ...     abjad.Timespan(0, 3),</span>
<span class="sd">        ...     abjad.Timespan(3, 6),</span>
<span class="sd">        ...     abjad.Timespan(6, 10),</span>
<span class="sd">        ... ])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">        &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">        Timespan(Offset((0, 1)), Offset((3, 1)))</span>
<span class="sd">        Timespan(Offset((3, 1)), Offset((6, 1)))</span>
<span class="sd">        Timespan(Offset((6, 1)), Offset((10, 1)))</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Overlapping timespan list:</span>

<span class="sd">        &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">        ...     abjad.Timespan(0, 16),</span>
<span class="sd">        ...     abjad.Timespan(5, 12),</span>
<span class="sd">        ...     abjad.Timespan(-2, 8),</span>
<span class="sd">        ...     abjad.Timespan(15, 20),</span>
<span class="sd">        ...     abjad.Timespan(24, 30),</span>
<span class="sd">        ... ])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">        &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">        Timespan(Offset((0, 1)), Offset((16, 1)))</span>
<span class="sd">        Timespan(Offset((5, 1)), Offset((12, 1)))</span>
<span class="sd">        Timespan(Offset((-2, 1)), Offset((8, 1)))</span>
<span class="sd">        Timespan(Offset((15, 1)), Offset((20, 1)))</span>
<span class="sd">        Timespan(Offset((24, 1)), Offset((30, 1)))</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Empty timespan list:</span>

<span class="sd">        &gt;&gt;&gt; abjad.TimespanList()</span>
<span class="sd">        TimespanList([])</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Coerces input:</span>

<span class="sd">        &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">        ...     abjad.Timespan(0, (1, 2)),</span>
<span class="sd">        ...     ((1, 2), (3, 4)),</span>
<span class="sd">        ...     abjad.Timespan((3, 4), 1),</span>
<span class="sd">        ... ])</span>

<span class="sd">        &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">        Timespan(Offset((0, 1)), Offset((1, 2)))</span>
<span class="sd">        Timespan(Offset((1, 2)), Offset((3, 4)))</span>
<span class="sd">        Timespan(Offset((3, 4)), Offset((1, 1)))</span>


<span class="sd">    Operations on timespan currently work in place.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="o">=</span><span class="p">()):</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_coerce_item</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">]</span>
        <span class="nb">list</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespans</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Coerces ``argument`` and sets at ``i``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coerce_item</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="nb">list</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_coerce_item</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">]</span>
            <span class="nb">list</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">items</span><span class="p">)</span>

<div class="viewcode-block" id="TimespanList.append">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.append">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Coerces ``item`` and appends.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coerce_item</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimespanList.extend">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.extend">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Coerces ``items`` and extends.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_coerce_item</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">items</span><span class="p">]</span>
        <span class="nb">list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimespanList.remove">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.remove">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Coerces ``item`` and removes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coerce_item</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="nb">list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Keeps material that intersects ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Keeps material that intersects timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(5, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespans = timespans &amp; timespan</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((8, 1)))</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((10, 1)))</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((10, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_timespans</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Timespan</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">current_timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[:]:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">current_timespan</span> <span class="o">&amp;</span> <span class="n">timespan</span>
            <span class="n">new_timespans</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">new_timespans</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets repr.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_make_markup</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">range_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sort_callable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sortkey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_indicators</span><span class="o">.</span><span class="n">Markup</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Makes markup.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Illustrates timespans:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespan_operand = abjad.Timespan(6, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespans = timespans - timespan_operand</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; lilypond_file = abjad.illustrate(timespans)</span>
<span class="sd">                &gt;&gt;&gt; markup = lilypond_file.items[-1]</span>
<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(markup)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \markup \column {</span>
<span class="sd">                \overlay {</span>
<span class="sd">                \translate #&#39;(1.0 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction -2 1</span>
<span class="sd">                \translate #&#39;(17.666666666666668 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 0 1</span>
<span class="sd">                \translate #&#39;(59.33333333333334 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 5 1</span>
<span class="sd">                \translate #&#39;(67.66666666666667 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 6 1</span>
<span class="sd">                \translate #&#39;(101.00000000000001 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 10 1</span>
<span class="sd">                \translate #&#39;(117.66666666666667 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 12 1</span>
<span class="sd">                \translate #&#39;(151.0 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 16 1</span>
<span class="sd">                }</span>
<span class="sd">                \pad-to-box #&#39;(0 . 82.33333333333333) #&#39;(0 . 8.5)</span>
<span class="sd">                \postscript #&quot;</span>
<span class="sd">                0.2 setlinewidth</span>
<span class="sd">                1 6.5 moveto</span>
<span class="sd">                67.66666666666667 6.5 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                1 7.25 moveto</span>
<span class="sd">                1 5.75 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                67.66666666666667 7.25 moveto</span>
<span class="sd">                67.66666666666667 5.75 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                17.666666666666668 3.5 moveto</span>
<span class="sd">                67.66666666666667 3.5 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                17.666666666666668 4.25 moveto</span>
<span class="sd">                17.666666666666668 2.75 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                67.66666666666667 4.25 moveto</span>
<span class="sd">                67.66666666666667 2.75 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                101.00000000000001 3.5 moveto</span>
<span class="sd">                151 3.5 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                101.00000000000001 4.25 moveto</span>
<span class="sd">                101.00000000000001 2.75 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                151 4.25 moveto</span>
<span class="sd">                151 2.75 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                59.33333333333334 0.5 moveto</span>
<span class="sd">                67.66666666666667 0.5 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                59.33333333333334 1.25 moveto</span>
<span class="sd">                59.33333333333334 -0.25 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                67.66666666666667 1.25 moveto</span>
<span class="sd">                67.66666666666667 -0.25 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                101.00000000000001 0.5 moveto</span>
<span class="sd">                117.66666666666667 0.5 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                101.00000000000001 1.25 moveto</span>
<span class="sd">                101.00000000000001 -0.25 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                117.66666666666667 1.25 moveto</span>
<span class="sd">                117.66666666666667 -0.25 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                0.1 setlinewidth</span>
<span class="sd">                [ 0.1 0.2 ] 0 setdash</span>
<span class="sd">                1 8.5 moveto</span>
<span class="sd">                1 7 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                17.666666666666668 8.5 moveto</span>
<span class="sd">                17.666666666666668 4 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                59.33333333333334 8.5 moveto</span>
<span class="sd">                59.33333333333334 1 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                67.66666666666667 8.5 moveto</span>
<span class="sd">                67.66666666666667 1 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                101.00000000000001 8.5 moveto</span>
<span class="sd">                101.00000000000001 1 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                117.66666666666667 8.5 moveto</span>
<span class="sd">                117.66666666666667 1 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                151 8.5 moveto</span>
<span class="sd">                151 4 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                0 0 moveto</span>
<span class="sd">                0.99 setgray</span>
<span class="sd">                0 0.01 rlineto</span>
<span class="sd">                stroke&quot;</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Set ``key`` and ``sort_callable`` together like this to customize timespan</span>
<span class="sd">            sorting:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, (1, 4), annotation=&quot;voice 1&quot;),</span>
<span class="sd">            ...     abjad.Timespan(0, (1, 4), annotation=&quot;voice 2&quot;),</span>
<span class="sd">            ...     abjad.Timespan(0, (1, 4), annotation=&quot;voice 10&quot;),</span>
<span class="sd">            ... ])</span>

<span class="sd">            &gt;&gt;&gt; def to_digit(string):</span>
<span class="sd">            ...     return int(string) if string.isdigit() else string</span>

<span class="sd">            &gt;&gt;&gt; def human_sorted_keys(pair):</span>
<span class="sd">            ...     key, timespan = pair</span>
<span class="sd">            ...     values = [to_digit(_) for _ in key.split()]</span>
<span class="sd">            ...     hashable_key = tuple(values)</span>
<span class="sd">            ...     return hashable_key</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(</span>
<span class="sd">            ...     timespans,</span>
<span class="sd">            ...     key=&quot;annotation&quot;,</span>
<span class="sd">            ...     sort_callable=human_sorted_keys,</span>
<span class="sd">            ...     scale=0.5,</span>
<span class="sd">            ... ) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; lilypond_file = abjad.illustrate(</span>
<span class="sd">                ...     timespans,</span>
<span class="sd">                ...     key=&quot;annotation&quot;,</span>
<span class="sd">                ...     sort_callable=human_sorted_keys,</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt; markup = lilypond_file.items[-1]</span>
<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(markup)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \markup</span>
<span class="sd">                \left-column {</span>
<span class="sd">                \fontsize #-1 \sans \line { &quot;voice 1:&quot; }</span>
<span class="sd">                \vspace #0.5</span>
<span class="sd">                \column {</span>
<span class="sd">                \overlay {</span>
<span class="sd">                \translate #&#39;(1.0 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 0 1</span>
<span class="sd">                \translate #&#39;(151.0 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 1 4</span>
<span class="sd">                }</span>
<span class="sd">                \pad-to-box #&#39;(0 . 149.0) #&#39;(0 . 2.5)</span>
<span class="sd">                \postscript #&quot;</span>
<span class="sd">                0.2 setlinewidth</span>
<span class="sd">                1 0.5 moveto</span>
<span class="sd">                151 0.5 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                1 1.25 moveto</span>
<span class="sd">                1 -0.25 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                151 1.25 moveto</span>
<span class="sd">                151 -0.25 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                0.1 setlinewidth</span>
<span class="sd">                [ 0.1 0.2 ] 0 setdash</span>
<span class="sd">                1 2.5 moveto</span>
<span class="sd">                1 1 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                151 2.5 moveto</span>
<span class="sd">                151 1 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                0 0 moveto</span>
<span class="sd">                0.99 setgray</span>
<span class="sd">                0 0.01 rlineto</span>
<span class="sd">                stroke&quot;</span>
<span class="sd">                }</span>
<span class="sd">                \vspace #0.5</span>
<span class="sd">                \fontsize #-1 \sans \line { &quot;voice 2:&quot; }</span>
<span class="sd">                \vspace #0.5</span>
<span class="sd">                \column {</span>
<span class="sd">                \overlay {</span>
<span class="sd">                \translate #&#39;(1.0 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 0 1</span>
<span class="sd">                \translate #&#39;(151.0 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 1 4</span>
<span class="sd">                }</span>
<span class="sd">                \pad-to-box #&#39;(0 . 149.0) #&#39;(0 . 2.5)</span>
<span class="sd">                \postscript #&quot;</span>
<span class="sd">                0.2 setlinewidth</span>
<span class="sd">                1 0.5 moveto</span>
<span class="sd">                151 0.5 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                1 1.25 moveto</span>
<span class="sd">                1 -0.25 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                151 1.25 moveto</span>
<span class="sd">                151 -0.25 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                0.1 setlinewidth</span>
<span class="sd">                [ 0.1 0.2 ] 0 setdash</span>
<span class="sd">                1 2.5 moveto</span>
<span class="sd">                1 1 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                151 2.5 moveto</span>
<span class="sd">                151 1 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                0 0 moveto</span>
<span class="sd">                0.99 setgray</span>
<span class="sd">                0 0.01 rlineto</span>
<span class="sd">                stroke&quot;</span>
<span class="sd">                }</span>
<span class="sd">                \vspace #0.5</span>
<span class="sd">                \fontsize #-1 \sans \line { &quot;voice 10:&quot; }</span>
<span class="sd">                \vspace #0.5</span>
<span class="sd">                \column {</span>
<span class="sd">                \overlay {</span>
<span class="sd">                \translate #&#39;(1.0 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 0 1</span>
<span class="sd">                \translate #&#39;(151.0 . 1)</span>
<span class="sd">                \sans \fontsize #-3 \center-align \fraction 1 4</span>
<span class="sd">                }</span>
<span class="sd">                \pad-to-box #&#39;(0 . 149.0) #&#39;(0 . 2.5)</span>
<span class="sd">                \postscript #&quot;</span>
<span class="sd">                0.2 setlinewidth</span>
<span class="sd">                1 0.5 moveto</span>
<span class="sd">                151 0.5 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                1 1.25 moveto</span>
<span class="sd">                1 -0.25 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                151 1.25 moveto</span>
<span class="sd">                151 -0.25 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                0.1 setlinewidth</span>
<span class="sd">                [ 0.1 0.2 ] 0 setdash</span>
<span class="sd">                1 2.5 moveto</span>
<span class="sd">                1 1 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                151 2.5 moveto</span>
<span class="sd">                151 1 lineto</span>
<span class="sd">                stroke</span>
<span class="sd">                0 0 moveto</span>
<span class="sd">                0.99 setgray</span>
<span class="sd">                0 0.01 rlineto</span>
<span class="sd">                stroke&quot;</span>
<span class="sd">                }</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_indicators</span><span class="o">.</span><span class="n">Markup</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\markup \null&quot;</span><span class="p">)</span>
        <span class="n">maximum</span><span class="p">:</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span> <span class="o">|</span> <span class="n">_math</span><span class="o">.</span><span class="n">Infinity</span>
        <span class="n">minimum</span><span class="p">:</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span> <span class="o">|</span> <span class="n">_math</span><span class="o">.</span><span class="n">NegativeInfinity</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">range_</span><span class="p">,</span> <span class="n">Timespan</span><span class="p">):</span>
            <span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span> <span class="o">=</span> <span class="n">range_</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">range_</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">elif</span> <span class="n">range_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span> <span class="o">=</span> <span class="n">range_</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">minimum</span><span class="p">,</span> <span class="n">maximum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">scale</span>
        <span class="n">minimum_float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">minimum</span><span class="p">))</span>
        <span class="n">maximum_float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">maximum</span><span class="p">))</span>
        <span class="n">postscript_scale</span> <span class="o">=</span> <span class="mf">150.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">maximum_float</span> <span class="o">-</span> <span class="n">minimum_float</span><span class="p">)</span>
        <span class="n">postscript_scale</span> <span class="o">*=</span> <span class="nb">float</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
        <span class="n">postscript_x_offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">minimum_float</span> <span class="o">*</span> <span class="n">postscript_scale</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">_make_timespan_list_markup</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="n">postscript_x_offset</span><span class="p">,</span> <span class="n">postscript_scale</span><span class="p">,</span> <span class="n">sortkey</span><span class="o">=</span><span class="n">sortkey</span>
            <span class="p">)</span>
            <span class="n">markup</span> <span class="o">=</span> <span class="n">_indicators</span><span class="o">.</span><span class="n">Markup</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;\markup </span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">timespan_lists</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">timespan</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">timespan_lists</span><span class="p">:</span>
                    <span class="n">timespan_lists</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
                <span class="n">timespan_lists</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
            <span class="n">strings</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">generator</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">timespan_lists</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">sort_callable</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">generator</span><span class="p">):</span>
                <span class="n">value</span><span class="p">,</span> <span class="n">timespans</span> <span class="o">=</span> <span class="n">item</span>
                <span class="n">timespans</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">string</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\vspace #0.5&quot;</span>
                    <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
                <span class="n">string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s1">&#39;\fontsize #-1 \sans \line </span><span class="se">{{</span><span class="s1"> &quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">:&quot; </span><span class="se">}}</span><span class="s1">&#39;</span>
                <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
                <span class="n">string</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\vspace #0.5&quot;</span>
                <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">_make_timespan_list_markup</span><span class="p">(</span>
                    <span class="n">timespans</span><span class="p">,</span>
                    <span class="n">postscript_x_offset</span><span class="p">,</span>
                    <span class="n">postscript_scale</span><span class="p">,</span>
                    <span class="n">sortkey</span><span class="o">=</span><span class="n">sortkey</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
            <span class="n">markup</span> <span class="o">=</span> <span class="n">_indicators</span><span class="o">.</span><span class="n">Markup</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">markup</span><span class="se">\n\\</span><span class="s2">left-column </span><span class="se">{{\n</span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="se">\n}}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">markup</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__invert__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Inverts timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Inverts timespans:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(~timespans, range_=(-2, 30), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in ~timespans: _</span>
<span class="sd">            Timespan(Offset((8, 1)), Offset((15, 1)))</span>
<span class="sd">            Timespan(Offset((20, 1)), Offset((24, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Inverts contiguous timespans:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; ~timespans</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">-</span> <span class="n">timespan</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes material that intersects ``timespan``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Deletes material that intersects timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(5, 10)</span>
<span class="sd">            &gt;&gt;&gt; timespans = timespans - timespan</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((5, 1)))</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((5, 1)))</span>
<span class="sd">            Timespan(Offset((10, 1)), Offset((12, 1)))</span>
<span class="sd">            Timespan(Offset((10, 1)), Offset((16, 1)))</span>


<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_timespans</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Timespan</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">current_timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[:]:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">current_timespan</span> <span class="o">-</span> <span class="n">timespan</span>
            <span class="n">new_timespans</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">new_timespans</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_coerce_item</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Timespan</span><span class="o">.</span><span class="n">_implements_timespan_interface</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Timespan</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Timespan</span><span class="p">(</span><span class="o">*</span><span class="n">item</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Timespan</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_offsets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">argument</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">argument</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">argument</span><span class="o">.</span><span class="n">timespan</span><span class="o">.</span><span class="n">offsets</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span> <span class="o">=</span> <span class="n">Timespan</span><span class="o">.</span><span class="n">_get_offsets</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Timespan</span><span class="p">(</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">all_are_contiguous</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when all timespans are contiguous.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when all timespans are contiguous:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.all_are_contiguous</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is false when timespans not contiguous:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.all_are_contiguous</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when timespan list is empty:</span>

<span class="sd">            &gt;&gt;&gt; abjad.TimespanList().all_are_contiguous</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">[:])</span>
        <span class="n">last_stop_offset</span> <span class="o">=</span> <span class="n">timespans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="n">timespans</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="n">timespan</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">!=</span> <span class="n">last_stop_offset</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="n">last_stop_offset</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">all_are_nonoverlapping</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when all timespans are nonoverlapping.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when all timespans are nonoverlapping:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.all_are_nonoverlapping</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is false when timespans are overlapping:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.all_are_nonoverlapping</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when timespan list is empty:</span>

<span class="sd">            &gt;&gt;&gt; abjad.TimespanList().all_are_nonoverlapping</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">[:])</span>
        <span class="n">last_stop_offset</span> <span class="o">=</span> <span class="n">timespans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="n">timespans</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="n">timespan</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">last_stop_offset</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">last_stop_offset</span> <span class="o">&lt;</span> <span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">:</span>
                <span class="n">last_stop_offset</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">all_are_wellformed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when all timespans are wellformed.</span>

<span class="sd">        Is false when timespans are not all wellformed.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when all timespans are wellformed:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.all_are_wellformed</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when all timespans are wellformed:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.all_are_wellformed</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when timespan list is empty:</span>

<span class="sd">            &gt;&gt;&gt; abjad.TimespanList().all_are_wellformed</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span><span class="o">.</span><span class="n">is_wellformed</span><span class="p">()</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">axis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets axis defined equal to arithmetic mean of start- and stop-offsets.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets axis:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.axis</span>
<span class="sd">            Offset((5, 1))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets axis:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.axis</span>
<span class="sd">            Offset((14, 1))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets none when timespan list is empty:</span>

<span class="sd">            &gt;&gt;&gt; abjad.TimespanList().axis is None</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">,</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets duration of timespan list.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets duration:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.duration</span>
<span class="sd">            Duration(10, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets duration:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.duration</span>
<span class="sd">            Duration(32, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets zero when timespan list is empty:</span>

<span class="sd">            &gt;&gt;&gt; abjad.TimespanList().duration</span>
<span class="sd">            Duration(0, 1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">!=</span> <span class="n">infinity</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">!=</span> <span class="n">negative_infinity</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when timespans are in time order.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is true when timespans are sorted:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.is_sorted</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Is false when timespans are not sorted:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.is_sorted</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="n">_sequence</span><span class="o">.</span><span class="n">nwise</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">left_timespan</span><span class="p">,</span> <span class="n">right_timespan</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">right_timespan</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">left_timespan</span><span class="o">.</span><span class="n">start_offset</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">left_timespan</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">==</span> <span class="n">right_timespan</span><span class="o">.</span><span class="n">start_offset</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">right_timespan</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&lt;</span> <span class="n">left_timespan</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">start_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span> <span class="o">|</span> <span class="n">_math</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets start offset.</span>

<span class="sd">        Defined equal to earliest start offset of any timespan in list.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets start offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.start_offset</span>
<span class="sd">            Offset((0, 1))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets start offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.start_offset</span>
<span class="sd">            Offset((-2, 1))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets negative infinity when timespan list is empty:</span>

<span class="sd">            &gt;&gt;&gt; abjad.TimespanList().start_offset</span>
<span class="sd">            NegativeInfinity()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span><span class="o">.</span><span class="n">start_offset</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">negative_infinity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">stop_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span> <span class="o">|</span> <span class="n">_math</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets stop offset.</span>

<span class="sd">        Defined equal to latest stop offset of any timespan.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets stop offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.stop_offset</span>
<span class="sd">            Offset((10, 1))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets stop offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.stop_offset</span>
<span class="sd">            Offset((30, 1))</span>

<span class="sd">        ..  container:: example</span>


<span class="sd">            Gets infinity when timespan list is empty:</span>

<span class="sd">            &gt;&gt;&gt; abjad.TimespanList().stop_offset</span>
<span class="sd">            Infinity()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span><span class="o">.</span><span class="n">stop_offset</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">infinity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">timespan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets timespan of timespan list.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(timespans.timespan, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.timespan</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((10, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(timespans.timespan, range_=(0, 30), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans.timespan</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((30, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets infinite timespan when list is empty:</span>

<span class="sd">            &gt;&gt;&gt; abjad.TimespanList().timespan</span>
<span class="sd">            Timespan(NegativeInfinity(), Infinity())</span>

<span class="sd">        Returns timespan.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Timespan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span>

    <span class="c1">### PUBLIC METHODS ###</span>

<div class="viewcode-block" id="TimespanList.clip_timespan_durations">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.clip_timespan_durations">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">clip_timespan_durations</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">minimum</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">_enums</span><span class="o">.</span><span class="n">LEFT</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clips timespan durations.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Clips timespan durations:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 1),</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.clip_timespan_durations(minimum=5)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((5, 1)))</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((10, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Clips timespan durations:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 1),</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.clip_timespan_durations(maximum=5)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((1, 1)))</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((5, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Clips timespan durations:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 1),</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.clip_timespan_durations(</span>
<span class="sd">            ...     minimum=3,</span>
<span class="sd">            ...     maximum=7,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((3, 1)))</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((7, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Clips timespan durations:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 1),</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.clip_timespan_durations(</span>
<span class="sd">            ...     minimum=3,</span>
<span class="sd">            ...     maximum=7,</span>
<span class="sd">            ...     anchor=abjad.RIGHT,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((1, 1)))</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((10, 1)))</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">anchor</span> <span class="ow">in</span> <span class="p">(</span><span class="n">_enums</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">_enums</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">minimum</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">minimum</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">minimum</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">maximum</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">maximum</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">maximum</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">minimum</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">maximum</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">minimum</span> <span class="o">&lt;=</span> <span class="n">maximum</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">minimum</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">timespan</span><span class="o">.</span><span class="n">duration</span> <span class="o">&lt;</span> <span class="n">minimum</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">anchor</span> <span class="ow">is</span> <span class="n">_enums</span><span class="o">.</span><span class="n">LEFT</span><span class="p">:</span>
                    <span class="n">new_timespan</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">set_duration</span><span class="p">(</span><span class="n">minimum</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">-</span> <span class="n">minimum</span>
                    <span class="n">new_timespan</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                        <span class="n">timespan</span><span class="p">,</span>
                        <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span>
                        <span class="n">stop_offset</span><span class="o">=</span><span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="n">maximum</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">maximum</span> <span class="o">&lt;</span> <span class="n">timespan</span><span class="o">.</span><span class="n">duration</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">anchor</span> <span class="ow">is</span> <span class="n">_enums</span><span class="o">.</span><span class="n">LEFT</span><span class="p">:</span>
                    <span class="n">new_timespan</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">set_duration</span><span class="p">(</span><span class="n">maximum</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_start_offset</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">-</span> <span class="n">maximum</span>
                    <span class="n">new_timespan</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                        <span class="n">timespan</span><span class="p">,</span>
                        <span class="n">start_offset</span><span class="o">=</span><span class="n">new_start_offset</span><span class="p">,</span>
                        <span class="n">stop_offset</span><span class="o">=</span><span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_timespan</span> <span class="o">=</span> <span class="n">timespan</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">timespans</span></div>


<div class="viewcode-block" id="TimespanList.compute_logical_and">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.compute_logical_and">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_logical_and</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes logical AND of timespans.</span>

<span class="sd">        Same as setwise intersection.</span>

<span class="sd">        Operates in place and returns timespan list.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical AND:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.compute_logical_and()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((10, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical AND:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.compute_logical_and()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((10, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes logical AND:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.compute_logical_and()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((8, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">timespan</span> <span class="o">&amp;</span> <span class="n">result</span><span class="p">):</span>
                    <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">return</span> <span class="bp">self</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">timespans</span> <span class="o">=</span> <span class="n">result</span> <span class="o">&amp;</span> <span class="n">timespan</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">timespans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="TimespanList.compute_logical_or">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.compute_logical_or">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_logical_or</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes logical OR of timespans.</span>

<span class="sd">        Operates in place and returns timespan list.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList()</span>
<span class="sd">            &gt;&gt;&gt; timespans = timespans.compute_logical_or()</span>

<span class="sd">            &gt;&gt;&gt; timespans</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.compute_logical_or()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((10, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.compute_logical_or()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((12, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 2),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.compute_logical_or()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((12, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(-2, 2),</span>
<span class="sd">            ...     abjad.Timespan(10, 20),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.compute_logical_or()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 20), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((2, 1)))</span>
<span class="sd">            Timespan(Offset((10, 1)), Offset((20, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespans</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Timespan</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">timespans</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="k">if</span> <span class="n">timespans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">_can_fuse</span><span class="p">(</span><span class="n">timespan</span><span class="p">):</span>
                    <span class="n">timespans_</span> <span class="o">=</span> <span class="n">timespans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">|</span> <span class="n">timespan</span>
                    <span class="n">timespans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">timespans_</span><span class="p">[:]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">timespans</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="TimespanList.compute_logical_xor">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.compute_logical_xor">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_logical_xor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes logical XOR of timespans.</span>

<span class="sd">        Operates in place and returns timespan list.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList()</span>
<span class="sd">            &gt;&gt;&gt; timespans = timespans.compute_logical_xor()</span>

<span class="sd">            &gt;&gt;&gt; timespans</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.compute_logical_xor()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((10, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.compute_logical_xor()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((5, 1)))</span>
<span class="sd">            Timespan(Offset((10, 1)), Offset((12, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 2),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.compute_logical_xor()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((0, 1)))</span>
<span class="sd">            Timespan(Offset((2, 1)), Offset((5, 1)))</span>
<span class="sd">            Timespan(Offset((10, 1)), Offset((12, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(-2, 2),</span>
<span class="sd">            ...     abjad.Timespan(10, 20),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.compute_logical_xor()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-2, 20), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((2, 1)))</span>
<span class="sd">            Timespan(Offset((10, 1)), Offset((20, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(4, 8),</span>
<span class="sd">            ...     abjad.Timespan(2, 6),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.compute_logical_xor()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((2, 1)))</span>
<span class="sd">            Timespan(Offset((8, 1)), Offset((10, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.compute_logical_xor()</span>

<span class="sd">            &gt;&gt;&gt; timespans</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_fragments</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">timespan_1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">timespan_1_fragments</span> <span class="o">=</span> <span class="p">[</span><span class="n">timespan_1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">timespan_2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">revised_timespan_1_fragments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Timespan</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">timespan_1_fragment</span> <span class="ow">in</span> <span class="n">timespan_1_fragments</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">timespan_2</span> <span class="o">&amp;</span> <span class="n">timespan_1_fragment</span><span class="p">):</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="n">timespan_1_fragment</span> <span class="o">-</span> <span class="n">timespan_2</span>
                        <span class="n">revised_timespan_1_fragments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">revised_timespan_1_fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan_1_fragment</span><span class="p">)</span>
                <span class="n">timespan_1_fragments</span> <span class="o">=</span> <span class="n">revised_timespan_1_fragments</span>
            <span class="n">all_fragments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">timespan_1_fragments</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">all_fragments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="TimespanList.compute_overlap_factor">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.compute_overlap_factor">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_overlap_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes overlap factor of timespans.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Example timespan list:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 15),</span>
<span class="sd">            ...     abjad.Timespan(20, 25),</span>
<span class="sd">            ...     abjad.Timespan(20, 30),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor across the entire list:</span>

<span class="sd">            &gt;&gt;&gt; timespans.compute_overlap_factor()</span>
<span class="sd">            Fraction(7, 6)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor within a specific timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespans.compute_overlap_factor(</span>
<span class="sd">            ...     timespan=abjad.Timespan(-15, 0))</span>
<span class="sd">            Fraction(0, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor:</span>

<span class="sd">            &gt;&gt;&gt; timespans.compute_overlap_factor(timespan=abjad.Timespan(-10, 5))</span>
<span class="sd">            Fraction(1, 3)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor:</span>

<span class="sd">            &gt;&gt;&gt; timespans.compute_overlap_factor(</span>
<span class="sd">            ...     timespan=abjad.Timespan(-5, 10))</span>
<span class="sd">            Fraction(1, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor:</span>

<span class="sd">            &gt;&gt;&gt; timespans.compute_overlap_factor(</span>
<span class="sd">            ...     timespan=abjad.Timespan(0, 15))</span>
<span class="sd">            Fraction(4, 3)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor:</span>

<span class="sd">            &gt;&gt;&gt; timespans.compute_overlap_factor(</span>
<span class="sd">            ...     timespan=abjad.Timespan(5, 20))</span>
<span class="sd">            Fraction(1, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor:</span>

<span class="sd">            &gt;&gt;&gt; timespans.compute_overlap_factor(</span>
<span class="sd">            ...     timespan=abjad.Timespan(10, 25))</span>
<span class="sd">            Fraction(1, 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Computes overlap factor:</span>

<span class="sd">            &gt;&gt;&gt; timespans.compute_overlap_factor(</span>
<span class="sd">            ...     timespan=abjad.Timespan(15, 30))</span>
<span class="sd">            Fraction(1, 1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">timespan</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timespan</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_timespans_that_satisfy_time_relation</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">_</span> <span class="o">&amp;</span> <span class="n">timespan</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">total_overlap</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span>
            <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">get_overlap_with_timespan</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">timespans</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">overlap_factor</span> <span class="o">=</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">(</span><span class="n">total_overlap</span> <span class="o">/</span> <span class="n">timespan</span><span class="o">.</span><span class="n">duration</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">overlap_factor</span></div>


<div class="viewcode-block" id="TimespanList.compute_overlap_factor_mapping">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.compute_overlap_factor_mapping">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_overlap_factor_mapping</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes overlap factor for each consecutive offset pair in timespans.</span>

<span class="sd">        Returns mapping.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 15),</span>
<span class="sd">            ...     abjad.Timespan(20, 25),</span>
<span class="sd">            ...     abjad.Timespan(20, 30),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; mapping = timespans.compute_overlap_factor_mapping()</span>
<span class="sd">            &gt;&gt;&gt; for timespan, overlap_factor in mapping.items():</span>
<span class="sd">            ...     timespan.start_offset, timespan.stop_offset, overlap_factor</span>
<span class="sd">            ...</span>
<span class="sd">            (Offset((0, 1)), Offset((5, 1)), Fraction(1, 1))</span>
<span class="sd">            (Offset((5, 1)), Offset((10, 1)), Fraction(2, 1))</span>
<span class="sd">            (Offset((10, 1)), Offset((15, 1)), Fraction(1, 1))</span>
<span class="sd">            (Offset((15, 1)), Offset((20, 1)), Fraction(0, 1))</span>
<span class="sd">            (Offset((20, 1)), Offset((25, 1)), Fraction(2, 1))</span>
<span class="sd">            (Offset((25, 1)), Offset((30, 1)), Fraction(1, 1))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mapping</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count_offsets</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span> <span class="ow">in</span> <span class="n">_sequence</span><span class="o">.</span><span class="n">nwise</span><span class="p">(</span><span class="n">offsets</span><span class="p">):</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">Timespan</span><span class="p">(</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="p">)</span>
            <span class="n">overlap_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_overlap_factor</span><span class="p">(</span><span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">)</span>
            <span class="n">mapping</span><span class="p">[</span><span class="n">timespan</span><span class="p">]</span> <span class="o">=</span> <span class="n">overlap_factor</span>
        <span class="k">return</span> <span class="n">mapping</span></div>


<div class="viewcode-block" id="TimespanList.count_offsets">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.count_offsets">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">count_offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OffsetCounter</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Counts offsets.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Counts offsets:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((3, 1)))</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((6, 1)))</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((10, 1)))</span>

<span class="sd">            &gt;&gt;&gt; offset_counter = timespans.count_offsets()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(offset_counter, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for offset, count in sorted(</span>
<span class="sd">            ...     timespans.count_offsets().items.items()):</span>
<span class="sd">            ...     offset, count</span>
<span class="sd">            ...</span>
<span class="sd">            (Offset((0, 1)), 1)</span>
<span class="sd">            (Offset((3, 1)), 2)</span>
<span class="sd">            (Offset((6, 1)), 2)</span>
<span class="sd">            (Offset((10, 1)), 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Counts offsets:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((16, 1)))</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((12, 1)))</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((8, 1)))</span>
<span class="sd">            Timespan(Offset((15, 1)), Offset((20, 1)))</span>
<span class="sd">            Timespan(Offset((24, 1)), Offset((30, 1)))</span>

<span class="sd">            &gt;&gt;&gt; offset_counter = timespans.count_offsets()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(offset_counter, range_=(0, 30), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for offset, count in sorted(</span>
<span class="sd">            ...     timespans.count_offsets().items.items()):</span>
<span class="sd">            ...     offset, count</span>
<span class="sd">            ...</span>
<span class="sd">            (Offset((-2, 1)), 1)</span>
<span class="sd">            (Offset((0, 1)), 1)</span>
<span class="sd">            (Offset((5, 1)), 1)</span>
<span class="sd">            (Offset((8, 1)), 1)</span>
<span class="sd">            (Offset((12, 1)), 1)</span>
<span class="sd">            (Offset((15, 1)), 1)</span>
<span class="sd">            (Offset((16, 1)), 1)</span>
<span class="sd">            (Offset((20, 1)), 1)</span>
<span class="sd">            (Offset((24, 1)), 1)</span>
<span class="sd">            (Offset((30, 1)), 1)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Counts offsets:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(0, 6),</span>
<span class="sd">            ...     abjad.Timespan(0, 9),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; offset_counter = timespans.count_offsets()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(offset_counter, range_=(0, 9), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for offset, count in sorted(</span>
<span class="sd">            ...     timespans.count_offsets().items.items()):</span>
<span class="sd">            ...     offset, count</span>
<span class="sd">            ...</span>
<span class="sd">            (Offset((0, 1)), 3)</span>
<span class="sd">            (Offset((3, 1)), 1)</span>
<span class="sd">            (Offset((6, 1)), 1)</span>
<span class="sd">            (Offset((9, 1)), 1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OffsetCounter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimespanList.explode">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.explode">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">explode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inventory_count</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="s2">&quot;TimespanList&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Explodes timespans into timespan lists, avoiding overlap, and</span>
<span class="sd">        distributing density as evenly as possible.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Example timespan list:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(5, 13),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ...     abjad.Timespan(8, 9),</span>
<span class="sd">            ...     abjad.Timespan(15, 23),</span>
<span class="sd">            ...     abjad.Timespan(16, 21),</span>
<span class="sd">            ...     abjad.Timespan(17, 19),</span>
<span class="sd">            ...     abjad.Timespan(19, 20),</span>
<span class="sd">            ...     abjad.Timespan(25, 30),</span>
<span class="sd">            ...     abjad.Timespan(26, 29),</span>
<span class="sd">            ...     abjad.Timespan(32, 34),</span>
<span class="sd">            ...     abjad.Timespan(34, 37),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Explodes timespans into the optimal number of non-overlapping timespan_lists:</span>

<span class="sd">            &gt;&gt;&gt; for exploded_timespan_list in timespans.explode():</span>
<span class="sd">            ...     for _ in exploded_timespan_list: _</span>
<span class="sd">            ...     &quot;---&quot;</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((3, 1)))</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((13, 1)))</span>
<span class="sd">            Timespan(Offset((17, 1)), Offset((19, 1)))</span>
<span class="sd">            Timespan(Offset((19, 1)), Offset((20, 1)))</span>
<span class="sd">            Timespan(Offset((34, 1)), Offset((37, 1)))</span>
<span class="sd">            &#39;---&#39;</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((10, 1)))</span>
<span class="sd">            Timespan(Offset((16, 1)), Offset((21, 1)))</span>
<span class="sd">            Timespan(Offset((25, 1)), Offset((30, 1)))</span>
<span class="sd">            &#39;---&#39;</span>
<span class="sd">            Timespan(Offset((8, 1)), Offset((9, 1)))</span>
<span class="sd">            Timespan(Offset((15, 1)), Offset((23, 1)))</span>
<span class="sd">            Timespan(Offset((26, 1)), Offset((29, 1)))</span>
<span class="sd">            Timespan(Offset((32, 1)), Offset((34, 1)))</span>
<span class="sd">            &#39;---&#39;</span>


<span class="sd">        ..  container:: example</span>

<span class="sd">            Explodes timespans into a less-than-optimal number of overlapping</span>
<span class="sd">            timespan_lists:</span>

<span class="sd">            &gt;&gt;&gt; for exploded_timespan_list in timespans.explode(inventory_count=6):</span>
<span class="sd">            ...     for _ in exploded_timespan_list: _</span>
<span class="sd">            ...     &quot;---&quot;</span>
<span class="sd">            ...</span>
<span class="sd">            Timespan(Offset((16, 1)), Offset((21, 1)))</span>
<span class="sd">            Timespan(Offset((34, 1)), Offset((37, 1)))</span>
<span class="sd">            &#39;---&#39;</span>
<span class="sd">            Timespan(Offset((15, 1)), Offset((23, 1)))</span>
<span class="sd">            &#39;---&#39;</span>
<span class="sd">            Timespan(Offset((8, 1)), Offset((9, 1)))</span>
<span class="sd">            Timespan(Offset((17, 1)), Offset((19, 1)))</span>
<span class="sd">            Timespan(Offset((19, 1)), Offset((20, 1)))</span>
<span class="sd">            Timespan(Offset((26, 1)), Offset((29, 1)))</span>
<span class="sd">            &#39;---&#39;</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((10, 1)))</span>
<span class="sd">            Timespan(Offset((32, 1)), Offset((34, 1)))</span>
<span class="sd">            &#39;---&#39;</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((13, 1)))</span>
<span class="sd">            &#39;---&#39;</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((3, 1)))</span>
<span class="sd">            Timespan(Offset((25, 1)), Offset((30, 1)))</span>
<span class="sd">            &#39;---&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inventory_count</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inventory_count</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">inventory_count</span>
        <span class="n">bounding_timespan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timespan</span>
        <span class="n">global_overlap_factors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">empty_timespans_pairs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">result_timespan_lists</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">inventory_count</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">inventory_count</span><span class="p">):</span>
                <span class="n">global_overlap_factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">result_timespans</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)([])</span>
                <span class="n">empty_timespans_pairs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">result_timespans</span><span class="p">))</span>
                <span class="n">result_timespan_lists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result_timespans</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">current_timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">current_overlap_factor</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">current_timespan</span><span class="o">.</span><span class="n">duration</span> <span class="o">/</span> <span class="n">bounding_timespan</span><span class="o">.</span><span class="n">duration</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">empty_timespans_pairs</span><span class="p">:</span>
                <span class="n">i</span><span class="p">,</span> <span class="n">empty_timespans</span> <span class="o">=</span> <span class="n">empty_timespans_pairs</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">empty_timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_timespan</span><span class="p">)</span>
                <span class="n">global_overlap_factors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_overlap_factor</span>
                <span class="k">continue</span>
            <span class="n">nonoverlapping_timespan_lists</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">overlapping_timespan_lists</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result_timespans</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">result_timespan_lists</span><span class="p">):</span>
                <span class="n">local_overlap_factor</span> <span class="o">=</span> <span class="n">result_timespans</span><span class="o">.</span><span class="n">compute_overlap_factor</span><span class="p">(</span>
                    <span class="n">current_timespan</span>
                <span class="p">)</span>
                <span class="n">global_overlap_factor</span> <span class="o">=</span> <span class="n">global_overlap_factors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">local_overlap_factor</span><span class="p">:</span>
                    <span class="n">nonoverlapping_timespan_lists</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">global_overlap_factor</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">overlapping_timespan_lists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">local_overlap_factor</span><span class="p">,</span> <span class="n">global_overlap_factor</span><span class="p">)</span>
                    <span class="p">)</span>
            <span class="n">nonoverlapping_timespan_lists</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">overlapping_timespan_lists</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">nonoverlapping_timespan_lists</span> <span class="ow">and</span> <span class="n">inventory_count</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result_timespans</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)([</span><span class="n">current_timespan</span><span class="p">])</span>
                <span class="n">global_overlap_factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_overlap_factor</span><span class="p">)</span>
                <span class="n">result_timespan_lists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result_timespans</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">nonoverlapping_timespan_lists</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">nonoverlapping_timespan_lists</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">overlapping_timespan_lists</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">result_timespans</span> <span class="o">=</span> <span class="n">result_timespan_lists</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">result_timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_timespan</span><span class="p">)</span>
            <span class="n">global_overlap_factors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">current_overlap_factor</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">result_timespan_lists</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimespanList.get_timespan_that_satisfies_time_relation">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.get_timespan_that_satisfies_time_relation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_timespan_that_satisfies_time_relation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_relation</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets timespan that satisifies ``time_relation``.</span>

<span class="sd">        Returns timespan when timespan list contains exactly one timespan that</span>
<span class="sd">        satisfies ``time_relation``.</span>

<span class="sd">        Raises exception when timespan list contains no timespan that satisfies</span>
<span class="sd">        ``time_relation``.</span>

<span class="sd">        Raises exception when timespan list contains more than one timespan</span>
<span class="sd">        that satisfies ``time_relation``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(2, 5)</span>
<span class="sd">            &gt;&gt;&gt; time_relation = lambda _: timespan.start_offset &lt; _.start_offset &lt; timespan.stop_offset</span>
<span class="sd">            &gt;&gt;&gt; timespan = timespans.get_timespan_that_satisfies_time_relation(</span>
<span class="sd">            ...     time_relation</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespan, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespan</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((6, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_timespans_that_satisfy_time_relation</span><span class="p">(</span><span class="n">time_relation</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">timespans</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">timespans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">timespans</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;extra timespan.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;missing timespan.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimespanList.get_timespans_that_satisfy_time_relation">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.get_timespans_that_satisfy_time_relation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_timespans_that_satisfy_time_relation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_relation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets timespans that satisfy ``time_relation``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(2, 8)</span>
<span class="sd">            &gt;&gt;&gt; time_relation = lambda _: timespan.start_offset &lt; _.start_offset &lt; timespan.stop_offset</span>
<span class="sd">            &gt;&gt;&gt; timespans = timespans.get_timespans_that_satisfy_time_relation(</span>
<span class="sd">            ...     time_relation)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((6, 1)))</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((10, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">time_relation</span><span class="p">(</span><span class="n">timespan</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">result</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimespanList.has_timespan_that_satisfies_time_relation">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.has_timespan_that_satisfies_time_relation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">has_timespan_that_satisfies_time_relation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_relation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when list has matching timespan.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(2, 8)</span>
<span class="sd">            &gt;&gt;&gt; time_relation = lambda _: timespan.start_offset &lt; _.start_offset &lt; timespan.stop_offset</span>
<span class="sd">            &gt;&gt;&gt; timespans.has_timespan_that_satisfies_time_relation(time_relation)</span>
<span class="sd">            True</span>

<span class="sd">            Is false when list does not have matching timespan:</span>

<span class="sd">            &gt;&gt;&gt; timespan = abjad.Timespan(10, 20)</span>
<span class="sd">            &gt;&gt;&gt; timespans.has_timespan_that_satisfies_time_relation(time_relation)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_timespans_that_satisfy_time_relation</span><span class="p">(</span><span class="n">time_relation</span><span class="p">))</span></div>


<div class="viewcode-block" id="TimespanList.partition">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.partition">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">partition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_tangent_timespans</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="s2">&quot;TimespanList&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Partitions timespans into timespan lists.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((3, 1)))</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((6, 1)))</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((10, 1)))</span>

<span class="sd">            &gt;&gt;&gt; for timespan_list in timespans.partition():</span>
<span class="sd">            ...     for _ in timespan_list: _</span>
<span class="sd">            ...     &quot;---&quot;</span>
<span class="sd">            ...</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((3, 1)))</span>
<span class="sd">            &#39;---&#39;</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((6, 1)))</span>
<span class="sd">            &#39;---&#39;</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((10, 1)))</span>
<span class="sd">            &#39;---&#39;</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Partitions timespans:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 16),</span>
<span class="sd">            ...     abjad.Timespan(5, 12),</span>
<span class="sd">            ...     abjad.Timespan(-2, 8),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ...     abjad.Timespan(24, 30),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((16, 1)))</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((12, 1)))</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((8, 1)))</span>
<span class="sd">            Timespan(Offset((15, 1)), Offset((20, 1)))</span>
<span class="sd">            Timespan(Offset((24, 1)), Offset((30, 1)))</span>

<span class="sd">            &gt;&gt;&gt; for timespan_list in timespans.partition():</span>
<span class="sd">            ...     for _ in timespan_list: _</span>
<span class="sd">            ...     &quot;---&quot;</span>
<span class="sd">            ...</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((8, 1)))</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((16, 1)))</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((12, 1)))</span>
<span class="sd">            Timespan(Offset((15, 1)), Offset((20, 1)))</span>
<span class="sd">            &#39;---&#39;</span>
<span class="sd">            Timespan(Offset((24, 1)), Offset((30, 1)))</span>
<span class="sd">            &#39;---&#39;</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Treats tangent timespans as part of the same group when</span>
<span class="sd">            ``include_tangent_timespans`` is true:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for timespan_list in timespans.partition(</span>
<span class="sd">            ...     include_tangent_timespans=True,</span>
<span class="sd">            ... ):</span>
<span class="sd">            ...     for _ in timespan_list: _</span>
<span class="sd">            ...     &quot;---&quot;</span>
<span class="sd">            ...</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((3, 1)))</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((6, 1)))</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((10, 1)))</span>
<span class="sd">            &#39;---&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">()</span>
        <span class="n">timespan_lists</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">[:])</span>
        <span class="n">current_list</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)([</span><span class="n">timespans</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="n">latest_stop_offset</span> <span class="o">=</span> <span class="n">current_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">for</span> <span class="n">current_timespan</span> <span class="ow">in</span> <span class="n">timespans</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="n">current_timespan</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">latest_stop_offset</span><span class="p">:</span>
                <span class="n">current_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_timespan</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">include_tangent_timespans</span>
                <span class="ow">and</span> <span class="n">current_timespan</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">==</span> <span class="n">latest_stop_offset</span>
            <span class="p">):</span>
                <span class="n">current_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_timespan</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">timespan_lists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_list</span><span class="p">)</span>
                <span class="n">current_list</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)([</span><span class="n">current_timespan</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">latest_stop_offset</span> <span class="o">&lt;</span> <span class="n">current_timespan</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">:</span>
                <span class="n">latest_stop_offset</span> <span class="o">=</span> <span class="n">current_timespan</span><span class="o">.</span><span class="n">stop_offset</span>
        <span class="k">if</span> <span class="n">current_list</span><span class="p">:</span>
            <span class="n">timespan_lists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_list</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">timespan_lists</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimespanList.reflect">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.reflect">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">reflect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reflects timespans.</span>

<span class="sd">        Operates in place.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Reflects timespans about timespan list axis:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.reflect()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((4, 1)))</span>
<span class="sd">            Timespan(Offset((4, 1)), Offset((7, 1)))</span>
<span class="sd">            Timespan(Offset((7, 1)), Offset((10, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Reflects timespans about arbitrary axis:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 30), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.reflect(axis=abjad.Offset(15))</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 30), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((20, 1)), Offset((24, 1)))</span>
<span class="sd">            Timespan(Offset((24, 1)), Offset((27, 1)))</span>
<span class="sd">            Timespan(Offset((27, 1)), Offset((30, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">reflect</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="n">timespans</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">timespans</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="TimespanList.remove_degenerate_timespans">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.remove_degenerate_timespans">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove_degenerate_timespans</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes degenerate timespans.</span>

<span class="sd">        Operates in place.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(5, 5),</span>
<span class="sd">            ...     abjad.Timespan(5, 10),</span>
<span class="sd">            ...     abjad.Timespan(5, 25),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.remove_degenerate_timespans()</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((10, 1)))</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((25, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_wellformed</span><span class="p">()]</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">timespans</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="TimespanList.repeat_to_stop_offset">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.repeat_to_stop_offset">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">repeat_to_stop_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stop_offset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Repeats timespans to ``stop_offset``.</span>

<span class="sd">        Operates in place.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 15), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.repeat_to_stop_offset(15)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 15), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((3, 1)))</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((6, 1)))</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((10, 1)))</span>
<span class="sd">            Timespan(Offset((10, 1)), Offset((13, 1)))</span>
<span class="sd">            Timespan(Offset((13, 1)), Offset((15, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_sorted</span>
        <span class="n">stop_offset</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&lt;=</span> <span class="n">stop_offset</span>
        <span class="n">current_timespan_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&lt;</span> <span class="n">stop_offset</span><span class="p">:</span>
                <span class="n">current_timespan</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">current_timespan_index</span><span class="p">]</span>
                <span class="n">translation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">-</span> <span class="n">current_timespan</span><span class="o">.</span><span class="n">start_offset</span>
                <span class="n">new_timespan</span> <span class="o">=</span> <span class="n">current_timespan</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">translation</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_timespan</span><span class="p">)</span>
                <span class="n">current_timespan_index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">stop_offset</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">(</span><span class="n">stop_offset</span><span class="o">=</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="TimespanList.rotate">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.rotate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rotates by ``count`` contiguous timespans.</span>

<span class="sd">        Operates in place.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Rotates by one timespan to the left:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 4),</span>
<span class="sd">            ...     abjad.Timespan(4, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.rotate(-1)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((1, 1)))</span>
<span class="sd">            Timespan(Offset((1, 1)), Offset((7, 1)))</span>
<span class="sd">            Timespan(Offset((7, 1)), Offset((10, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Rotates by one timespan to the right:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 4),</span>
<span class="sd">            ...     abjad.Timespan(4, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.rotate(1)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((6, 1)))</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((9, 1)))</span>
<span class="sd">            Timespan(Offset((9, 1)), Offset((10, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_are_contiguous</span>
        <span class="n">elements_to_move</span> <span class="o">=</span> <span class="n">count</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">elements_to_move</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="n">left_timespans</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[:</span><span class="o">-</span><span class="n">elements_to_move</span><span class="p">]</span>
        <span class="n">right_timespans</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="n">elements_to_move</span><span class="p">:]</span>
        <span class="n">split_offset</span> <span class="o">=</span> <span class="n">right_timespans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start_offset</span>
        <span class="n">translation_to_left</span> <span class="o">=</span> <span class="n">split_offset</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
        <span class="n">translation_to_left</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">translation_to_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">-</span> <span class="n">split_offset</span>
        <span class="n">translated_right_timespans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">right_timespan</span> <span class="ow">in</span> <span class="n">right_timespans</span><span class="p">:</span>
            <span class="n">translated_right_timespan</span> <span class="o">=</span> <span class="n">right_timespan</span><span class="o">.</span><span class="n">translate_offsets</span><span class="p">(</span>
                <span class="n">translation_to_left</span><span class="p">,</span> <span class="n">translation_to_left</span>
            <span class="p">)</span>
            <span class="n">translated_right_timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">translated_right_timespan</span><span class="p">)</span>
        <span class="n">translated_left_timespans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">left_timespan</span> <span class="ow">in</span> <span class="n">left_timespans</span><span class="p">:</span>
            <span class="n">translated_left_timespan</span> <span class="o">=</span> <span class="n">left_timespan</span><span class="o">.</span><span class="n">translate_offsets</span><span class="p">(</span>
                <span class="n">translation_to_right</span><span class="p">,</span> <span class="n">translation_to_right</span>
            <span class="p">)</span>
            <span class="n">translated_left_timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">translated_left_timespan</span><span class="p">)</span>
        <span class="n">new_timespans</span> <span class="o">=</span> <span class="n">translated_right_timespans</span> <span class="o">+</span> <span class="n">translated_left_timespans</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">new_timespans</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="TimespanList.round_offsets">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.round_offsets">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">round_offsets</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">_enums</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">must_be_wellformed</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rounds offsets of timespans in list to multiples of ``multiplier``.</span>

<span class="sd">        Operates in place.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 2),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; rounded_timespans = timespans.round_offsets(3)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(rounded_timespans, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in rounded_timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((3, 1)))</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((6, 1)))</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((9, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 2),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; rounded_timespans = timespans.round_offsets(5)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(rounded_timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in rounded_timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((5, 1)))</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((10, 1)))</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((10, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 2),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-5, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; rounded_timespans = timespans.round_offsets(</span>
<span class="sd">            ...     5,</span>
<span class="sd">            ...     anchor=abjad.RIGHT,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(rounded_timespans, range_=(-5, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in rounded_timespans: _</span>
<span class="sd">            Timespan(Offset((-5, 1)), Offset((0, 1)))</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((5, 1)))</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((10, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 2),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; rounded_timespans = timespans.round_offsets(</span>
<span class="sd">            ...     5,</span>
<span class="sd">            ...     anchor=abjad.RIGHT,</span>
<span class="sd">            ...     must_be_wellformed=False,</span>
<span class="sd">            ... )</span>

<span class="sd">            &gt;&gt;&gt; for _ in rounded_timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((0, 1)))</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((5, 1)))</span>
<span class="sd">            Timespan(Offset((5, 1)), Offset((10, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">round_offsets</span><span class="p">(</span>
                <span class="n">multiplier</span><span class="p">,</span>
                <span class="n">anchor</span><span class="o">=</span><span class="n">anchor</span><span class="p">,</span>
                <span class="n">must_be_wellformed</span><span class="o">=</span><span class="n">must_be_wellformed</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">timespans</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="TimespanList.scale">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.scale">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">_enums</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scales timespan by ``multiplier`` relative to ``anchor``.</span>

<span class="sd">        Operates in place.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Scales timespans relative to timespan list start offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 14), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.scale(2)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 14), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((6, 1)))</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((9, 1)))</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((14, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Scales timespans relative to timespan list stop offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-3, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.scale(2, anchor=abjad.RIGHT)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-3, 10), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((-3, 1)), Offset((3, 1)))</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((6, 1)))</span>
<span class="sd">            Timespan(Offset((2, 1)), Offset((10, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="n">anchor</span><span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">timespans</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="TimespanList.split_at_offset">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.split_at_offset">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">split_at_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="s2">&quot;TimespanList&quot;</span><span class="p">,</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Splits timespans at ``offset``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; left, right = timespans.split_at_offset(4)</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(left, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>
<span class="sd">            &gt;&gt;&gt; for _ in left: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((3, 1)))</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((4, 1)))</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(right, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>
<span class="sd">            &gt;&gt;&gt; for _ in right: _</span>
<span class="sd">            Timespan(Offset((4, 1)), Offset((6, 1)))</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((10, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Splits at offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; left, right = timespans.split_at_offset(6)</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(left, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>
<span class="sd">            &gt;&gt;&gt; for _ in left: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((3, 1)))</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((6, 1)))</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(right, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>
<span class="sd">            &gt;&gt;&gt; for _ in right: _</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((10, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Splits at offset:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; left, right = timespans.split_at_offset(-1)</span>

<span class="sd">            &gt;&gt;&gt; left</span>
<span class="sd">            TimespanList([])</span>

<span class="sd">            &gt;&gt;&gt; abjad.show(right, range_=(0, 10), scale=0.5) # doctest: +SKIP</span>
<span class="sd">            &gt;&gt;&gt; for _ in right: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((3, 1)))</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((6, 1)))</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((10, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="n">before_list</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="n">during_list</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="n">after_list</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span> <span class="o">&lt;=</span> <span class="n">offset</span><span class="p">:</span>
                <span class="n">before_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">offset</span> <span class="o">&lt;=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">start_offset</span><span class="p">:</span>
                <span class="n">after_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">during_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="n">during_list</span><span class="p">:</span>
            <span class="n">before_timespan</span><span class="p">,</span> <span class="n">after_timespan</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">split_at_offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
            <span class="n">before_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">before_timespan</span><span class="p">)</span>
            <span class="n">after_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">after_timespan</span><span class="p">)</span>
        <span class="n">before_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">after_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">before_list</span><span class="p">,</span> <span class="n">after_list</span></div>


<div class="viewcode-block" id="TimespanList.split_at_offsets">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.split_at_offsets">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">split_at_offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offsets</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;TimespanList&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Splits timespans at ``offsets``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(4, 10),</span>
<span class="sd">            ...     abjad.Timespan(15, 20),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 20), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; offsets = [-1, 3, 6, 12, 13]</span>
<span class="sd">            &gt;&gt;&gt; for timespan_list in timespans.split_at_offsets(offsets):</span>
<span class="sd">            ...     abjad.show(timespan_list, range_=(0, 20), scale=0.5) # doctest: +SKIP</span>
<span class="sd">            ...     for _ in timespan_list: _</span>
<span class="sd">            ...     &quot;---&quot;</span>
<span class="sd">            ...</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Splits empty list:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([])</span>
<span class="sd">            &gt;&gt;&gt; timespans.split_at_offsets(offsets)</span>
<span class="sd">            [TimespanList([])]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespan_lists</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">timespan_lists</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">))</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">offsets</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="n">offsets</span><span class="p">:</span>
            <span class="n">shards</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">timespan_lists</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split_at_offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">shards</span><span class="p">:</span>
                <span class="n">timespan_lists</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">shards</span>
        <span class="k">return</span> <span class="n">timespan_lists</span></div>


<div class="viewcode-block" id="TimespanList.stretch">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.stretch">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">stretch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stretches timespans by ``multiplier`` relative to ``anchor``.</span>

<span class="sd">        Operates in place.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 20), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.stretch(2)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((6, 1)))</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((12, 1)))</span>
<span class="sd">            Timespan(Offset((12, 1)), Offset((20, 1)))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Stretches timespans relative to arbitrary anchor:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(-8, 12), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.stretch(2, anchor=abjad.Offset(8))</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((-8, 1)), Offset((-2, 1)))</span>
<span class="sd">            Timespan(Offset((-2, 1)), Offset((4, 1)))</span>
<span class="sd">            Timespan(Offset((4, 1)), Offset((12, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">anchor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">stretch</span><span class="p">(</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">anchor</span><span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">timespans</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="TimespanList.translate">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.translate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">translation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Translates timespans by ``translation``.</span>

<span class="sd">        Operates in place.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Translates timespan by offset ``50``:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 60), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.translate(50)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 60), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((50, 1)), Offset((53, 1)))</span>
<span class="sd">            Timespan(Offset((53, 1)), Offset((56, 1)))</span>
<span class="sd">            Timespan(Offset((56, 1)), Offset((60, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">translate_offsets</span><span class="p">(</span><span class="n">translation</span><span class="p">,</span> <span class="n">translation</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimespanList.translate_offsets">
<a class="viewcode-back" href="../../api/abjad/timespan.html#abjad.timespan.TimespanList.translate_offsets">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">translate_offsets</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">start_offset_translation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stop_offset_translation</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimespanList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Translates timespans by ``start_offset_translation`` and</span>
<span class="sd">        ``stop_offset_translation``.</span>

<span class="sd">        Operates in place.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Translates timespan start- and stop-offsets equally:</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 60), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.translate_offsets(50, 50)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 60), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((50, 1)), Offset((53, 1)))</span>
<span class="sd">            Timespan(Offset((53, 1)), Offset((56, 1)))</span>
<span class="sd">            Timespan(Offset((56, 1)), Offset((60, 1)))</span>

<span class="sd">        Translates timespan stop-offsets only:</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; timespans = abjad.TimespanList([</span>
<span class="sd">            ...     abjad.Timespan(0, 3),</span>
<span class="sd">            ...     abjad.Timespan(3, 6),</span>
<span class="sd">            ...     abjad.Timespan(6, 10),</span>
<span class="sd">            ... ])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 30), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; timespans = timespans.translate_offsets(stop_offset_translation=20)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(timespans, range_=(0, 30), scale=0.5) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; for _ in timespans: _</span>
<span class="sd">            Timespan(Offset((0, 1)), Offset((23, 1)))</span>
<span class="sd">            Timespan(Offset((3, 1)), Offset((26, 1)))</span>
<span class="sd">            Timespan(Offset((6, 1)), Offset((30, 1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timespans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">timespan</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">translate_offsets</span><span class="p">(</span>
                <span class="n">start_offset_translation</span><span class="p">,</span> <span class="n">stop_offset_translation</span>
            <span class="p">)</span>
            <span class="n">timespans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">timespans</span>
        <span class="k">return</span> <span class="bp">self</span></div>
</div>



<span class="k">def</span><span class="w"> </span><span class="nf">_format_postscript_argument</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">argument</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">argument</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">argument</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">argument</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;[ ]&quot;</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_format_postscript_argument</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;[ </span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2"> ]&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">):</span>
        <span class="n">argument</span> <span class="o">=</span> <span class="n">_math</span><span class="o">.</span><span class="n">integer_equivalent_number_to_integer</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>


<span class="n">_fpa</span> <span class="o">=</span> <span class="n">_format_postscript_argument</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_make_timespan_list_markup</span><span class="p">(</span>
    <span class="n">timespans</span><span class="p">,</span>
    <span class="n">postscript_x_offset</span><span class="p">,</span>
    <span class="n">postscript_scale</span><span class="p">,</span>
    <span class="n">draw_offsets</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sortkey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">exploded_timespan_lists</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sortkey</span><span class="p">:</span>
        <span class="n">exploded_timespan_lists</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">timespans</span><span class="o">.</span><span class="n">explode</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sorted_timespan_lists</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="n">timespans</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">timespan</span><span class="p">,</span> <span class="n">sortkey</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sorted_timespan_lists</span><span class="p">:</span>
                <span class="n">sorted_timespan_lists</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">TimespanList</span><span class="p">()</span>
            <span class="n">sorted_timespan_lists</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">timespans</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">sorted_timespan_lists</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">exploded_timespan_lists</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">timespans</span><span class="o">.</span><span class="n">explode</span><span class="p">())</span>
    <span class="n">postscript_strings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0.2 setlinewidth&quot;</span><span class="p">]</span>
    <span class="n">offset_mapping</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">height</span> <span class="o">=</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">exploded_timespan_lists</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">level</span><span class="p">,</span> <span class="n">timespans</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">exploded_timespan_lists</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">postscript_y_offset</span> <span class="o">=</span> <span class="n">height</span> <span class="o">-</span> <span class="p">(</span><span class="n">level</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
        <span class="k">for</span> <span class="n">timespan</span> <span class="ow">in</span> <span class="n">timespans</span><span class="p">:</span>
            <span class="n">offset_mapping</span><span class="p">[</span><span class="n">timespan</span><span class="o">.</span><span class="n">start_offset</span><span class="p">]</span> <span class="o">=</span> <span class="n">level</span>
            <span class="n">offset_mapping</span><span class="p">[</span><span class="n">timespan</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">]</span> <span class="o">=</span> <span class="n">level</span>
            <span class="n">strings</span> <span class="o">=</span> <span class="n">timespan</span><span class="o">.</span><span class="n">_as_postscript</span><span class="p">(</span>
                <span class="n">postscript_x_offset</span><span class="p">,</span> <span class="n">postscript_y_offset</span><span class="p">,</span> <span class="n">postscript_scale</span>
            <span class="p">)</span>
            <span class="n">postscript_strings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">draw_offsets</span><span class="p">:</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">r</span><span class="s2">&quot;\postscript&quot;</span><span class="p">,</span>
            <span class="s1">&#39;#&quot;&#39;</span><span class="p">,</span>
            <span class="o">*</span><span class="n">postscript_strings</span><span class="p">,</span>
            <span class="s1">&#39;&quot;&#39;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
        <span class="n">markup</span> <span class="o">=</span> <span class="n">_indicators</span><span class="o">.</span><span class="n">Markup</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">markup</span>
    <span class="n">postscript_strings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="s2">&quot;0.1 setlinewidth&quot;</span><span class="p">,</span>
            <span class="s2">&quot;[ 0.1 0.2 ] 0 setdash&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">offset_mapping</span><span class="p">):</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">offset_mapping</span><span class="p">[</span><span class="n">offset</span><span class="p">]</span>
        <span class="n">x_offset</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="o">*</span> <span class="n">postscript_scale</span>
        <span class="n">x_offset</span> <span class="o">-=</span> <span class="n">postscript_x_offset</span>
        <span class="n">postscript_strings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">x_offset</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">height</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.5</span><span class="p">)</span><span class="si">}</span><span class="s2"> moveto&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">x_offset</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">_fpa</span><span class="p">(</span><span class="n">height</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">level</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="si">}</span><span class="s2"> lineto&quot;</span><span class="p">,</span>
                <span class="s2">&quot;stroke&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="n">postscript_strings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="s2">&quot;0 0 moveto&quot;</span><span class="p">,</span>
            <span class="s2">&quot;0.99 setgray&quot;</span><span class="p">,</span>
            <span class="s2">&quot;0 0.01 rlineto&quot;</span><span class="p">,</span>
            <span class="s2">&quot;stroke&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">postscript_strings</span><span class="p">)</span>
    <span class="n">postscript</span> <span class="o">=</span> <span class="n">string</span>
    <span class="n">x_extent</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">timespans</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span>
    <span class="n">x_extent</span> <span class="o">*=</span> <span class="n">postscript_scale</span>
    <span class="n">x_extent</span> <span class="o">+=</span> <span class="n">postscript_x_offset</span>
    <span class="n">y_extent</span> <span class="o">=</span> <span class="n">height</span> <span class="o">+</span> <span class="mf">1.5</span>
    <span class="n">lines_string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\pad-to-box #&#39;(0 . </span><span class="si">{</span><span class="n">x_extent</span><span class="si">}</span><span class="s2">) #&#39;(0 . </span><span class="si">{</span><span class="n">y_extent</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">lines_string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n\\</span><span class="s1">postscript #&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">postscript</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
    <span class="n">fraction_strings</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">offset_mapping</span><span class="p">):</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">_duration</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="n">numerator</span><span class="p">,</span> <span class="n">denominator</span> <span class="o">=</span> <span class="n">offset</span><span class="o">.</span><span class="n">numerator</span><span class="p">,</span> <span class="n">offset</span><span class="o">.</span><span class="n">denominator</span>
        <span class="n">x_translation</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="o">*</span> <span class="n">postscript_scale</span>
        <span class="n">x_translation</span> <span class="o">-=</span> <span class="n">postscript_x_offset</span>
        <span class="n">string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\translate #&#39;(</span><span class="si">{</span><span class="n">x_translation</span><span class="si">}</span><span class="s2"> . 1)&quot;</span>
        <span class="n">fraction_strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\sans \fontsize #-3 \center-align&quot;</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="sa">rf</span><span class="s2">&quot; \fraction </span><span class="si">{</span><span class="n">numerator</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">denominator</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">fraction_strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="n">fraction_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fraction_strings</span><span class="p">)</span>
    <span class="n">fraction_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">overlay </span><span class="se">{{\n</span><span class="si">{</span><span class="n">fraction_string</span><span class="si">}</span><span class="se">\n}}</span><span class="s2">&quot;</span>
    <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">column </span><span class="se">{{\n</span><span class="si">{</span><span class="n">fraction_string</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">lines_string</span><span class="si">}</span><span class="se">\n}}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">string</span>
</pre></div>

    </div>
    
    </div>
    

<footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2008-2025, Trevor Bača &amp; Joséphine Oberholtzer.
      <span class="lastupdated">
        Last updated on Jul 05, 2025.
      </span>

    </p>
  </div> 

</footer>

</div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>