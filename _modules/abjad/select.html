

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>abjad.select &mdash; Abjad 3.2 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/abjad.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/uqbar.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/lightbox2/css/lightbox.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  
    <link rel="canonical" href="https://abjad.github.io_modules/abjad/select.html"/>
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script defer="defer" src="../../_static/copybutton.js"></script>
        <script src="../../_static/ga.js"></script>
        <script defer="defer" src="../../_static/lightbox2/js/lightbox.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #cc3300" >
          


    <a href="../../index.html" class="icon icon-home" alt="Documentation
    Home"> Abjad 3.2



    <img src="../../_static/abjad-logo.png" class="logo" alt="Logo"/>

</a>




<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">First steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/audience.html">Audience</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/macos.html">macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/linux.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/windows.html">Windows</a></li>
</ul>
<p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/about_the_docs.html">About the docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers_basic_operations_on.html">Containers, basic operations on</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers_retrieving_by_name.html">Containers, retrieving by name</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers_time_interpretation_of.html">Containers, time interpretation of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/contexts_lilypond_type_of.html">Contexts, LilyPond type of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/indicators.html">Indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/lilypond_files_preamble_of.html">LilyPond files, preamble of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/lilypond_format_of_abjad_objects.html">LilyPond format, of Abjad objects</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/corpus_selection.html">Corpus, figure selection from</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/design_by_dyads.html">Design, by dyads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/enumeration.html">Enumeration, of rhythmic cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/magic_square_from_twelve_tone_row.html">Magic square, from twelve-tone row</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/scales_diatonic.html">Scales, diatonic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/score_fragment_piano.html">Score fragment, piano</a></li>
</ul>
<p class="caption"><span class="caption-text">All classes &amp; functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">Abjad API</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/best_practices.html">Best practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/changes.html">Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/developer_installation.html">Developer installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/lilypond_context_concatenation.html">LilyPond context concatenation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/publications.html">Publications</a></li>
</ul>
<p class="caption"><span class="caption-text">Score gallery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../gallery_2020.html">2020-16</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery_2015.html">2015-11</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery_2010.html">2010-00</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Abjad</a>
        
      </nav>


      <div class="wy-nav-content">

<div class="rst-content">

    


    <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    <div itemprop="articleBody">
    
  <h1>Source code for abjad.select</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">collections.abc</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_inspect</span><span class="p">,</span> <span class="n">_iterate</span><span class="p">,</span> <span class="n">enums</span><span class="p">,</span> <span class="n">math</span><span class="p">,</span> <span class="n">typings</span>
<span class="kn">from</span> <span class="nn">.attach</span> <span class="kn">import</span> <span class="n">attach</span><span class="p">,</span> <span class="n">detach</span>
<span class="kn">from</span> <span class="nn">.cyclictuple</span> <span class="kn">import</span> <span class="n">CyclicTuple</span>
<span class="kn">from</span> <span class="nn">.duration</span> <span class="kn">import</span> <span class="n">Duration</span><span class="p">,</span> <span class="n">Offset</span>
<span class="kn">from</span> <span class="nn">.expression</span> <span class="kn">import</span> <span class="n">Expression</span>
<span class="kn">from</span> <span class="nn">.indicators.Tie</span> <span class="kn">import</span> <span class="n">Tie</span>
<span class="kn">from</span> <span class="nn">.new</span> <span class="kn">import</span> <span class="n">new</span>
<span class="kn">from</span> <span class="nn">.parentage</span> <span class="kn">import</span> <span class="n">Parentage</span>
<span class="kn">from</span> <span class="nn">.pattern</span> <span class="kn">import</span> <span class="n">Pattern</span>
<span class="kn">from</span> <span class="nn">.pitch.pitches</span> <span class="kn">import</span> <span class="n">NamedPitch</span><span class="p">,</span> <span class="n">NumberedPitch</span>
<span class="kn">from</span> <span class="nn">.pitch.segments</span> <span class="kn">import</span> <span class="n">PitchSegment</span>
<span class="kn">from</span> <span class="nn">.pitch.sets</span> <span class="kn">import</span> <span class="n">PitchSet</span>
<span class="kn">from</span> <span class="nn">.ratio</span> <span class="kn">import</span> <span class="n">Ratio</span>
<span class="kn">from</span> <span class="nn">.score</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">AfterGraceContainer</span><span class="p">,</span>
    <span class="n">BeforeGraceContainer</span><span class="p">,</span>
    <span class="n">Chord</span><span class="p">,</span>
    <span class="n">Component</span><span class="p">,</span>
    <span class="n">Container</span><span class="p">,</span>
    <span class="n">Context</span><span class="p">,</span>
    <span class="n">Leaf</span><span class="p">,</span>
    <span class="n">MultimeasureRest</span><span class="p">,</span>
    <span class="n">Note</span><span class="p">,</span>
    <span class="n">Rest</span><span class="p">,</span>
    <span class="n">Skip</span><span class="p">,</span>
    <span class="n">Tuplet</span><span class="p">,</span>
    <span class="n">Voice</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">.sequence</span> <span class="kn">import</span> <span class="n">Sequence</span>
<span class="kn">from</span> <span class="nn">.storage</span> <span class="kn">import</span> <span class="n">FormatSpecification</span><span class="p">,</span> <span class="n">StorageFormatManager</span>

<span class="c1">### INEQUALITIES ###</span>


<div class="viewcode-block" id="Inequality"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Inequality">[docs]</a><span class="k">class</span> <span class="nc">Inequality</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Inequality.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="n">__documentation_section__</span> <span class="o">=</span> <span class="s2">&quot;Inequalities&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_operator_string&quot;</span><span class="p">,</span> <span class="s2">&quot;_operator_function&quot;</span><span class="p">)</span>

    <span class="n">_operator_strings</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;!=&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span> <span class="s2">&quot;==&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;=&quot;</span><span class="p">)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator_string</span><span class="o">=</span><span class="s2">&quot;&lt;&quot;</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">operator_string</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operator_strings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_operator_string</span> <span class="o">=</span> <span class="n">operator_string</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_operator_function</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;!=&quot;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">ne</span><span class="p">,</span>
            <span class="s2">&quot;&lt;&quot;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">lt</span><span class="p">,</span>
            <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">le</span><span class="p">,</span>
            <span class="s2">&quot;==&quot;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">eq</span><span class="p">,</span>
            <span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">gt</span><span class="p">,</span>
            <span class="s2">&quot;&gt;=&quot;</span><span class="p">:</span> <span class="n">operator</span><span class="o">.</span><span class="n">ge</span><span class="p">,</span>
        <span class="p">}[</span><span class="bp">self</span><span class="o">.</span><span class="n">_operator_string</span><span class="p">]</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="Inequality.__call__"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Inequality.__call__">[docs]</a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calls inequality on ``argument``.</span>

<span class="sd">        Returns true or false.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="Inequality.__eq__"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Inequality.__eq__">[docs]</a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true equal to ``argument``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StorageFormatManager</span><span class="o">.</span><span class="n">compare_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span></div>

<div class="viewcode-block" id="Inequality.__hash__"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Inequality.__hash__">[docs]</a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Hashes object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hash_values</span> <span class="o">=</span> <span class="n">StorageFormatManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_hash_values</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="n">hash_values</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unhashable type: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Inequality.__repr__"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Inequality.__repr__">[docs]</a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets interpreter representation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StorageFormatManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_repr_format</span><span class="p">()</span></div>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">operator_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets operator string.</span>

<span class="sd">        Returns string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operator_string</span></div>


<div class="viewcode-block" id="DurationInequality"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.DurationInequality">[docs]</a><span class="k">class</span> <span class="nc">DurationInequality</span><span class="p">(</span><span class="n">Inequality</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Duration inequality.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; inequality = abjad.DurationInequality(&#39;&lt;&#39;, (3, 4))</span>
<span class="sd">        &gt;&gt;&gt; abjad.f(inequality)</span>
<span class="sd">        abjad.DurationInequality(</span>
<span class="sd">            operator_string=&#39;&lt;&#39;,</span>
<span class="sd">            duration=abjad.Duration(3, 4),</span>
<span class="sd">            )</span>

<span class="sd">        &gt;&gt;&gt; inequality(abjad.Duration(1, 2))</span>
<span class="sd">        True</span>

<span class="sd">        &gt;&gt;&gt; inequality(abjad.Note(&quot;c&#39;4&quot;))</span>
<span class="sd">        True</span>

<span class="sd">        &gt;&gt;&gt; inequality(abjad.Container(&quot;c&#39;1 d&#39;1&quot;))</span>
<span class="sd">        False</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Has clean interpreter representation:</span>

<span class="sd">        &gt;&gt;&gt; abjad.DurationInequality(&#39;&lt;&#39;, (3, 4))</span>
<span class="sd">        DurationInequality(operator_string=&#39;&lt;&#39;, duration=Duration(3, 4))</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="n">__documentation_section__</span> <span class="o">=</span> <span class="s2">&quot;Inequalities&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_duration&quot;</span><span class="p">,</span> <span class="s2">&quot;_preprolated&quot;</span><span class="p">)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">operator_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">,</span>
        <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">preprolated</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Inequality</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator_string</span><span class="o">=</span><span class="n">operator_string</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">Infinity</span><span class="p">()</span>
        <span class="n">infinities</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">Infinity</span><span class="p">(),</span> <span class="n">math</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">duration</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">infinities</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">Duration</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
            <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">duration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_duration</span> <span class="o">=</span> <span class="n">duration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_preprolated</span> <span class="o">=</span> <span class="n">preprolated</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="DurationInequality.__call__"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.DurationInequality.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calls inequality on ``argument``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprolated</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;_get_preprolated_duration&quot;</span><span class="p">):</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">_get_preprolated_duration</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">duration</span> <span class="o">=</span> <span class="n">Duration</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">duration</span> <span class="o">=</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">_get_duration</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operator_function</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">)</span></div>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Duration</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets duration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duration</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">preprolated</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when inequality evaluates preprolated duration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprolated</span></div>


<div class="viewcode-block" id="LengthInequality"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.LengthInequality">[docs]</a><span class="k">class</span> <span class="nc">LengthInequality</span><span class="p">(</span><span class="n">Inequality</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Length inequality.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; inequality = abjad.LengthInequality(&#39;&lt;&#39;, 4)</span>
<span class="sd">        &gt;&gt;&gt; abjad.f(inequality)</span>
<span class="sd">        abjad.LengthInequality(</span>
<span class="sd">            operator_string=&#39;&lt;&#39;,</span>
<span class="sd">            length=4,</span>
<span class="sd">            )</span>

<span class="sd">        &gt;&gt;&gt; inequality([1, 2, 3])</span>
<span class="sd">        True</span>

<span class="sd">        &gt;&gt;&gt; inequality([1, 2, 3, 4])</span>
<span class="sd">        False</span>

<span class="sd">        &gt;&gt;&gt; inequality([1, 2, 3, 4, 5])</span>
<span class="sd">        False</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="n">__documentation_section__</span> <span class="o">=</span> <span class="s2">&quot;Inequalities&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_length&quot;</span><span class="p">,)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator_string</span><span class="o">=</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">Inequality</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator_string</span><span class="o">=</span><span class="n">operator_string</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">Infinity</span><span class="p">()</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">length</span>
        <span class="n">infinities</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">Infinity</span><span class="p">(),</span> <span class="n">math</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">length</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">infinities</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_length</span> <span class="o">=</span> <span class="n">length</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="LengthInequality.__call__"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.LengthInequality.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calls inequality on ``argument``.</span>

<span class="sd">        Returns true or false.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operator_function</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">argument</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">)</span></div>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets length.</span>

<span class="sd">        Returns integer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length</span></div>


<div class="viewcode-block" id="PitchInequality"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.PitchInequality">[docs]</a><span class="k">class</span> <span class="nc">PitchInequality</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Pitch inequality.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; inequality = abjad.PitchInequality(&#39;&amp;&#39;, &#39;C4 E4&#39;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.f(inequality)</span>
<span class="sd">        abjad.PitchInequality(</span>
<span class="sd">            operator_string=&#39;&amp;&#39;,</span>
<span class="sd">            pitches=abjad.PitchSet(</span>
<span class="sd">                [0, 4]</span>
<span class="sd">                ),</span>
<span class="sd">            )</span>

<span class="sd">        &gt;&gt;&gt; inequality(abjad.Staff(&quot;d&#39;8 e&#39; f&#39; g&#39;&quot;))</span>
<span class="sd">        True</span>

<span class="sd">        &gt;&gt;&gt; inequality(abjad.Staff(&quot;e&#39;8 f&#39; g&#39; a&#39;&quot;))</span>
<span class="sd">        True</span>

<span class="sd">        &gt;&gt;&gt; inequality(abjad.Staff(&quot;f&#39;8 g&#39; a&#39; b&#39;&quot;))</span>
<span class="sd">        False</span>

<span class="sd">    .. note:: only intersection currently implemented.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="n">__documentation_section__</span> <span class="o">=</span> <span class="s2">&quot;Inequalities&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_operator_string&quot;</span><span class="p">,</span> <span class="s2">&quot;_pitches&quot;</span><span class="p">)</span>

    <span class="n">_set_theoretic_operator_strings</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">,</span> <span class="s2">&quot;^&quot;</span><span class="p">)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator_string</span><span class="o">=</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="n">pitches</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">operator_string</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_theoretic_operator_strings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_operator_string</span> <span class="o">=</span> <span class="n">operator_string</span>
        <span class="c1"># only intersection is currently implemented</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pitches</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
            <span class="n">pitches</span> <span class="o">=</span> <span class="p">[</span><span class="n">pitches</span><span class="p">]</span>
        <span class="n">pitches</span> <span class="o">=</span> <span class="n">PitchSet</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="n">pitches</span><span class="p">,</span> <span class="n">item_class</span><span class="o">=</span><span class="n">NumberedPitch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pitches</span> <span class="o">=</span> <span class="n">pitches</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="PitchInequality.__call__"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.PitchInequality.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calls inequality on ``argument``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pitches</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">Selection</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="n">pitch_set</span> <span class="o">=</span> <span class="n">PitchSet</span><span class="o">.</span><span class="n">from_selection</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">item_class</span><span class="o">=</span><span class="n">NumberedPitch</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">operator_string</span> <span class="o">==</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pitches</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">pitch_set</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;implement </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">operator_string</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span></div>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">operator_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets operator string.</span>

<span class="sd">        Returns string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operator_string</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pitches</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets pitches.</span>

<span class="sd">        Returns numbered pitch set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pitches</span></div>


<span class="c1">### SELECTION ###</span>


<div class="viewcode-block" id="Selection"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection">[docs]</a><span class="k">class</span> <span class="nc">Selection</span><span class="p">(</span><span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Selection of items (components / or other selections).</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; string = r&quot;c&#39;4 \times 2/3 { d&#39;8 r8 e&#39;8 } r16 f&#39;16 g&#39;8 a&#39;4&quot;</span>
<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        &gt;&gt;&gt; result = abjad.select(staff).runs()</span>

<span class="sd">        &gt;&gt;&gt; for item in result:</span>
<span class="sd">        ...     item</span>
<span class="sd">        ...</span>
<span class="sd">        Selection([Note(&quot;c&#39;4&quot;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">        Selection([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">        Selection([Note(&quot;f&#39;16&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;4&quot;)])</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="n">__documentation_section__</span> <span class="o">=</span> <span class="s2">&quot;Selections&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_expression&quot;</span><span class="p">,</span> <span class="s2">&quot;_items&quot;</span><span class="p">,</span> <span class="s2">&quot;_previous&quot;</span><span class="p">)</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">Component</span><span class="p">):</span>
            <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">items</span><span class="p">]</span>
        <span class="n">items</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_items</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_previous</span> <span class="o">=</span> <span class="n">previous</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="Selection.__add__"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.__add__">[docs]</a>    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cocatenates ``argument`` to selection.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Adds selections:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; left = abjad.select(staff).leaves()[:2]</span>
<span class="sd">                &gt;&gt;&gt; right = abjad.select(staff).leaves()[-2:]</span>
<span class="sd">                &gt;&gt;&gt; result = left + right</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;g&#39;8&quot;)</span>
<span class="sd">                Note(&quot;a&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; left = abjad.select().leaves()[:2]</span>
<span class="sd">                &gt;&gt;&gt; right = abjad.select().leaves()[-2:]</span>
<span class="sd">                &gt;&gt;&gt; selector = left + right</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;g&#39;8&quot;)</span>
<span class="sd">                Note(&quot;a&#39;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">items</span><span class="o">=</span><span class="n">items</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.__contains__"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.__contains__">[docs]</a>    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when ``argument`` is in selection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">argument</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span></div>

<div class="viewcode-block" id="Selection.__eq__"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.__eq__">[docs]</a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when selection and ``argument`` are of the same type</span>
<span class="sd">        and when items in selection equal item in ``argument``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">==</span> <span class="n">argument</span><span class="o">.</span><span class="n">items</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Selection.__getitem__"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.__getitem__">[docs]</a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets item, slice or pattern ``argument`` in selection.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.select().leaves()[:2]</span>
<span class="sd">            abjad.select().leaves()[:2]</span>

<span class="sd">        Returns a single item (or expression) when ``argument`` is an integer.</span>

<span class="sd">        Returns new selection (or expression) when ``argument`` is a slice.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="n">Expression</span><span class="o">.</span><span class="n">_make___getitem___string_template</span>
            <span class="n">template</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="n">template</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="o">.</span><span class="n">template</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">(),</span> <span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;use abjad.Selection.get() instead.&quot;</span><span class="p">)</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_previous</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_previous</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">items</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="o">.</span><span class="n">retain_pattern</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">items</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_previous</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">result</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_previous</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets state of selection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;__dict__&quot;</span><span class="p">):</span>
            <span class="n">state</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">class_</span> <span class="ow">in</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__mro__</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">class_</span><span class="p">,</span> <span class="s2">&quot;__slots__&quot;</span><span class="p">,</span> <span class="p">()):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">state</span><span class="p">[</span><span class="n">slot</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slot</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">return</span> <span class="n">state</span>

<div class="viewcode-block" id="Selection.__hash__"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.__hash__">[docs]</a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Hashes selection.</span>

<span class="sd">        Redefined in tandem with __eq__.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hash_values</span> <span class="o">=</span> <span class="n">StorageFormatManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_hash_values</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="n">hash_values</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unhashable type: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Selection.__len__"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.__len__">[docs]</a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets number of items in selection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.__radd__"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.__radd__">[docs]</a>    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Concatenates selection to ``argument``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">items</span><span class="o">=</span><span class="n">items</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.__repr__"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.__repr__">[docs]</a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets interpreter representation of selection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StorageFormatManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_repr_format</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets state of selection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_attach_tie_to_leaves</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">detach</span><span class="p">(</span><span class="n">Tie</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span>
            <span class="n">attach</span><span class="p">(</span><span class="n">Tie</span><span class="p">(),</span> <span class="n">leaf</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_check</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="n">Component</span><span class="p">,</span> <span class="n">Selection</span><span class="p">)):</span>
                <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;components / selections only:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;   </span><span class="si">{</span><span class="n">items</span><span class="si">!r}</span><span class="s2">&quot;</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_components</span><span class="p">(</span>
        <span class="n">class_</span><span class="p">,</span>
        <span class="n">argument</span><span class="p">,</span>
        <span class="n">prototype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">exclude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">grace</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">head</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tail</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">trim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">prototype</span> <span class="o">=</span> <span class="n">prototype</span> <span class="ow">or</span> <span class="n">Component</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prototype</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">prototype</span> <span class="o">=</span> <span class="p">(</span><span class="n">prototype</span><span class="p">,)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="n">_iterate</span><span class="o">.</span><span class="n">_public_iterate_components</span><span class="p">(</span>
            <span class="n">argument</span><span class="p">,</span> <span class="n">prototype</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span> <span class="n">grace</span><span class="o">=</span><span class="n">grace</span>
        <span class="p">)</span>
        <span class="n">components</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">components</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">trim</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">enums</span><span class="o">.</span><span class="n">Left</span><span class="p">):</span>
                <span class="n">components</span> <span class="o">=</span> <span class="n">Selection</span><span class="o">.</span><span class="n">_trim_subresult</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="n">trim</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">head</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">components</span> <span class="o">=</span> <span class="n">Selection</span><span class="o">.</span><span class="n">_head_filter_subresult</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="n">head</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tail</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">components</span> <span class="o">=</span> <span class="n">Selection</span><span class="o">.</span><span class="n">_tail_filter_subresult</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="n">tail</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">class_</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_contiguous_logical_voice</span><span class="p">()</span>
        <span class="n">new_components</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
                <span class="n">new_component</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">_copy_with_children</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_component</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
            <span class="n">new_components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_component</span><span class="p">)</span>
        <span class="n">new_components</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">new_components</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_components</span>

    <span class="k">def</span> <span class="nf">_get_component</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">prototype</span> <span class="o">=</span> <span class="n">prototype</span> <span class="ow">or</span> <span class="p">(</span><span class="n">Component</span><span class="p">,)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prototype</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">prototype</span> <span class="o">=</span> <span class="p">(</span><span class="n">prototype</span><span class="p">,)</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">recurse</span><span class="p">:</span>
                <span class="n">components</span> <span class="o">=</span> <span class="n">_iterate</span><span class="o">.</span><span class="n">_public_iterate_components</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prototype</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">components</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">components</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">recurse</span><span class="p">:</span>
                <span class="n">components</span> <span class="o">=</span> <span class="n">_iterate</span><span class="o">.</span><span class="n">_public_iterate_components</span><span class="p">(</span>
                    <span class="bp">self</span><span class="p">,</span> <span class="n">prototype</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">components</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">components</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">abs</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">x</span>

    <span class="k">def</span> <span class="nf">_get_format_specification</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">FormatSpecification</span><span class="p">(</span><span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_format_args_values</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_offset_lists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">start_offsets</span><span class="p">,</span> <span class="n">stop_offsets</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">start_offsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">()</span><span class="o">.</span><span class="n">start_offset</span><span class="p">)</span>
            <span class="n">stop_offsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">()</span><span class="o">.</span><span class="n">stop_offset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">start_offsets</span><span class="p">,</span> <span class="n">stop_offsets</span>

    <span class="k">def</span> <span class="nf">_get_parent_and_start_stop_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ignore_before_after_grace</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_contiguous_same_parent</span><span class="p">(</span>
            <span class="n">ignore_before_after_grace</span><span class="o">=</span><span class="n">ignore_before_after_grace</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">first</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">_parent</span>
            <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">first_index</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">first</span><span class="p">)</span>
                <span class="n">last_index</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">last</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">parent</span><span class="p">,</span> <span class="n">first_index</span><span class="p">,</span> <span class="n">last_index</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_get_preprolated_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">_get_preprolated_duration</span><span class="p">()</span> <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_template</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">selector</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">frame_info</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getframeinfo</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
            <span class="n">function_name</span> <span class="o">=</span> <span class="n">frame_info</span><span class="o">.</span><span class="n">function</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="n">Expression</span><span class="o">.</span><span class="n">_wrap_arguments</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">frame</span>
        <span class="n">template</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">function_name</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">arguments</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">return</span> <span class="n">selector</span><span class="o">.</span><span class="n">template</span> <span class="o">+</span> <span class="n">template</span>

    <span class="k">def</span> <span class="nf">_give_components_to_empty_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Not composer-safe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_contiguous_same_parent</span><span class="p">()</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">container</span>
        <span class="n">components</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">components</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="s2">&quot;components&quot;</span><span class="p">,</span> <span class="p">()))</span>
        <span class="n">container</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
        <span class="n">container</span><span class="p">[:]</span><span class="o">.</span><span class="n">_set_parents</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_give_position_in_parent_to_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Not composer-safe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">are_contiguous_same_parent</span><span class="p">()</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">Container</span><span class="p">)</span>
        <span class="n">parent</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_parent_and_start_stop_indices</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parent</span><span class="o">.</span><span class="n">_components</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">start</span><span class="p">),</span> <span class="p">[</span><span class="n">container</span><span class="p">])</span>
            <span class="n">container</span><span class="o">.</span><span class="n">_set_parent</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_parents</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_head_filter_subresult</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">head</span><span class="p">):</span>
        <span class="n">result_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Component</span><span class="p">):</span>
                <span class="n">leaves</span> <span class="o">=</span> <span class="n">_iterate</span><span class="o">.</span><span class="n">_get_logical_tie_leaves</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">head</span> <span class="o">==</span> <span class="p">(</span><span class="n">item</span> <span class="ow">is</span> <span class="n">leaves</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">result_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Selection</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">Component</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">item</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">selection</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                    <span class="n">leaves</span> <span class="o">=</span> <span class="n">_iterate</span><span class="o">.</span><span class="n">_get_logical_tie_leaves</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">head</span> <span class="o">==</span> <span class="n">leaves</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">selection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="n">selection</span> <span class="o">=</span> <span class="n">Selection</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
                <span class="n">result_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result_</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">result_</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Selection</span><span class="p">(</span><span class="n">result_</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_immediately_precedes</span><span class="p">(</span><span class="n">component_1</span><span class="p">,</span> <span class="n">component_2</span><span class="p">,</span> <span class="n">ignore_before_after_grace</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">successors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current</span> <span class="o">=</span> <span class="n">component_1</span>
        <span class="c1"># do not include OnBeatGraceContainer here because</span>
        <span class="c1"># OnBeatGraceContainer is a proper container</span>
        <span class="n">grace_prototype</span> <span class="o">=</span> <span class="p">(</span><span class="n">AfterGraceContainer</span><span class="p">,</span> <span class="n">BeforeGraceContainer</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">current</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sibling</span> <span class="o">=</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">_get_sibling_with_graces</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">while</span> <span class="p">(</span>
                <span class="n">ignore_before_after_grace</span>
                <span class="ow">and</span> <span class="n">sibling</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sibling</span><span class="o">.</span><span class="n">_parent</span><span class="p">,</span> <span class="n">grace_prototype</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">sibling</span> <span class="o">=</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">_get_sibling_with_graces</span><span class="p">(</span><span class="n">sibling</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sibling</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="n">_parent</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">descendants</span> <span class="o">=</span> <span class="n">sibling</span><span class="o">.</span><span class="n">_get_descendants_starting_with</span><span class="p">()</span>
                <span class="n">successors</span> <span class="o">=</span> <span class="n">descendants</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">component_2</span> <span class="ow">in</span> <span class="n">successors</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_is_immediate_child_of_outermost_voice</span><span class="p">(</span><span class="n">component</span><span class="p">):</span>
        <span class="n">parentage</span> <span class="o">=</span> <span class="n">Parentage</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">parentage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Voice</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="n">parentage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">parentage</span><span class="o">.</span><span class="n">component</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="n">context</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># TODO: remove this in favor of the abjad.iterpitches module;</span>
    <span class="c1">#       force users to initialize pitch segments expicitly after iteration.</span>
    <span class="k">def</span> <span class="nf">_pitch_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PitchSegment</span><span class="p">:</span>
        <span class="n">pitches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">_iterate</span><span class="o">.</span><span class="n">_public_iterate_leaves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pitched</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pitches</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">leaf</span><span class="o">.</span><span class="n">written_pitches</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pitches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leaf</span><span class="o">.</span><span class="n">written_pitch</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">return</span> <span class="n">PitchSegment</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="n">pitches</span><span class="p">,</span> <span class="n">item_class</span><span class="o">=</span><span class="n">NamedPitch</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_parents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Not composer-safe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="n">component</span><span class="o">.</span><span class="n">_set_parent</span><span class="p">(</span><span class="n">new_parent</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_tail_filter_subresult</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">tail</span><span class="p">):</span>
        <span class="n">result_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Component</span><span class="p">):</span>
                <span class="n">leaves</span> <span class="o">=</span> <span class="n">_iterate</span><span class="o">.</span><span class="n">_get_logical_tie_leaves</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">tail</span> <span class="o">==</span> <span class="p">(</span><span class="n">item</span> <span class="ow">is</span> <span class="n">leaves</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="n">result_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Selection</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">Component</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">item</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">selection</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                    <span class="n">leaves</span> <span class="o">=</span> <span class="n">_iterate</span><span class="o">.</span><span class="n">_get_logical_tie_leaves</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">tail</span> <span class="o">==</span> <span class="n">leaves</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">selection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="n">selection</span> <span class="o">=</span> <span class="n">Selection</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
                <span class="n">result_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result_</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">result_</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Selection</span><span class="p">(</span><span class="n">result_</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_trim_subresult</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">trim</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">trim</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">enums</span><span class="o">.</span><span class="n">Left</span><span class="p">)</span>
        <span class="n">prototype</span> <span class="o">=</span> <span class="p">(</span><span class="n">MultimeasureRest</span><span class="p">,</span> <span class="n">Rest</span><span class="p">,</span> <span class="n">Skip</span><span class="p">)</span>
        <span class="n">result_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">found_good_component</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Component</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">prototype</span><span class="p">):</span>
                    <span class="n">found_good_component</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Selection</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">Component</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">item</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">selection</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">prototype</span><span class="p">):</span>
                        <span class="n">found_good_component</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">if</span> <span class="n">found_good_component</span><span class="p">:</span>
                        <span class="n">selection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">Selection</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">found_good_component</span><span class="p">:</span>
                <span class="n">result_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">trim</span> <span class="ow">is</span> <span class="n">enums</span><span class="o">.</span><span class="n">Left</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Selection</span><span class="p">(</span><span class="n">result_</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result__</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">found_good_component</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">result_</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Component</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">prototype</span><span class="p">):</span>
                        <span class="n">found_good_component</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Selection</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">Component</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">item</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                    <span class="n">selection</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">prototype</span><span class="p">):</span>
                            <span class="n">found_good_component</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">if</span> <span class="n">found_good_component</span><span class="p">:</span>
                            <span class="n">selection</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span>
                    <span class="n">item</span> <span class="o">=</span> <span class="n">Selection</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">found_good_component</span><span class="p">:</span>
                    <span class="n">result__</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result__</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">result__</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Selection</span><span class="p">(</span><span class="n">result__</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_update_expression</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">frame</span><span class="p">,</span>
        <span class="n">evaluation_template</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">lone</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">map_operand</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">template</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="n">Expression</span><span class="o">.</span><span class="n">_frame_to_callback</span><span class="p">(</span>
            <span class="n">frame</span><span class="p">,</span>
            <span class="n">evaluation_template</span><span class="o">=</span><span class="n">evaluation_template</span><span class="p">,</span>
            <span class="n">map_operand</span><span class="o">=</span><span class="n">map_operand</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="n">new</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">lone</span><span class="o">=</span><span class="n">lone</span><span class="p">)</span>
        <span class="n">expression</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="o">.</span><span class="n">append_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">template</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">template</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_template</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">)</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets items.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.Staff(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)[:].items</span>
<span class="sd">            (Note(&quot;c&#39;4&quot;), Note(&quot;d&#39;4&quot;), Note(&quot;e&#39;4&quot;), Note(&quot;f&#39;4&quot;))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_items</span>

    <span class="c1">### PUBLIC METHODS ###</span>

<div class="viewcode-block" id="Selection.are_contiguous_logical_voice"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.are_contiguous_logical_voice">[docs]</a>    <span class="k">def</span> <span class="nf">are_contiguous_logical_voice</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ignore_before_after_grace</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when items in selection are contiguous components in the</span>
<span class="sd">        same logical voice.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; staff[:].are_contiguous_logical_voice()</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; selection = staff[:1] + staff[-1:]</span>
<span class="sd">            &gt;&gt;&gt; selection.are_contiguous_logical_voice()</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            REGRESSION. Before-grace music may be ignored:</span>

<span class="sd">            &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cs&#39;16&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(voice)</span>
<span class="sd">                \new Voice</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \grace {</span>
<span class="sd">                        cs&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; voice[:]</span>
<span class="sd">            Selection([Note(&quot;c&#39;4&quot;), Note(&quot;d&#39;4&quot;), Note(&quot;e&#39;4&quot;), Note(&quot;f&#39;4&quot;)])</span>

<span class="sd">            &gt;&gt;&gt; voice[:].are_contiguous_logical_voice()</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; voice[:].are_contiguous_logical_voice(</span>
<span class="sd">            ...     ignore_before_after_grace=True</span>
<span class="sd">            ... )</span>
<span class="sd">            True</span>

<span class="sd">            After-grace music may be ignored, too:</span>

<span class="sd">            &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.AfterGraceContainer(&quot;cs&#39;16&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(container, voice[0])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(voice)</span>
<span class="sd">                \new Voice</span>
<span class="sd">                {</span>
<span class="sd">                    \afterGrace</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    {</span>
<span class="sd">                        cs&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; voice[:]</span>
<span class="sd">            Selection([Note(&quot;c&#39;4&quot;), Note(&quot;d&#39;4&quot;), Note(&quot;e&#39;4&quot;), Note(&quot;f&#39;4&quot;)])</span>

<span class="sd">            &gt;&gt;&gt; voice[:].are_contiguous_logical_voice()</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; voice[:].are_contiguous_logical_voice(</span>
<span class="sd">            ...     ignore_before_after_grace=True</span>
<span class="sd">            ... )</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">prototype</span> <span class="o">=</span> <span class="n">prototype</span> <span class="ow">or</span> <span class="p">(</span><span class="n">Component</span><span class="p">,)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prototype</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">prototype</span> <span class="o">=</span> <span class="p">(</span><span class="n">prototype</span><span class="p">,)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prototype</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">prototype</span><span class="p">)</span> <span class="ow">and</span> <span class="n">_</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">first</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">prototype</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">first_parentage</span> <span class="o">=</span> <span class="n">Parentage</span><span class="p">(</span><span class="n">first</span><span class="p">)</span>
        <span class="n">first_logical_voice</span> <span class="o">=</span> <span class="n">first_parentage</span><span class="o">.</span><span class="n">logical_voice</span><span class="p">()</span>
        <span class="n">first_root</span> <span class="o">=</span> <span class="n">first_parentage</span><span class="o">.</span><span class="n">root</span>
        <span class="n">previous</span> <span class="o">=</span> <span class="n">first</span>
        <span class="k">for</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">current_parentage</span> <span class="o">=</span> <span class="n">Parentage</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
            <span class="n">current_logical_voice</span> <span class="o">=</span> <span class="n">current_parentage</span><span class="o">.</span><span class="n">logical_voice</span><span class="p">()</span>
            <span class="c1"># false if wrong type of component found</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">prototype</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="c1"># false if in different logical voices</span>
            <span class="k">if</span> <span class="n">current_logical_voice</span> <span class="o">!=</span> <span class="n">first_logical_voice</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="c1"># false if components are in same score and are discontiguous</span>
            <span class="k">if</span> <span class="n">current_parentage</span><span class="o">.</span><span class="n">root</span> <span class="o">==</span> <span class="n">first_root</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_immediately_precedes</span><span class="p">(</span>
                    <span class="n">previous</span><span class="p">,</span>
                    <span class="n">current</span><span class="p">,</span>
                    <span class="n">ignore_before_after_grace</span><span class="o">=</span><span class="n">ignore_before_after_grace</span><span class="p">,</span>
                <span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="n">previous</span> <span class="o">=</span> <span class="n">current</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Selection.are_contiguous_same_parent"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.are_contiguous_same_parent">[docs]</a>    <span class="k">def</span> <span class="nf">are_contiguous_same_parent</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ignore_before_after_grace</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when items in selection are all contiguous components in</span>
<span class="sd">        the same parent.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; staff[:].are_contiguous_same_parent()</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; selection = staff[:1] + staff[-1:]</span>
<span class="sd">            &gt;&gt;&gt; selection.are_contiguous_same_parent()</span>
<span class="sd">            False</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            REGRESSION. Before-grace music music may be ignored:</span>

<span class="sd">            &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cs&#39;16&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(container, voice[1])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(voice)</span>
<span class="sd">                \new Voice</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \grace {</span>
<span class="sd">                        cs&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; voice[:]</span>
<span class="sd">            Selection([Note(&quot;c&#39;4&quot;), Note(&quot;d&#39;4&quot;), Note(&quot;e&#39;4&quot;), Note(&quot;f&#39;4&quot;)])</span>

<span class="sd">            &gt;&gt;&gt; voice[:].are_contiguous_same_parent()</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; voice[:].are_contiguous_same_parent(</span>
<span class="sd">            ...     ignore_before_after_grace=True</span>
<span class="sd">            ... )</span>
<span class="sd">            True</span>

<span class="sd">            After-grace music may be ignored, too:</span>

<span class="sd">            &gt;&gt;&gt; voice = abjad.Voice(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.AfterGraceContainer(&quot;cs&#39;16&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(container, voice[0])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(voice) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(voice)</span>
<span class="sd">                \new Voice</span>
<span class="sd">                {</span>
<span class="sd">                    \afterGrace</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    {</span>
<span class="sd">                        cs&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>

<span class="sd">            &gt;&gt;&gt; voice[:]</span>
<span class="sd">            Selection([Note(&quot;c&#39;4&quot;), Note(&quot;d&#39;4&quot;), Note(&quot;e&#39;4&quot;), Note(&quot;f&#39;4&quot;)])</span>

<span class="sd">            &gt;&gt;&gt; voice[:].are_contiguous_same_parent()</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; voice[:].are_contiguous_same_parent(</span>
<span class="sd">            ...     ignore_before_after_grace=True</span>
<span class="sd">            ... )</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">prototype</span> <span class="o">=</span> <span class="n">prototype</span> <span class="ow">or</span> <span class="p">(</span><span class="n">Component</span><span class="p">,)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prototype</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">prototype</span> <span class="o">=</span> <span class="p">(</span><span class="n">prototype</span><span class="p">,)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prototype</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">prototype</span><span class="p">)</span> <span class="ow">and</span> <span class="n">_</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">first</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">prototype</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">first_parent</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">_parent</span>
        <span class="n">same_parent</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">strictly_contiguous</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">previous</span> <span class="o">=</span> <span class="n">first</span>
        <span class="k">for</span> <span class="n">current</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">prototype</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">current</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">first_parent</span><span class="p">:</span>
                <span class="n">same_parent</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_immediately_precedes</span><span class="p">(</span>
                <span class="n">previous</span><span class="p">,</span>
                <span class="n">current</span><span class="p">,</span>
                <span class="n">ignore_before_after_grace</span><span class="o">=</span><span class="n">ignore_before_after_grace</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="n">strictly_contiguous</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">current</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="n">same_parent</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">strictly_contiguous</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="n">previous</span> <span class="o">=</span> <span class="n">current</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Selection.are_leaves"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.are_leaves">[docs]</a>    <span class="k">def</span> <span class="nf">are_leaves</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when items in selection are all leaves.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.Staff(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)[:].are_leaves()</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">Leaf</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.are_logical_voice"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.are_logical_voice">[docs]</a>    <span class="k">def</span> <span class="nf">are_logical_voice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when items in selection are all components in the same</span>
<span class="sd">        logical voice.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; staff[:].are_logical_voice()</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; selection = staff[:1] + staff[-1:]</span>
<span class="sd">            &gt;&gt;&gt; selection.are_logical_voice()</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">_are_logical_voice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="n">prototype</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.chord"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.chord">[docs]</a>    <span class="k">def</span> <span class="nf">chord</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">Strings</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">grace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Chord</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects chord ``n``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects chord -1:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; tuplets = [</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 c&#39;16 &lt;d&#39; e&#39;&gt;4 ~ &lt;d&#39; e&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 d&#39;16 &lt;e&#39; fs&#39;&gt;4 ~ &lt;e&#39; fs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 e&#39;16 &lt;fs&#39; gs&#39;&gt;4 ~ &lt;fs&#39; gs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     ]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = zip([(10, 9), (8, 9), (10, 9)], tuplets)</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.Tuplet(*_) for _ in tuplets]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.select(tuplets)]</span>
<span class="sd">                &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.rhythm(tuplets)</span>
<span class="sd">                &gt;&gt;&gt; staff = lilypond_file[abjad.Staff]</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.direction = abjad.Up</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.staff_padding = 3</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).chord(-1)</span>

<span class="sd">                &gt;&gt;&gt; result</span>
<span class="sd">                Chord(&quot;&lt;fs&#39; gs&#39;&gt;16&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().chord(-1)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Chord(&quot;&lt;fs&#39; gs&#39;&gt;16&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(lilypond_file[abjad.Score], align_tags=89)</span>
<span class="sd">                \new Score</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new GlobalContext</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/4</span>
<span class="sd">                        s1 * 7/4</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override TupletBracket.direction = #up</span>
<span class="sd">                        \override TupletBracket.staff-padding = #3</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 8/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            d&#39;16</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            \abjad-color-music #&#39;green</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">(),</span> <span class="n">lone</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">chords</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span> <span class="n">grace</span><span class="o">=</span><span class="n">grace</span><span class="p">)[</span><span class="n">n</span><span class="p">]</span></div>

<div class="viewcode-block" id="Selection.chords"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.chords">[docs]</a>    <span class="k">def</span> <span class="nf">chords</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">Strings</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">grace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects chords.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects chords:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; tuplets = [</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 c&#39;16 &lt;d&#39; e&#39;&gt;4 ~ &lt;d&#39; e&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 d&#39;16 &lt;e&#39; fs&#39;&gt;4 ~ &lt;e&#39; fs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 e&#39;16 &lt;fs&#39; gs&#39;&gt;4 ~ &lt;fs&#39; gs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     ]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = zip([(10, 9), (8, 9), (10, 9)], tuplets)</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.Tuplet(*_) for _ in tuplets]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.select(tuplets)]</span>
<span class="sd">                &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.rhythm(tuplets)</span>
<span class="sd">                &gt;&gt;&gt; staff = lilypond_file[abjad.Staff]</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.direction = abjad.Up</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.staff_padding = 3</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).chords()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Chord(&quot;&lt;a&#39;&#39; b&#39;&#39;&gt;16&quot;)</span>
<span class="sd">                Chord(&quot;&lt;d&#39; e&#39;&gt;4&quot;)</span>
<span class="sd">                Chord(&quot;&lt;d&#39; e&#39;&gt;16&quot;)</span>
<span class="sd">                Chord(&quot;&lt;a&#39;&#39; b&#39;&#39;&gt;16&quot;)</span>
<span class="sd">                Chord(&quot;&lt;e&#39; fs&#39;&gt;4&quot;)</span>
<span class="sd">                Chord(&quot;&lt;e&#39; fs&#39;&gt;16&quot;)</span>
<span class="sd">                Chord(&quot;&lt;a&#39;&#39; b&#39;&#39;&gt;16&quot;)</span>
<span class="sd">                Chord(&quot;&lt;fs&#39; gs&#39;&gt;4&quot;)</span>
<span class="sd">                Chord(&quot;&lt;fs&#39; gs&#39;&gt;16&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().chords()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Chord(&quot;&lt;a&#39;&#39; b&#39;&#39;&gt;16&quot;)</span>
<span class="sd">                Chord(&quot;&lt;d&#39; e&#39;&gt;4&quot;)</span>
<span class="sd">                Chord(&quot;&lt;d&#39; e&#39;&gt;16&quot;)</span>
<span class="sd">                Chord(&quot;&lt;a&#39;&#39; b&#39;&#39;&gt;16&quot;)</span>
<span class="sd">                Chord(&quot;&lt;e&#39; fs&#39;&gt;4&quot;)</span>
<span class="sd">                Chord(&quot;&lt;e&#39; fs&#39;&gt;16&quot;)</span>
<span class="sd">                Chord(&quot;&lt;a&#39;&#39; b&#39;&#39;&gt;16&quot;)</span>
<span class="sd">                Chord(&quot;&lt;fs&#39; gs&#39;&gt;4&quot;)</span>
<span class="sd">                Chord(&quot;&lt;fs&#39; gs&#39;&gt;16&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(lilypond_file[abjad.Score], align_tags=89)</span>
<span class="sd">                \new Score</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new GlobalContext</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/4</span>
<span class="sd">                        s1 * 7/4</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override TupletBracket.direction = #up</span>
<span class="sd">                        \override TupletBracket.staff-padding = #3</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 8/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            d&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">Chord</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span> <span class="n">grace</span><span class="o">=</span><span class="n">grace</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.components"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.components">[docs]</a>    <span class="k">def</span> <span class="nf">components</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">prototype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">exclude</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">Strings</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">grace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">reverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects components.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects notes:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39;8 ~ d&#39;16 e&#39;16 ~ e&#39;8 r4 g&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).components(abjad.Note)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;c&#39;4&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;16&quot;)</span>
<span class="sd">                Note(&quot;e&#39;16&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;g&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().components(abjad.Note)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;c&#39;4&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;16&quot;)</span>
<span class="sd">                Note(&quot;e&#39;16&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;g&#39;8&quot;)</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r4</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects both main notes and graces when ``grace=None``:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cf&#39;&#39;16 bf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.AfterGraceContainer(&quot;af&#39;16 gf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                ..  docs::</span>

<span class="sd">                    &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            cf&#39;&#39;16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        {</span>
<span class="sd">                            af&#39;16</span>
<span class="sd">                            gf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).components(</span>
<span class="sd">                ...     abjad.Leaf,</span>
<span class="sd">                ...     grace=None,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;cf&#39;&#39;16&quot;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;af&#39;16&quot;)</span>
<span class="sd">                Note(&quot;gf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().components(</span>
<span class="sd">                ...     abjad.Leaf,</span>
<span class="sd">                ...     grace=None,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;cf&#39;&#39;16&quot;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;af&#39;16&quot;)</span>
<span class="sd">                Note(&quot;gf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \grace {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        cf&#39;&#39;16</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        bf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    \afterGrace</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        af&#39;16</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        gf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Excludes grace notes when ``grace=False``:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cf&#39;&#39;16 bf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.AfterGraceContainer(&quot;af&#39;16 gf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                ..  docs::</span>

<span class="sd">                    &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            cf&#39;&#39;16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        {</span>
<span class="sd">                            af&#39;16</span>
<span class="sd">                            gf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).components(</span>
<span class="sd">                ...     abjad.Leaf,</span>
<span class="sd">                ...     grace=False,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().components(</span>
<span class="sd">                ...     abjad.Leaf,</span>
<span class="sd">                ...     grace=False,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \grace {</span>
<span class="sd">                        cf&#39;&#39;16</span>
<span class="sd">                        bf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    \afterGrace</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    {</span>
<span class="sd">                        af&#39;16</span>
<span class="sd">                        gf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects only grace notes when ``grace=True``:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cf&#39;&#39;16 bf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.AfterGraceContainer(&quot;af&#39;16 gf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                ..  docs::</span>

<span class="sd">                    &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            cf&#39;&#39;16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        {</span>
<span class="sd">                            af&#39;16</span>
<span class="sd">                            gf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).components(</span>
<span class="sd">                ...     abjad.Leaf,</span>
<span class="sd">                ...     grace=True,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;cf&#39;&#39;16&quot;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;af&#39;16&quot;)</span>
<span class="sd">                Note(&quot;gf&#39;16&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().components(</span>
<span class="sd">                ...     abjad.Leaf,</span>
<span class="sd">                ...     grace=True,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;cf&#39;&#39;16&quot;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;af&#39;16&quot;)</span>
<span class="sd">                Note(&quot;gf&#39;16&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \grace {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        cf&#39;&#39;16</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        bf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \afterGrace</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        af&#39;16</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        gf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="n">_iterate</span><span class="o">.</span><span class="n">_public_iterate_components</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="n">prototype</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span> <span class="n">grace</span><span class="o">=</span><span class="n">grace</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">generator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_previous</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.exclude"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.exclude">[docs]</a>    <span class="k">def</span> <span class="nf">exclude</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets patterned items.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Excludes every other leaf:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; string = r&quot;c&#39;8 d&#39;8 ~ d&#39;8 e&#39;8 ~ e&#39;8 ~ e&#39;8 r8 f&#39;8&quot;</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; for leaf in abjad.select(staff).leaves().exclude([0], 2):</span>
<span class="sd">                ...     leaf</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves().exclude([0], 2)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Excludes every other logical tie:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; string = r&quot;c&#39;8 d&#39;8 ~ d&#39;8 e&#39;8 ~ e&#39;8 ~ e&#39;8 r8 f&#39;8&quot;</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; selection = abjad.select(staff).logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; for logical_tie in selection.exclude([0], 2):</span>
<span class="sd">                ...     logical_tie</span>
<span class="sd">                ...</span>
<span class="sd">                LogicalTie([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.exclude([0], 2)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                LogicalTie([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Excludes note 1 (or nothing) in each pitched logical tie:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;c&#39;8 d&#39;8 ~ d&#39;8 e&#39;8 ~ e&#39;8 ~ e&#39;8 r8 f&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; getter = abjad.select().leaves().exclude([1])</span>
<span class="sd">                &gt;&gt;&gt; for selection in abjad.select(staff).logical_ties(</span>
<span class="sd">                ...     pitched=True,</span>
<span class="sd">                ...     ).map(getter):</span>
<span class="sd">                ...     selection</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; getter = abjad.select().leaves().exclude([1])</span>
<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.map(getter)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            {</span>
<span class="sd">                \abjad-color-music #&#39;red</span>
<span class="sd">                c&#39;8</span>
<span class="sd">                \abjad-color-music #&#39;blue</span>
<span class="sd">                d&#39;8</span>
<span class="sd">                ~</span>
<span class="sd">                d&#39;8</span>
<span class="sd">                \abjad-color-music #&#39;red</span>
<span class="sd">                e&#39;8</span>
<span class="sd">                ~</span>
<span class="sd">                e&#39;8</span>
<span class="sd">                ~</span>
<span class="sd">                \abjad-color-music #&#39;red</span>
<span class="sd">                e&#39;8</span>
<span class="sd">                r8</span>
<span class="sd">                \abjad-color-music #&#39;blue</span>
<span class="sd">                f&#39;8</span>
<span class="sd">            }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">Pattern</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">,</span> <span class="n">inverted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_previous</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_previous</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="o">.</span><span class="n">retain_pattern</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">items</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_previous</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Selection.filter"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.filter">[docs]</a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filters selection by ``predicate``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects runs with duration equal to 2/8:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; inequality = abjad.DurationInequality(&#39;==&#39;, (2, 8))</span>
<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).runs().filter(inequality)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().runs().filter(inequality)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">predicate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)([</span><span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">predicate</span><span class="p">(</span><span class="n">_</span><span class="p">)])</span></div>

<div class="viewcode-block" id="Selection.filter_duration"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.filter_duration">[docs]</a>    <span class="k">def</span> <span class="nf">filter_duration</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">operator</span><span class="p">,</span>
        <span class="n">duration</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">DurationTyping</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">preprolated</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filters selection by ``operator`` and ``duration``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects runs with duration equal to 2/8:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).runs()</span>
<span class="sd">                &gt;&gt;&gt; result = result.filter_duration(&#39;==&#39;, (2, 8))</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().runs()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.filter_duration(&#39;==&#39;, (2, 8))</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects runs with duration less than 3/8:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).runs()</span>
<span class="sd">                &gt;&gt;&gt; result = result.filter_duration(&#39;&lt;&#39;, (3, 8))</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expresison</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().runs()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.filter_duration(&#39;&lt;&#39;, (3, 8))</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">inequality</span> <span class="o">=</span> <span class="n">DurationInequality</span><span class="p">(</span><span class="n">operator</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">preprolated</span><span class="o">=</span><span class="n">preprolated</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">inequality</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.filter_length"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.filter_length">[docs]</a>    <span class="k">def</span> <span class="nf">filter_length</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filters selection by ``operator`` and ``length``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects notes runs with length greater than 1:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).runs().filter_length(&#39;&gt;&#39;, 1)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().runs().filter_length(&#39;&gt;&#39;, 1)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects runs with length less than 3:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).runs().filter_length(&#39;&lt;&#39;, 3)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().runs().filter_length(&#39;&lt;&#39;, 3)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">LengthInequality</span><span class="p">(</span><span class="n">operator</span><span class="p">,</span> <span class="n">length</span><span class="p">))</span></div>

<div class="viewcode-block" id="Selection.filter_pitches"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.filter_pitches">[docs]</a>    <span class="k">def</span> <span class="nf">filter_pitches</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">pitches</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filters selection by ``operator`` and ``pitches``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects leaves with pitches intersecting C4:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 ~ d&#39;8 e&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; staff.extend(&quot;r8 &lt;c&#39; e&#39; g&#39;&gt;8 ~ &lt;c&#39; e&#39; g&#39;&gt;4&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.filter_pitches(&#39;&amp;&#39;, &#39;C4&#39;)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;8&quot;)</span>
<span class="sd">                Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;4&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.filter_pitches(&#39;&amp;&#39;, &#39;C4&#39;)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;8&quot;)</span>
<span class="sd">                Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;4&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    &lt;c&#39; e&#39; g&#39;&gt;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    &lt;c&#39; e&#39; g&#39;&gt;4</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects leaves with pitches intersecting C4 or E4:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 ~ d&#39;8 e&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; staff.extend(&quot;r8 &lt;c&#39; e&#39; g&#39;&gt;8 ~ &lt;c&#39; e&#39; g&#39;&gt;4&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.filter_pitches(&#39;&amp;&#39;, &#39;C4 E4&#39;)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;8&quot;)</span>
<span class="sd">                Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;4&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.filter_pitches(&#39;&amp;&#39;, &#39;C4 E4&#39;)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;8&quot;)</span>
<span class="sd">                Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;4&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    &lt;c&#39; e&#39; g&#39;&gt;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    &lt;c&#39; e&#39; g&#39;&gt;4</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects logical ties with pitches intersecting C4:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 ~ d&#39;8 e&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; staff.extend(&quot;r8 &lt;c&#39; e&#39; g&#39;&gt;8 ~ &lt;c&#39; e&#39; g&#39;&gt;4&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties()</span>
<span class="sd">                &gt;&gt;&gt; result = result.filter_pitches(&#39;&amp;&#39;, &#39;C4&#39;)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                LogicalTie([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;8&quot;), Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;4&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.filter_pitches(&#39;&amp;&#39;, &#39;C4&#39;)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                LogicalTie([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;8&quot;), Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;4&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    &lt;c&#39; e&#39; g&#39;&gt;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    &lt;c&#39; e&#39; g&#39;&gt;4</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">PitchInequality</span><span class="p">(</span><span class="n">operator</span><span class="p">,</span> <span class="n">pitches</span><span class="p">))</span></div>

<div class="viewcode-block" id="Selection.filter_preprolated"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.filter_preprolated">[docs]</a>    <span class="k">def</span> <span class="nf">filter_preprolated</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">DurationTyping</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filters selection by ``operator`` and preprolated ``duration``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects runs with duration equal to 2/8:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).runs()</span>
<span class="sd">                &gt;&gt;&gt; result = result.filter_preprolated(&#39;==&#39;, (2, 8))</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().runs()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.filter_preprolated(&#39;==&#39;, (2, 8))</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects runs with duration less than 3/8:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).runs()</span>
<span class="sd">                &gt;&gt;&gt; result = result.filter_preprolated(&#39;&lt;&#39;, (3, 8))</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expresison</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().runs()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.filter_preprolated(&#39;&lt;&#39;, (3, 8))</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">inequality</span> <span class="o">=</span> <span class="n">DurationInequality</span><span class="p">(</span><span class="n">operator</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">preprolated</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">inequality</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.flatten"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.flatten">[docs]</a>    <span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Flattens selection to ``depth``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects first two leaves of each tuplet:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; tuplets = [</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 c&#39;16 &lt;d&#39; e&#39;&gt;4 ~ &lt;d&#39; e&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 d&#39;16 &lt;e&#39; fs&#39;&gt;4 ~ &lt;e&#39; fs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 e&#39;16 &lt;fs&#39; gs&#39;&gt;4 ~ &lt;fs&#39; gs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     ]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = zip([(10, 9), (8, 9), (10, 9)], tuplets)</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.Tuplet(*_) for _ in tuplets]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.select(tuplets)]</span>
<span class="sd">                &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.rhythm(tuplets)</span>
<span class="sd">                &gt;&gt;&gt; staff = lilypond_file[abjad.Staff]</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.direction = abjad.Up</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.staff_padding = 3</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; getter = abjad.select().leaves()[:2]</span>
<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).tuplets().map(getter)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                Selection([Rest(&#39;r16&#39;), Note(&quot;bf&#39;16&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r16&#39;), Note(&quot;bf&#39;16&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r16&#39;), Note(&quot;bf&#39;16&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().tuplets().map(getter)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Rest(&#39;r16&#39;), Note(&quot;bf&#39;16&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r16&#39;), Note(&quot;bf&#39;16&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r16&#39;), Note(&quot;bf&#39;16&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(lilypond_file[abjad.Score], align_tags=89)</span>
<span class="sd">                \new Score</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new GlobalContext</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/4</span>
<span class="sd">                        s1 * 7/4</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override TupletBracket.direction = #up</span>
<span class="sd">                        \override TupletBracket.staff-padding = #3</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            r16</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 8/9 {</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            r16</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            d&#39;16</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            r16</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects first two leaves of all tuplets:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; tuplets = [</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 c&#39;16 &lt;d&#39; e&#39;&gt;4 ~ &lt;d&#39; e&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 d&#39;16 &lt;e&#39; fs&#39;&gt;4 ~ &lt;e&#39; fs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 e&#39;16 &lt;fs&#39; gs&#39;&gt;4 ~ &lt;fs&#39; gs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     ]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = zip([(10, 9), (8, 9), (10, 9)], tuplets)</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.Tuplet(*_) for _ in tuplets]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.select(tuplets)]</span>
<span class="sd">                &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.rhythm(tuplets)</span>
<span class="sd">                &gt;&gt;&gt; staff = lilypond_file[abjad.Staff]</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.direction = abjad.Up</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.staff_padding = 3</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; getter = abjad.select().leaves()[:2]</span>
<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).tuplets().map(getter)</span>
<span class="sd">                &gt;&gt;&gt; result = result.flatten()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                Rest(&#39;r16&#39;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Rest(&#39;r16&#39;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Rest(&#39;r16&#39;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().tuplets().map(getter).flatten()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Rest(&#39;r16&#39;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Rest(&#39;r16&#39;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Rest(&#39;r16&#39;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(lilypond_file[abjad.Score], align_tags=89)</span>
<span class="sd">                \new Score</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new GlobalContext</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/4</span>
<span class="sd">                        s1 * 7/4</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override TupletBracket.direction = #up</span>
<span class="sd">                        \override TupletBracket.staff-padding = #3</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            r16</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 8/9 {</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            r16</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            d&#39;16</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            r16</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">Sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="p">))</span></div>

<div class="viewcode-block" id="Selection.get"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">indices</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">Pattern</span><span class="p">],</span>
        <span class="n">period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets patterned items.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets every other leaf:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; string = r&quot;c&#39;8 d&#39;8 ~ d&#39;8 e&#39;8 ~ e&#39;8 ~ e&#39;8 r8 f&#39;8&quot;</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; for leaf in abjad.select(staff).leaves().get([0], 2):</span>
<span class="sd">                ...     leaf</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves().get([0], 2)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets every other logical tie:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; string = r&quot;c&#39;8 d&#39;8 ~ d&#39;8 e&#39;8 ~ e&#39;8 ~ e&#39;8 r8 f&#39;8&quot;</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; selection = abjad.select(staff).logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; for logical_tie in selection.get([0], 2):</span>
<span class="sd">                ...     logical_tie</span>
<span class="sd">                ...</span>
<span class="sd">                LogicalTie([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;e&#39;8&quot;), Note(&quot;e&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.get([0], 2)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                LogicalTie([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;e&#39;8&quot;), Note(&quot;e&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets note 1 (or nothing) in each pitched logical tie:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;c&#39;8 d&#39;8 ~ d&#39;8 e&#39;8 ~ e&#39;8 ~ e&#39;8 r8 f&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; getter = abjad.select().leaves().get([1])</span>
<span class="sd">                &gt;&gt;&gt; for selection in abjad.select(staff).logical_ties(</span>
<span class="sd">                ...     pitched=True,</span>
<span class="sd">                ...     ).map(getter):</span>
<span class="sd">                ...     selection</span>
<span class="sd">                ...</span>
<span class="sd">                Selection(items=())</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection(items=())</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; getter = abjad.select().leaves().get([1])</span>
<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.map(getter)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection(items=())</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection(items=())</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;8</span>
<span class="sd">                d&#39;8</span>
<span class="sd">                ~</span>
<span class="sd">                \abjad-color-music #&#39;blue</span>
<span class="sd">                d&#39;8</span>
<span class="sd">                e&#39;8</span>
<span class="sd">                ~</span>
<span class="sd">                \abjad-color-music #&#39;red</span>
<span class="sd">                e&#39;8</span>
<span class="sd">                ~</span>
<span class="sd">                e&#39;8</span>
<span class="sd">                r8</span>
<span class="sd">                f&#39;8</span>
<span class="sd">            }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">period</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="n">indices</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="n">Pattern</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">)</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_previous</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_previous</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="o">.</span><span class="n">retain_pattern</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">items</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_previous</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Selection.group"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.group">[docs]</a>    <span class="k">def</span> <span class="nf">group</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Groups selection.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&#39;&#39;&#39;</span>
<span class="sd">                ...     c&#39;8 ~ c&#39;16 c&#39;16 r8 c&#39;16 c&#39;16</span>
<span class="sd">                ...     d&#39;8 ~ d&#39;16 d&#39;16 r8 d&#39;16 d&#39;16</span>
<span class="sd">                ...     &#39;&#39;&#39;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff, align_tags=89) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves(pitched=True).group()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves(pitched=True).group()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Selection([Note(&quot;c&#39;8&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;)])])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff, align_tags=89) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">(),</span> <span class="n">lone</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_by</span><span class="p">()</span></div>

<div class="viewcode-block" id="Selection.group_by"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.group_by">[docs]</a>    <span class="k">def</span> <span class="nf">group_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Groups items in selection by ``predicate``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Wraps selection in selection when ``predicate`` is none:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     c&#39;8 ~ c&#39;16 c&#39;16 r8 c&#39;16 c&#39;16</span>
<span class="sd">                ...     d&#39;8 ~ d&#39;16 d&#39;16 r8 d&#39;16 d&#39;16</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; result = result.group_by()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves(pitched=True).group_by()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Selection([Note(&quot;c&#39;8&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;)])])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;green</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                }</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span>
                <span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">(),</span>
                <span class="n">evaluation_template</span><span class="o">=</span><span class="s2">&quot;group_by&quot;</span><span class="p">,</span>
                <span class="n">map_operand</span><span class="o">=</span><span class="n">predicate</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">predicate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">def</span> <span class="nf">predicate</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="n">pairs</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">group</span><span class="p">)</span>
            <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">items</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.group_by_contiguity"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.group_by_contiguity">[docs]</a>    <span class="k">def</span> <span class="nf">group_by_contiguity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Groups items in selection by contiguity.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Groups pitched leaves by contiguity:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; string = r&quot;c&#39;8 d&#39; r \times 2/3 { e&#39; r f&#39; } g&#39; a&#39; r&quot;</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; staff.extend(&quot;r8 &lt;c&#39; e&#39; g&#39;&gt;8 ~ &lt;c&#39; e&#39; g&#39;&gt;4&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; result = result.group_by_contiguity()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>
<span class="sd">                Selection([Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;8&quot;), Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;4&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.group_by_contiguity()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>
<span class="sd">                Selection([Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;8&quot;), Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;4&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        r8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    &lt;c&#39; e&#39; g&#39;&gt;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    &lt;c&#39; e&#39; g&#39;&gt;4</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Groups sixteenths by contiguity:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39;16 d&#39; d&#39; d&#39; e&#39;4 f&#39;16 f&#39; f&#39; f&#39;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.filter_duration(&#39;==&#39;, (1, 16))</span>
<span class="sd">                &gt;&gt;&gt; result = result.group_by_contiguity()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;16&quot;), Note(&quot;f&#39;16&quot;), Note(&quot;f&#39;16&quot;), Note(&quot;f&#39;16&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.filter_duration(&#39;==&#39;, (1, 16))</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.group_by_contiguity()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;16&quot;), Note(&quot;f&#39;16&quot;), Note(&quot;f&#39;16&quot;), Note(&quot;f&#39;16&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;16</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Groups short-duration logical ties by contiguity; then gets leaf 0</span>
<span class="sd">            in each group:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39;8 ~ d&#39;16 e&#39;16 ~ e&#39;8 f&#39;4 g&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties()</span>
<span class="sd">                &gt;&gt;&gt; result = result.filter_duration(&#39;&lt;&#39;, (1, 4))</span>
<span class="sd">                &gt;&gt;&gt; result = result.group_by_contiguity()</span>
<span class="sd">                &gt;&gt;&gt; result = result.map(abjad.select().leaves()[0])</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;g&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.filter_duration(&#39;&lt;&#39;, (1, 4))</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.group_by_contiguity()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.map(abjad.select().leaves()[0])</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;g&#39;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                    ~</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Groups pitched leaves pitch; then regroups each group by</span>
<span class="sd">            contiguity:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     c&#39;8 ~ c&#39;16 c&#39;16 r8 c&#39;16 c&#39;16</span>
<span class="sd">                ...     d&#39;8 ~ d&#39;16 d&#39;16 r8 d&#39;16 d&#39;16</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; result = result.group_by_pitch()</span>
<span class="sd">                &gt;&gt;&gt; result = result.map(abjad.select().group_by_contiguity())</span>
<span class="sd">                &gt;&gt;&gt; result = result.flatten()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.group_by_pitch()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.map(</span>
<span class="sd">                ...     abjad.select().group_by_contiguity()</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.flatten()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Groups pitched logical ties by contiguity; then regroups each group</span>
<span class="sd">            by pitch:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     c&#39;8 ~ c&#39;16 c&#39;16 r8 c&#39;16 c&#39;16</span>
<span class="sd">                ...     d&#39;8 ~ d&#39;16 d&#39;16 r8 d&#39;16 d&#39;16</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; getter = abjad.select().group_by_pitch()</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; result = result.group_by_contiguity()</span>
<span class="sd">                &gt;&gt;&gt; result = result.map(getter).flatten()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;8&quot;), Note(&quot;c&#39;16&quot;)]), LogicalTie([Note(&quot;c&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;16&quot;)]), LogicalTie([Note(&quot;c&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;16&quot;)]), LogicalTie([Note(&quot;d&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;d&#39;16&quot;)]), LogicalTie([Note(&quot;d&#39;16&quot;)])])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.group_by_contiguity()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.map(getter).flatten()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;8&quot;), Note(&quot;c&#39;16&quot;)]), LogicalTie([Note(&quot;c&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;16&quot;)]), LogicalTie([Note(&quot;c&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;16&quot;)]), LogicalTie([Note(&quot;d&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;d&#39;16&quot;)]), LogicalTie([Note(&quot;d&#39;16&quot;)])])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                }</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">selection</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Component</span><span class="p">,</span> <span class="n">Selection</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">selection</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">this_timespan</span> <span class="o">=</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">(</span><span class="n">selection</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">that_timespan</span> <span class="o">=</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">_get_timespan</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="c1"># remove displacement</span>
            <span class="n">this_stop_offset</span> <span class="o">=</span> <span class="n">this_timespan</span><span class="o">.</span><span class="n">stop_offset</span>
            <span class="n">this_stop_offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">this_stop_offset</span><span class="o">.</span><span class="n">pair</span><span class="p">)</span>
            <span class="n">that_start_offset</span> <span class="o">=</span> <span class="n">that_timespan</span><span class="o">.</span><span class="n">start_offset</span>
            <span class="n">that_start_offset</span> <span class="o">=</span> <span class="n">Offset</span><span class="p">(</span><span class="n">that_start_offset</span><span class="o">.</span><span class="n">pair</span><span class="p">)</span>
            <span class="c1"># if this_timespan.stop_offset == that_timespan.start_offset:</span>
            <span class="k">if</span> <span class="n">this_stop_offset</span> <span class="o">==</span> <span class="n">that_start_offset</span><span class="p">:</span>
                <span class="n">selection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">selection</span><span class="p">))</span>
                <span class="n">selection</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">selection</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">selection</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">result</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.group_by_duration"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.group_by_duration">[docs]</a>    <span class="k">def</span> <span class="nf">group_by_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Groups items in selection by duration.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Groups logical ties by duration:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; string = &quot;c&#39;4 ~ c&#39;16 d&#39; ~ d&#39; d&#39; e&#39;4 ~ e&#39;16 f&#39; ~ f&#39; f&#39;&quot;</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties()</span>
<span class="sd">                &gt;&gt;&gt; result = result.group_by_duration()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;4&quot;), Note(&quot;c&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;d&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;e&#39;4&quot;), Note(&quot;e&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;f&#39;16&quot;), Note(&quot;f&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;f&#39;16&quot;)])])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties().group_by_duration()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;4&quot;), Note(&quot;c&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;d&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;e&#39;4&quot;), Note(&quot;e&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;f&#39;16&quot;), Note(&quot;f&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;f&#39;16&quot;)])])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;16</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;16</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>

        <span class="k">def</span> <span class="nf">predicate</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">_get_duration</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.group_by_length"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.group_by_length">[docs]</a>    <span class="k">def</span> <span class="nf">group_by_length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Groups items in selection by length.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Groups logical ties by length:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; string = &quot;c&#39;4 ~ c&#39;16 d&#39; ~ d&#39; d&#39; e&#39;4 ~ e&#39;16 f&#39; ~ f&#39; f&#39;&quot;</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties().group_by_length()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;4&quot;), Note(&quot;c&#39;16&quot;)]), LogicalTie([Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;d&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;e&#39;4&quot;), Note(&quot;e&#39;16&quot;)]), LogicalTie([Note(&quot;f&#39;16&quot;), Note(&quot;f&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;f&#39;16&quot;)])])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties().group_by_length()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;4&quot;), Note(&quot;c&#39;16&quot;)]), LogicalTie([Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;d&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;e&#39;4&quot;), Note(&quot;e&#39;16&quot;)]), LogicalTie([Note(&quot;f&#39;16&quot;), Note(&quot;f&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;f&#39;16&quot;)])])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;16</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;16</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>

        <span class="k">def</span> <span class="nf">predicate</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">Leaf</span><span class="p">):</span>
                <span class="k">return</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.group_by_measure"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.group_by_measure">[docs]</a>    <span class="k">def</span> <span class="nf">group_by_measure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Groups items in selection by measure.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Groups leaves by measure:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39; e&#39; f&#39; g&#39; a&#39; b&#39; c&#39;&#39;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((2, 8)), staff[0])</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((3, 8)), staff[4])</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((1, 8)), staff[7])</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.group_by_measure()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;), Note(&quot;b&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;c&#39;&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.group_by_measure()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;), Note(&quot;b&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;c&#39;&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    b&#39;8</span>
<span class="sd">                    \time 1/8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    c&#39;&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Groups leaves by measure and joins pairs of consecutive groups:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39; e&#39; f&#39; g&#39; a&#39; b&#39; c&#39;&#39;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((2, 8)), staff[0])</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((3, 8)), staff[4])</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((1, 8)), staff[7])</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.group_by_measure()</span>
<span class="sd">                &gt;&gt;&gt; result = result.partition_by_counts([2], cyclic=True)</span>
<span class="sd">                &gt;&gt;&gt; result = result.map(abjad.select().flatten())</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;), Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;), Note(&quot;b&#39;8&quot;), Note(&quot;c&#39;&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.group_by_measure()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.partition_by_counts([2], cyclic=True)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.map(abjad.select().flatten())</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;), Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;), Note(&quot;b&#39;8&quot;), Note(&quot;c&#39;&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    b&#39;8</span>
<span class="sd">                    \time 1/8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    c&#39;&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Groups leaves by measure; then gets item 0 in each group:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39; e&#39; f&#39; g&#39; a&#39; b&#39; c&#39;&#39;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((2, 8)), staff[0])</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((3, 8)), staff[4])</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((1, 8)), staff[7])</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.group_by_measure()</span>
<span class="sd">                &gt;&gt;&gt; result = result.map(abjad.select()[0])</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;g&#39;8&quot;)</span>
<span class="sd">                Note(&quot;c&#39;&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.group_by_measure()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.map(abjad.select()[0])</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;g&#39;8&quot;)</span>
<span class="sd">                Note(&quot;c&#39;&#39;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    b&#39;8</span>
<span class="sd">                    \time 1/8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    c&#39;&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Groups leaves by measure; then gets item -1 in each group:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39; e&#39; f&#39; g&#39; a&#39; b&#39; c&#39;&#39;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((2, 8)), staff[0])</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((3, 8)), staff[4])</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((1, 8)), staff[7])</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.group_by_measure()</span>
<span class="sd">                &gt;&gt;&gt; result = result.map(abjad.select()[-1])</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;b&#39;8&quot;)</span>
<span class="sd">                Note(&quot;c&#39;&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.group_by_measure()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.map(abjad.select()[-1])</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;b&#39;8&quot;)</span>
<span class="sd">                Note(&quot;c&#39;&#39;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    b&#39;8</span>
<span class="sd">                    \time 1/8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    c&#39;&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Works with implicit time signatures:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39; g&#39; a&#39; b&#39; c&#39;&#39;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">                &gt;&gt;&gt; scheme = abjad.SchemeMoment((1, 16))</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(score).proportional_notation_duration = scheme</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(score).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.group_by_measure()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;4&quot;), Note(&quot;d&#39;4&quot;), Note(&quot;e&#39;4&quot;), Note(&quot;f&#39;4&quot;)])</span>
<span class="sd">                Selection([Note(&quot;g&#39;4&quot;), Note(&quot;a&#39;4&quot;), Note(&quot;b&#39;4&quot;), Note(&quot;c&#39;&#39;4&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.group_by_measure()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(score)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;4&quot;), Note(&quot;d&#39;4&quot;), Note(&quot;e&#39;4&quot;), Note(&quot;f&#39;4&quot;)])</span>
<span class="sd">                Selection([Note(&quot;g&#39;4&quot;), Note(&quot;a&#39;4&quot;), Note(&quot;b&#39;4&quot;), Note(&quot;c&#39;&#39;4&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    g&#39;4</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    a&#39;4</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    b&#39;4</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    c&#39;&#39;4</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Groups logical ties by measure:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39; ~ d&#39; e&#39; ~ e&#39; f&#39; g&#39; ~ g&#39;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((2, 8)), staff[0])</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((3, 8)), staff[4])</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(abjad.TimeSignature((1, 8)), staff[7])</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties()</span>
<span class="sd">                &gt;&gt;&gt; result = result.group_by_measure()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;8&quot;)]), LogicalTie([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;8&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;e&#39;8&quot;), Note(&quot;e&#39;8&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;f&#39;8&quot;)]), LogicalTie([Note(&quot;g&#39;8&quot;), Note(&quot;g&#39;8&quot;)])])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.group_by_measure()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;8&quot;)]), LogicalTie([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;8&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;e&#39;8&quot;), Note(&quot;e&#39;8&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;f&#39;8&quot;)]), LogicalTie([Note(&quot;g&#39;8&quot;), Note(&quot;g&#39;8&quot;)])])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 1/8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>

        <span class="k">def</span> <span class="nf">_get_first_component</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
            <span class="n">component</span> <span class="o">=</span> <span class="n">Selection</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span><span class="o">.</span><span class="n">components</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Component</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">component</span>

        <span class="k">def</span> <span class="nf">_get_measure_number</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
            <span class="n">first_component</span> <span class="o">=</span> <span class="n">_get_first_component</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">first_component</span><span class="o">.</span><span class="n">_measure_number</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="n">first_component</span><span class="o">.</span><span class="n">_measure_number</span>

        <span class="n">selections</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">first_component</span> <span class="o">=</span> <span class="n">_get_first_component</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">first_component</span><span class="o">.</span><span class="n">_update_measure_numbers</span><span class="p">()</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_get_measure_number</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">value</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
            <span class="n">selection</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">group</span><span class="p">)</span>
            <span class="n">selections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">selections</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.group_by_pitch"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.group_by_pitch">[docs]</a>    <span class="k">def</span> <span class="nf">group_by_pitch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Groups items in selection by pitches.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Groups logical ties by pitches:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; string = &quot;c&#39;4 ~ c&#39;16 d&#39; ~ d&#39; d&#39; e&#39;4 ~ e&#39;16 f&#39; ~ f&#39; f&#39;&quot;</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties().group_by_pitch()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;4&quot;), Note(&quot;c&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;)]), LogicalTie([Note(&quot;d&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;e&#39;4&quot;), Note(&quot;e&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;f&#39;16&quot;), Note(&quot;f&#39;16&quot;)]), LogicalTie([Note(&quot;f&#39;16&quot;)])])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties().group_by_pitch()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;4&quot;), Note(&quot;c&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;)]), LogicalTie([Note(&quot;d&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;e&#39;4&quot;), Note(&quot;e&#39;16&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;f&#39;16&quot;), Note(&quot;f&#39;16&quot;)]), LogicalTie([Note(&quot;f&#39;16&quot;)])])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;16</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;16</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;16</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>

        <span class="k">def</span> <span class="nf">predicate</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
            <span class="n">selection</span> <span class="o">=</span> <span class="n">Selection</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">PitchSet</span><span class="o">.</span><span class="n">from_selection</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.leaf"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.leaf">[docs]</a>    <span class="k">def</span> <span class="nf">leaf</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">exclude</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">Strings</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">grace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">head</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pitched</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prototype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">reverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tail</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">trim</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Leaf</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects leaf ``n``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects leaf -1:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; tuplets = [</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 c&#39;16 &lt;d&#39; e&#39;&gt;4 ~ &lt;d&#39; e&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 d&#39;16 &lt;e&#39; fs&#39;&gt;4 ~ &lt;e&#39; fs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 e&#39;16 &lt;fs&#39; gs&#39;&gt;4 ~ &lt;fs&#39; gs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     ]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = zip([(10, 9), (8, 9), (10, 9)], tuplets)</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.Tuplet(*_) for _ in tuplets]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.select(tuplets)]</span>
<span class="sd">                &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.rhythm(tuplets)</span>
<span class="sd">                &gt;&gt;&gt; staff = lilypond_file[abjad.Staff]</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.direction = abjad.Up</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.staff_padding = 3</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaf(-1)</span>

<span class="sd">                &gt;&gt;&gt; result</span>
<span class="sd">                Chord(&quot;&lt;fs&#39; gs&#39;&gt;16&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaf(-1)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Chord(&quot;&lt;fs&#39; gs&#39;&gt;16&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(lilypond_file[abjad.Score], align_tags=89)</span>
<span class="sd">                \new Score</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new GlobalContext</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/4</span>
<span class="sd">                        s1 * 7/4</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override TupletBracket.direction = #up</span>
<span class="sd">                        \override TupletBracket.staff-padding = #3</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 8/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            d&#39;16</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            \abjad-color-music #&#39;green</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">(),</span> <span class="n">lone</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span>
            <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span>
            <span class="n">grace</span><span class="o">=</span><span class="n">grace</span><span class="p">,</span>
            <span class="n">head</span><span class="o">=</span><span class="n">head</span><span class="p">,</span>
            <span class="n">pitched</span><span class="o">=</span><span class="n">pitched</span><span class="p">,</span>
            <span class="n">prototype</span><span class="o">=</span><span class="n">prototype</span><span class="p">,</span>
            <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">,</span>
            <span class="n">tail</span><span class="o">=</span><span class="n">tail</span><span class="p">,</span>
            <span class="n">trim</span><span class="o">=</span><span class="n">trim</span><span class="p">,</span>
        <span class="p">)[</span><span class="n">n</span><span class="p">]</span></div>

<div class="viewcode-block" id="Selection.leaves"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.leaves">[docs]</a>    <span class="k">def</span> <span class="nf">leaves</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">prototype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">exclude</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">Strings</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">grace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">head</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pitched</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">reverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tail</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">trim</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Selects leaves (without grace notes).</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects leaves:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     \times 2/3 { r8 d&#39; e&#39; } f&#39; r</span>
<span class="sd">                ...     r f&#39; \times 2/3 { e&#39; d&#39; r8 }</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        r8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        r8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects pitched leaves:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     \times 2/3 { r8 d&#39; e&#39; } f&#39; r</span>
<span class="sd">                ...     r f&#39; \times 2/3 { e&#39; d&#39; r8 }</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves(pitched=True)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        r8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        r8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Trimmed leaves are the correct selection for ottava brackets.</span>

<span class="sd">            Selects trimmed leaves:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     \times 2/3 { r8 d&#39; e&#39; } f&#39; r</span>
<span class="sd">                ...     r f&#39; \times 2/3 { e&#39; d&#39; r8 }</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves(trim=True)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves(trim=True)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.ottava(result)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        r8</span>
<span class="sd">                        \ottava 1</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \ottava 0</span>
<span class="sd">                        r8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Set ``trim`` to ``abjad.Left`` to trim rests at left (and preserve</span>
<span class="sd">            rests at right):</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     \times 2/3 { r8 d&#39; e&#39; } f&#39; r</span>
<span class="sd">                ...     r f&#39; \times 2/3 { e&#39; d&#39; r8 }</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves(trim=abjad.Left)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves(trim=abjad.Left)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.ottava(result)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        r8</span>
<span class="sd">                        \ottava 1</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        r8</span>
<span class="sd">                        \ottava 0</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            REGRESSION: selects trimmed leaves (even when there are no rests to</span>
<span class="sd">            trim):</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     \times 2/3 { c&#39;8 d&#39; e&#39; } f&#39; r</span>
<span class="sd">                ...     r f&#39; \times 2/3 { e&#39; d&#39; c&#39; }</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves(trim=True)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves(trim=True)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects leaves in tuplets:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     \times 2/3 { r8 d&#39; e&#39; } f&#39; r</span>
<span class="sd">                ...     r f&#39; \times 2/3 { e&#39; d&#39; r8 }</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).components(abjad.Tuplet)</span>
<span class="sd">                &gt;&gt;&gt; result = result.leaves()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().components(abjad.Tuplet)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        r8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    r8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        r8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects trimmed leaves in tuplets:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     \times 2/3 { r8 d&#39; e&#39; } f&#39; r</span>
<span class="sd">                ...     r f&#39; \times 2/3 { e&#39; d&#39; r8 }</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).components(abjad.Tuplet)</span>
<span class="sd">                &gt;&gt;&gt; result = result.leaves(trim=True)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().components(abjad.Tuplet)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.leaves(trim=True)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        r8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    r8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        r8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Pitched heads is the correct selection for most articulations.</span>

<span class="sd">            Selects pitched heads in tuplets:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     \times 2/3 { c&#39;8 d&#39; ~ d&#39; } e&#39; r</span>
<span class="sd">                ...     r e&#39; \times 2/3 { d&#39; ~ d&#39; c&#39; }</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).components(abjad.Tuplet)</span>
<span class="sd">                &gt;&gt;&gt; result = result.leaves(head=True, pitched=True)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().components(abjad.Tuplet)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.leaves(head=True, pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    r8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Pitched tails in the correct selection for laissez vibrer.</span>

<span class="sd">            Selects pitched tails in tuplets:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     \times 2/3 { c&#39;8 d&#39; ~ d&#39; } e&#39; r</span>
<span class="sd">                ...     r e&#39; \times 2/3 { d&#39; ~ d&#39; c&#39; }</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).components(abjad.Tuplet)</span>
<span class="sd">                &gt;&gt;&gt; result = result.leaves(tail=True, pitched=True)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.components(abjad.Tuplet)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.leaves(tail=True, pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    r8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Chord heads are the correct selection for arpeggios.</span>

<span class="sd">            Selects chord heads in tuplets:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     \times 2/3 { &lt;c&#39; e&#39; g&#39;&gt;8 ~ &lt;c&#39; e&#39; g&#39;&gt; d&#39; } e&#39; r</span>
<span class="sd">                ...     r &lt;g d&#39; fs&#39;&gt; \times 2/3 { e&#39; &lt;c&#39; d&#39;&gt; ~ &lt;c&#39; d&#39;&gt; }</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).components(abjad.Tuplet)</span>
<span class="sd">                &gt;&gt;&gt; result = result.leaves(abjad.Chord, head=True)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;8&quot;)</span>
<span class="sd">                Chord(&quot;&lt;c&#39; d&#39;&gt;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().components(abjad.Tuplet)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.leaves(abjad.Chord, head=True)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Chord(&quot;&lt;c&#39; e&#39; g&#39;&gt;8&quot;)</span>
<span class="sd">                Chord(&quot;&lt;c&#39; d&#39;&gt;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        &lt;c&#39; e&#39; g&#39;&gt;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        &lt;c&#39; e&#39; g&#39;&gt;8</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    r8</span>
<span class="sd">                    &lt;g d&#39; fs&#39;&gt;8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        &lt;c&#39; d&#39;&gt;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        &lt;c&#39; d&#39;&gt;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Excludes leaves with ``&quot;HIDDEN&quot;`` indicator:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     \times 2/3 { r8 d&#39; e&#39; } f&#39; r</span>
<span class="sd">                ...     r f&#39; \times 2/3 { e&#39; d&#39; r8 }</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(&quot;HIDDEN&quot;, staff[-1][-2])</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(&quot;HIDDEN&quot;, staff[-1][-1])</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves(exclude=&quot;HIDDEN&quot;)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves(exclude=&quot;HIDDEN&quot;)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        r8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        r8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects both main notes and graces when ``grace=None``:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cf&#39;&#39;16 bf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.AfterGraceContainer(&quot;af&#39;16 gf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                ..  docs::</span>

<span class="sd">                    &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            cf&#39;&#39;16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        {</span>
<span class="sd">                            af&#39;16</span>
<span class="sd">                            gf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves(grace=None)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;cf&#39;&#39;16&quot;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;af&#39;16&quot;)</span>
<span class="sd">                Note(&quot;gf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves(grace=None)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;cf&#39;&#39;16&quot;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;af&#39;16&quot;)</span>
<span class="sd">                Note(&quot;gf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \grace {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        cf&#39;&#39;16</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        bf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    \afterGrace</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        af&#39;16</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        gf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Excludes grace notes when ``grace=False``:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cf&#39;&#39;16 bf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.AfterGraceContainer(&quot;af&#39;16 gf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                ..  docs::</span>

<span class="sd">                    &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            cf&#39;&#39;16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        {</span>
<span class="sd">                            af&#39;16</span>
<span class="sd">                            gf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves(grace=False)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves(grace=False)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;8&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \grace {</span>
<span class="sd">                        cf&#39;&#39;16</span>
<span class="sd">                        bf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    \afterGrace</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    {</span>
<span class="sd">                        af&#39;16</span>
<span class="sd">                        gf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects only grace notes when ``grace=True``:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cf&#39;&#39;16 bf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.AfterGraceContainer(&quot;af&#39;16 gf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                ..  docs::</span>

<span class="sd">                    &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            cf&#39;&#39;16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        {</span>
<span class="sd">                            af&#39;16</span>
<span class="sd">                            gf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves(grace=True)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;cf&#39;&#39;16&quot;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;af&#39;16&quot;)</span>
<span class="sd">                Note(&quot;gf&#39;16&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves(grace=True)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;cf&#39;&#39;16&quot;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;af&#39;16&quot;)</span>
<span class="sd">                Note(&quot;gf&#39;16&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \grace {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        cf&#39;&#39;16</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        bf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \afterGrace</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        af&#39;16</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        gf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">assert</span> <span class="n">trim</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">enums</span><span class="o">.</span><span class="n">Left</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">pitched</span><span class="p">:</span>
            <span class="n">prototype</span> <span class="o">=</span> <span class="p">(</span><span class="n">Chord</span><span class="p">,</span> <span class="n">Note</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">prototype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prototype</span> <span class="o">=</span> <span class="n">Leaf</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">prototype</span><span class="o">=</span><span class="n">prototype</span><span class="p">,</span>
            <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span>
            <span class="n">grace</span><span class="o">=</span><span class="n">grace</span><span class="p">,</span>
            <span class="n">head</span><span class="o">=</span><span class="n">head</span><span class="p">,</span>
            <span class="n">tail</span><span class="o">=</span><span class="n">tail</span><span class="p">,</span>
            <span class="n">trim</span><span class="o">=</span><span class="n">trim</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Selection.logical_tie"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.logical_tie">[docs]</a>    <span class="k">def</span> <span class="nf">logical_tie</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">exclude</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">Strings</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">grace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">nontrivial</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pitched</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">reverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Leaf</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        ..  todo:: Make work on nonhead leaves.</span>

<span class="sd">        ..  todo:: Write examples.</span>

<span class="sd">        ..  todo:: Remove ``abjad.get.logical_tie()``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">(),</span> <span class="n">lone</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">logical_ties</span><span class="p">(</span>
            <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span>
            <span class="n">grace</span><span class="o">=</span><span class="n">grace</span><span class="p">,</span>
            <span class="n">nontrivial</span><span class="o">=</span><span class="n">nontrivial</span><span class="p">,</span>
            <span class="n">pitched</span><span class="o">=</span><span class="n">pitched</span><span class="p">,</span>
            <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">,</span>
        <span class="p">)[</span><span class="n">n</span><span class="p">]</span></div>

<div class="viewcode-block" id="Selection.logical_ties"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.logical_ties">[docs]</a>    <span class="k">def</span> <span class="nf">logical_ties</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">exclude</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">Strings</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">grace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">nontrivial</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pitched</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">reverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Selects logical ties (without grace notes).</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects logical ties:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39; ~ { d&#39; e&#39; r f&#39;~ } f&#39; r&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                LogicalTie([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Rest(&#39;r8&#39;)])</span>
<span class="sd">                LogicalTie([Note(&quot;f&#39;8&quot;), Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Rest(&#39;r8&#39;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                LogicalTie([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Rest(&#39;r8&#39;)])</span>
<span class="sd">                LogicalTie([Note(&quot;f&#39;8&quot;), Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Rest(&#39;r8&#39;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        r8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects pitched logical ties:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39; ~ { d&#39; e&#39; r f&#39;~ } f&#39; r&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties(pitched=True)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                LogicalTie([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;f&#39;8&quot;), Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                LogicalTie([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;f&#39;8&quot;), Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        r8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects pitched nontrivial logical ties:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39; ~ { d&#39; e&#39; r f&#39;~ } f&#39; r&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties(</span>
<span class="sd">                ...     pitched=True,</span>
<span class="sd">                ...     nontrivial=True,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                LogicalTie([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;f&#39;8&quot;), Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties(</span>
<span class="sd">                ...     pitched=True,</span>
<span class="sd">                ...     nontrivial=True,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                LogicalTie([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;f&#39;8&quot;), Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        r8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects pitched logical ties (starting) in each tuplet:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     \times 2/3 { c&#39;8 d&#39; e&#39;  ~ } e&#39; f&#39; ~</span>
<span class="sd">                ...     \times 2/3 { f&#39; g&#39; a&#39; ~ } a&#39; b&#39; ~</span>
<span class="sd">                ...     \times 2/3 { b&#39; c&#39;&#39; d&#39;&#39; }</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; getter = abjad.select().logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).components(abjad.Tuplet)</span>
<span class="sd">                &gt;&gt;&gt; result = result.map(getter)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;8&quot;)]), LogicalTie([Note(&quot;d&#39;8&quot;)]), LogicalTie([Note(&quot;e&#39;8&quot;), Note(&quot;e&#39;8&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;g&#39;8&quot;)]), LogicalTie([Note(&quot;a&#39;8&quot;), Note(&quot;a&#39;8&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;&#39;8&quot;)]), LogicalTie([Note(&quot;d&#39;&#39;8&quot;)])])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().components(abjad.Tuplet)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.map(getter)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;8&quot;)]), LogicalTie([Note(&quot;d&#39;8&quot;)]), LogicalTie([Note(&quot;e&#39;8&quot;), Note(&quot;e&#39;8&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;g&#39;8&quot;)]), LogicalTie([Note(&quot;a&#39;8&quot;), Note(&quot;a&#39;8&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;&#39;8&quot;)]), LogicalTie([Note(&quot;d&#39;&#39;8&quot;)])])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        g&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        a&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    b&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        b&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects pitched logical ties (starting) in each of the last two</span>
<span class="sd">            tuplets:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     \times 2/3 { c&#39;8 d&#39; e&#39;  ~ } e&#39; f&#39; ~</span>
<span class="sd">                ...     \times 2/3 { f&#39; g&#39; a&#39; ~ } a&#39; b&#39; ~</span>
<span class="sd">                ...     \times 2/3 { b&#39; c&#39;&#39; d&#39;&#39; }</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; getter = abjad.select().logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).components(abjad.Tuplet)[-2:]</span>
<span class="sd">                &gt;&gt;&gt; result = result.map(getter)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;g&#39;8&quot;)]), LogicalTie([Note(&quot;a&#39;8&quot;), Note(&quot;a&#39;8&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;&#39;8&quot;)]), LogicalTie([Note(&quot;d&#39;&#39;8&quot;)])])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().components(abjad.Tuplet)[-2:]</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.map(getter)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;g&#39;8&quot;)]), LogicalTie([Note(&quot;a&#39;8&quot;), Note(&quot;a&#39;8&quot;)])])</span>
<span class="sd">                Selection([LogicalTie([Note(&quot;c&#39;&#39;8&quot;)]), LogicalTie([Note(&quot;d&#39;&#39;8&quot;)])])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        g&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        a&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    b&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        b&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        c&#39;&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects both main notes and graces when ``grace=None``:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cf&#39;&#39;16 bf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.AfterGraceContainer(&quot;af&#39;16 gf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                ..  docs::</span>

<span class="sd">                    &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            cf&#39;&#39;16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        {</span>
<span class="sd">                            af&#39;16</span>
<span class="sd">                            gf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties(grace=None)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                LogicalTie([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;cf&#39;&#39;16&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;bf&#39;16&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;af&#39;16&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;gf&#39;16&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties(grace=None)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                LogicalTie([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;cf&#39;&#39;16&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;bf&#39;16&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;af&#39;16&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;gf&#39;16&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \grace {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        cf&#39;&#39;16</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        bf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    \afterGrace</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        af&#39;16</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        gf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Excludes grace notes when ``grace=False``:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cf&#39;&#39;16 bf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.AfterGraceContainer(&quot;af&#39;16 gf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                ..  docs::</span>

<span class="sd">                    &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            cf&#39;&#39;16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        {</span>
<span class="sd">                            af&#39;16</span>
<span class="sd">                            gf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties(grace=False)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                LogicalTie([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties(grace=False)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                LogicalTie([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \grace {</span>
<span class="sd">                        cf&#39;&#39;16</span>
<span class="sd">                        bf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    \afterGrace</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    {</span>
<span class="sd">                        af&#39;16</span>
<span class="sd">                        gf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects only grace notes when ``grace=True``:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cf&#39;&#39;16 bf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; container = abjad.AfterGraceContainer(&quot;af&#39;16 gf&#39;16&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(container, staff[1])</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                ..  docs::</span>

<span class="sd">                    &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            cf&#39;&#39;16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        {</span>
<span class="sd">                            af&#39;16</span>
<span class="sd">                            gf&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties(grace=True)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                LogicalTie([Note(&quot;cf&#39;&#39;16&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;bf&#39;16&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;af&#39;16&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;gf&#39;16&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties(grace=True)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                LogicalTie([Note(&quot;cf&#39;&#39;16&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;bf&#39;16&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;af&#39;16&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;gf&#39;16&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \grace {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        cf&#39;&#39;16</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        bf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \afterGrace</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        af&#39;16</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        gf&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            STATAL SELECTOR WITH PATTERN.  Note that this currently only works</span>
<span class="sd">            with pattern objects; slices and integer indices do not work yet.</span>

<span class="sd">            Selector configured for logical ties 4, 5, 6, 7:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39; ~ { d&#39; e&#39; r f&#39;~ } f&#39; r&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties()</span>
<span class="sd">                &gt;&gt;&gt; result = result.get([4, 5, 6, 7])</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                LogicalTie([Note(&quot;f&#39;8&quot;), Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Rest(&#39;r8&#39;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.get([4, 5, 6, 7])</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                LogicalTie([Note(&quot;f&#39;8&quot;), Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Rest(&#39;r8&#39;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    {</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        r8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>

<span class="sd">            Selects logical ties 4 and 5 on first call.</span>

<span class="sd">            Setting ``previous`` effects statal outcome:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39; ~ { d&#39; e&#39; r f&#39;~ } f&#39; r&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; logical_ties = abjad.select(staff).logical_ties()</span>
<span class="sd">                &gt;&gt;&gt; previous = len(logical_ties)</span>
<span class="sd">                &gt;&gt;&gt; previous</span>
<span class="sd">                6</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff, previous=previous)</span>
<span class="sd">                &gt;&gt;&gt; result = result.logical_ties().get([4, 5, 6, 7])</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                LogicalTie([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select(previous=previous)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.logical_ties().get([4, 5, 6, 7])</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                LogicalTie([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                LogicalTie([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        r8</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>

<span class="sd">            Selects logical ties 6 and 7 on second call.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="c1"># generator = Iteration(self).logical_ties(</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="n">_iterate</span><span class="o">.</span><span class="n">_iterate_logical_ties</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span>
            <span class="n">grace</span><span class="o">=</span><span class="n">grace</span><span class="p">,</span>
            <span class="n">nontrivial</span><span class="o">=</span><span class="n">nontrivial</span><span class="p">,</span>
            <span class="n">pitched</span><span class="o">=</span><span class="n">pitched</span><span class="p">,</span>
            <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">,</span>
            <span class="n">wrapper_class</span><span class="o">=</span><span class="n">LogicalTie</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">generator</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_previous</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.map"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.map">[docs]</a>    <span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Maps ``expression`` to items in selection.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects each tuplet as a separate selection:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     \times 2/3 { r8 d&#39; e&#39; } f&#39; r</span>
<span class="sd">                ...     r f&#39; \times 2/3 { e&#39; d&#39; r8 }</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).components(abjad.Tuplet)</span>
<span class="sd">                &gt;&gt;&gt; result = result.map(abjad.select())</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Tuplet(&#39;3:2&#39;, &quot;r8 d&#39;8 e&#39;8&quot;)])</span>
<span class="sd">                Selection([Tuplet(&#39;3:2&#39;, &quot;e&#39;8 d&#39;8 r8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().components(abjad.Tuplet)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.map(abjad.select())</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Tuplet(&#39;3:2&#39;, &quot;r8 d&#39;8 e&#39;8&quot;)])</span>
<span class="sd">                Selection([Tuplet(&#39;3:2&#39;, &quot;e&#39;8 d&#39;8 r8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        r8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    r8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        r8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects leaves in each component:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;&quot;&quot;</span>
<span class="sd">                ...     \times 2/3 { r8 d&#39; e&#39; } f&#39; r</span>
<span class="sd">                ...     r f&#39; \times 2/3 { e&#39; d&#39; r8 }</span>
<span class="sd">                ...     &quot;&quot;&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = staff[:].map(abjad.select().leaves())</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Note(&quot;d&#39;8&quot;), Rest(&#39;r8&#39;)])</span>

<span class="sd">            ..  container:: example expression:</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().map(abjad.select().leaves())</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff[:])</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Note(&quot;d&#39;8&quot;), Rest(&#39;r8&#39;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        r8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        r8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets item 0 in each note run:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; string = r&quot;c&#39;4 \times 2/3 { d&#39;8 r8 e&#39;8 } r16 f&#39;16 g&#39;8 a&#39;4&quot;</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).runs()</span>
<span class="sd">                &gt;&gt;&gt; result = result.map(abjad.select()[0])</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;c&#39;4&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;16&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().runs()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.map(abjad.select()[0])</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;c&#39;4&quot;)</span>
<span class="sd">                Note(&quot;e&#39;8&quot;)</span>
<span class="sd">                Note(&quot;f&#39;16&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                        r8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    r16</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;16</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;4</span>
<span class="sd">                }</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span>
                <span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">(),</span>
                <span class="n">evaluation_template</span><span class="o">=</span><span class="s2">&quot;map&quot;</span><span class="p">,</span>
                <span class="n">map_operand</span><span class="o">=</span><span class="n">expression</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">expression</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)([</span><span class="n">expression</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span></div>

<div class="viewcode-block" id="Selection.nontrivial"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.nontrivial">[docs]</a>    <span class="k">def</span> <span class="nf">nontrivial</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filters selection by length greater than 1.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects nontrivial runs:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).runs().nontrivial()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().runs().nontrivial()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_length</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.note"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.note">[docs]</a>    <span class="k">def</span> <span class="nf">note</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">Strings</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">grace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Note</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects note ``n``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects note -1:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; tuplets = [</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 c&#39;16 &lt;d&#39; e&#39;&gt;4 ~ &lt;d&#39; e&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 d&#39;16 &lt;e&#39; fs&#39;&gt;4 ~ &lt;e&#39; fs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 e&#39;16 &lt;fs&#39; gs&#39;&gt;4 ~ &lt;fs&#39; gs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     ]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = zip([(10, 9), (8, 9), (10, 9)], tuplets)</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.Tuplet(*_) for _ in tuplets]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.select(tuplets)]</span>
<span class="sd">                &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.rhythm(tuplets)</span>
<span class="sd">                &gt;&gt;&gt; staff = lilypond_file[abjad.Staff]</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.direction = abjad.Up</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.staff_padding = 3</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).note(-1)</span>

<span class="sd">                &gt;&gt;&gt; result</span>
<span class="sd">                Note(&quot;e&#39;16&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().note(-1)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;e&#39;16&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(lilypond_file[abjad.Score], align_tags=89)</span>
<span class="sd">                \new Score</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new GlobalContext</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/4</span>
<span class="sd">                        s1 * 7/4</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override TupletBracket.direction = #up</span>
<span class="sd">                        \override TupletBracket.staff-padding = #3</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 8/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            d&#39;16</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            \abjad-color-music #&#39;green</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">(),</span> <span class="n">lone</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">notes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span> <span class="n">grace</span><span class="o">=</span><span class="n">grace</span><span class="p">)[</span><span class="n">n</span><span class="p">]</span></div>

<div class="viewcode-block" id="Selection.notes"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.notes">[docs]</a>    <span class="k">def</span> <span class="nf">notes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">Strings</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">grace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects notes.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects notes:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; tuplets = [</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 c&#39;16 &lt;d&#39; e&#39;&gt;4 ~ &lt;d&#39; e&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 d&#39;16 &lt;e&#39; fs&#39;&gt;4 ~ &lt;e&#39; fs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 e&#39;16 &lt;fs&#39; gs&#39;&gt;4 ~ &lt;fs&#39; gs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     ]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = zip([(10, 9), (8, 9), (10, 9)], tuplets)</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.Tuplet(*_) for _ in tuplets]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.select(tuplets)]</span>
<span class="sd">                &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.rhythm(tuplets)</span>
<span class="sd">                &gt;&gt;&gt; staff = lilypond_file[abjad.Staff]</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.direction = abjad.Up</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.staff_padding = 3</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).notes()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;c&#39;16&quot;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;d&#39;16&quot;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;e&#39;16&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().notes()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;c&#39;16&quot;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;d&#39;16&quot;)</span>
<span class="sd">                Note(&quot;bf&#39;16&quot;)</span>
<span class="sd">                Note(&quot;e&#39;16&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(lilypond_file[abjad.Score], align_tags=89)</span>
<span class="sd">                \new Score</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new GlobalContext</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/4</span>
<span class="sd">                        s1 * 7/4</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override TupletBracket.direction = #up</span>
<span class="sd">                        \override TupletBracket.staff-padding = #3</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 8/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            d&#39;16</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">Note</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span> <span class="n">grace</span><span class="o">=</span><span class="n">grace</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.partition_by_counts"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.partition_by_counts">[docs]</a>    <span class="k">def</span> <span class="nf">partition_by_counts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">counts</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">cyclic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">enchain</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fuse_overhang</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">nonempty</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">overhang</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Partitions selection by ``counts``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Partitions leaves into a single part of length 3; truncates</span>
<span class="sd">            overhang:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.partition_by_counts(</span>
<span class="sd">                ...     [3],</span>
<span class="sd">                ...     cyclic=False,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.partition_by_counts(</span>
<span class="sd">                ...     [3],</span>
<span class="sd">                ...     cyclic=False,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Cyclically partitions leaves into parts of length 3; truncates</span>
<span class="sd">            overhang:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves().partition_by_counts(</span>
<span class="sd">                ...     [3],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves().partition_by_counts(</span>
<span class="sd">                ...     [3],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Cyclically partitions leaves into parts of length 3; returns</span>
<span class="sd">            overhang at end:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves().partition_by_counts(</span>
<span class="sd">                ...     [3],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     overhang=True,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves().partition_by_counts(</span>
<span class="sd">                ...     [3],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     overhang=True,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Cyclically partitions leaves into parts of length 3; fuses overhang</span>
<span class="sd">            to last part:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves().partition_by_counts(</span>
<span class="sd">                ...     [3],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     fuse_overhang=True,</span>
<span class="sd">                ...     overhang=True,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves().partition_by_counts(</span>
<span class="sd">                ...     [3],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     fuse_overhang=True,</span>
<span class="sd">                ...     overhang=True,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Cyclically partitions leaves into parts of length 3; returns</span>
<span class="sd">            overhang at end:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; string = &quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8 b&#39;8 r8 c&#39;&#39;8&quot;</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves().partition_by_counts(</span>
<span class="sd">                ...     [1, 2, 3],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     overhang=True,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;g&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;a&#39;8&quot;), Note(&quot;b&#39;8&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;), Note(&quot;c&#39;&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves().partition_by_counts(</span>
<span class="sd">                ...     [1, 2, 3],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     overhang=True,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;g&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;a&#39;8&quot;), Note(&quot;b&#39;8&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;), Note(&quot;c&#39;&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector, [&quot;red&quot;, &quot;blue&quot;, &quot;cyan&quot;])</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;cyan</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;cyan</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;cyan</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    b&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;cyan</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;cyan</span>
<span class="sd">                    c&#39;&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            With negative ``counts``.</span>

<span class="sd">            Partitions leaves alternately into parts 2 and -3 (without</span>
<span class="sd">            overhang):</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; string = &quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8 b&#39;8 r8 c&#39;&#39;8&quot;</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves().partition_by_counts(</span>
<span class="sd">                ...     [2, -3],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves().partition_by_counts(</span>
<span class="sd">                ...     [2, -3],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    b&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    c&#39;&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            With negative ``counts``.</span>

<span class="sd">            Partitions leaves alternately into parts 2 and -3 (with overhang):</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; string = &quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8 b&#39;8 r8 c&#39;&#39;8&quot;</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves().partition_by_counts(</span>
<span class="sd">                ...     [2, -3],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     overhang=True,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;c&#39;&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves().partition_by_counts(</span>
<span class="sd">                ...     [2, -3],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     overhang=True,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;c&#39;&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    b&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            REGRESSION. Noncyclic counts work when ``overhang`` is true:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; string = &quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8 b&#39;8 r8 c&#39;&#39;8&quot;</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves().partition_by_counts(</span>
<span class="sd">                ...     [3],</span>
<span class="sd">                ...     overhang=True,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;), Note(&quot;b&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;c&#39;&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves().partition_by_counts(</span>
<span class="sd">                ...     [3],</span>
<span class="sd">                ...     overhang=True,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;), Note(&quot;b&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;c&#39;&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    b&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    c&#39;&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">partition_by_counts</span><span class="p">(</span>
            <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">],</span>
            <span class="n">cyclic</span><span class="o">=</span><span class="n">cyclic</span><span class="p">,</span>
            <span class="n">enchain</span><span class="o">=</span><span class="n">enchain</span><span class="p">,</span>
            <span class="n">overhang</span><span class="o">=</span><span class="n">overhang</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">overhang</span> <span class="ow">and</span> <span class="n">fuse_overhang</span> <span class="ow">and</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">):</span>
            <span class="n">last_count</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">counts</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">!=</span> <span class="n">last_count</span><span class="p">:</span>
                <span class="n">last_group</span> <span class="o">=</span> <span class="n">groups</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">groups</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">last_group</span>
        <span class="n">subresult</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">cyclic</span><span class="p">:</span>
            <span class="n">counts</span> <span class="o">=</span> <span class="n">CyclicTuple</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">groups</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">overhang</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">==</span> <span class="n">total</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">count</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="n">items</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">group</span><span class="p">)</span>
            <span class="n">subresult</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nonempty</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">subresult</span><span class="p">:</span>
            <span class="n">group</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">subresult</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">subresult</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">result</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.partition_by_durations"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.partition_by_durations">[docs]</a>    <span class="k">def</span> <span class="nf">partition_by_durations</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">durations</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">cyclic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">in_seconds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">overhang</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Partitions selection by ``durations``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Cyclically partitions leaves into parts equal to exactly 3/8;</span>
<span class="sd">            returns overhang at end:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff([</span>
<span class="sd">                ...     abjad.Container(&quot;c&#39;8 d&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;e&#39;8 f&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;g&#39;8 a&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;b&#39;8 c&#39;&#39;&quot;),</span>
<span class="sd">                ... ])</span>
<span class="sd">                &gt;&gt;&gt; for container in staff:</span>
<span class="sd">                ...     time_signature = abjad.TimeSignature((2, 8))</span>
<span class="sd">                ...     abjad.attach(time_signature, container[0])</span>
<span class="sd">                ...</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves().partition_by_durations(</span>
<span class="sd">                ...     [abjad.Duration(3, 8)],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     fill=abjad.Exact,</span>
<span class="sd">                ...     in_seconds=False,</span>
<span class="sd">                ...     overhang=True,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;b&#39;8&quot;), Note(&quot;c&#39;&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves().partition_by_durations(</span>
<span class="sd">                ...     [abjad.Duration(3, 8)],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     fill=abjad.Exact,</span>
<span class="sd">                ...     in_seconds=False,</span>
<span class="sd">                ...     overhang=True,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;b&#39;8&quot;), Note(&quot;c&#39;&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        g&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        a&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        b&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Partitions leaves into one part equal to exactly 3/8; truncates</span>
<span class="sd">            overhang:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff([</span>
<span class="sd">                ...     abjad.Container(&quot;c&#39;8 d&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;e&#39;8 f&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;g&#39;8 a&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;b&#39;8 c&#39;&#39;&quot;),</span>
<span class="sd">                ... ])</span>
<span class="sd">                &gt;&gt;&gt; for container in staff:</span>
<span class="sd">                ...     time_signature = abjad.TimeSignature((2, 8))</span>
<span class="sd">                ...     abjad.attach(time_signature, container[0])</span>
<span class="sd">                ...</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.partition_by_durations(</span>
<span class="sd">                ...     [abjad.Duration(3, 8)],</span>
<span class="sd">                ...     cyclic=False,</span>
<span class="sd">                ...     fill=abjad.Exact,</span>
<span class="sd">                ...     in_seconds=False,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.partition_by_durations(</span>
<span class="sd">                ...     [abjad.Duration(3, 8)],</span>
<span class="sd">                ...     cyclic=False,</span>
<span class="sd">                ...     fill=abjad.Exact,</span>
<span class="sd">                ...     in_seconds=False,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        g&#39;8</span>
<span class="sd">                        a&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        b&#39;8</span>
<span class="sd">                        c&#39;&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Cyclically partitions leaves into parts equal to (or just less</span>
<span class="sd">            than) 3/16 and 1/16; returns overhang at end:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff([</span>
<span class="sd">                ...     abjad.Container(&quot;c&#39;8 d&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;e&#39;8 f&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;g&#39;8 a&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;b&#39;8 c&#39;&#39;&quot;),</span>
<span class="sd">                ... ])</span>
<span class="sd">                &gt;&gt;&gt; for container in staff:</span>
<span class="sd">                ...     time_signature = abjad.TimeSignature((2, 8))</span>
<span class="sd">                ...     abjad.attach(time_signature, container[0])</span>
<span class="sd">                ...</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.partition_by_durations(</span>
<span class="sd">                ...     [abjad.Duration(3, 16), abjad.Duration(1, 16)],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     fill=abjad.More,</span>
<span class="sd">                ...     in_seconds=False,</span>
<span class="sd">                ...     overhang=True,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;a&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;b&#39;8&quot;), Note(&quot;c&#39;&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.partition_by_durations(</span>
<span class="sd">                ...     [abjad.Duration(3, 16), abjad.Duration(1, 16)],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     fill=abjad.More,</span>
<span class="sd">                ...     in_seconds=False,</span>
<span class="sd">                ...     overhang=True,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;a&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;b&#39;8&quot;), Note(&quot;c&#39;&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        g&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        a&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        b&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Cyclically partitions leaves into parts equal to (or just less</span>
<span class="sd">            than) 3/16; truncates overhang:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff([</span>
<span class="sd">                ...     abjad.Container(&quot;c&#39;8 d&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;e&#39;8 f&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;g&#39;8 a&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;b&#39;8 c&#39;&#39;&quot;),</span>
<span class="sd">                ... ])</span>
<span class="sd">                &gt;&gt;&gt; for container in staff:</span>
<span class="sd">                ...     time_signature = abjad.TimeSignature((2, 8))</span>
<span class="sd">                ...     abjad.attach(time_signature, container[0])</span>
<span class="sd">                ...</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.partition_by_durations(</span>
<span class="sd">                ...     [abjad.Duration(3, 16)],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     fill=abjad.Less,</span>
<span class="sd">                ...     in_seconds=False,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;g&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;a&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;b&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.partition_by_durations(</span>
<span class="sd">                ...     [abjad.Duration(3, 16)],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     fill=abjad.Less,</span>
<span class="sd">                ...     in_seconds=False,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;g&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;a&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;b&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        g&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        a&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        b&#39;8</span>
<span class="sd">                        c&#39;&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Partitions leaves into a single part equal to (or just less than)</span>
<span class="sd">            3/16; truncates overhang:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff([</span>
<span class="sd">                ...     abjad.Container(&quot;c&#39;8 d&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;e&#39;8 f&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;g&#39;8 a&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;b&#39;8 c&#39;&#39;&quot;),</span>
<span class="sd">                ... ])</span>
<span class="sd">                &gt;&gt;&gt; for container in staff:</span>
<span class="sd">                ...     time_signature = abjad.TimeSignature((2, 8))</span>
<span class="sd">                ...     abjad.attach(time_signature, container[0])</span>
<span class="sd">                ...</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.partition_by_durations(</span>
<span class="sd">                ...     [abjad.Duration(3, 16)],</span>
<span class="sd">                ...     cyclic=False,</span>
<span class="sd">                ...     fill=abjad.Less,</span>
<span class="sd">                ...     in_seconds=False,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.partition_by_durations(</span>
<span class="sd">                ...     [abjad.Duration(3, 16)],</span>
<span class="sd">                ...     cyclic=False,</span>
<span class="sd">                ...     fill=abjad.Less,</span>
<span class="sd">                ...     in_seconds=False,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        g&#39;8</span>
<span class="sd">                        a&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        b&#39;8</span>
<span class="sd">                        c&#39;&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Cyclically partitions leaves into parts equal to exactly 1.5</span>
<span class="sd">            seconds; truncates overhang:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff([</span>
<span class="sd">                ...     abjad.Container(&quot;c&#39;8 d&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;e&#39;8 f&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;g&#39;8 a&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;b&#39;8 c&#39;&#39;&quot;),</span>
<span class="sd">                ... ])</span>
<span class="sd">                &gt;&gt;&gt; for container in staff:</span>
<span class="sd">                ...     time_signature = abjad.TimeSignature((2, 8))</span>
<span class="sd">                ...     abjad.attach(time_signature, container[0])</span>
<span class="sd">                ...</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; mark = abjad.MetronomeMark((1, 4), 60)</span>
<span class="sd">                &gt;&gt;&gt; leaf = abjad.get.leaf(staff, 0)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(mark, leaf, context=&#39;Staff&#39;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.partition_by_durations(</span>
<span class="sd">                ...     [1.5],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     fill=abjad.Exact,</span>
<span class="sd">                ...     in_seconds=True,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.partition_by_durations(</span>
<span class="sd">                ...     [1.5],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     fill=abjad.Exact,</span>
<span class="sd">                ...     in_seconds=True,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    {</span>
<span class="sd">                        \tempo 4=60</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        g&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        a&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        b&#39;8</span>
<span class="sd">                        c&#39;&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Cyclically partitions leaves into parts equal to exactly 1.5</span>
<span class="sd">            seconds; returns overhang at end:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff([</span>
<span class="sd">                ...     abjad.Container(&quot;c&#39;8 d&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;e&#39;8 f&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;g&#39;8 a&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;b&#39;8 c&#39;&#39;&quot;),</span>
<span class="sd">                ... ])</span>
<span class="sd">                &gt;&gt;&gt; for container in staff:</span>
<span class="sd">                ...     time_signature = abjad.TimeSignature((2, 8))</span>
<span class="sd">                ...     abjad.attach(time_signature, container[0])</span>
<span class="sd">                ...</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; mark = abjad.MetronomeMark((1, 4), 60)</span>
<span class="sd">                &gt;&gt;&gt; leaf = abjad.get.leaf(staff, 0)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(mark, leaf, context=&#39;Staff&#39;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.partition_by_durations(</span>
<span class="sd">                ...     [1.5],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     fill=abjad.Exact,</span>
<span class="sd">                ...     in_seconds=True,</span>
<span class="sd">                ...     overhang=True,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;b&#39;8&quot;), Note(&quot;c&#39;&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.partition_by_durations(</span>
<span class="sd">                ...     [1.5],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     fill=abjad.Exact,</span>
<span class="sd">                ...     in_seconds=True,</span>
<span class="sd">                ...     overhang=True,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;b&#39;8&quot;), Note(&quot;c&#39;&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    {</span>
<span class="sd">                        \tempo 4=60</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        g&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        a&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        b&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Partitions leaves into a single part equal to exactly 1.5 seconds;</span>
<span class="sd">            truncates overhang:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff([</span>
<span class="sd">                ...     abjad.Container(&quot;c&#39;8 d&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;e&#39;8 f&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;g&#39;8 a&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;b&#39;8 c&#39;&#39;&quot;),</span>
<span class="sd">                ... ])</span>
<span class="sd">                &gt;&gt;&gt; for container in staff:</span>
<span class="sd">                ...     time_signature = abjad.TimeSignature((2, 8))</span>
<span class="sd">                ...     abjad.attach(time_signature, container[0])</span>
<span class="sd">                ...</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; mark = abjad.MetronomeMark((1, 4), 60)</span>
<span class="sd">                &gt;&gt;&gt; leaf = abjad.get.leaf(staff, 0)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(mark, leaf, context=&#39;Staff&#39;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.partition_by_durations(</span>
<span class="sd">                ...     [1.5],</span>
<span class="sd">                ...     cyclic=False,</span>
<span class="sd">                ...     fill=abjad.Exact,</span>
<span class="sd">                ...     in_seconds=True,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.partition_by_durations(</span>
<span class="sd">                ...     [1.5],</span>
<span class="sd">                ...     cyclic=False,</span>
<span class="sd">                ...     fill=abjad.Exact,</span>
<span class="sd">                ...     in_seconds=True,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    {</span>
<span class="sd">                        \tempo 4=60</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        g&#39;8</span>
<span class="sd">                        a&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        b&#39;8</span>
<span class="sd">                        c&#39;&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Cyclically partitions leaves into parts equal to (or just less</span>
<span class="sd">            than) 0.75 seconds; truncates overhang:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff([</span>
<span class="sd">                ...     abjad.Container(&quot;c&#39;8 d&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;e&#39;8 f&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;g&#39;8 a&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;b&#39;8 c&#39;&#39;&quot;),</span>
<span class="sd">                ... ])</span>
<span class="sd">                &gt;&gt;&gt; for container in staff:</span>
<span class="sd">                ...     time_signature = abjad.TimeSignature((2, 8))</span>
<span class="sd">                ...     abjad.attach(time_signature, container[0])</span>
<span class="sd">                ...</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; mark = abjad.MetronomeMark((1, 4), 60)</span>
<span class="sd">                &gt;&gt;&gt; leaf = abjad.get.leaf(staff, 0)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(mark, leaf, context=&#39;Staff&#39;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.partition_by_durations(</span>
<span class="sd">                ...     [0.75],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     fill=abjad.Less,</span>
<span class="sd">                ...     in_seconds=True,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;g&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;a&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;b&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.partition_by_durations(</span>
<span class="sd">                ...     [0.75],</span>
<span class="sd">                ...     cyclic=True,</span>
<span class="sd">                ...     fill=abjad.Less,</span>
<span class="sd">                ...     in_seconds=True,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;g&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;a&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;b&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    {</span>
<span class="sd">                        \tempo 4=60</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        g&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        a&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        b&#39;8</span>
<span class="sd">                        c&#39;&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Partitions leaves into one part equal to (or just less than) 0.75</span>
<span class="sd">            seconds; truncates overhang:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff([</span>
<span class="sd">                ...     abjad.Container(&quot;c&#39;8 d&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;e&#39;8 f&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;g&#39;8 a&#39;&quot;),</span>
<span class="sd">                ...     abjad.Container(&quot;b&#39;8 c&#39;&#39;&quot;),</span>
<span class="sd">                ... ])</span>
<span class="sd">                &gt;&gt;&gt; for container in staff:</span>
<span class="sd">                ...     time_signature = abjad.TimeSignature((2, 8))</span>
<span class="sd">                ...     abjad.attach(time_signature, container[0])</span>
<span class="sd">                ...</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; mark = abjad.MetronomeMark((1, 4), 60)</span>
<span class="sd">                &gt;&gt;&gt; leaf = abjad.get.leaf(staff, 0)</span>
<span class="sd">                &gt;&gt;&gt; abjad.attach(mark, leaf, context=&#39;Staff&#39;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.partition_by_durations(</span>
<span class="sd">                ...     [0.75],</span>
<span class="sd">                ...     cyclic=False,</span>
<span class="sd">                ...     fill=abjad.Less,</span>
<span class="sd">                ...     in_seconds=True,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.partition_by_durations(</span>
<span class="sd">                ...     [0.75],</span>
<span class="sd">                ...     cyclic=False,</span>
<span class="sd">                ...     fill=abjad.Less,</span>
<span class="sd">                ...     in_seconds=True,</span>
<span class="sd">                ...     overhang=False,</span>
<span class="sd">                ...     )</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    {</span>
<span class="sd">                        \tempo 4=60</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        d&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        g&#39;8</span>
<span class="sd">                        a&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        b&#39;8</span>
<span class="sd">                        c&#39;&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        Interprets ``fill`` as ``Exact`` when ``fill`` is none.</span>

<span class="sd">        Parts must equal ``durations`` exactly when ``fill`` is ``Exact``.</span>

<span class="sd">        Parts must be less than or equal to ``durations`` when ``fill`` is</span>
<span class="sd">        ``Less``.</span>

<span class="sd">        Parts must be greater or equal to ``durations`` when ``fill`` is</span>
<span class="sd">        ``More``.</span>

<span class="sd">        Reads ``durations`` cyclically when ``cyclic`` is true.</span>

<span class="sd">        Reads component durations in seconds when ``in_seconds`` is true.</span>

<span class="sd">        Returns remaining components at end in final part when ``overhang``</span>
<span class="sd">        is true.</span>

<span class="sd">        Returns nested selection (or expression):</span>

<span class="sd">            &gt;&gt;&gt; type(result).__name__</span>
<span class="sd">            &#39;Selection&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="n">fill</span> <span class="ow">or</span> <span class="n">enums</span><span class="o">.</span><span class="n">Exact</span>
        <span class="n">durations</span> <span class="o">=</span> <span class="p">[</span><span class="n">Duration</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">durations</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">cyclic</span><span class="p">:</span>
            <span class="n">durations</span> <span class="o">=</span> <span class="n">CyclicTuple</span><span class="p">(</span><span class="n">durations</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">part</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_duration_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">target_duration</span> <span class="o">=</span> <span class="n">durations</span><span class="p">[</span><span class="n">current_duration_index</span><span class="p">]</span>
        <span class="n">cumulative_duration</span> <span class="o">=</span> <span class="n">Duration</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">components_copy</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">component</span> <span class="o">=</span> <span class="n">components_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">component_duration</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">_get_duration</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">in_seconds</span><span class="p">:</span>
                <span class="n">component_duration</span> <span class="o">=</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">_get_duration_in_seconds</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
            <span class="n">candidate_duration</span> <span class="o">=</span> <span class="n">cumulative_duration</span> <span class="o">+</span> <span class="n">component_duration</span>
            <span class="k">if</span> <span class="n">candidate_duration</span> <span class="o">&lt;</span> <span class="n">target_duration</span><span class="p">:</span>
                <span class="n">part</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
                <span class="n">cumulative_duration</span> <span class="o">=</span> <span class="n">candidate_duration</span>
            <span class="k">elif</span> <span class="n">candidate_duration</span> <span class="o">==</span> <span class="n">target_duration</span><span class="p">:</span>
                <span class="n">part</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
                <span class="n">part</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">cumulative_duration</span> <span class="o">=</span> <span class="n">Duration</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">current_duration_index</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">target_duration</span> <span class="o">=</span> <span class="n">durations</span><span class="p">[</span><span class="n">current_duration_index</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">elif</span> <span class="n">target_duration</span> <span class="o">&lt;</span> <span class="n">candidate_duration</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fill</span> <span class="ow">is</span> <span class="n">enums</span><span class="o">.</span><span class="n">Exact</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;must partition exactly.&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">fill</span> <span class="ow">is</span> <span class="n">enums</span><span class="o">.</span><span class="n">Less</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
                    <span class="n">part</span> <span class="o">=</span> <span class="p">[</span><span class="n">component</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">in_seconds</span><span class="p">:</span>
                        <span class="n">sum_</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">_inspect</span><span class="o">.</span><span class="n">_get_duration_in_seconds</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">part</span><span class="p">])</span>
                        <span class="n">cumulative_duration</span> <span class="o">=</span> <span class="n">Duration</span><span class="p">(</span><span class="n">sum_</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">sum_</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">_inspect</span><span class="o">.</span><span class="n">_get_duration</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">part</span><span class="p">])</span>
                        <span class="n">cumulative_duration</span> <span class="o">=</span> <span class="n">Duration</span><span class="p">(</span><span class="n">sum_</span><span class="p">)</span>
                    <span class="n">current_duration_index</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">target_duration</span> <span class="o">=</span> <span class="n">durations</span><span class="p">[</span><span class="n">current_duration_index</span><span class="p">]</span>
                    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                        <span class="k">break</span>
                    <span class="k">if</span> <span class="n">target_duration</span> <span class="o">&lt;</span> <span class="n">cumulative_duration</span><span class="p">:</span>
                        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;target duration </span><span class="si">{</span><span class="n">target_duration</span><span class="si">}</span><span class="s2"> is less&quot;</span>
                        <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot; than cumulative duration&quot;</span>
                        <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">cumulative_duration</span><span class="si">}</span><span class="s2">.&quot;</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">fill</span> <span class="ow">is</span> <span class="n">enums</span><span class="o">.</span><span class="n">More</span><span class="p">:</span>
                    <span class="n">part</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
                    <span class="n">part</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">cumulative_duration</span> <span class="o">=</span> <span class="n">Duration</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">current_duration_index</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">target_duration</span> <span class="o">=</span> <span class="n">durations</span><span class="p">[</span><span class="n">current_duration_index</span><span class="p">]</span>
                    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                        <span class="k">break</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">part</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">overhang</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">components_copy</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">overhang</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">components_copy</span><span class="p">)</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">selections</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.partition_by_ratio"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.partition_by_ratio">[docs]</a>    <span class="k">def</span> <span class="nf">partition_by_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Partitions selection by ``ratio``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Partitions leaves by a ratio of 1:1:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; string = r&quot;c&#39;8 d&#39; r \times 2/3 { e&#39; r f&#39; } g&#39; a&#39; r&quot;</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.partition_by_ratio((1, 1))</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;), Rest(&#39;r8&#39;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.partition_by_ratio((1, 1))</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;), Rest(&#39;r8&#39;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        r8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Partitions leaves by a ratio of 1:1:1:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; string = r&quot;c&#39;8 d&#39; r \times 2/3 { e&#39; r f&#39; } g&#39; a&#39; r&quot;</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves()</span>
<span class="sd">                &gt;&gt;&gt; result = result.partition_by_ratio((1, 1, 1))</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;), Rest(&#39;r8&#39;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.partition_by_ratio((1, 1, 1))</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Note(&quot;d&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;), Note(&quot;f&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;), Rest(&#39;r8&#39;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector, [&quot;red&quot;, &quot;blue&quot;, &quot;cyan&quot;])</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        r8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;cyan</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;cyan</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;cyan</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="n">ratio</span> <span class="ow">or</span> <span class="n">Ratio</span><span class="p">((</span><span class="mi">1</span><span class="p">,))</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="n">Ratio</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="n">ratio</span><span class="o">.</span><span class="n">partition_integer</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">partition_by_counts</span><span class="p">(</span><span class="n">counts</span><span class="o">=</span><span class="n">counts</span><span class="p">)</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">selections</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.rest"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.rest">[docs]</a>    <span class="k">def</span> <span class="nf">rest</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">Strings</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">grace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Rest</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects rest ``n``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects rest -1:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; tuplets = [</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 c&#39;16 &lt;d&#39; e&#39;&gt;4 ~ &lt;d&#39; e&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 d&#39;16 &lt;e&#39; fs&#39;&gt;4 ~ &lt;e&#39; fs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 e&#39;16 &lt;fs&#39; gs&#39;&gt;4 ~ &lt;fs&#39; gs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     ]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = zip([(10, 9), (8, 9), (10, 9)], tuplets)</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.Tuplet(*_) for _ in tuplets]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.select(tuplets)]</span>
<span class="sd">                &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.rhythm(tuplets)</span>
<span class="sd">                &gt;&gt;&gt; staff = lilypond_file[abjad.Staff]</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.direction = abjad.Up</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.staff_padding = 3</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).rest(-1)</span>

<span class="sd">                &gt;&gt;&gt; result</span>
<span class="sd">                Rest(&#39;r16&#39;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().rest(-1)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Rest(&#39;r16&#39;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(lilypond_file[abjad.Score], align_tags=89)</span>
<span class="sd">                \new Score</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new GlobalContext</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/4</span>
<span class="sd">                        s1 * 7/4</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override TupletBracket.direction = #up</span>
<span class="sd">                        \override TupletBracket.staff-padding = #3</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 8/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            d&#39;16</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            \abjad-color-music #&#39;green</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">(),</span> <span class="n">lone</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rests</span><span class="p">(</span><span class="n">grace</span><span class="o">=</span><span class="n">grace</span><span class="p">)[</span><span class="n">n</span><span class="p">]</span></div>

<div class="viewcode-block" id="Selection.rests"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.rests">[docs]</a>    <span class="k">def</span> <span class="nf">rests</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">Strings</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">grace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects rests.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects rests:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; tuplets = [</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 c&#39;16 &lt;d&#39; e&#39;&gt;4 ~ &lt;d&#39; e&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 d&#39;16 &lt;e&#39; fs&#39;&gt;4 ~ &lt;e&#39; fs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 e&#39;16 &lt;fs&#39; gs&#39;&gt;4 ~ &lt;fs&#39; gs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     ]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = zip([(10, 9), (8, 9), (10, 9)], tuplets)</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.Tuplet(*_) for _ in tuplets]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.select(tuplets)]</span>
<span class="sd">                &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.rhythm(tuplets)</span>
<span class="sd">                &gt;&gt;&gt; staff = lilypond_file[abjad.Staff]</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.direction = abjad.Up</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.staff_padding = 3</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).rests()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Rest(&#39;r16&#39;)</span>
<span class="sd">                Rest(&#39;r16&#39;)</span>
<span class="sd">                Rest(&#39;r16&#39;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().rests()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Rest(&#39;r16&#39;)</span>
<span class="sd">                Rest(&#39;r16&#39;)</span>
<span class="sd">                Rest(&#39;r16&#39;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(lilypond_file[abjad.Score], align_tags=89)</span>
<span class="sd">                \new Score</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new GlobalContext</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/4</span>
<span class="sd">                        s1 * 7/4</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override TupletBracket.direction = #up</span>
<span class="sd">                        \override TupletBracket.staff-padding = #3</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 8/9 {</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            d&#39;16</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">((</span><span class="n">MultimeasureRest</span><span class="p">,</span> <span class="n">Rest</span><span class="p">),</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span> <span class="n">grace</span><span class="o">=</span><span class="n">grace</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.run"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">Strings</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects run ``n``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects run -1:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; tuplets = [</span>
<span class="sd">                ...     &quot;r16 c&#39;16 c&#39;16 c&#39;16 &lt;d&#39; e&#39;&gt;4 ~ &lt;d&#39; e&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 d&#39;16 d&#39;16 d&#39;16 &lt;e&#39; fs&#39;&gt;4 ~ &lt;e&#39; fs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 e&#39;16 e&#39;16 e&#39;16 &lt;fs&#39; gs&#39;&gt;4 ~ &lt;fs&#39; gs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     ]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = zip([(10, 9), (8, 9), (10, 9)], tuplets)</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.Tuplet(*_) for _ in tuplets]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.select(tuplets)]</span>
<span class="sd">                &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.rhythm(tuplets)</span>
<span class="sd">                &gt;&gt;&gt; staff = lilypond_file[abjad.Staff]</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.direction = abjad.Up</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.staff_padding = 3</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).run(-1)</span>

<span class="sd">                &gt;&gt;&gt; result</span>
<span class="sd">                Selection([Note(&quot;e&#39;16&quot;), Note(&quot;e&#39;16&quot;), Note(&quot;e&#39;16&quot;), Chord(&quot;&lt;fs&#39; gs&#39;&gt;4&quot;), Chord(&quot;&lt;fs&#39; gs&#39;&gt;16&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().run(-1)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;e&#39;16&quot;), Note(&quot;e&#39;16&quot;), Note(&quot;e&#39;16&quot;), Chord(&quot;&lt;fs&#39; gs&#39;&gt;4&quot;), Chord(&quot;&lt;fs&#39; gs&#39;&gt;16&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(lilypond_file[abjad.Score], align_tags=89)</span>
<span class="sd">                \new Score</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new GlobalContext</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/4</span>
<span class="sd">                        s1 * 7/4</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override TupletBracket.direction = #up</span>
<span class="sd">                        \override TupletBracket.staff-padding = #3</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 8/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            d&#39;16</span>
<span class="sd">                            d&#39;16</span>
<span class="sd">                            d&#39;16</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            \abjad-color-music #&#39;green</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;green</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;green</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;green</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            \abjad-color-music #&#39;green</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">(),</span> <span class="n">lone</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)[</span><span class="n">n</span><span class="p">]</span></div>

<div class="viewcode-block" id="Selection.runs"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.runs">[docs]</a>    <span class="k">def</span> <span class="nf">runs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">Strings</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects runs.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects runs:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; tuplets = [</span>
<span class="sd">                ...     &quot;r16 c&#39;16 c&#39;16 c&#39;16 &lt;d&#39; e&#39;&gt;4 ~ &lt;d&#39; e&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 d&#39;16 d&#39;16 d&#39;16 &lt;e&#39; fs&#39;&gt;4 ~ &lt;e&#39; fs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 e&#39;16 e&#39;16 e&#39;16 &lt;fs&#39; gs&#39;&gt;4 ~ &lt;fs&#39; gs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     ]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = zip([(10, 9), (8, 9), (10, 9)], tuplets)</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.Tuplet(*_) for _ in tuplets]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.select(tuplets)]</span>
<span class="sd">                &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.rhythm(tuplets)</span>
<span class="sd">                &gt;&gt;&gt; staff = lilypond_file[abjad.Staff]</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.direction = abjad.Up</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.staff_padding = 3</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).runs()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;), Chord(&quot;&lt;d&#39; e&#39;&gt;4&quot;), Chord(&quot;&lt;d&#39; e&#39;&gt;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;), Chord(&quot;&lt;e&#39; fs&#39;&gt;4&quot;), Chord(&quot;&lt;e&#39; fs&#39;&gt;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;16&quot;), Note(&quot;e&#39;16&quot;), Note(&quot;e&#39;16&quot;), Chord(&quot;&lt;fs&#39; gs&#39;&gt;4&quot;), Chord(&quot;&lt;fs&#39; gs&#39;&gt;16&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().runs()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;), Note(&quot;c&#39;16&quot;), Chord(&quot;&lt;d&#39; e&#39;&gt;4&quot;), Chord(&quot;&lt;d&#39; e&#39;&gt;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;d&#39;16&quot;), Chord(&quot;&lt;e&#39; fs&#39;&gt;4&quot;), Chord(&quot;&lt;e&#39; fs&#39;&gt;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;16&quot;), Note(&quot;e&#39;16&quot;), Note(&quot;e&#39;16&quot;), Chord(&quot;&lt;fs&#39; gs&#39;&gt;4&quot;), Chord(&quot;&lt;fs&#39; gs&#39;&gt;16&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(lilypond_file[abjad.Score], align_tags=89)</span>
<span class="sd">                \new Score</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new GlobalContext</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/4</span>
<span class="sd">                        s1 * 7/4</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override TupletBracket.direction = #up</span>
<span class="sd">                        \override TupletBracket.staff-padding = #3</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 8/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            d&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            d&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            d&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            REGRESSION. Works with grace note (and containers):</span>

<span class="sd">            &gt;&gt;&gt; music_voice = abjad.Voice(</span>
<span class="sd">            ...     &quot;c&#39;16 d&#39; e&#39; r d&#39;4 e&#39; r8 f&#39;&quot;, name=&quot;Music_Voice&quot;</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cs&#39;16&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(container, music_voice[4])</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.on_beat_grace_container(</span>
<span class="sd">            ...     &quot;g&#39;16 gs&#39; a&#39; as&#39;&quot;, music_voice[5:7]</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(abjad.Articulation(&quot;&gt;&quot;), container[0])</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.AfterGraceContainer(&quot;fs&#39;16&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(container, music_voice[-1])</span>
<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff([music_voice])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Music_Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        d&#39;16</span>
<span class="sd">                        e&#39;16</span>
<span class="sd">                        r16</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            cs&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        &lt;&lt;</span>
<span class="sd">                            \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \set fontSize = #-3 %! abjad.on_beat_grace_container(1)</span>
<span class="sd">                                \slash %! abjad.on_beat_grace_container(2)</span>
<span class="sd">                                \voiceOne %! abjad.on_beat_grace_container(3)</span>
<span class="sd">                                &lt;</span>
<span class="sd">                                    \tweak font-size #0</span>
<span class="sd">                                    \tweak transparent ##t</span>
<span class="sd">                                    e&#39;</span>
<span class="sd">                                    g&#39;</span>
<span class="sd">                                &gt;16</span>
<span class="sd">                                - \accent</span>
<span class="sd">                                [</span>
<span class="sd">                                (</span>
<span class="sd">                                gs&#39;16</span>
<span class="sd">                                a&#39;16</span>
<span class="sd">                                as&#39;16</span>
<span class="sd">                                )</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \context Voice = &quot;Music_Voice&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \voiceTwo %! abjad.on_beat_grace_container(4)</span>
<span class="sd">                                e&#39;4</span>
<span class="sd">                                r8</span>
<span class="sd">                            }</span>
<span class="sd">                        &gt;&gt;</span>
<span class="sd">                        \oneVoice %! abjad.on_beat_grace_container(5)</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                        {</span>
<span class="sd">                            fs&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().runs()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;16&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;e&#39;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;cs&#39;16&quot;), Note(&quot;d&#39;4&quot;), Chord(&quot;&lt;e&#39; g&#39;&gt;16&quot;), Note(&quot;gs&#39;16&quot;), Note(&quot;a&#39;16&quot;), Note(&quot;as&#39;16&quot;), Note(&quot;e&#39;4&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;fs&#39;16&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().runs()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;16&quot;), Note(&quot;d&#39;16&quot;), Note(&quot;e&#39;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;cs&#39;16&quot;), Note(&quot;d&#39;4&quot;), Chord(&quot;&lt;e&#39; g&#39;&gt;16&quot;), Note(&quot;gs&#39;16&quot;), Note(&quot;a&#39;16&quot;), Note(&quot;as&#39;16&quot;), Note(&quot;e&#39;4&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;fs&#39;16&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Music_Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;16</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;16</span>
<span class="sd">                        r16</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            cs&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        &lt;&lt;</span>
<span class="sd">                            \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \set fontSize = #-3                                                      %! abjad.on_beat_grace_container(1)</span>
<span class="sd">                                \slash                                                                   %! abjad.on_beat_grace_container(2)</span>
<span class="sd">                                \voiceOne                                                                %! abjad.on_beat_grace_container(3)</span>
<span class="sd">                                \abjad-color-music #&#39;blue</span>
<span class="sd">                                &lt;</span>
<span class="sd">                                    \tweak font-size #0</span>
<span class="sd">                                    \tweak transparent ##t</span>
<span class="sd">                                    e&#39;</span>
<span class="sd">                                    g&#39;</span>
<span class="sd">                                &gt;16</span>
<span class="sd">                                - \accent</span>
<span class="sd">                                [</span>
<span class="sd">                                (</span>
<span class="sd">                                \abjad-color-music #&#39;blue</span>
<span class="sd">                                gs&#39;16</span>
<span class="sd">                                \abjad-color-music #&#39;blue</span>
<span class="sd">                                a&#39;16</span>
<span class="sd">                                \abjad-color-music #&#39;blue</span>
<span class="sd">                                as&#39;16</span>
<span class="sd">                                )</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \context Voice = &quot;Music_Voice&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \voiceTwo                                                                %! abjad.on_beat_grace_container(4)</span>
<span class="sd">                                \abjad-color-music #&#39;blue</span>
<span class="sd">                                e&#39;4</span>
<span class="sd">                                r8</span>
<span class="sd">                            }</span>
<span class="sd">                        &gt;&gt;</span>
<span class="sd">                        \oneVoice                                                                        %! abjad.on_beat_grace_container(5)</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                        {</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            fs&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">Selection</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span> <span class="n">pitched</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">group_by_contiguity</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">Selection</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Selection.top"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.top">[docs]</a>    <span class="k">def</span> <span class="nf">top</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">Strings</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects top components.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects top components (up from leaves):</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; string = r&quot;c&#39;8 d&#39; r \times 2/3 { e&#39; r f&#39; } g&#39; a&#39; r&quot;</span>
<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(string)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).leaves().top()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Tuplet(&#39;3:2&#39;, &quot;e&#39;8 r8 f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;g&#39;8&quot;)</span>
<span class="sd">                Note(&quot;a&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves().top()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Note(&quot;c&#39;8&quot;)</span>
<span class="sd">                Note(&quot;d&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>
<span class="sd">                Tuplet(&#39;3:2&#39;, &quot;e&#39;8 r8 f&#39;8&quot;)</span>
<span class="sd">                Note(&quot;g&#39;8&quot;)</span>
<span class="sd">                Note(&quot;a&#39;8&quot;)</span>
<span class="sd">                Rest(&#39;r8&#39;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        r8</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        f&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Component</span><span class="p">,</span> <span class="n">Selection</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">_iterate</span><span class="o">.</span><span class="n">_public_iterate_components</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">component_</span> <span class="ow">in</span> <span class="n">Parentage</span><span class="p">(</span><span class="n">component</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_is_immediate_child_of_outermost_voice</span><span class="p">(</span><span class="n">component_</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="n">component_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span>
                <span class="p">):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component_</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">result</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.tuplet"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.tuplet">[docs]</a>    <span class="k">def</span> <span class="nf">tuplet</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">Strings</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Component</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects tuplet ``n``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects tuplet -1:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; tuplets = [</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 c&#39;16 &lt;d&#39; e&#39;&gt;4 ~ &lt;d&#39; e&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 d&#39;16 &lt;e&#39; fs&#39;&gt;4 ~ &lt;e&#39; fs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 e&#39;16 &lt;fs&#39; gs&#39;&gt;4 ~ &lt;fs&#39; gs&#39;&gt;16&quot;,</span>
<span class="sd">                ...     ]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = zip([(10, 9), (8, 9), (10, 9)], tuplets)</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.Tuplet(*_) for _ in tuplets]</span>
<span class="sd">                &gt;&gt;&gt; tuplets = [abjad.select(tuplets)]</span>
<span class="sd">                &gt;&gt;&gt; lilypond_file = abjad.LilyPondFile.rhythm(tuplets)</span>
<span class="sd">                &gt;&gt;&gt; staff = lilypond_file[abjad.Staff]</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.direction = abjad.Up</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).tuplet_bracket.staff_padding = 3</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).tuplet(-1)</span>

<span class="sd">                &gt;&gt;&gt; result</span>
<span class="sd">                Tuplet(&#39;9:10&#39;, &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 e&#39;16 &lt;fs&#39; gs&#39;&gt;4 &lt;fs&#39; gs&#39;&gt;16&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().tuplet(-1)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Tuplet(&#39;9:10&#39;, &quot;r16 bf&#39;16 &lt;a&#39;&#39; b&#39;&#39;&gt;16 e&#39;16 &lt;fs&#39; gs&#39;&gt;4 &lt;fs&#39; gs&#39;&gt;16&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(lilypond_file[abjad.Score], align_tags=89)</span>
<span class="sd">                \new Score</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \new GlobalContext</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/4</span>
<span class="sd">                        s1 * 7/4</span>
<span class="sd">                    }</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override TupletBracket.direction = #up</span>
<span class="sd">                        \override TupletBracket.staff-padding = #3</span>
<span class="sd">                        autoBeaming = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;d&#39; e&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 8/9 {</span>
<span class="sd">                            r16</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            d&#39;16</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            &lt;e&#39; fs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 10/9 {</span>
<span class="sd">                            \abjad-color-music #&#39;green</span>
<span class="sd">                            r16</span>
<span class="sd">                            \abjad-color-music #&#39;green</span>
<span class="sd">                            bf&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;green</span>
<span class="sd">                            &lt;a&#39;&#39; b&#39;&#39;&gt;16</span>
<span class="sd">                            \abjad-color-music #&#39;green</span>
<span class="sd">                            e&#39;16</span>
<span class="sd">                            \abjad-color-music #&#39;green</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            \abjad-color-music #&#39;green</span>
<span class="sd">                            &lt;fs&#39; gs&#39;&gt;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">(),</span> <span class="n">lone</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">)[</span><span class="n">n</span><span class="p">]</span></div>

<div class="viewcode-block" id="Selection.tuplets"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.tuplets">[docs]</a>    <span class="k">def</span> <span class="nf">tuplets</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">typings</span><span class="o">.</span><span class="n">Strings</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects tuplets.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects tuplets at every level:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(</span>
<span class="sd">                ...     r&quot;\times 2/3 { c&#39;2 \times 2/3 { d&#39;8 e&#39; f&#39; } } \times 2/3 { c&#39;4 d&#39; e&#39; }&quot;</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                ..  docs::</span>

<span class="sd">                    &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    {</span>
<span class="sd">                        \times 2/3 {</span>
<span class="sd">                            c&#39;2</span>
<span class="sd">                            \times 2/3 {</span>
<span class="sd">                                d&#39;8</span>
<span class="sd">                                e&#39;8</span>
<span class="sd">                                f&#39;8</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3 {</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            d&#39;4</span>
<span class="sd">                            e&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).tuplets()</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Tuplet(&#39;3:2&#39;, &quot;c&#39;2 { 2/3 d&#39;8 e&#39;8 f&#39;8 }&quot;)</span>
<span class="sd">                Tuplet(&#39;3:2&#39;, &quot;d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">                Tuplet(&#39;3:2&#39;, &quot;c&#39;4 d&#39;4 e&#39;4&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().tuplets()</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Tuplet(&#39;3:2&#39;, &quot;c&#39;2 { 2/3 d&#39;8 e&#39;8 f&#39;8 }&quot;)</span>
<span class="sd">                Tuplet(&#39;3:2&#39;, &quot;d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">                Tuplet(&#39;3:2&#39;, &quot;c&#39;4 d&#39;4 e&#39;4&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                        \times 2/3 {</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            d&#39;8</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            e&#39;8</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            \abjad-color-music #&#39;blue</span>
<span class="sd">                            f&#39;8</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects tuplets at level -1:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(</span>
<span class="sd">                ...     r&quot;\times 2/3 { c&#39;2 \times 2/3 { d&#39;8 e&#39; f&#39; } } \times 2/3 { c&#39;4 d&#39; e&#39; }&quot;</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                ..  docs::</span>

<span class="sd">                    &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    {</span>
<span class="sd">                        \times 2/3 {</span>
<span class="sd">                            c&#39;2</span>
<span class="sd">                            \times 2/3 {</span>
<span class="sd">                                d&#39;8</span>
<span class="sd">                                e&#39;8</span>
<span class="sd">                                f&#39;8</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3 {</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            d&#39;4</span>
<span class="sd">                            e&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).tuplets(level=-1)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Tuplet(&#39;3:2&#39;, &quot;d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">                Tuplet(&#39;3:2&#39;, &quot;c&#39;4 d&#39;4 e&#39;4&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().tuplets(level=-1)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Tuplet(&#39;3:2&#39;, &quot;d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">                Tuplet(&#39;3:2&#39;, &quot;c&#39;4 d&#39;4 e&#39;4&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                        \times 2/3 {</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            d&#39;8</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            e&#39;8</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            f&#39;8</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">            Tuplets at level -1 are bottom-level tuplet: tuplets at level -1</span>
<span class="sd">            contain only one tuplet (themselves) and do not contain any other</span>
<span class="sd">            tuplets.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects tuplets at level 1:</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(</span>
<span class="sd">                ...     r&quot;\times 2/3 { c&#39;2 \times 2/3 { d&#39;8 e&#39; f&#39; } } \times 2/3 { c&#39;4 d&#39; e&#39; }&quot;</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                ..  docs::</span>

<span class="sd">                    &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                    \new Staff</span>
<span class="sd">                    {</span>
<span class="sd">                        \times 2/3 {</span>
<span class="sd">                            c&#39;2</span>
<span class="sd">                            \times 2/3 {</span>
<span class="sd">                                d&#39;8</span>
<span class="sd">                                e&#39;8</span>
<span class="sd">                                f&#39;8</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3 {</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            d&#39;4</span>
<span class="sd">                            e&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).tuplets(level=1)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Tuplet(&#39;3:2&#39;, &quot;c&#39;2 { 2/3 d&#39;8 e&#39;8 f&#39;8 }&quot;)</span>
<span class="sd">                Tuplet(&#39;3:2&#39;, &quot;c&#39;4 d&#39;4 e&#39;4&quot;)</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().tuplets(level=1)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Tuplet(&#39;3:2&#39;, &quot;c&#39;2 { 2/3 d&#39;8 e&#39;8 f&#39;8 }&quot;)</span>
<span class="sd">                Tuplet(&#39;3:2&#39;, &quot;c&#39;4 d&#39;4 e&#39;4&quot;)</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                        \times 2/3 {</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            d&#39;8</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            e&#39;8</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            f&#39;8</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3 {</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        e&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">            Tuplets at level 1 are top-level tuplets: level-1 tuplets contain only 1</span>
<span class="sd">            tuplet (themselves) and are not contained by any other tuplets.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">tuplets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">Tuplet</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tuplets</span><span class="p">,</span> <span class="n">Selection</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">level</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tuplets</span>
        <span class="k">elif</span> <span class="n">level</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">tuplets</span><span class="p">:</span>
                <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">_iterate</span><span class="o">.</span><span class="n">_iterate_descendants</span><span class="p">(</span><span class="n">tuplet</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">Tuplet</span><span class="p">):</span>
                        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="o">-</span><span class="n">count</span> <span class="o">==</span> <span class="n">level</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">tuplets</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Parentage</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">Tuplet</span><span class="p">)</span> <span class="o">==</span> <span class="n">level</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">result</span><span class="p">)</span></div>

    <span class="c1"># TODO: write grace examples</span>
<div class="viewcode-block" id="Selection.with_next_leaf"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.with_next_leaf">[docs]</a>    <span class="k">def</span> <span class="nf">with_next_leaf</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">grace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extends selection with next leaf.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects runs (each with next leaf):</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).runs()</span>
<span class="sd">                &gt;&gt;&gt; result = result.map(abjad.select().with_next_leaf())</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().runs()</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.map(abjad.select().with_next_leaf())</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects pitched tails (each with next leaf):</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;c&#39;8 r d&#39; ~ d&#39; e&#39; ~ e&#39; r8 f&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; getter = abjad.select()[-1:].with_next_leaf()</span>
<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; result = result.map(getter)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.map(getter)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Pitched logical ties (each with next leaf) is the correct selection</span>
<span class="sd">            for single-pitch sustain pedal applications.</span>

<span class="sd">            Selects pitched logical ties (each with next leaf):</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;c&#39;8 r d&#39; ~ d&#39; e&#39; ~ e&#39; r8 f&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).pedal_sustain_style = &quot;#&#39;mixed&quot;</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; result = result.map(abjad.select().with_next_leaf())</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.map(abjad.select().with_next_leaf())</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;e&#39;8&quot;), Note(&quot;e&#39;8&quot;), Rest(&#39;r8&#39;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     abjad.piano_pedal(item)</span>
<span class="sd">                ...</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.override(staff).sustain_pedal_line_spanner.staff_padding = 6</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override SustainPedalLineSpanner.staff-padding = #6</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                    pedalSustainStyle = #&#39;mixed</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \sustainOn</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \sustainOff</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \sustainOn</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \sustainOff</span>
<span class="sd">                    ~</span>
<span class="sd">                    \sustainOn</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \sustainOff</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \sustainOff</span>
<span class="sd">                    \sustainOn</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            REGRESSION. Works with grace note (and containers):</span>

<span class="sd">            &gt;&gt;&gt; music_voice = abjad.Voice(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;, name=&quot;Music_Voice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cs&#39;16&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(container, music_voice[1])</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.on_beat_grace_container(</span>
<span class="sd">            ...     &quot;g&#39;16 gs&#39; a&#39; as&#39;&quot;, music_voice[2:3]</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(abjad.Articulation(&quot;&gt;&quot;), container[0])</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.AfterGraceContainer(&quot;fs&#39;16&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(container, music_voice[3])</span>
<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff([music_voice])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Music_Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            cs&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        &lt;&lt;</span>
<span class="sd">                            \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \set fontSize = #-3 %! abjad.on_beat_grace_container(1)</span>
<span class="sd">                                \slash %! abjad.on_beat_grace_container(2)</span>
<span class="sd">                                \voiceOne %! abjad.on_beat_grace_container(3)</span>
<span class="sd">                                &lt;</span>
<span class="sd">                                    \tweak font-size #0</span>
<span class="sd">                                    \tweak transparent ##t</span>
<span class="sd">                                    e&#39;</span>
<span class="sd">                                    g&#39;</span>
<span class="sd">                                &gt;16</span>
<span class="sd">                                - \accent</span>
<span class="sd">                                [</span>
<span class="sd">                                (</span>
<span class="sd">                                gs&#39;16</span>
<span class="sd">                                a&#39;16</span>
<span class="sd">                                as&#39;16</span>
<span class="sd">                                )</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \context Voice = &quot;Music_Voice&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \voiceTwo %! abjad.on_beat_grace_container(4)</span>
<span class="sd">                                e&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                        &gt;&gt;</span>
<span class="sd">                        \oneVoice %! abjad.on_beat_grace_container(5)</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        f&#39;4</span>
<span class="sd">                        {</span>
<span class="sd">                            fs&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; prototype = (</span>
<span class="sd">                ...     abjad.BeforeGraceContainer,</span>
<span class="sd">                ...     abjad.OnBeatGraceContainer,</span>
<span class="sd">                ...     abjad.AfterGraceContainer,</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt; containers = abjad.select(staff).components(prototype)</span>
<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves().with_next_leaf()</span>
<span class="sd">                &gt;&gt;&gt; result = containers.map(selector)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;cs&#39;16&quot;), Note(&quot;d&#39;4&quot;)])</span>
<span class="sd">                Selection([Chord(&quot;&lt;e&#39; g&#39;&gt;16&quot;), Note(&quot;gs&#39;16&quot;), Note(&quot;a&#39;16&quot;), Note(&quot;as&#39;16&quot;), Note(&quot;e&#39;4&quot;)])</span>
<span class="sd">                Selection([Note(&quot;fs&#39;16&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; containers = abjad.select().components(prototype)</span>
<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves().with_next_leaf()</span>
<span class="sd">                &gt;&gt;&gt; selector = containers.map(selector)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;cs&#39;16&quot;), Note(&quot;d&#39;4&quot;)])</span>
<span class="sd">                Selection([Chord(&quot;&lt;e&#39; g&#39;&gt;16&quot;), Note(&quot;gs&#39;16&quot;), Note(&quot;a&#39;16&quot;), Note(&quot;as&#39;16&quot;), Note(&quot;e&#39;4&quot;)])</span>
<span class="sd">                Selection([Note(&quot;fs&#39;16&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Music_Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            cs&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        &lt;&lt;</span>
<span class="sd">                            \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \set fontSize = #-3                                                      %! abjad.on_beat_grace_container(1)</span>
<span class="sd">                                \slash                                                                   %! abjad.on_beat_grace_container(2)</span>
<span class="sd">                                \voiceOne                                                                %! abjad.on_beat_grace_container(3)</span>
<span class="sd">                                \abjad-color-music #&#39;blue</span>
<span class="sd">                                &lt;</span>
<span class="sd">                                    \tweak font-size #0</span>
<span class="sd">                                    \tweak transparent ##t</span>
<span class="sd">                                    e&#39;</span>
<span class="sd">                                    g&#39;</span>
<span class="sd">                                &gt;16</span>
<span class="sd">                                - \accent</span>
<span class="sd">                                [</span>
<span class="sd">                                (</span>
<span class="sd">                                \abjad-color-music #&#39;blue</span>
<span class="sd">                                gs&#39;16</span>
<span class="sd">                                \abjad-color-music #&#39;blue</span>
<span class="sd">                                a&#39;16</span>
<span class="sd">                                \abjad-color-music #&#39;blue</span>
<span class="sd">                                as&#39;16</span>
<span class="sd">                                )</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \context Voice = &quot;Music_Voice&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \voiceTwo                                                                %! abjad.on_beat_grace_container(4)</span>
<span class="sd">                                \abjad-color-music #&#39;blue</span>
<span class="sd">                                e&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                        &gt;&gt;</span>
<span class="sd">                        \oneVoice                                                                        %! abjad.on_beat_grace_container(5)</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        f&#39;4</span>
<span class="sd">                        {</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            fs&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">leaves</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leaves</span><span class="p">())</span>
        <span class="n">previous_leaf</span> <span class="o">=</span> <span class="n">leaves</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">next_leaf</span> <span class="o">=</span> <span class="n">_iterate</span><span class="o">.</span><span class="n">_get_leaf</span><span class="p">(</span><span class="n">previous_leaf</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">next_leaf</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">grace</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="ow">or</span> <span class="p">(</span><span class="n">grace</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">_get_grace_container</span><span class="p">(</span><span class="n">next_leaf</span><span class="p">))</span>
                <span class="ow">or</span> <span class="p">(</span><span class="n">grace</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">_inspect</span><span class="o">.</span><span class="n">_get_grace_container</span><span class="p">(</span><span class="n">next_leaf</span><span class="p">))</span>
            <span class="p">):</span>
                <span class="n">leaves</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_leaf</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="n">previous_leaf</span> <span class="o">=</span> <span class="n">next_leaf</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">leaves</span><span class="p">)</span></div>

<div class="viewcode-block" id="Selection.with_previous_leaf"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.Selection.with_previous_leaf">[docs]</a>    <span class="k">def</span> <span class="nf">with_previous_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extends selection with previous leaf.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects runs (each with previous leaf):</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 r8 d&#39;8 e&#39;8 r8 f&#39;8 g&#39;8 a&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; getter = abjad.select().with_previous_leaf()</span>
<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).runs().map(getter)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;), Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().runs().map(getter)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;), Note(&quot;f&#39;8&quot;), Note(&quot;g&#39;8&quot;), Note(&quot;a&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Selects pitched heads (each with previous leaf):</span>

<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; staff = abjad.Staff(r&quot;c&#39;8 r d&#39; ~ d&#39; e&#39; ~ e&#39; r8 f&#39;8&quot;)</span>
<span class="sd">                &gt;&gt;&gt; abjad.setting(staff).auto_beaming = False</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">                &gt;&gt;&gt; getter = abjad.select()[:1].with_previous_leaf()</span>
<span class="sd">                &gt;&gt;&gt; result = abjad.select(staff).logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; result = result.map(getter)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;), Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; selector = abjad.select().logical_ties(pitched=True)</span>
<span class="sd">                &gt;&gt;&gt; selector = selector.map(getter)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;8&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;), Note(&quot;d&#39;8&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;8&quot;), Note(&quot;e&#39;8&quot;)])</span>
<span class="sd">                Selection([Rest(&#39;r8&#39;), Note(&quot;f&#39;8&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    autoBeaming = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;red</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    r8</span>
<span class="sd">                    \abjad-color-music #&#39;blue</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            REGRESSION. Works with grace note (and containers):</span>

<span class="sd">            &gt;&gt;&gt; music_voice = abjad.Voice(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;, name=&quot;Music_Voice&quot;)</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.BeforeGraceContainer(&quot;cs&#39;16&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(container, music_voice[1])</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.on_beat_grace_container(</span>
<span class="sd">            ...     &quot;g&#39;16 gs&#39; a&#39; as&#39;&quot;, music_voice[2:3]</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(abjad.Articulation(&quot;&gt;&quot;), container[0])</span>
<span class="sd">            &gt;&gt;&gt; container = abjad.AfterGraceContainer(&quot;fs&#39;16&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(container, music_voice[3])</span>
<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff([music_voice])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Music_Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            cs&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        &lt;&lt;</span>
<span class="sd">                            \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \set fontSize = #-3 %! abjad.on_beat_grace_container(1)</span>
<span class="sd">                                \slash %! abjad.on_beat_grace_container(2)</span>
<span class="sd">                                \voiceOne %! abjad.on_beat_grace_container(3)</span>
<span class="sd">                                &lt;</span>
<span class="sd">                                    \tweak font-size #0</span>
<span class="sd">                                    \tweak transparent ##t</span>
<span class="sd">                                    e&#39;</span>
<span class="sd">                                    g&#39;</span>
<span class="sd">                                &gt;16</span>
<span class="sd">                                - \accent</span>
<span class="sd">                                [</span>
<span class="sd">                                (</span>
<span class="sd">                                gs&#39;16</span>
<span class="sd">                                a&#39;16</span>
<span class="sd">                                as&#39;16</span>
<span class="sd">                                )</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \context Voice = &quot;Music_Voice&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \voiceTwo %! abjad.on_beat_grace_container(4)</span>
<span class="sd">                                e&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                        &gt;&gt;</span>
<span class="sd">                        \oneVoice %! abjad.on_beat_grace_container(5)</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        f&#39;4</span>
<span class="sd">                        {</span>
<span class="sd">                            fs&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>


<span class="sd">            ..  container:: example</span>

<span class="sd">                &gt;&gt;&gt; prototype = (</span>
<span class="sd">                ...     abjad.BeforeGraceContainer,</span>
<span class="sd">                ...     abjad.OnBeatGraceContainer,</span>
<span class="sd">                ...     abjad.AfterGraceContainer,</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt; containers = abjad.select(staff).components(prototype)</span>
<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves().with_previous_leaf()</span>
<span class="sd">                &gt;&gt;&gt; result = containers.map(selector)</span>

<span class="sd">                &gt;&gt;&gt; for item in result:</span>
<span class="sd">                ...     item</span>
<span class="sd">                ...</span>
<span class="sd">                Selection([Note(&quot;c&#39;4&quot;), Note(&quot;cs&#39;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;4&quot;), Chord(&quot;&lt;e&#39; g&#39;&gt;16&quot;), Note(&quot;gs&#39;16&quot;), Note(&quot;a&#39;16&quot;), Note(&quot;as&#39;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;4&quot;), Note(&quot;fs&#39;16&quot;)])</span>

<span class="sd">            ..  container:: example expression</span>

<span class="sd">                &gt;&gt;&gt; containers = abjad.select().components(prototype)</span>
<span class="sd">                &gt;&gt;&gt; selector = abjad.select().leaves().with_previous_leaf()</span>
<span class="sd">                &gt;&gt;&gt; selector = containers.map(selector)</span>
<span class="sd">                &gt;&gt;&gt; result = selector(staff)</span>

<span class="sd">                &gt;&gt;&gt; selector.print(result)</span>
<span class="sd">                Selection([Note(&quot;c&#39;4&quot;), Note(&quot;cs&#39;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;d&#39;4&quot;), Chord(&quot;&lt;e&#39; g&#39;&gt;16&quot;), Note(&quot;gs&#39;16&quot;), Note(&quot;a&#39;16&quot;), Note(&quot;as&#39;16&quot;)])</span>
<span class="sd">                Selection([Note(&quot;f&#39;4&quot;), Note(&quot;fs&#39;16&quot;)])</span>

<span class="sd">                &gt;&gt;&gt; abjad.label(result).by_selector(selector)</span>
<span class="sd">                &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff, align_tags=89)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Music_Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            cs&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        \abjad-color-music #&#39;blue</span>
<span class="sd">                        d&#39;4</span>
<span class="sd">                        &lt;&lt;</span>
<span class="sd">                            \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \set fontSize = #-3                                                      %! abjad.on_beat_grace_container(1)</span>
<span class="sd">                                \slash                                                                   %! abjad.on_beat_grace_container(2)</span>
<span class="sd">                                \voiceOne                                                                %! abjad.on_beat_grace_container(3)</span>
<span class="sd">                                \abjad-color-music #&#39;blue</span>
<span class="sd">                                &lt;</span>
<span class="sd">                                    \tweak font-size #0</span>
<span class="sd">                                    \tweak transparent ##t</span>
<span class="sd">                                    e&#39;</span>
<span class="sd">                                    g&#39;</span>
<span class="sd">                                &gt;16</span>
<span class="sd">                                - \accent</span>
<span class="sd">                                [</span>
<span class="sd">                                (</span>
<span class="sd">                                \abjad-color-music #&#39;blue</span>
<span class="sd">                                gs&#39;16</span>
<span class="sd">                                \abjad-color-music #&#39;blue</span>
<span class="sd">                                a&#39;16</span>
<span class="sd">                                \abjad-color-music #&#39;blue</span>
<span class="sd">                                as&#39;16</span>
<span class="sd">                                )</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \context Voice = &quot;Music_Voice&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \voiceTwo                                                                %! abjad.on_beat_grace_container(4)</span>
<span class="sd">                                e&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                        &gt;&gt;</span>
<span class="sd">                        \oneVoice                                                                        %! abjad.on_beat_grace_container(5)</span>
<span class="sd">                        \abjad-color-music #&#39;red</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        f&#39;4</span>
<span class="sd">                        {</span>
<span class="sd">                            \abjad-color-music #&#39;red</span>
<span class="sd">                            fs&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expression</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_expression</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())</span>
        <span class="n">leaves</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leaves</span><span class="p">())</span>
        <span class="n">previous_leaf</span> <span class="o">=</span> <span class="n">_iterate</span><span class="o">.</span><span class="n">_get_leaf</span><span class="p">(</span><span class="n">leaves</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">previous_leaf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">leaves</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">previous_leaf</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">leaves</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="LogicalTie"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.LogicalTie">[docs]</a><span class="k">class</span> <span class="nc">LogicalTie</span><span class="p">(</span><span class="n">Selection</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Logical tie of a component.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39; d&#39; e&#39; ~ e&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        &gt;&gt;&gt; abjad.select(staff[2]).logical_tie()</span>
<span class="sd">        LogicalTie([Note(&quot;e&#39;4&quot;), Note(&quot;e&#39;4&quot;)])</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="LogicalTie.__getitem__"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.LogicalTie.__getitem__">[docs]</a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets ``argument``.</span>

<span class="sd">        Returns component or vanilla selection (not logical tie).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Selection</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">leaf</span><span class="o">.</span><span class="n">_scale</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">head</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reference to element ``0`` in logical tie.</span>

<span class="sd">        Returns component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_pitched</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when logical tie head is a note or chord.</span>

<span class="sd">        Returns true or false.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="s2">&quot;written_pitch&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="s2">&quot;written_pitches&quot;</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_trivial</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when length of logical tie is less than or equal to ``1``.</span>

<span class="sd">        Returns true or false.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">leaves</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets leaves in logical tie.</span>

<span class="sd">        Returns selection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Selection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tail</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets last leaf in logical tie.</span>

<span class="sd">        Returns leaf.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">written_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sum of written duration of all components in logical tie.</span>

<span class="sd">        Returns duration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">_</span><span class="o">.</span><span class="n">written_duration</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">])</span></div>


<span class="c1">### FUNCTIONS ###</span>


<div class="viewcode-block" id="select"><a class="viewcode-back" href="../../api/abjad/select.html#abjad.select.select">[docs]</a><span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Selects ``items`` or makes select expression.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Selects first two notes in staff:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; selection = abjad.select(staff[:2]).leaves(pitched=True)</span>
<span class="sd">        &gt;&gt;&gt; for note in selection:</span>
<span class="sd">        ...     abjad.override(note).note_head.color = &#39;red&#39;</span>

<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                \once \override NoteHead.color = #red</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                \once \override NoteHead.color = #red</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Returns selection agent:</span>

<span class="sd">        &gt;&gt;&gt; abjad.select(staff)</span>
<span class="sd">        Selection([Staff(&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;)])</span>

<span class="sd">        &gt;&gt;&gt; abjad.select()</span>
<span class="sd">        abjad.select()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Selection</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="n">items</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">)</span>
    <span class="n">expression</span> <span class="o">=</span> <span class="n">Expression</span><span class="p">(</span><span class="n">proxy_class</span><span class="o">=</span><span class="n">Selection</span><span class="p">)</span>
    <span class="n">callback</span> <span class="o">=</span> <span class="n">Expression</span><span class="o">.</span><span class="n">_make_initializer_callback</span><span class="p">(</span><span class="n">Selection</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">)</span>
    <span class="n">expression</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="n">append_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="s2">&quot;abjad.select()&quot;</span><span class="p">)</span></div>
</pre></div>

    </div>
    
    </div>
    

<footer>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

</div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>