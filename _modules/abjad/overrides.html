

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>abjad.overrides &mdash; Abjad 3.2 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/abjad.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/uqbar.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/lightbox2/css/lightbox.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  
    <link rel="canonical" href="https://abjad.github.io_modules/abjad/overrides.html"/>
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script defer="defer" src="../../_static/copybutton.js"></script>
        <script src="../../_static/ga.js"></script>
        <script defer="defer" src="../../_static/lightbox2/js/lightbox.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #cc3300" >
          


    <a href="../../index.html" class="icon icon-home" alt="Documentation
    Home"> Abjad 3.2



    <img src="../../_static/abjad-logo.png" class="logo" alt="Logo"/>

</a>




<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">First steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/audience.html">Audience</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/macos.html">macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/linux.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps/windows.html">Windows</a></li>
</ul>
<p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/about_the_docs.html">About the docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers_basic_operations_on.html">Containers, basic operations on</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers_retrieving_by_name.html">Containers, retrieving by name</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/containers_time_interpretation_of.html">Containers, time interpretation of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/contexts_lilypond_type_of.html">Contexts, LilyPond type of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/indicators.html">Indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/lilypond_files_preamble_of.html">LilyPond files, preamble of</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/corpus_selection.html">Corpus, figure selection from</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/design_by_dyads.html">Design, by dyads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/enumeration.html">Enumeration, of rhythmic cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/magic_square_from_twelve_tone_row.html">Magic square, from twelve-tone row</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/scales_diatonic.html">Scales, diatonic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/score_fragment_piano.html">Score fragment, piano</a></li>
</ul>
<p class="caption"><span class="caption-text">All classes &amp; functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">Abjad API</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/best_practices.html">Best practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/changes.html">Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/developer_installation.html">Developer installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/lilypond_context_concatenation.html">LilyPond context concatenation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/publications.html">Publications</a></li>
</ul>
<p class="caption"><span class="caption-text">Score gallery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../gallery_2020.html">2020-16</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery_2015.html">2015-11</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery_2010.html">2010-00</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Abjad</a>
        
      </nav>


      <div class="wy-nav-content">

<div class="rst-content">

    


    <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    <div itemprop="articleBody">
    
  <h1>Source code for abjad.overrides</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">enums</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">tag</span> <span class="k">as</span> <span class="n">_tag</span>
<span class="kn">from</span> <span class="nn">.bundle</span> <span class="kn">import</span> <span class="n">LilyPondFormatBundle</span>
<span class="kn">from</span> <span class="nn">.lyconst</span> <span class="kn">import</span> <span class="n">colors</span>
<span class="kn">from</span> <span class="nn">.lyenv</span> <span class="kn">import</span> <span class="n">contexts</span><span class="p">,</span> <span class="n">grob_interfaces</span>
<span class="kn">from</span> <span class="nn">.scheme</span> <span class="kn">import</span> <span class="n">Scheme</span><span class="p">,</span> <span class="n">SchemePair</span>
<span class="kn">from</span> <span class="nn">.storage</span> <span class="kn">import</span> <span class="n">FormatSpecification</span><span class="p">,</span> <span class="n">StorageFormatManager</span>
<span class="kn">from</span> <span class="nn">.string</span> <span class="kn">import</span> <span class="n">String</span>


<div class="viewcode-block" id="LilyPondLiteral"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.LilyPondLiteral">[docs]</a><span class="k">class</span> <span class="nc">LilyPondLiteral</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LilyPond literal.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Dotted slur:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.slur(staff[:])</span>
<span class="sd">        &gt;&gt;&gt; literal = abjad.LilyPondLiteral(r&quot;\slurDotted&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(literal, staff[0])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                \slurDotted</span>
<span class="sd">                c&#39;8</span>
<span class="sd">                (</span>
<span class="sd">                d&#39;8</span>
<span class="sd">                e&#39;8</span>
<span class="sd">                f&#39;8</span>
<span class="sd">                )</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Use the absolute before and absolute after format slots like this:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.slur(staff[:])</span>
<span class="sd">        &gt;&gt;&gt; literal = abjad.LilyPondLiteral(r&quot;\slurDotted&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(literal, staff[0])</span>
<span class="sd">        &gt;&gt;&gt; literal = abjad.LilyPondLiteral(&quot;&quot;, format_slot=&quot;absolute_before&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(literal, staff[0])</span>
<span class="sd">        &gt;&gt;&gt; literal = abjad.LilyPondLiteral(</span>
<span class="sd">        ...     &quot;% before all formatting&quot;,</span>
<span class="sd">        ...     format_slot=&quot;absolute_before&quot;,</span>
<span class="sd">        ...     )</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(literal, staff[0])</span>
<span class="sd">        &gt;&gt;&gt; literal = abjad.LilyPondLiteral(&quot;&quot;, format_slot=&quot;absolute_after&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(literal, staff[-1])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">                % before all formatting</span>
<span class="sd">                \slurDotted</span>
<span class="sd">                c&#39;8</span>
<span class="sd">                (</span>
<span class="sd">                d&#39;8</span>
<span class="sd">                e&#39;8</span>
<span class="sd">                f&#39;8</span>
<span class="sd">                )</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        LilyPond literals can be tagged:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.slur(staff[:])</span>
<span class="sd">        &gt;&gt;&gt; literal = abjad.LilyPondLiteral(r&quot;\slurDotted&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(literal, staff[0], tag=abjad.Tag(&quot;+PARTS&quot;))</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">        \new Staff</span>
<span class="sd">        {</span>
<span class="sd">            \slurDotted %! +PARTS</span>
<span class="sd">            c&#39;8</span>
<span class="sd">            (</span>
<span class="sd">            d&#39;8</span>
<span class="sd">            e&#39;8</span>
<span class="sd">            f&#39;8</span>
<span class="sd">            )</span>
<span class="sd">        }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Multiline input is allowed:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 d&#39;8 e&#39;8 f&#39;8&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.slur(staff[:])</span>
<span class="sd">        &gt;&gt;&gt; lines = [</span>
<span class="sd">        ...     r&quot;\stopStaff&quot;,</span>
<span class="sd">        ...     r&quot;\startStaff&quot;,</span>
<span class="sd">        ...     r&quot;\once \override Staff.StaffSymbol.color = #red&quot;,</span>
<span class="sd">        ...     ]</span>
<span class="sd">        &gt;&gt;&gt; literal = abjad.LilyPondLiteral(lines)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(literal, staff[2], tag=abjad.Tag(&quot;+PARTS&quot;))</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">        \new Staff</span>
<span class="sd">        {</span>
<span class="sd">            c&#39;8</span>
<span class="sd">            (</span>
<span class="sd">            d&#39;8</span>
<span class="sd">            \stopStaff %! +PARTS</span>
<span class="sd">            \startStaff %! +PARTS</span>
<span class="sd">            \once \override Staff.StaffSymbol.color = #red %! +PARTS</span>
<span class="sd">            e&#39;8</span>
<span class="sd">            f&#39;8</span>
<span class="sd">            )</span>
<span class="sd">        }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        REGRESSION. Duplicate literals are allowed:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; literal = abjad.LilyPondLiteral(&quot;% text&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(literal, staff[0])</span>
<span class="sd">        &gt;&gt;&gt; literal = abjad.LilyPondLiteral(&quot;% text&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(literal, staff[0])</span>

<span class="sd">        &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">        \new Staff</span>
<span class="sd">        {</span>
<span class="sd">            % text</span>
<span class="sd">            % text</span>
<span class="sd">            c&#39;4</span>
<span class="sd">            d&#39;4</span>
<span class="sd">            e&#39;4</span>
<span class="sd">            f&#39;4</span>
<span class="sd">        }</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_argument&quot;</span><span class="p">,</span> <span class="s2">&quot;_directed&quot;</span><span class="p">,</span> <span class="s2">&quot;_format_slot&quot;</span><span class="p">,</span> <span class="s2">&quot;_tweaks&quot;</span><span class="p">)</span>

    <span class="n">_allowable_format_slots</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;absolute_after&quot;</span><span class="p">,</span>
        <span class="s2">&quot;absolute_before&quot;</span><span class="p">,</span>
        <span class="s2">&quot;after&quot;</span><span class="p">,</span>
        <span class="s2">&quot;before&quot;</span><span class="p">,</span>
        <span class="s2">&quot;closing&quot;</span><span class="p">,</span>
        <span class="s2">&quot;opening&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">_can_attach_to_containers</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">_format_leaf_children</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">argument</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="c1"># TODO: probaby change default to &quot;before&quot;</span>
        <span class="n">format_slot</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;opening&quot;</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">directed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tweaks</span><span class="p">:</span> <span class="s2">&quot;TweakInterface&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_argument</span> <span class="o">=</span> <span class="n">argument</span>
        <span class="k">assert</span> <span class="n">format_slot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allowable_format_slots</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">format_slot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_format_slot</span> <span class="o">=</span> <span class="n">format_slot</span>
        <span class="k">if</span> <span class="n">directed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">directed</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">directed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_directed</span> <span class="o">=</span> <span class="n">directed</span>
        <span class="k">if</span> <span class="n">tweaks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tweaks</span><span class="p">,</span> <span class="n">TweakInterface</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">tweaks</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tweaks</span> <span class="o">=</span> <span class="n">TweakInterface</span><span class="o">.</span><span class="n">set_tweaks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tweaks</span><span class="p">)</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="LilyPondLiteral.__eq__"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.LilyPondLiteral.__eq__">[docs]</a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when all initialization values of Abjad value object equal</span>
<span class="sd">        the initialization values of ``argument``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StorageFormatManager</span><span class="o">.</span><span class="n">compare_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span></div>

<div class="viewcode-block" id="LilyPondLiteral.__hash__"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.LilyPondLiteral.__hash__">[docs]</a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Hashes Abjad value object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hash_values</span> <span class="o">=</span> <span class="n">StorageFormatManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_hash_values</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="n">hash_values</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unhashable type: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="LilyPondLiteral.__repr__"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.LilyPondLiteral.__repr__">[docs]</a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets interpreter representation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StorageFormatManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_repr_format</span><span class="p">()</span></div>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="c1"># TODO: activate this:</span>
    <span class="c1">#    def _before_attach(self, component):</span>
    <span class="c1">#        if self.format_slot not in component._allowable_format_slots:</span>
    <span class="c1">#            message = f&quot;{type(component).__name__} does not accept&quot;</span>
    <span class="c1">#            message += f&quot; format slot {repr(self.format_slot)}.&quot;</span>
    <span class="c1">#            raise Exception(message)</span>

    <span class="k">def</span> <span class="nf">_get_format_pieces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">argument</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">argument</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">argument</span><span class="p">[:]</span>

    <span class="k">def</span> <span class="nf">_get_format_specification</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">FormatSpecification</span><span class="p">(</span>
            <span class="n">client</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">storage_format_args_values</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">argument</span><span class="p">],</span>
            <span class="n">storage_format_is_indented</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_lilypond_format_bundle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="n">LilyPondFormatBundle</span><span class="p">()</span>
        <span class="n">format_slot</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">format_slot</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tweaks</span><span class="p">:</span>
            <span class="n">tweaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tweaks</span><span class="o">.</span><span class="n">_list_format_contributions</span><span class="p">(</span><span class="n">directed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">directed</span><span class="p">)</span>
            <span class="n">format_slot</span><span class="o">.</span><span class="n">commands</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">tweaks</span><span class="p">)</span>
        <span class="n">pieces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_format_pieces</span><span class="p">()</span>
        <span class="n">format_slot</span><span class="o">.</span><span class="n">commands</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bundle</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">argument</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets argument of LilyPond literal.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; literal = abjad.LilyPondLiteral(r&quot;\slurDotted&quot;)</span>
<span class="sd">            &gt;&gt;&gt; literal.argument</span>
<span class="sd">            &#39;\\slurDotted&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_argument</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">directed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when literal is directed.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Directed literal:</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; literal = abjad.LilyPondLiteral(r&quot;\f&quot;, &quot;after&quot;, directed=True)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(literal).color = &quot;blue&quot;</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(literal).dynamic_line_spanner.staff_padding = 5</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(literal, staff[0])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    - \tweak DynamicLineSpanner.staff-padding #5</span>
<span class="sd">                    - \tweak color #blue</span>
<span class="sd">                    \f</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Nondirected literal:</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; literal = abjad.LilyPondLiteral(</span>
<span class="sd">            ...     r&quot;\breathe&quot;,</span>
<span class="sd">            ...     &quot;after&quot;,</span>
<span class="sd">            ...     directed=False,</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(literal).color = &quot;blue&quot;</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(literal, staff[0])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \tweak color #blue</span>
<span class="sd">                    \breathe</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>

<span class="sd">        Proper use of the ``directed`` property entails searching the LilyPond</span>
<span class="sd">        docs to understand whether LilyPond treats any particular command as</span>
<span class="sd">        directed or not. Most LilyPond commands are directed. LilyPond insists</span>
<span class="sd">        that a few commands (include ``\breathe``, ``\key``, ``\mark``) must</span>
<span class="sd">        not be directed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_directed</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">format_slot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets format slot of LilyPond literal.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; literal = abjad.LilyPondLiteral(r&quot;\slurDotted&quot;)</span>
<span class="sd">            &gt;&gt;&gt; literal.format_slot</span>
<span class="sd">            &#39;opening&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_slot</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tweaks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;TweakInterface&quot;</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets tweaks.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; literal = abjad.LilyPondLiteral(r&quot;\f&quot;, &quot;after&quot;, directed=True)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(literal).color = &quot;blue&quot;</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(literal, staff[0])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    - \tweak color #blue</span>
<span class="sd">                    \f</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tweaks</span>

    <span class="c1">### PUBLIC METHODS ###</span>

<div class="viewcode-block" id="LilyPondLiteral.list_allowable_format_slots"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.LilyPondLiteral.list_allowable_format_slots">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">list_allowable_format_slots</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists allowable format slots.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; for slot in abjad.LilyPondLiteral.list_allowable_format_slots():</span>
<span class="sd">            ...     slot</span>
<span class="sd">            ...</span>
<span class="sd">            &#39;absolute_after&#39;</span>
<span class="sd">            &#39;absolute_before&#39;</span>
<span class="sd">            &#39;after&#39;</span>
<span class="sd">            &#39;before&#39;</span>
<span class="sd">            &#39;closing&#39;</span>
<span class="sd">            &#39;opening&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">LilyPondLiteral</span><span class="o">.</span><span class="n">_allowable_format_slots</span></div></div>


<div class="viewcode-block" id="Interface"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.Interface">[docs]</a><span class="k">class</span> <span class="nc">Interface</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LilyPond name manager.</span>

<span class="sd">    Base class from which grob, setting and tweak managers inherit.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="Interface.__eq__"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.Interface.__eq__">[docs]</a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when ``argument`` is a LilyPond name manager with attribute</span>
<span class="sd">        pairs equal to those of this LilyPond name manager.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; note_1 = abjad.Note(&quot;c&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(note_1).voice.auto_beaming = False</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(note_1).staff.tuplet_full_length = True</span>

<span class="sd">            &gt;&gt;&gt; note_2 = abjad.Note(&quot;c&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(note_2).voice.auto_beaming = False</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(note_2).staff.tuplet_full_length = True</span>

<span class="sd">            &gt;&gt;&gt; note_3 = abjad.Note(&quot;c&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(note_3).voice.auto_beaming = True</span>

<span class="sd">            &gt;&gt;&gt; setting_1 = abjad.setting(note_1)</span>
<span class="sd">            &gt;&gt;&gt; setting_2 = abjad.setting(note_2)</span>
<span class="sd">            &gt;&gt;&gt; setting_3 = abjad.setting(note_3)</span>

<span class="sd">            &gt;&gt;&gt; setting_1 == setting_1</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; setting_1 == setting_2</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; setting_1 == setting_3</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; setting_2 == setting_1</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; setting_2 == setting_2</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; setting_2 == setting_3</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; setting_3 == setting_1</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; setting_3 == setting_2</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; setting_3 == setting_3</span>
<span class="sd">            True</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; note_1 = abjad.Note(&quot;c&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(note_1).note_head.color = &quot;red&quot;</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(note_1).stem.color = &quot;red&quot;</span>

<span class="sd">            &gt;&gt;&gt; note_2 = abjad.Note(&quot;c&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(note_2).note_head.color = &quot;red&quot;</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(note_2).stem.color = &quot;red&quot;</span>

<span class="sd">            &gt;&gt;&gt; note_3 = abjad.Note(&quot;c&#39;4&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(note_3).note_head.color = &quot;red&quot;</span>

<span class="sd">            &gt;&gt;&gt; override_1 = abjad.override(note_1)</span>
<span class="sd">            &gt;&gt;&gt; override_2 = abjad.override(note_2)</span>
<span class="sd">            &gt;&gt;&gt; override_3 = abjad.override(note_3)</span>

<span class="sd">            &gt;&gt;&gt; override_1 == override_1</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; override_1 == override_2</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; override_1 == override_3</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; override_2 == override_1</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; override_2 == override_2</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; override_2 == override_3</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; override_3 == override_1</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; override_3 == override_2</span>
<span class="sd">            False</span>
<span class="sd">            &gt;&gt;&gt; override_3 == override_3</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="n">attribute_pairs_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_attribute_pairs</span><span class="p">()</span>
            <span class="n">attribute_pairs_2</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">_get_attribute_pairs</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">attribute_pairs_1</span> <span class="o">==</span> <span class="n">attribute_pairs_2</span>
        <span class="k">return</span> <span class="kc">False</span></div>

    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets object state.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

<div class="viewcode-block" id="Interface.__hash__"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.Interface.__hash__">[docs]</a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Hashes LilyPond name manager.</span>

<span class="sd">        Redefined in tandem with __eq__.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__hash__</span><span class="p">()</span></div>

<div class="viewcode-block" id="Interface.__repr__"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.Interface.__repr__">[docs]</a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets interpreter representation of LilyPond name manager.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">body_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_attribute_pairs</span><span class="p">()</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">]</span>
        <span class="n">body_string</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">body_string</span><span class="si">}</span><span class="s2">)&quot;</span></div>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets object state.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_get_attribute_pairs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span></div>


<div class="viewcode-block" id="LilyPondOverride"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.LilyPondOverride">[docs]</a><span class="k">class</span> <span class="nc">LilyPondOverride</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LilyPond grob override.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">        ...    lilypond_type=&quot;Staff&quot;,</span>
<span class="sd">        ...    grob_name=&quot;TextSpanner&quot;,</span>
<span class="sd">        ...    once=True,</span>
<span class="sd">        ...    property_path=(</span>
<span class="sd">        ...        &quot;bound-details&quot;,</span>
<span class="sd">        ...        &quot;left&quot;,</span>
<span class="sd">        ...        &quot;text&quot;,</span>
<span class="sd">        ...        ),</span>
<span class="sd">        ...    value=abjad.Markup(r&quot;\bold { over pressure }&quot;),</span>
<span class="sd">        ...    )</span>

<span class="sd">        &gt;&gt;&gt; print(override.override_string)</span>
<span class="sd">        \once \override Staff.TextSpanner.bound-details.left.text = \markup {</span>
<span class="sd">            \bold</span>
<span class="sd">                {</span>
<span class="sd">                    over</span>
<span class="sd">                    pressure</span>
<span class="sd">                }</span>
<span class="sd">            }</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_grob_name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_is_revert&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_lilypond_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_once&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_property_path&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_value&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">_format_leaf_children</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">lilypond_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">grob_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;NoteHead&quot;</span><span class="p">,</span>
        <span class="n">once</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_revert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">property_path</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span>
        <span class="n">value</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">lilypond_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lilypond_type</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">lilypond_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lilypond_type</span> <span class="o">=</span> <span class="n">lilypond_type</span>
        <span class="k">assert</span> <span class="n">grob_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grob_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">grob_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">once</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">once</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">once</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_once</span> <span class="o">=</span> <span class="n">once</span>
        <span class="k">if</span> <span class="n">is_revert</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">is_revert</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">is_revert</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_revert</span> <span class="o">=</span> <span class="n">is_revert</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">property_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">property_path_</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">property_path</span><span class="p">,)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">property_path_</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">property_path</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">property_path_</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">property_path_</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">property_path_</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">_</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">property_path_</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_property_path</span> <span class="o">=</span> <span class="n">property_path_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="LilyPondOverride.__eq__"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.LilyPondOverride.__eq__">[docs]</a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when ``argument`` is a LilyPond grob override with equivalent</span>
<span class="sd">        keyword values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span></div>

<div class="viewcode-block" id="LilyPondOverride.__hash__"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.LilyPondOverride.__hash__">[docs]</a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Hashes LilyPond grob override.</span>

<span class="sd">        Redefined in tandem with __eq__.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__hash__</span><span class="p">()</span></div>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_get_lilypond_format_bundle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="n">LilyPondFormatBundle</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">once</span><span class="p">:</span>
            <span class="n">revert_format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">revert_format_pieces</span><span class="p">)</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">grob_reverts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">revert_format</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_revert</span><span class="p">:</span>
            <span class="n">override_format</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">override_format_pieces</span><span class="p">)</span>
            <span class="n">bundle</span><span class="o">.</span><span class="n">grob_overrides</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">override_format</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bundle</span>

    <span class="k">def</span> <span class="nf">_override_property_path_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lilypond_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lilypond_type</span><span class="p">)</span>
        <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grob_name</span><span class="p">)</span>
        <span class="n">parts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">property_path</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span>

    <span class="k">def</span> <span class="nf">_revert_property_path_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lilypond_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lilypond_type</span><span class="p">)</span>
        <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grob_name</span><span class="p">)</span>
        <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">property_path</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">grob_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets grob name.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">            ...     grob_name=&quot;Glissando&quot;,</span>
<span class="sd">            ...     property_path=&quot;style&quot;,</span>
<span class="sd">            ...     value=abjad.SchemeSymbol(&quot;zigzag&quot;),</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; override.grob_name</span>
<span class="sd">            &#39;Glissando&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grob_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_revert</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true if grob override is a grob revert.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">            ...     grob_name=&quot;Glissando&quot;,</span>
<span class="sd">            ...     property_path=&quot;style&quot;,</span>
<span class="sd">            ...     value=abjad.SchemeSymbol(&quot;zigzag&quot;),</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; bool(override.is_revert)</span>
<span class="sd">            False</span>

<span class="sd">            &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">            ...     grob_name=&quot;Glissando&quot;,</span>
<span class="sd">            ...     is_revert=True,</span>
<span class="sd">            ...     property_path=&quot;style&quot;,</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; bool(override.is_revert)</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_revert</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lilypond_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets LilyPond type of context.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">            ...    lilypond_type=&quot;Staff&quot;,</span>
<span class="sd">            ...    grob_name=&quot;TextSpanner&quot;,</span>
<span class="sd">            ...    once=True,</span>
<span class="sd">            ...    property_path=(</span>
<span class="sd">            ...        &quot;bound-details&quot;,</span>
<span class="sd">            ...        &quot;left&quot;,</span>
<span class="sd">            ...        &quot;text&quot;,</span>
<span class="sd">            ...        ),</span>
<span class="sd">            ...    value=abjad.Markup(r&quot;\bold { over pressure }&quot;),</span>
<span class="sd">            ...    )</span>
<span class="sd">            &gt;&gt;&gt; override.lilypond_type</span>
<span class="sd">            &#39;Staff&#39;</span>

<span class="sd">            &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">            ...     grob_name=&quot;Glissando&quot;,</span>
<span class="sd">            ...     property_path=&quot;style&quot;,</span>
<span class="sd">            ...     value=abjad.SchemeSymbol(&quot;zigzag&quot;),</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; override.lilypond_type is None</span>
<span class="sd">            True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lilypond_type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">once</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when grob override is to be applied only once.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">            ...    lilypond_type=&quot;Staff&quot;,</span>
<span class="sd">            ...    grob_name=&quot;TextSpanner&quot;,</span>
<span class="sd">            ...    once=True,</span>
<span class="sd">            ...    property_path=(</span>
<span class="sd">            ...        &quot;bound-details&quot;,</span>
<span class="sd">            ...        &quot;left&quot;,</span>
<span class="sd">            ...        &quot;text&quot;,</span>
<span class="sd">            ...        ),</span>
<span class="sd">            ...    value=abjad.Markup(r&quot;\bold { over pressure }&quot;),</span>
<span class="sd">            ...    )</span>
<span class="sd">            &gt;&gt;&gt; bool(override.once)</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">            ...     grob_name=&quot;Glissando&quot;,</span>
<span class="sd">            ...     property_path=&quot;style&quot;,</span>
<span class="sd">            ...     value=abjad.SchemeSymbol(&quot;zigzag&quot;),</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; bool(override.once)</span>
<span class="sd">            False</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_once</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">override_format_pieces</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets LilyPond grob override \override format pieces.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">            ...    lilypond_type=&quot;Staff&quot;,</span>
<span class="sd">            ...    grob_name=&quot;TextSpanner&quot;,</span>
<span class="sd">            ...    once=True,</span>
<span class="sd">            ...    property_path=(</span>
<span class="sd">            ...        &quot;bound-details&quot;,</span>
<span class="sd">            ...        &quot;left&quot;,</span>
<span class="sd">            ...        &quot;text&quot;,</span>
<span class="sd">            ...        ),</span>
<span class="sd">            ...    value=abjad.Markup(r&quot;\bold { over pressure }&quot;),</span>
<span class="sd">            ...    )</span>
<span class="sd">            &gt;&gt;&gt; for line in override.override_format_pieces:</span>
<span class="sd">            ...     line</span>
<span class="sd">            ...</span>
<span class="sd">            &#39;\\once \\override Staff.TextSpanner.bound-details.left.text = \\markup {&#39;</span>
<span class="sd">            &#39;    \\bold&#39;</span>
<span class="sd">            &#39;        {&#39;</span>
<span class="sd">            &#39;            over&#39;</span>
<span class="sd">            &#39;            pressure&#39;</span>
<span class="sd">            &#39;        }&#39;</span>
<span class="sd">            &#39;    }&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">once</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\once&quot;</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\override&quot;</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_override_property_path_string</span><span class="p">())</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">Scheme</span><span class="o">.</span><span class="n">format_embedded_scheme_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">value_pieces</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value_pieces</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">result</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value_pieces</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">override_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets LilyPond grob override \override string.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">            ...     grob_name=&quot;Glissando&quot;,</span>
<span class="sd">            ...     property_path=&quot;style&quot;,</span>
<span class="sd">            ...     value=abjad.SchemeSymbol(&quot;zigzag&quot;),</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; override.override_string</span>
<span class="sd">            &quot;\\override Glissando.style = #&#39;zigzag&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">override_format_pieces</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">property_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets LilyPond grob override property path.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">            ...    lilypond_type=&quot;Staff&quot;,</span>
<span class="sd">            ...    grob_name=&quot;TextSpanner&quot;,</span>
<span class="sd">            ...    once=True,</span>
<span class="sd">            ...    property_path=(</span>
<span class="sd">            ...        &quot;bound-details&quot;,</span>
<span class="sd">            ...        &quot;left&quot;,</span>
<span class="sd">            ...        &quot;text&quot;,</span>
<span class="sd">            ...        ),</span>
<span class="sd">            ...    value=abjad.Markup(r&quot;\bold { over pressure }&quot;),</span>
<span class="sd">            ...    )</span>
<span class="sd">            &gt;&gt;&gt; override.property_path</span>
<span class="sd">            (&#39;bound-details&#39;, &#39;left&#39;, &#39;text&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_property_path</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">revert_format_pieces</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets LilyPond grob override \revert format pieces.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">            ...     grob_name=&quot;Glissando&quot;,</span>
<span class="sd">            ...     property_path=&quot;style&quot;,</span>
<span class="sd">            ...     value=abjad.SchemeSymbol(&quot;zigzag&quot;),</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; override.revert_format_pieces</span>
<span class="sd">            (&#39;\\revert Glissando.style&#39;,)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\revert </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_revert_property_path_string</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">result</span><span class="p">,)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">revert_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets LilyPond grob override \revert string.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">            ...     grob_name=&quot;Glissando&quot;,</span>
<span class="sd">            ...     property_path=&quot;style&quot;,</span>
<span class="sd">            ...     value=abjad.SchemeSymbol(&quot;zigzag&quot;),</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; override.revert_string</span>
<span class="sd">            &#39;\\revert Glissando.style&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">revert_format_pieces</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets value of LilyPond grob override.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">            ...    lilypond_type=&quot;Staff&quot;,</span>
<span class="sd">            ...    grob_name=&quot;TextSpanner&quot;,</span>
<span class="sd">            ...    once=True,</span>
<span class="sd">            ...    property_path=(</span>
<span class="sd">            ...        &quot;bound-details&quot;,</span>
<span class="sd">            ...        &quot;left&quot;,</span>
<span class="sd">            ...        &quot;text&quot;,</span>
<span class="sd">            ...        ),</span>
<span class="sd">            ...    value=abjad.Markup(r&quot;\bold { over pressure }&quot;),</span>
<span class="sd">            ...    )</span>
<span class="sd">            &gt;&gt;&gt; override.value</span>
<span class="sd">            Markup(contents=[MarkupCommand(&#39;bold&#39;, [&#39;over&#39;, &#39;pressure&#39;])])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>

    <span class="c1">### PUBLIC METHODS ###</span>

<div class="viewcode-block" id="LilyPondOverride.tweak_string"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.LilyPondOverride.tweak_string">[docs]</a>    <span class="k">def</span> <span class="nf">tweak_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets LilyPond grob override \tweak string.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">            ...     grob_name=&quot;Glissando&quot;,</span>
<span class="sd">            ...     property_path=&quot;style&quot;,</span>
<span class="sd">            ...     value=abjad.SchemeSymbol(&quot;zigzag&quot;),</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; override.tweak_string()</span>
<span class="sd">            &quot;- \\tweak style #&#39;zigzag&quot;</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">            ...     grob_name=&quot;RehearsalMark&quot;,</span>
<span class="sd">            ...     property_path=&quot;color&quot;,</span>
<span class="sd">            ...     value=&quot;red&quot;,</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; override.tweak_string(directed=False)</span>
<span class="sd">            &#39;\\tweak color #red&#39;</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            LilyPond literals are allowed:</span>

<span class="sd">            &gt;&gt;&gt; override = abjad.LilyPondOverride(</span>
<span class="sd">            ...     grob_name=&quot;TextSpann&quot;,</span>
<span class="sd">            ...     property_path=(&quot;bound-details&quot;, &quot;left-broken&quot;, &quot;text&quot;),</span>
<span class="sd">            ...     value=abjad.LilyPondLiteral(r&quot;\markup \upright pont.&quot;),</span>
<span class="sd">            ...     )</span>
<span class="sd">            &gt;&gt;&gt; override.tweak_string(directed=False)</span>
<span class="sd">            &#39;\\tweak bound-details.left-broken.text \\markup \\upright pont.&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">directed</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;- \tweak&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;\tweak&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">grob</span><span class="p">:</span>
            <span class="n">property_path</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grob_name</span><span class="p">,)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_path</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">property_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_path</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">property_path</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">LilyPondLiteral</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">argument</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">Scheme</span><span class="o">.</span><span class="n">format_embedded_scheme_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="LilyPondSetting"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.LilyPondSetting">[docs]</a><span class="k">class</span> <span class="nc">LilyPondSetting</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LilyPond context setting.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; context_setting = abjad.LilyPondSetting(</span>
<span class="sd">        ...    lilypond_type=&quot;Score&quot;,</span>
<span class="sd">        ...    context_property=&quot;autoBeaming&quot;,</span>
<span class="sd">        ...    value=False,</span>
<span class="sd">        ...    )</span>

<span class="sd">        &gt;&gt;&gt; print(&quot;\n&quot;.join(context_setting.format_pieces))</span>
<span class="sd">        \set Score.autoBeaming = ##f</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### CLASS VARIABLES ###</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_context_property&quot;</span><span class="p">,</span> <span class="s2">&quot;_lilypond_type&quot;</span><span class="p">,</span> <span class="s2">&quot;_is_unset&quot;</span><span class="p">,</span> <span class="s2">&quot;_value&quot;</span><span class="p">)</span>

    <span class="n">_format_leaf_children</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">lilypond_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">context_property</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;autoBeaming&quot;</span><span class="p">,</span>
        <span class="n">is_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">value</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">lilypond_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lilypond_type</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">lilypond_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lilypond_type</span> <span class="o">=</span> <span class="n">lilypond_type</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">context_property</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">context_property</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_context_property</span> <span class="o">=</span> <span class="n">context_property</span>
        <span class="k">if</span> <span class="n">is_unset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">is_unset</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">is_unset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_unset</span> <span class="o">=</span> <span class="n">is_unset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="LilyPondSetting.__eq__"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.LilyPondSetting.__eq__">[docs]</a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when ``argument`` is a LilyPond context setting with</span>
<span class="sd">        equivalent keyword values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span></div>

<div class="viewcode-block" id="LilyPondSetting.__hash__"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.LilyPondSetting.__hash__">[docs]</a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Hashes LilyPond context setting.</span>

<span class="sd">        Redefined in tandem with __eq__.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__hash__</span><span class="p">()</span></div>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_get_lilypond_format_bundle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">bundle</span> <span class="o">=</span> <span class="n">LilyPondFormatBundle</span><span class="p">()</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">format_pieces</span><span class="p">)</span>
        <span class="n">bundle</span><span class="o">.</span><span class="n">context_settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bundle</span>

    <span class="c1">### PUBLIC PROPERTIES ###</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">context_property</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets LilyPond context property name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_context_property</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">format_pieces</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets LilyPond context setting ``\set`` or ``\unset`` format pieces.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_unset</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\set&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\unset&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lilypond_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lilypond_type</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">context_property</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context_property</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">Scheme</span><span class="o">.</span><span class="n">format_embedded_scheme_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">value_pieces</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value_pieces</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">result</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value_pieces</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_unset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true if context setting unsets its value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_unset</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lilypond_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets LilyPond type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lilypond_type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets value of LilyPond context setting.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span></div>


<div class="viewcode-block" id="OverrideInterface"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.OverrideInterface">[docs]</a><span class="k">class</span> <span class="nc">OverrideInterface</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LilyPond grob name manager.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        OverrideInterface instances are created by the</span>
<span class="sd">        ``abjad.override()`` factory function:</span>

<span class="sd">        &gt;&gt;&gt; note = abjad.Note(&quot;c&#39;4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(note)</span>
<span class="sd">        OverrideInterface()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="OverrideInterface.__getattr__"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.OverrideInterface.__getattr__">[docs]</a>    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Interface</span><span class="p">,</span> <span class="s2">&quot;OverrideInterface&quot;</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets Interface (or OverrideInterface) keyed to ``name``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Somewhat confusingly, getting a grob name returns a</span>
<span class="sd">            Interface:</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(staff[0]).note_head</span>
<span class="sd">            Interface()</span>

<span class="sd">            While getting a context name returns a OverrideInterface:</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(staff[0]).staff</span>
<span class="sd">            OverrideInterface()</span>

<span class="sd">            Which can then be deferenced to get a Interface:</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.override(staff[0]).staff.note_head</span>
<span class="sd">            Interface()</span>

<span class="sd">        Note that the dot-chained user syntax is unproblematic. But the class</span>
<span class="sd">        of each manager returned in the chain is likely to be surprising at</span>
<span class="sd">        first encounter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">camel_name</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">to_upper_camel_case</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">type_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{type_name!r}</span><span class="s2"> object has no attribute: </span><span class="si">{name!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">camel_name</span> <span class="ow">in</span> <span class="n">contexts</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">context</span> <span class="o">=</span> <span class="n">OverrideInterface</span><span class="p">()</span>
                <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>
                <span class="k">return</span> <span class="n">context</span>
        <span class="k">elif</span> <span class="n">camel_name</span> <span class="ow">in</span> <span class="n">grob_interfaces</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">Interface</span><span class="p">()</span>
                <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">type_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">type_name</span><span class="si">!r}</span><span class="s2"> object has no attribute: </span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s2">.&quot;</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="OverrideInterface.__setattr__"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.OverrideInterface.__setattr__">[docs]</a>    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets attribute ``attribute`` of grob name manager to ``value``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># make sure attribute name is valid grob name before setting value</span>
        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_get_attribute_tuples</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Interface</span><span class="p">:</span>
                <span class="n">grob</span><span class="p">,</span> <span class="n">grob_proxy</span> <span class="o">=</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span>
                <span class="n">pairs</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">grob_proxy</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
                <span class="k">for</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
                    <span class="n">triple</span> <span class="o">=</span> <span class="p">(</span><span class="n">grob</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">triple</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">context</span><span class="p">,</span> <span class="n">context_proxy</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">),</span> <span class="n">value</span>
                <span class="k">for</span> <span class="n">grob</span><span class="p">,</span> <span class="n">grob_proxy</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="n">context_proxy</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">pairs</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">grob_proxy</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
                    <span class="k">for</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
                        <span class="n">quadruple</span> <span class="o">=</span> <span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">grob</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">quadruple</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_list_format_contributions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contribution_type</span><span class="p">,</span> <span class="n">once</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">contribution_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;override&quot;</span><span class="p">,</span> <span class="s2">&quot;revert&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">attribute_tuple</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_attribute_tuples</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">attribute_tuple</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">context</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">grob</span> <span class="o">=</span> <span class="n">attribute_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">attribute</span> <span class="o">=</span> <span class="n">attribute_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">attribute_tuple</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">attribute_tuple</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">context</span> <span class="o">=</span> <span class="n">attribute_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">grob</span> <span class="o">=</span> <span class="n">attribute_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">attribute</span> <span class="o">=</span> <span class="n">attribute_tuple</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">attribute_tuple</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;invalid attribute tuple: </span><span class="si">{</span><span class="n">attribute_tuple</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">contribution_type</span> <span class="o">==</span> <span class="s2">&quot;override&quot;</span><span class="p">:</span>
                <span class="n">override_string</span> <span class="o">=</span> <span class="n">OverrideInterface</span><span class="o">.</span><span class="n">make_lilypond_override_string</span><span class="p">(</span>
                    <span class="n">grob</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span> <span class="n">once</span><span class="o">=</span><span class="n">once</span>
                <span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">override_string</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">revert_string</span> <span class="o">=</span> <span class="n">OverrideInterface</span><span class="o">.</span><span class="n">make_lilypond_revert_string</span><span class="p">(</span>
                    <span class="n">grob</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span>
                <span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">revert_string</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="c1">### PUBLIC METHODS ###</span>

<div class="viewcode-block" id="OverrideInterface.format_lilypond_attribute"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.OverrideInterface.format_lilypond_attribute">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">format_lilypond_attribute</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Formats LilyPond attribute according to Scheme formatting conventions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
        <span class="n">attribute</span> <span class="o">=</span> <span class="n">attribute</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">attribute</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="OverrideInterface.format_lilypond_value"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.OverrideInterface.format_lilypond_value">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">format_lilypond_value</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Formats LilyPond ``argument`` according to Scheme formatting</span>
<span class="sd">        conventions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;_get_lilypond_format&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">argument</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">Scheme</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argument</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="n">enums</span><span class="o">.</span><span class="n">Up</span><span class="p">,</span>
            <span class="n">enums</span><span class="o">.</span><span class="n">Down</span><span class="p">,</span>
            <span class="n">enums</span><span class="o">.</span><span class="n">Left</span><span class="p">,</span>
            <span class="n">enums</span><span class="o">.</span><span class="n">Right</span><span class="p">,</span>
            <span class="n">enums</span><span class="o">.</span><span class="n">Center</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">Scheme</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">Scheme</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">Scheme</span><span class="o">.</span><span class="n">lilypond_color_constants</span><span class="p">:</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">Scheme</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">argument</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
            <span class="c1"># argument = Scheme(argument)</span>
            <span class="k">return</span> <span class="n">argument</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;::&quot;</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">:</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">Scheme</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">SchemePair</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot; &quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">:</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">Scheme</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">:</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">Scheme</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">argument</span> <span class="o">=</span> <span class="n">Scheme</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">_get_lilypond_format</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="OverrideInterface.make_lilypond_override_string"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.OverrideInterface.make_lilypond_override_string">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">make_lilypond_override_string</span><span class="p">(</span>
        <span class="n">grob</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">once</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Makes Lilypond override string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">grob</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">grob</span><span class="p">)</span><span class="o">.</span><span class="n">to_upper_camel_case</span><span class="p">()</span>
        <span class="n">attribute</span> <span class="o">=</span> <span class="n">OverrideInterface</span><span class="o">.</span><span class="n">format_lilypond_attribute</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">OverrideInterface</span><span class="o">.</span><span class="n">format_lilypond_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize_start</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">once</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">once</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\once &quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">once</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">once</span><span class="si">}</span><span class="s2">\override </span><span class="si">{</span><span class="n">context</span><span class="si">}{</span><span class="n">grob</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="OverrideInterface.make_lilypond_revert_string"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.OverrideInterface.make_lilypond_revert_string">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">make_lilypond_revert_string</span><span class="p">(</span><span class="n">grob</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Makes LilyPond revert string.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; abjad.OverrideInterface.make_lilypond_revert_string(</span>
<span class="sd">            ...     &quot;glissando&quot;,</span>
<span class="sd">            ...     &quot;bound_details__right__arrow&quot;,</span>
<span class="sd">            ...     )</span>
<span class="sd">            &#39;\\revert Glissando.bound-details.right.arrow&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">grob</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">grob</span><span class="p">)</span><span class="o">.</span><span class="n">to_upper_camel_case</span><span class="p">()</span>
        <span class="n">dotted</span> <span class="o">=</span> <span class="n">OverrideInterface</span><span class="o">.</span><span class="n">format_lilypond_attribute</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="o">.</span><span class="n">to_upper_camel_case</span><span class="p">()</span>
            <span class="n">context</span> <span class="o">+=</span> <span class="s2">&quot;.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\revert </span><span class="si">{</span><span class="n">context</span><span class="si">}{</span><span class="n">grob</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">dotted</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<span class="c1">### FUNCTIONS ###</span>


<div class="viewcode-block" id="override"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.override">[docs]</a><span class="k">def</span> <span class="nf">override</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes LilyPond grob name manager.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Overrides staff symbol color:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 e&#39;4 d&#39;4 f&#39;4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(staff).staff_symbol.color = &quot;red&quot;</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override StaffSymbol.color = #red</span>
<span class="sd">            }</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Specify grob context like this:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 e&#39;4 d&#39;4 f&#39;4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(staff[0]).staff.staff_symbol.color = &quot;blue&quot;</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                \once \override Staff.StaffSymbol.color = #blue</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Returns LilyPond grob name manager:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 e&#39; d&#39; f&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(staff)</span>
<span class="sd">        OverrideInterface()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;_overrides&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">argument</span><span class="o">.</span><span class="n">_overrides</span> <span class="o">=</span> <span class="n">OverrideInterface</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">argument</span><span class="o">.</span><span class="n">_overrides</span></div>


<div class="viewcode-block" id="SettingInterface"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.SettingInterface">[docs]</a><span class="k">class</span> <span class="nc">SettingInterface</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LilyPond setting name manager.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; note = abjad.Note(&quot;c&#39;4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(note)</span>
<span class="sd">        SettingInterface()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="SettingInterface.__getattr__"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.SettingInterface.__getattr__">[docs]</a>    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets arbitrary object keyed to ``name``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.setting(staff).instrument_name = abjad.Markup(&quot;Vn. I&quot;)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">                \new Staff</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    instrumentName = \markup { &quot;Vn. I&quot; }</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    d&#39;4</span>
<span class="sd">                    e&#39;4</span>
<span class="sd">                    f&#39;4</span>
<span class="sd">                }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Returns arbitrary object keyed to ``name``:</span>

<span class="sd">            &gt;&gt;&gt; abjad.setting(staff).instrument_name</span>
<span class="sd">            Markup(contents=[&#39;Vn. I&#39;])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">camel_name</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">to_upper_camel_case</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;{type(self).__name__!r} object has no attribute: </span><span class="si">{name!r}</span><span class="s2">.&quot;</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">camel_name</span> <span class="ow">in</span> <span class="n">contexts</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">context</span> <span class="o">=</span> <span class="n">Interface</span><span class="p">()</span>
                <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>
                <span class="k">return</span> <span class="n">context</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;{type(self).__name__!r} object has no attribute: </span><span class="si">{name!r}</span><span class="s2">.&quot;</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></div>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_format_in_with_block</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">strings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="n">first</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">rest</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">rest</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rest</span><span class="p">]</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">first</span> <span class="o">+</span> <span class="n">rest</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">OverrideInterface</span><span class="o">.</span><span class="n">format_lilypond_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">value_parts</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">string</span><span class="si">!s}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">!s}</span><span class="s2">&quot;</span>
            <span class="n">pieces</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">value_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LilyPondFormatBundle</span><span class="o">.</span><span class="n">indent</span> <span class="o">+</span> <span class="n">part</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>
            <span class="n">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">strings</span>

    <span class="k">def</span> <span class="nf">_format_inline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># if we&#39;ve found a leaf context namespace</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">):</span>
                        <span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_inline_helper</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="c1"># otherwise we&#39;ve found a default leaf context setting</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># parse default context setting</span>
                <span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_inline_helper</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_format_inline_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
        <span class="n">first</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">rest</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">rest</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rest</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">first</span> <span class="o">+</span> <span class="n">rest</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">OverrideInterface</span><span class="o">.</span><span class="n">format_lilypond_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">context_string</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">context_string</span> <span class="o">=</span> <span class="n">context_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="n">context_string</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">context_string</span><span class="p">]</span>
            <span class="n">context_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">context_string</span><span class="p">)</span>
            <span class="n">context_string</span> <span class="o">+=</span> <span class="s2">&quot;.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">context_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\set </span><span class="si">{</span><span class="n">context_string</span><span class="si">}{</span><span class="n">name</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_get_attribute_tuples</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Interface</span><span class="p">:</span>
                <span class="n">prefixed_context_name</span> <span class="o">=</span> <span class="n">name</span>
                <span class="n">lilypond_type</span> <span class="o">=</span> <span class="n">prefixed_context_name</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="n">context_proxy</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">attribute_pairs</span> <span class="o">=</span> <span class="n">context_proxy</span><span class="o">.</span><span class="n">_get_attribute_pairs</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">attribute_name</span><span class="p">,</span> <span class="n">attribute_value</span> <span class="ow">in</span> <span class="n">attribute_pairs</span><span class="p">:</span>
                    <span class="n">triple</span> <span class="o">=</span> <span class="p">(</span><span class="n">lilypond_type</span><span class="p">,</span> <span class="n">attribute_name</span><span class="p">,</span> <span class="n">attribute_value</span><span class="p">)</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">triple</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">attribute_name</span><span class="p">,</span> <span class="n">attribute_value</span> <span class="o">=</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">attribute_name</span><span class="p">,</span> <span class="n">attribute_value</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span></div>


<span class="c1">### FUNCTIONS ###</span>


<div class="viewcode-block" id="setting"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.setting">[docs]</a><span class="k">def</span> <span class="nf">setting</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes LilyPond setting name manager.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Sets instrument name:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 e&#39;4 d&#39;4 f&#39;4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(staff).instrument_name = abjad.Markup(&quot;Vn. I&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>


<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                instrumentName = \markup { &quot;Vn. I&quot; }</span>
<span class="sd">            }</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Returns LilyPond setting name manager:</span>

<span class="sd">        &gt;&gt;&gt; abjad.setting(staff)</span>
<span class="sd">        SettingInterface((&#39;instrument_name&#39;, Markup(contents=[&#39;Vn. I&#39;])))</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;_lilypond_setting_name_manager&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">argument</span><span class="o">.</span><span class="n">_lilypond_setting_name_manager</span> <span class="o">=</span> <span class="n">SettingInterface</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">argument</span><span class="o">.</span><span class="n">_lilypond_setting_name_manager</span></div>


<div class="viewcode-block" id="TweakInterface"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.TweakInterface">[docs]</a><span class="k">class</span> <span class="nc">TweakInterface</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LilyPond tweak manager.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Tweak managers are created by the ``abjad.tweak()`` factory function:</span>

<span class="sd">        &gt;&gt;&gt; markup = abjad.Markup(&quot;Allegro&quot;, direction=abjad.Up)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(markup)</span>
<span class="sd">        TweakInterface((&#39;_literal&#39;, None))</span>

<span class="sd">        Set an attribute like this:</span>

<span class="sd">        &gt;&gt;&gt; abjad.tweak(markup).color = &quot;red&quot;</span>

<span class="sd">        The state of the tweak manager has changed:</span>

<span class="sd">        &gt;&gt;&gt; abjad.tweak(markup)</span>
<span class="sd">        TweakInterface((&#39;_literal&#39;, None), (&#39;color&#39;, &#39;red&#39;))</span>

<span class="sd">        And the value of the attribute just set is available like this:</span>

<span class="sd">        &gt;&gt;&gt; abjad.tweak(markup).color</span>
<span class="sd">        &#39;red&#39;</span>

<span class="sd">        Trying to get an attribute that has not yet been set raises an</span>
<span class="sd">        attribute error:</span>

<span class="sd">        &gt;&gt;&gt; abjad.tweak(markup).foo</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        AttributeError: TweakInterface object has no attribute &#39;foo&#39;.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">### INITIALIZER ###</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">deactivate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">literal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">deactivate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_currently_deactivated</span> <span class="o">=</span> <span class="n">deactivate</span>
        <span class="k">if</span> <span class="n">literal</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">literal</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">literal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_literal</span> <span class="o">=</span> <span class="n">literal</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_currently_tagging</span> <span class="o">=</span> <span class="n">tag</span>

    <span class="c1">### SPECIAL METHODS ###</span>

<div class="viewcode-block" id="TweakInterface.__getattr__"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.TweakInterface.__getattr__">[docs]</a>    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">Interface</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets Interface (or OverrideInterface) keyed to ``name``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Tweaks may be tagged:</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; markup = abjad.Markup(r&quot;\italic Allegro&quot;, direction=abjad.Up)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(markup, tag=abjad.Tag(&quot;+PARTS&quot;)).color = &quot;red&quot;</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(markup, staff[0])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                - \tweak color #red %! +PARTS</span>
<span class="sd">                ^ \markup {</span>
<span class="sd">                    \italic</span>
<span class="sd">                        Allegro</span>
<span class="sd">                    }</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">            Tweaks may be tagged with ``deactivate=True``:</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; markup = abjad.Markup(r&quot;\italic Allegro&quot;, direction=abjad.Up)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(</span>
<span class="sd">            ...     markup, deactivate=True, tag=abjad.Tag(&quot;+PARTS&quot;)</span>
<span class="sd">            ... ).color = &quot;red&quot;</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(markup, staff[0])</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                - \tweak color #red %! +PARTS</span>
<span class="sd">                ^ \markup {</span>
<span class="sd">                    \italic</span>
<span class="sd">                        Allegro</span>
<span class="sd">                    }</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">            Tweak tags and indicator tags may be set together:</span>

<span class="sd">            &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">            &gt;&gt;&gt; markup = abjad.Markup(r&quot;\italic Allegro&quot;, direction=abjad.Up)</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(markup, tag=abjad.Tag(&quot;+PARTS&quot;)).color = &quot;red&quot;</span>
<span class="sd">            &gt;&gt;&gt; abjad.attach(markup, staff[0], tag=abjad.Tag(&quot;RED:M1&quot;))</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff, align_tags=40)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                - \tweak color #red                 %! +PARTS</span>
<span class="sd">                ^ \markup {                         %! RED:M1</span>
<span class="sd">                    \italic                         %! RED:M1</span>
<span class="sd">                        Allegro                     %! RED:M1</span>
<span class="sd">                    }                               %! RED:M1</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Preloaded tweak managers can be made like this:</span>

<span class="sd">            &gt;&gt;&gt; tweaks = abjad.TweakInterface()</span>
<span class="sd">            &gt;&gt;&gt; tweaks.color = &quot;red&quot;</span>
<span class="sd">            &gt;&gt;&gt; tweaks.Y_offset = 6</span>
<span class="sd">            &gt;&gt;&gt; tweaks</span>
<span class="sd">            TweakInterface((&#39;Y_offset&#39;, 6), (&#39;_literal&#39;, None), (&#39;color&#39;, &#39;red&#39;))</span>

<span class="sd">            Use the ``abjad.tweak()`` factory function for a shortcut:</span>

<span class="sd">            &gt;&gt;&gt; tweaks = abjad.tweak(&quot;red&quot;).color</span>
<span class="sd">            &gt;&gt;&gt; tweaks</span>
<span class="sd">            TweakInterface((&#39;_literal&#39;, None), (&#39;color&#39;, &#39;red&#39;))</span>

<span class="sd">            &gt;&gt;&gt; tweaks.Y_offset = 6</span>
<span class="sd">            &gt;&gt;&gt; tweaks</span>
<span class="sd">            TweakInterface((&#39;Y_offset&#39;, 6), (&#39;_literal&#39;, None), (&#39;color&#39;, &#39;red&#39;))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Set long LilyPond grob chains like this:</span>

<span class="sd">            &gt;&gt;&gt; abjad.tweak(False).bound_details__left_broken__text</span>
<span class="sd">            TweakInterface((&#39;_literal&#39;, None), (&#39;bound_details__left_broken__text&#39;, False))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;_currently_deactivated&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_currently_deactivated&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;_currently_tagging&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_currently_tagging&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;_literal&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_literal&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;_pending_value&quot;</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">_pending_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending_value</span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">_pending_value</span><span class="p">)</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_pending_value&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="n">camel_name</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">to_upper_camel_case</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">type_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">type_name</span><span class="si">}</span><span class="s2"> object has no attribute </span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">camel_name</span> <span class="ow">in</span> <span class="n">grob_interfaces</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">Interface</span><span class="p">()</span>
                <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">type_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">type_name</span><span class="si">}</span><span class="s2"> object has no attribute </span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TweakInterface.__setattr__"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.TweakInterface.__setattr__">[docs]</a>    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets attribute ``name`` equal to ``value``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Allows LilyPond colors:</span>

<span class="sd">            &gt;&gt;&gt; abjad.tweak(&quot;ForestGreen&quot;).color</span>
<span class="sd">            TweakInterface((&#39;_literal&#39;, None), (&#39;color&#39;, &#39;ForestGreen&#39;))</span>

<span class="sd">            &gt;&gt;&gt; string = &quot;#(x11-color &#39;blue)&quot;</span>
<span class="sd">            &gt;&gt;&gt; abjad.tweak(string).color</span>
<span class="sd">            TweakInterface((&#39;_literal&#39;, None), (&#39;color&#39;, &quot;#(x11-color &#39;blue)&quot;))</span>

<span class="sd">            Raises exception on unknown color:</span>

<span class="sd">            &gt;&gt;&gt; abjad.tweak(&quot;SavannahGreen&quot;).color</span>
<span class="sd">            Traceback (most recent call last):</span>
<span class="sd">                ...</span>
<span class="sd">            Exception: &#39;SavannahGreen&#39; is not a LilyPond color.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;x11-color&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">if</span> <span class="n">color</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2"> is not a LilyPond color.&quot;</span><span class="p">)</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_currently_tagging&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">deactivate</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_currently_deactivated&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">deactivate</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;TAGGED&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;TAGGED&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;_currently_deactivated&quot;</span><span class="p">,</span> <span class="s2">&quot;_currently_tagging&quot;</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_currently_deactivated&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_currently_tagging&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span></div>

    <span class="c1">### PRIVATE METHODS ###</span>

    <span class="k">def</span> <span class="nf">_get_attribute_tuples</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">]:</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;_currently_tagging&quot;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;_literal&quot;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Interface</span><span class="p">:</span>
                <span class="n">grob_name</span> <span class="o">=</span> <span class="n">name</span>
                <span class="n">grob_proxy</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">pairs</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">grob_proxy</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
                <span class="k">for</span> <span class="n">attribute_name</span><span class="p">,</span> <span class="n">attribute_value</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
                    <span class="n">triple</span> <span class="o">=</span> <span class="p">(</span><span class="n">grob_name</span><span class="p">,</span> <span class="n">attribute_name</span><span class="p">,</span> <span class="n">attribute_value</span><span class="p">)</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">triple</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">attribute_name</span> <span class="o">=</span> <span class="n">name</span>
                <span class="n">attribute_value</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">pair</span> <span class="o">=</span> <span class="p">(</span><span class="n">attribute_name</span><span class="p">,</span> <span class="n">attribute_value</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_list_format_contributions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">attribute_tuple</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_attribute_tuples</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">attribute_tuple</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">grob</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">attribute</span> <span class="o">=</span> <span class="n">attribute_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">attribute_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">attribute_tuple</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">grob</span> <span class="o">=</span> <span class="n">attribute_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">attribute</span> <span class="o">=</span> <span class="n">attribute_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">attribute_tuple</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;invalid attribute tuple: </span><span class="si">{</span><span class="n">attribute_tuple</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">deactivate</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;TAGGED&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">deactivate</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="n">tag</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tag</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_lilypond_tweak_string</span><span class="p">(</span>
                <span class="n">attribute</span><span class="p">,</span>
                <span class="n">value</span><span class="p">,</span>
                <span class="n">directed</span><span class="o">=</span><span class="n">directed</span><span class="p">,</span>
                <span class="n">grob</span><span class="o">=</span><span class="n">grob</span><span class="p">,</span>
                <span class="n">literal</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_literal</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">strings</span> <span class="o">=</span> <span class="p">[</span><span class="n">string</span><span class="p">]</span>
                <span class="n">strings</span> <span class="o">=</span> <span class="n">_tag</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="n">deactivate</span><span class="o">=</span><span class="n">deactivate</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">strings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="c1">### PUBLIC METHODS ###</span>

<div class="viewcode-block" id="TweakInterface.make_lilypond_tweak_string"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.TweakInterface.make_lilypond_tweak_string">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">make_lilypond_tweak_string</span><span class="p">(</span>
        <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grob</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">literal</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Makes Lilypond \tweak string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">grob</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">grob</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">grob</span><span class="p">)</span><span class="o">.</span><span class="n">to_upper_camel_case</span><span class="p">()</span>
            <span class="n">grob</span> <span class="o">+=</span> <span class="s2">&quot;.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">grob</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">attribute</span> <span class="o">=</span> <span class="n">OverrideInterface</span><span class="o">.</span><span class="n">format_lilypond_attribute</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">literal</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">OverrideInterface</span><span class="o">.</span><span class="n">format_lilypond_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\tweak </span><span class="si">{</span><span class="n">grob</span><span class="si">}{</span><span class="n">attribute</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">directed</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;- &quot;</span> <span class="o">+</span> <span class="n">string</span>
        <span class="k">return</span> <span class="n">string</span></div>

<div class="viewcode-block" id="TweakInterface.set_tweaks"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.TweakInterface.set_tweaks">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">set_tweaks</span><span class="p">(</span>
        <span class="n">argument</span><span class="p">,</span> <span class="n">manager</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;TweakInterface&quot;</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;TweakInterface&quot;</span><span class="p">]:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets tweaks on ``argument``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; glissando = abjad.Glissando()</span>
<span class="sd">            &gt;&gt;&gt; glissando.tweaks is None</span>
<span class="sd">            True</span>

<span class="sd">            &gt;&gt;&gt; tweaks = abjad.tweak(&quot;blue&quot;).color</span>
<span class="sd">            &gt;&gt;&gt; abjad.TweakInterface.set_tweaks(glissando, tweaks)</span>
<span class="sd">            TweakInterface((&#39;_literal&#39;, None), (&#39;color&#39;, &#39;blue&#39;))</span>

<span class="sd">            &gt;&gt;&gt; abjad.tweak(glissando)</span>
<span class="sd">            TweakInterface((&#39;_literal&#39;, None), (&#39;color&#39;, &#39;blue&#39;))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;_tweaks&quot;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">argument</span><span class="o">.</span><span class="n">_tweaks</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> does not implement tweaks.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">manager</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">manager</span><span class="p">,</span> <span class="n">TweakInterface</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;must be tweak manager (not </span><span class="si">{</span><span class="n">manager</span><span class="si">!r}</span><span class="s2">).&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">argument</span><span class="o">.</span><span class="n">_tweaks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">argument</span><span class="o">.</span><span class="n">_tweaks</span> <span class="o">=</span> <span class="n">TweakInterface</span><span class="p">(</span><span class="n">literal</span><span class="o">=</span><span class="n">manager</span><span class="o">.</span><span class="n">_literal</span><span class="p">)</span>
        <span class="n">existing_manager</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">_tweaks</span>
        <span class="k">for</span> <span class="n">tuple_</span> <span class="ow">in</span> <span class="n">manager</span><span class="o">.</span><span class="n">_get_attribute_tuples</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tuple_</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">tuple_</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">existing_manager</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tuple_</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">grob</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">tuple_</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="n">grob</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">existing_manager</span><span class="p">,</span> <span class="n">grob</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">grob</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;tweak tuple must have length 2 or 3&quot;</span>
                <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; (not </span><span class="si">{</span><span class="n">tuple_</span><span class="si">!r}</span><span class="s2">).&quot;</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">existing_manager</span></div></div>


<span class="n">IndexedTweakManager</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">TweakInterface</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">TweakInterface</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>

<span class="n">IndexedTweakManagers</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">IndexedTweakManager</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>


<span class="c1">### FUNCTIONS ###</span>


<div class="viewcode-block" id="tweak"><a class="viewcode-back" href="../../api/abjad/overrides.html#abjad.overrides.tweak">[docs]</a><span class="k">def</span> <span class="nf">tweak</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">deactivate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">expression</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">literal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes LilyPond tweak manager.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Tweaks markup:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; markup = abjad.Markup(&quot;Allegro assai&quot;, direction=abjad.Up)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(markup).color = &quot;red&quot;</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(markup, staff[0])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                - \tweak color #red</span>
<span class="sd">                ^ \markup { &quot;Allegro assai&quot; }</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">        Survives copy:</span>

<span class="sd">        &gt;&gt;&gt; import copy</span>
<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; markup_1 = abjad.Markup(&quot;Allegro assai&quot;, direction=abjad.Up)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(markup_1).color = &quot;red&quot;</span>
<span class="sd">        &gt;&gt;&gt; markup_2 = copy.copy(markup_1)</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(markup_2, staff[0])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                - \tweak color #red</span>
<span class="sd">                ^ \markup { &quot;Allegro assai&quot; }</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">        Survives dot-chaining:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; markup = abjad.Markup(r&#39;\italic &quot;Allegro assai&quot;&#39;, direction=abjad.Up)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(markup).color = &quot;red&quot;</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(markup, staff[0])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                - \tweak color #red</span>
<span class="sd">                ^ \markup {</span>
<span class="sd">                    \italic</span>
<span class="sd">                        &quot;Allegro assai&quot;</span>
<span class="sd">                    }</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">        Works for opposite-directed coincident markup:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; markup_1 = abjad.Markup(&quot;Allegro assai ...&quot;, direction=abjad.Up)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(markup_1).color = &quot;red&quot;</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(markup_1, staff[0])</span>
<span class="sd">        &gt;&gt;&gt; markup_2 = abjad.Markup(&quot;... ma non troppo&quot;, direction=abjad.Down)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(markup_2).color = &quot;blue&quot;</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(markup_2).staff_padding = 4</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(markup_2, staff[0])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                - \tweak color #red</span>
<span class="sd">                ^ \markup { &quot;Allegro assai ...&quot; }</span>
<span class="sd">                - \tweak color #blue</span>
<span class="sd">                - \tweak staff-padding #4</span>
<span class="sd">                _ \markup { &quot;... ma non troppo&quot; }</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">        Ignored for same-directed coincident markup:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; markup_1 = abjad.Markup(&quot;Allegro assai ...&quot;, direction=abjad.Up)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(markup_1).color = &quot;red&quot;</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(markup_1, staff[0])</span>
<span class="sd">        &gt;&gt;&gt; markup_2 = abjad.Markup(&quot;... ma non troppo&quot;, direction=abjad.Up)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(markup_2).color = &quot;blue&quot;</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(markup_2).staff_padding = 4</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(markup_2, staff[0])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                - \tweak color #red</span>
<span class="sd">                ^ \markup { &quot;Allegro assai ...&quot; }</span>
<span class="sd">                - \tweak color #blue</span>
<span class="sd">                - \tweak staff-padding #4</span>
<span class="sd">                ^ \markup { &quot;... ma non troppo&quot; }</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                e&#39;4</span>
<span class="sd">                f&#39;4</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Tweaks note-head:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 cs&#39; d&#39; ds&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(staff[1].note_head).color = &quot;red&quot;</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                \tweak color #red</span>
<span class="sd">                cs&#39;4</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                ds&#39;4</span>
<span class="sd">            }</span>

<span class="sd">        Tweaks grob aggregated to note-head:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 cs&#39; d&#39; ds&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(staff[1].note_head).accidental.color = &quot;red&quot;</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">            \new Staff</span>
<span class="sd">            {</span>
<span class="sd">                c&#39;4</span>
<span class="sd">                \tweak Accidental.color #red</span>
<span class="sd">                cs&#39;4</span>
<span class="sd">                d&#39;4</span>
<span class="sd">                ds&#39;4</span>
<span class="sd">            }</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Tweaks can be tagged:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; dynamic = abjad.Dynamic(&quot;f&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(dynamic, tag=abjad.Tag(&quot;RED&quot;)).color = &quot;red&quot;</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(dynamic, staff[0])</span>

<span class="sd">        &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">        \new Staff</span>
<span class="sd">        {</span>
<span class="sd">            c&#39;4</span>
<span class="sd">            - \tweak color #red %! RED</span>
<span class="sd">            \f</span>
<span class="sd">            d&#39;4</span>
<span class="sd">            e&#39;4</span>
<span class="sd">            f&#39;4</span>
<span class="sd">        }</span>

<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">        REGRESSION. Tweaked tags can be set multiple times:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;4 d&#39; e&#39; f&#39;&quot;)</span>
<span class="sd">        &gt;&gt;&gt; dynamic = abjad.Dynamic(&quot;f&quot;)</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(dynamic, tag=abjad.Tag(&quot;RED&quot;)).color = &quot;red&quot;</span>
<span class="sd">        &gt;&gt;&gt; abjad.tweak(dynamic, tag=abjad.Tag(&quot;BLUE&quot;)).color = &quot;blue&quot;</span>
<span class="sd">        &gt;&gt;&gt; abjad.attach(dynamic, staff[0])</span>

<span class="sd">        &gt;&gt;&gt; abjad.f(staff)</span>
<span class="sd">        \new Staff</span>
<span class="sd">        {</span>
<span class="sd">            c&#39;4</span>
<span class="sd">            - \tweak color #blue %! BLUE</span>
<span class="sd">            \f</span>
<span class="sd">            d&#39;4</span>
<span class="sd">            e&#39;4</span>
<span class="sd">            f&#39;4</span>
<span class="sd">        }</span>

<span class="sd">        &gt;&gt;&gt; abjad.show(staff) # doctest: +SKIP</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Returns LilyPond tweak manager:</span>

<span class="sd">        &gt;&gt;&gt; abjad.tweak(markup_1)</span>
<span class="sd">        TweakInterface((&#39;_literal&#39;, None), (&#39;color&#39;, &#39;red&#39;))</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Tweak expressions work like this:</span>

<span class="sd">        &gt;&gt;&gt; abjad.tweak(&quot;red&quot;).color</span>
<span class="sd">        TweakInterface((&#39;_literal&#39;, None), (&#39;color&#39;, &#39;red&#39;))</span>

<span class="sd">        &gt;&gt;&gt; abjad.tweak(6).Y_offset</span>
<span class="sd">        TweakInterface((&#39;Y_offset&#39;, 6), (&#39;_literal&#39;, None))</span>

<span class="sd">        &gt;&gt;&gt; abjad.tweak(False).bound_details__left_broken__text</span>
<span class="sd">        TweakInterface((&#39;_literal&#39;, None), (&#39;bound_details__left_broken__text&#39;, False))</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">_tag</span><span class="o">.</span><span class="n">Tag</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;must be be tag: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">constants</span> <span class="o">=</span> <span class="p">(</span><span class="n">enums</span><span class="o">.</span><span class="n">Down</span><span class="p">,</span> <span class="n">enums</span><span class="o">.</span><span class="n">Left</span><span class="p">,</span> <span class="n">enums</span><span class="o">.</span><span class="n">Right</span><span class="p">,</span> <span class="n">enums</span><span class="o">.</span><span class="n">Up</span><span class="p">)</span>
    <span class="n">prototype</span> <span class="o">=</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">Scheme</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">expression</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">constants</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">prototype</span><span class="p">):</span>
        <span class="n">interface</span> <span class="o">=</span> <span class="n">TweakInterface</span><span class="p">(</span><span class="n">deactivate</span><span class="o">=</span><span class="n">deactivate</span><span class="p">,</span> <span class="n">literal</span><span class="o">=</span><span class="n">literal</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="n">interface</span><span class="o">.</span><span class="n">_pending_value</span> <span class="o">=</span> <span class="n">argument</span>
        <span class="k">return</span> <span class="n">interface</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="s2">&quot;_tweaks&quot;</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> does not allow tweaks (yet).&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">argument</span><span class="o">.</span><span class="n">_tweaks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">interface</span> <span class="o">=</span> <span class="n">TweakInterface</span><span class="p">(</span><span class="n">deactivate</span><span class="o">=</span><span class="n">deactivate</span><span class="p">,</span> <span class="n">literal</span><span class="o">=</span><span class="n">literal</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="n">argument</span><span class="o">.</span><span class="n">_tweaks</span> <span class="o">=</span> <span class="n">interface</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interface</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">_tweaks</span>
        <span class="n">interface</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">deactivate</span><span class="o">=</span><span class="n">deactivate</span><span class="p">,</span> <span class="n">literal</span><span class="o">=</span><span class="n">literal</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">interface</span></div>
</pre></div>

    </div>
    
    </div>
    

<footer>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

</div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>