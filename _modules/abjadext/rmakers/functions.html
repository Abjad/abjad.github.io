<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>abjadext.rmakers.functions &mdash; Abjad 3.17 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/abjad.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/uqbar.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/lightbox2/css/lightbox.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="canonical" href="https://abjad.github.io_modules/abjadext/rmakers/functions.html"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script defer="defer" src="../../../_static/copybutton.js"></script>
        <script src="../../../_static/ga.js"></script>
        <script defer="defer" src="../../../_static/lightbox2/js/lightbox.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #bb6611" >


    <a href="../../../index.html" class="icon icon-home" alt="Documentation
    Home"> Abjad 3.17



    <img src="../../../_static/abjad-logo.png" class="logo" alt="Logo"/>

</a>




<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">First steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../first_steps/audience.html">Audience</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../first_steps/macos.html">macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../first_steps/linux.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../first_steps/windows.html">Windows</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/containers-basic-operations-on.html">Containers, basic operations on</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/containers-retrieving-by-name.html">Containers, retrieving by name</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/containers-time-interpretation-of.html">Containers, time interpretation of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/contexts-lilypond-type-of.html">Contexts, LilyPond type of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/indicators.html">Indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/lilypond-files-preamble-of.html">LilyPond files, preamble of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/lilypond-format-of-abjad-objects.html">LilyPond format, of Abjad objects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/corpus-selection.html">Corpus, figure selection from</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/design-by-dyads.html">Design, by dyads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/enumeration.html">Enumeration, of rhythmic cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/magic-square-from-twelve-tone-row.html">Magic square, from twelve-tone row</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/scales-diatonic.html">Scales, diatonic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/score-fragment-piano.html">Score fragment, piano</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All classes &amp; functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">Abjad API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/best-practices.html">Best practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/changes.html">Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/developer-installation.html">Developer installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/lilypond-context-concatenation.html">LilyPond context concatenation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/publications.html">Publications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Score gallery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../gallery-2020.html">2016-present</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gallery-2015.html">2015-11</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gallery-2010.html">2010-00</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #bb6611" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Abjad</a>
      </nav>

      <div class="wy-nav-content">

<div class="rst-content">

    


    <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    <div itemprop="articleBody">
    
  <h1>Source code for abjadext.rmakers.functions</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The rmakers functions.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">import</span> <span class="nn">abjad</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">classes</span> <span class="k">as</span> <span class="n">_classes</span>


<span class="k">def</span> <span class="nf">_function_name</span><span class="p">(</span><span class="n">frame</span><span class="p">):</span>
    <span class="n">function_name</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_code</span><span class="o">.</span><span class="n">co_name</span>
    <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;rmakers.</span><span class="si">{</span><span class="n">function_name</span><span class="si">}</span><span class="s2">()&quot;</span>
    <span class="k">return</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_interpolate_cosine</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="n">mu2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">mu</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">y1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mu2</span><span class="p">)</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">*</span> <span class="n">mu2</span>


<span class="k">def</span> <span class="nf">_interpolate_divide_multiple</span><span class="p">(</span>
    <span class="n">total_durations</span><span class="p">,</span> <span class="n">reference_durations</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="s2">&quot;cosine&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Interpolates ``reference_durations`` such that the sum of the resulting</span>
<span class="sd">    interpolated values equals the given ``total_durations``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; durations = rmakers.functions._interpolate_divide_multiple(</span>
<span class="sd">        ...     total_durations=[100, 50],</span>
<span class="sd">        ...     reference_durations=[20, 10, 20],</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; for duration in durations:</span>
<span class="sd">        ...     duration</span>
<span class="sd">        19.448...</span>
<span class="sd">        18.520...</span>
<span class="sd">        16.227...</span>
<span class="sd">        13.715...</span>
<span class="sd">        11.748...</span>
<span class="sd">        10.487...</span>
<span class="sd">        9.8515...</span>
<span class="sd">        9.5130...</span>
<span class="sd">        10.421...</span>
<span class="sd">        13.073...</span>
<span class="sd">        16.991...</span>

<span class="sd">    Precondition: ``len(totals_durations) == len(reference_durations)-1``.</span>

<span class="sd">    Set ``exponent`` to ``cosine`` for cosine interpolation. Set ``exponent`` to a</span>
<span class="sd">    number for exponential interpolation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">total_durations</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">reference_durations</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">durations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">total_durations</span><span class="p">)):</span>
        <span class="n">durations_</span> <span class="o">=</span> <span class="n">_interpolate_divide</span><span class="p">(</span>
            <span class="n">total_durations</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">reference_durations</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">reference_durations</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">exponent</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">duration_</span> <span class="ow">in</span> <span class="n">durations_</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">duration_</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
            <span class="n">durations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">duration_</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">durations</span>


<span class="k">def</span> <span class="nf">_interpolate_exponential</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Interpolates between ``y1`` and ``y2`` at position ``mu``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Exponents equal to 1 leave durations unscaled:</span>

<span class="sd">        &gt;&gt;&gt; for mu in (0, 0.25, 0.5, 0.75, 1):</span>
<span class="sd">        ...     rmakers.functions._interpolate_exponential(100, 200, mu, exponent=1)</span>
<span class="sd">        ...</span>
<span class="sd">        100</span>
<span class="sd">        125.0</span>
<span class="sd">        150.0</span>
<span class="sd">        175.0</span>
<span class="sd">        200</span>

<span class="sd">        Exponents greater than 1 generate ritardandi:</span>

<span class="sd">        &gt;&gt;&gt; for mu in (0, 0.25, 0.5, 0.75, 1):</span>
<span class="sd">        ...     rmakers.functions._interpolate_exponential(100, 200, mu, exponent=2)</span>
<span class="sd">        ...</span>
<span class="sd">        100</span>
<span class="sd">        106.25</span>
<span class="sd">        125.0</span>
<span class="sd">        156.25</span>
<span class="sd">        200</span>

<span class="sd">        Exponents less than 1 generate accelerandi:</span>

<span class="sd">        &gt;&gt;&gt; for mu in (0, 0.25, 0.5, 0.75, 1):</span>
<span class="sd">        ...     rmakers.functions._interpolate_exponential(100, 200, mu, exponent=0.5)</span>
<span class="sd">        ...</span>
<span class="sd">        100.0</span>
<span class="sd">        150.0</span>
<span class="sd">        170.71067811865476</span>
<span class="sd">        186.60254037844388</span>
<span class="sd">        200.0</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mu</span><span class="o">**</span><span class="n">exponent</span><span class="p">)</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">*</span> <span class="n">mu</span><span class="o">**</span><span class="n">exponent</span>
    <span class="k">return</span> <span class="n">result</span>


<span class="k">def</span> <span class="nf">_interpolate_divide</span><span class="p">(</span>
    <span class="n">total_duration</span><span class="p">,</span> <span class="n">start_duration</span><span class="p">,</span> <span class="n">stop_duration</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="s2">&quot;cosine&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Divides ``total_duration`` into durations computed from interpolating between</span>
<span class="sd">    ``start_duration`` and ``stop_duration``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; rmakers.functions._interpolate_divide(</span>
<span class="sd">        ...     total_duration=10,</span>
<span class="sd">        ...     start_duration=1,</span>
<span class="sd">        ...     stop_duration=1,</span>
<span class="sd">        ...     exponent=1,</span>
<span class="sd">        ... )</span>
<span class="sd">        [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]</span>
<span class="sd">        &gt;&gt;&gt; sum(_)</span>
<span class="sd">        10.0</span>

<span class="sd">        &gt;&gt;&gt; rmakers.functions._interpolate_divide(</span>
<span class="sd">        ...     total_duration=10,</span>
<span class="sd">        ...     start_duration=5,</span>
<span class="sd">        ...     stop_duration=1,</span>
<span class="sd">        ... )</span>
<span class="sd">        [4.798..., 2.879..., 1.326..., 0.995...]</span>
<span class="sd">        &gt;&gt;&gt; sum(_)</span>
<span class="sd">        10.0</span>

<span class="sd">    Set ``exponent`` to ``&#39;cosine&#39;`` for cosine interpolation.</span>

<span class="sd">    Set ``exponent`` to a numeric value for exponential interpolation with</span>
<span class="sd">    ``exponent`` as the exponent.</span>

<span class="sd">    Scales resulting durations so that their sum equals ``total_duration`` exactly.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">total_duration</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Total duration must be positive.&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">start_duration</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">stop_duration</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Both &#39;start_duration&#39; and &#39;stop_duration&#39;&quot;</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot; must be positive.&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">total_duration</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">stop_duration</span> <span class="o">+</span> <span class="n">start_duration</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;too small&quot;</span>
    <span class="n">durations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">total_duration</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">total_duration</span><span class="p">)</span>
    <span class="n">partial_sum</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">while</span> <span class="n">partial_sum</span> <span class="o">&lt;</span> <span class="n">total_duration</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">exponent</span> <span class="o">==</span> <span class="s2">&quot;cosine&quot;</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">_interpolate_cosine</span><span class="p">(</span>
                <span class="n">start_duration</span><span class="p">,</span> <span class="n">stop_duration</span><span class="p">,</span> <span class="n">partial_sum</span> <span class="o">/</span> <span class="n">total_duration</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">_interpolate_exponential</span><span class="p">(</span>
                <span class="n">start_duration</span><span class="p">,</span>
                <span class="n">stop_duration</span><span class="p">,</span>
                <span class="n">partial_sum</span> <span class="o">/</span> <span class="n">total_duration</span><span class="p">,</span>
                <span class="n">exponent</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">durations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
        <span class="n">partial_sum</span> <span class="o">+=</span> <span class="n">duration</span>
    <span class="n">durations</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span> <span class="o">*</span> <span class="n">total_duration</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">durations</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">durations</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">durations</span>


<span class="k">def</span> <span class="nf">_is_accelerando</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
    <span class="n">first_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">last_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">first_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">first_leaf</span><span class="p">)</span>
    <span class="n">last_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">last_leaf</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">last_duration</span> <span class="o">&lt;</span> <span class="n">first_duration</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>


<span class="k">def</span> <span class="nf">_is_ritardando</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
    <span class="n">first_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">last_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">first_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">first_leaf</span><span class="p">)</span>
    <span class="n">last_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">last_leaf</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">first_duration</span> <span class="o">&lt;</span> <span class="n">last_duration</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>


<span class="k">def</span> <span class="nf">_make_beamable_groups</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="n">durations</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">durations</span><span class="p">)</span>
    <span class="n">music_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">music_duration</span> <span class="o">!=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">durations</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;music duration </span><span class="si">{</span><span class="n">music_duration</span><span class="si">}</span><span class="s2"> does not equal&quot;</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; total duration </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">durations</span><span class="p">)</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;   </span><span class="si">{</span><span class="n">components</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;   </span><span class="si">{</span><span class="n">durations</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="n">component_to_timespan</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">start_offset</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="n">stop_offset</span> <span class="o">=</span> <span class="n">start_offset</span> <span class="o">+</span> <span class="n">duration</span>
        <span class="n">timespan</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Timespan</span><span class="p">(</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="p">)</span>
        <span class="n">pair</span> <span class="o">=</span> <span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span>
        <span class="n">component_to_timespan</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
        <span class="n">start_offset</span> <span class="o">=</span> <span class="n">stop_offset</span>
    <span class="n">group_to_target_duration</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">start_offset</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">target_duration</span> <span class="ow">in</span> <span class="n">durations</span><span class="p">:</span>
        <span class="n">stop_offset</span> <span class="o">=</span> <span class="n">start_offset</span> <span class="o">+</span> <span class="n">target_duration</span>
        <span class="n">group_timespan</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Timespan</span><span class="p">(</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="p">)</span>
        <span class="n">start_offset</span> <span class="o">=</span> <span class="n">stop_offset</span>
        <span class="n">group</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">component</span><span class="p">,</span> <span class="n">component_timespan</span> <span class="ow">in</span> <span class="n">component_to_timespan</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">component_timespan</span> <span class="ow">in</span> <span class="n">group_timespan</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="n">pair</span> <span class="o">=</span> <span class="p">([</span><span class="n">group</span><span class="p">],</span> <span class="n">target_duration</span><span class="p">)</span>
        <span class="n">group_to_target_duration</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
    <span class="n">beamable_groups</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">target_duration</span> <span class="ow">in</span> <span class="n">group_to_target_duration</span><span class="p">:</span>
        <span class="n">group_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">group_duration</span> <span class="o">&lt;=</span> <span class="n">target_duration</span>
        <span class="k">if</span> <span class="n">group_duration</span> <span class="o">==</span> <span class="n">target_duration</span><span class="p">:</span>
            <span class="n">beamable_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">beamable_groups</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
    <span class="k">return</span> <span class="n">beamable_groups</span>


<span class="k">def</span> <span class="nf">_make_time_signature_staff</span><span class="p">(</span><span class="n">time_signatures</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">time_signatures</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">time_signatures</span><span class="p">)</span>
    <span class="n">staff</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Staff</span><span class="p">(</span><span class="n">simultaneous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Score</span><span class="p">([</span><span class="n">staff</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Score&quot;</span><span class="p">)</span>
    <span class="n">time_signature_voice</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;TimeSignatureVoice&quot;</span><span class="p">)</span>
    <span class="n">staff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time_signature_voice</span><span class="p">)</span>
    <span class="n">staff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;RhythmMaker.Music&quot;</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">time_signature</span> <span class="ow">in</span> <span class="n">time_signatures</span><span class="p">:</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">time_signature</span><span class="o">.</span><span class="n">pair</span>
        <span class="n">skip</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Skip</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">=</span><span class="n">duration</span><span class="p">)</span>
        <span class="n">time_signature_voice</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">skip</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">time_signature</span><span class="p">,</span> <span class="n">skip</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s2">&quot;Staff&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">score</span>


<span class="k">def</span> <span class="nf">_validate_tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">iterate</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">tuplet</span><span class="o">.</span><span class="n">multiplier</span><span class="p">)</span><span class="o">.</span><span class="n">normalized</span><span class="p">(),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tuplet</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>


<div class="viewcode-block" id="after_grace_container"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.after_grace_container">[docs]</a><span class="k">def</span> <span class="nf">after_grace_container</span><span class="p">(</span>
    <span class="n">argument</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Component</span> <span class="o">|</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Component</span><span class="p">],</span>
    <span class="n">counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">beam</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">slash</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">talea</span><span class="p">:</span> <span class="n">_classes</span><span class="o">.</span><span class="n">Talea</span> <span class="o">=</span> <span class="n">_classes</span><span class="o">.</span><span class="n">Talea</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="mi">8</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes (and attaches) after-grace containers.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs, *, beam=False, slash=False):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [4], extra_counts=[2])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.note(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.after_grace_container(notes, [1, 4], beam=beam, slash=slash)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        ...     abjad.setting(score).autoBeaming = False</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        With ``beam=False`` and ``slash=False``:</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs, beam=False, slash=False)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/5</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \afterGrace</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/5</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \afterGrace</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        With ``beam=True`` and ``slash=True``:</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs, beam=True, slash=True)</span>
<span class="sd">        &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/5</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \afterGrace</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/5</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \afterGrace</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            {</span>
<span class="sd">                                \slash</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                [</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        When ``slash=True`` then ``beam`` must also be true.</span>

<span class="sd">        Leaves lone after-graces unslashed even when ``slash=True``.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">slash</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">beam</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">beam</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">talea</span><span class="p">,</span> <span class="n">_classes</span><span class="o">.</span><span class="n">Talea</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">talea</span><span class="p">)</span>
    <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">grace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">cyclic_counts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">leaves</span><span class="p">):</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">cyclic_counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">count</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">count</span>
        <span class="n">durations</span> <span class="o">=</span> <span class="n">talea</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="n">notes</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">makers</span><span class="o">.</span><span class="n">make_leaves</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">durations</span><span class="p">)</span>
        <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">notes</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">beam</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">abjad</span><span class="o">.</span><span class="n">beam</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">slash</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">literal</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">LilyPondLiteral</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\slash&quot;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="s2">&quot;before&quot;</span><span class="p">)</span>
                <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">literal</span><span class="p">,</span> <span class="n">notes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">container</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">AfterGraceContainer</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span></div>


<div class="viewcode-block" id="beam"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.beam">[docs]</a><span class="k">def</span> <span class="nf">beam</span><span class="p">(</span>
    <span class="n">argument</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">beam_lone_notes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">beam_rests</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">stemlet_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Beams runs of notes in each component in ``argument``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs, beam_rests=False, stemlet_length=None):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [1, 1, 1, -1], 16)</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     rmakers.beam(</span>
<span class="sd">        ...         container, beam_rests=beam_rests, stemlet_length=stemlet_length</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     rmakers.swap_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        ...     abjad.setting(score).autoBeaming = False</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Beams runs of notes in each tuplet:</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                            r16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            r16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                            r16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            r16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                            r16</span>
<span class="sd">                        }</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                            r16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                            r16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Set ``beam_rests=True`` and ``stemlet_length=n`` to beam rests with</span>
<span class="sd">        stemlets of length ``n``:</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(</span>
<span class="sd">        ...     pairs, beam_rests=True, stemlet_length=0.75</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        {</span>
<span class="sd">                            \override Staff.Stem.stemlet-length = 0.75</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            r16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                            \revert Staff.Stem.stemlet-length</span>
<span class="sd">                        }</span>
<span class="sd">                        {</span>
<span class="sd">                            \override Staff.Stem.stemlet-length = 0.75</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            r16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            r16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                            \revert Staff.Stem.stemlet-length</span>
<span class="sd">                        }</span>
<span class="sd">                        {</span>
<span class="sd">                            \override Staff.Stem.stemlet-length = 0.75</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            r16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            r16</span>
<span class="sd">                            ]</span>
<span class="sd">                            \revert Staff.Stem.stemlet-length</span>
<span class="sd">                        }</span>
<span class="sd">                        {</span>
<span class="sd">                            \override Staff.Stem.stemlet-length = 0.75</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            r16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            r16</span>
<span class="sd">                            ]</span>
<span class="sd">                            \revert Staff.Stem.stemlet-length</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">:</span>
        <span class="n">unbeam</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">beam</span><span class="p">(</span>
            <span class="n">leaves</span><span class="p">,</span>
            <span class="n">beam_lone_notes</span><span class="o">=</span><span class="n">beam_lone_notes</span><span class="p">,</span>
            <span class="n">beam_rests</span><span class="o">=</span><span class="n">beam_rests</span><span class="p">,</span>
            <span class="n">stemlet_length</span><span class="o">=</span><span class="n">stemlet_length</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="beam_groups"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.beam_groups">[docs]</a><span class="k">def</span> <span class="nf">beam_groups</span><span class="p">(</span>
    <span class="n">argument</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">beam_lone_notes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">beam_rests</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">stemlet_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Beams groups in ``argument`` with single span beam.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [1], 16)</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     rmakers.beam_groups(tuplets)</span>
<span class="sd">        ...     rmakers.swap_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        {</span>
<span class="sd">                            \set stemLeftBeamCount = 0</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 1</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        {</span>
<span class="sd">                            \set stemLeftBeamCount = 1</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 1</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        {</span>
<span class="sd">                            \set stemLeftBeamCount = 1</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 1</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                        {</span>
<span class="sd">                            \set stemLeftBeamCount = 1</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 2</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            \set stemLeftBeamCount = 2</span>
<span class="sd">                            \set stemRightBeamCount = 0</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
    <span class="n">unbeam</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="n">durations</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">]</span>
    <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="n">abjad</span><span class="o">.</span><span class="n">beam</span><span class="p">(</span>
        <span class="n">leaves</span><span class="p">,</span>
        <span class="n">beam_lone_notes</span><span class="o">=</span><span class="n">beam_lone_notes</span><span class="p">,</span>
        <span class="n">beam_rests</span><span class="o">=</span><span class="n">beam_rests</span><span class="p">,</span>
        <span class="n">durations</span><span class="o">=</span><span class="n">durations</span><span class="p">,</span>
        <span class="n">span_beam_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">stemlet_length</span><span class="o">=</span><span class="n">stemlet_length</span><span class="p">,</span>
        <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="before_grace_container"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.before_grace_container">[docs]</a><span class="k">def</span> <span class="nf">before_grace_container</span><span class="p">(</span>
    <span class="n">argument</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Component</span> <span class="o">|</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Component</span><span class="p">],</span>
    <span class="n">counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">beam</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">slash</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">slur</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">talea</span><span class="p">:</span> <span class="n">_classes</span><span class="o">.</span><span class="n">Talea</span> <span class="o">=</span> <span class="n">_classes</span><span class="o">.</span><span class="n">Talea</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="mi">8</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes (and attaches) before-grace containers.</span>

<span class="sd">    With ``beam=False``, ``slash=False``, ``slur=False`` (default):</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [4], extra_counts=[2])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_) for _ in tuplets]</span>
<span class="sd">        ...     notes = [abjad.select.exclude(_, [0, -1]) for _ in notes]</span>
<span class="sd">        ...     rmakers.before_grace_container(notes, [1, 2, 3])</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/5</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \grace {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \grace {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \grace {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        With ``beam=False``, ``slash=False``, ``slur=True``:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [4], extra_counts=[2])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_) for _ in tuplets]</span>
<span class="sd">        ...     notes = [abjad.select.exclude(_, [0, -1]) for _ in notes]</span>
<span class="sd">        ...     rmakers.before_grace_container(notes, [1, 2, 3], slur=True)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/5</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \appoggiatura {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \appoggiatura {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \appoggiatura {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        With ``beam=True``, ``slash=False``, ``slur=False``:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [4], extra_counts=[2])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_) for _ in tuplets]</span>
<span class="sd">        ...     notes = [abjad.select.exclude(_, [0, -1]) for _ in notes]</span>
<span class="sd">        ...     rmakers.before_grace_container(notes, [1, 2, 3], beam=True)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/5</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \grace {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \grace {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                [</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \grace {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                [</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        With ``beam=True``, ``slash=False``, ``slur=True``:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [4], extra_counts=[2])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_) for _ in tuplets]</span>
<span class="sd">        ...     notes = [abjad.select.exclude(_, [0, -1]) for _ in notes]</span>
<span class="sd">        ...     rmakers.before_grace_container(notes, [1, 2, 3], beam=True, slur=True)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/5</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \appoggiatura {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \appoggiatura {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                [</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \appoggiatura {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                [</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        With ``beam=True``, ``slash=True``, ``slur=False``:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [4], extra_counts=[2])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_) for _ in tuplets]</span>
<span class="sd">        ...     notes = [abjad.select.exclude(_, [0, -1]) for _ in notes]</span>
<span class="sd">        ...     rmakers.before_grace_container(notes, [1, 2, 3], beam=True, slash=True)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/5</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \slashedGrace {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \slashedGrace {</span>
<span class="sd">                                \slash</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                [</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \slashedGrace {</span>
<span class="sd">                                \slash</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                [</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        (When ``slash=True`` then ``beam`` must also be true.)</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        With ``beam=True``, ``slash=True``, ``slur=True``:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [4], extra_counts=[2])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_) for _ in tuplets]</span>
<span class="sd">        ...     notes = [abjad.select.exclude(_, [0, -1]) for _ in notes]</span>
<span class="sd">        ...     rmakers.before_grace_container(</span>
<span class="sd">        ...         notes, [1, 2, 3], beam=True, slash=True, slur=True</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/5</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \acciaccatura {</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \acciaccatura {</span>
<span class="sd">                                \slash</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                [</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            \acciaccatura {</span>
<span class="sd">                                \slash</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                [</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        (When ``slash=True`` then ``beam`` must also be true.)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">slash</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">beam</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">beam</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">talea</span><span class="p">,</span> <span class="n">_classes</span><span class="o">.</span><span class="n">Talea</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">talea</span><span class="p">)</span>
    <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">grace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">cyclic_counts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">leaves</span><span class="p">):</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">cyclic_counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">count</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">count</span>
        <span class="n">durations</span> <span class="o">=</span> <span class="n">talea</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="n">notes</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">makers</span><span class="o">.</span><span class="n">make_leaves</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">durations</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">slash</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">slur</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\grace&quot;</span>
            <span class="k">elif</span> <span class="n">slash</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">slur</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\appoggiatura&quot;</span>
            <span class="k">elif</span> <span class="n">slash</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">slur</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\slashedGrace&quot;</span>
            <span class="k">elif</span> <span class="n">slash</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">slur</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\acciaccatura&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span>
        <span class="k">elif</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">notes</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">beam</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">abjad</span><span class="o">.</span><span class="n">beam</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">slash</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">literal</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">LilyPondLiteral</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\slash&quot;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="s2">&quot;before&quot;</span><span class="p">)</span>
                <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">literal</span><span class="p">,</span> <span class="n">notes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">slash</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">slur</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\grace&quot;</span>
            <span class="k">elif</span> <span class="n">slash</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">slur</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\appoggiatura&quot;</span>
            <span class="k">elif</span> <span class="n">slash</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">slur</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\slashedGrace&quot;</span>
            <span class="k">elif</span> <span class="n">slash</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">slur</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\acciaccatura&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span>
        <span class="n">container</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">BeforeGraceContainer</span><span class="p">(</span><span class="n">notes</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span></div>


<div class="viewcode-block" id="denominator"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.denominator">[docs]</a><span class="k">def</span> <span class="nf">denominator</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">denominator</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Duration</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets tuplet ratio denominator of tuplets in ``argument``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs, denominator=None):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.tuplet(durations, [(1, 4)])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.force_fraction(container)</span>
<span class="sd">        ...     if denominator is not None:</span>
<span class="sd">        ...         rmakers.denominator(container, denominator)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        ...     abjad.override(score).TupletBracket.bracket_visibility = True</span>
<span class="sd">        ...     abjad.override(score).TupletBracket.staff_padding = 4.5</span>
<span class="sd">        ...     abjad.setting(score).tupletFullLength = True</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        By default, tuplet numerators and denominators are reduced to numbers</span>
<span class="sd">        that are relatively prime. This means that ratios like ``6:4`` and</span>
<span class="sd">        ``10:8`` do not arise:</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">                tupletFullLength = ##t</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 4/5</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 2/16</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 4/5</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 6/5</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 6/16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 4/5</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 8/16</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;2</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Spelling tuplet ratios in terms of a given duration.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            **16th notes.** This attempts to set the denominator of each tuplet</span>
<span class="sd">            ratio in terms of sixteenth notes. Because the first tuplet is so</span>
<span class="sd">            short, its ratio must be read as &quot;5 in the time of 4 thirty-second</span>
<span class="sd">            notes.&quot; But the ratios of the three longer tuplets can now be read</span>
<span class="sd">            as &quot;x in the time of y sixteenth notes&quot;:</span>

<span class="sd">            &gt;&gt;&gt; pairs = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs, denominator=(1, 16))</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \context Score = &quot;Score&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                    \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">                    tupletFullLength = ##t</span>
<span class="sd">                }</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override Clef.stencil = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \context Voice = &quot;Voice&quot;</span>
<span class="sd">                        {</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 4/5</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 2/16</span>
<span class="sd">                                c&#39;32</span>
<span class="sd">                                [</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 4/5</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 4/16</span>
<span class="sd">                                c&#39;16</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 6/5</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 6/16</span>
<span class="sd">                                c&#39;16</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 8/10</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 8/16</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;2</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            **32nd notes.** This sets the denominator of each tuplet ratios in</span>
<span class="sd">            terms of thirty-second notes. All tuplet ratios can now be read as</span>
<span class="sd">            &quot;x in the time of y thirty-second notes&quot;:</span>

<span class="sd">            &gt;&gt;&gt; pairs = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs, denominator=(1, 32))</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \context Score = &quot;Score&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                    \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">                    tupletFullLength = ##t</span>
<span class="sd">                }</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override Clef.stencil = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \context Voice = &quot;Voice&quot;</span>
<span class="sd">                        {</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 4/5</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 2/16</span>
<span class="sd">                                c&#39;32</span>
<span class="sd">                                [</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 8/10</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 4/16</span>
<span class="sd">                                c&#39;16</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 12/10</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 6/16</span>
<span class="sd">                                c&#39;16</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 16/20</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 8/16</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;2</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            **64th notes.** This sets the denominator of each tuplet ratios in</span>
<span class="sd">            terms of sixth-fourth notes. All tuplet ratios can now be read as</span>
<span class="sd">            &quot;x in the time of y sixty-fourth notes&quot;:</span>

<span class="sd">            &gt;&gt;&gt; pairs = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs, (1, 64))</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \context Score = &quot;Score&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                    \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">                    tupletFullLength = ##t</span>
<span class="sd">                }</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override Clef.stencil = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \context Voice = &quot;Voice&quot;</span>
<span class="sd">                        {</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 4/5</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 2/16</span>
<span class="sd">                                c&#39;32</span>
<span class="sd">                                [</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 8/10</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 4/16</span>
<span class="sd">                                c&#39;16</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 12/10</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 6/16</span>
<span class="sd">                                c&#39;16</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 16/20</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 8/16</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;2</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Spelling tuplet ratios with a fixed denominator.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            **Tuplet ratios spelled with denominator equal to 8.** The ratio of</span>
<span class="sd">            the third tuplet is left unchanged. But the ratios of the other</span>
<span class="sd">            tuplets can be spelled &quot;x in the time of 8&quot;:</span>

<span class="sd">            &gt;&gt;&gt; pairs = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs, 8)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \context Score = &quot;Score&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                    \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">                    tupletFullLength = ##t</span>
<span class="sd">                }</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override Clef.stencil = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \context Voice = &quot;Voice&quot;</span>
<span class="sd">                        {</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 4/5</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 2/16</span>
<span class="sd">                                c&#39;32</span>
<span class="sd">                                [</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 8/10</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 4/16</span>
<span class="sd">                                c&#39;16</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 12/10</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 6/16</span>
<span class="sd">                                c&#39;16</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 16/20</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 8/16</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;2</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            **Tuplet ratios spelled with denominator equal to 12.** The ratios</span>
<span class="sd">            of all tuplets can be spelled &quot;x in the time of 12&quot;:</span>

<span class="sd">            &gt;&gt;&gt; pairs = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs, 12)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \context Score = &quot;Score&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                    \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">                    tupletFullLength = ##t</span>
<span class="sd">                }</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override Clef.stencil = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \context Voice = &quot;Voice&quot;</span>
<span class="sd">                        {</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 4/5</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 2/16</span>
<span class="sd">                                c&#39;32</span>
<span class="sd">                                [</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 8/10</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 4/16</span>
<span class="sd">                                c&#39;16</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 12/10</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 6/16</span>
<span class="sd">                                c&#39;16</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 16/20</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 8/16</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;2</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            **Tuplet ratios spelled with denominator equal to 13.** No tuplet</span>
<span class="sd">            ratio can be spelled &quot;x in the time of 13&quot;:</span>

<span class="sd">            &gt;&gt;&gt; pairs = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">            &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs, 13)</span>
<span class="sd">            &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">            ..  docs::</span>

<span class="sd">                &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">                &gt;&gt;&gt; print(string)</span>
<span class="sd">                \context Score = &quot;Score&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                    \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">                    tupletFullLength = ##t</span>
<span class="sd">                }</span>
<span class="sd">                &lt;&lt;</span>
<span class="sd">                    \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                    \with</span>
<span class="sd">                    {</span>
<span class="sd">                        \override Clef.stencil = ##f</span>
<span class="sd">                    }</span>
<span class="sd">                    {</span>
<span class="sd">                        \context Voice = &quot;Voice&quot;</span>
<span class="sd">                        {</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 4/5</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 2/16</span>
<span class="sd">                                c&#39;32</span>
<span class="sd">                                [</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 8/10</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 4/16</span>
<span class="sd">                                c&#39;16</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 12/10</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 6/16</span>
<span class="sd">                                c&#39;16</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 16/20</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 8/16</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                c&#39;2</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">denominator</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">denominator</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">denominator</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">denominator</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">):</span>
            <span class="n">unit_duration</span> <span class="o">=</span> <span class="n">denominator</span>
            <span class="k">assert</span> <span class="n">unit_duration</span><span class="o">.</span><span class="n">numerator</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
            <span class="n">denominator_</span> <span class="o">=</span> <span class="n">unit_duration</span><span class="o">.</span><span class="n">denominator</span>
            <span class="n">pair</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">with_denominator</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="n">denominator_</span><span class="p">)</span>
            <span class="n">tuplet</span><span class="o">.</span><span class="n">denominator</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">abjad</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">is_positive_integer</span><span class="p">(</span><span class="n">denominator</span><span class="p">):</span>
            <span class="n">tuplet</span><span class="o">.</span><span class="n">denominator</span> <span class="o">=</span> <span class="n">denominator</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;invalid preferred denominator: </span><span class="si">{</span><span class="n">denominator</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="duration_bracket"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.duration_bracket">[docs]</a><span class="k">def</span> <span class="nf">duration_bracket</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies duration bracket to tuplets in ``argument``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">duration_</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
        <span class="n">components</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">makers</span><span class="o">.</span><span class="n">make_leaves</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">duration_</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">components</span><span class="p">):</span>
            <span class="n">durations</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">components</span><span class="p">]</span>
            <span class="n">strings</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="o">.</span><span class="n">lilypond_duration_string</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">durations</span><span class="p">]</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot; ~ &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\rhythm </span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2"> </span><span class="se">}}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">illustrators</span><span class="o">.</span><span class="n">components_to_score_markup_string</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\markup \scale #&#39;(0.75 . 0.75) </span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">override</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span><span class="o">.</span><span class="n">TupletNumber</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">string</span></div>


<div class="viewcode-block" id="example"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.example">[docs]</a><span class="k">def</span> <span class="nf">example</span><span class="p">(</span>
    <span class="n">components</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Component</span><span class="p">],</span>
    <span class="n">time_signatures</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">TimeSignature</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">includes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abjad</span><span class="o">.</span><span class="n">LilyPondFile</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes example LilyPond file.</span>

<span class="sd">    Function is a documentation helper.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Component</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">components</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">time_signatures</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">TimeSignature</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">time_signatures</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span>
        <span class="n">time_signatures</span>
    <span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">includes</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">includes</span><span class="p">)</span>
    <span class="n">lilypond_file</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">illustrators</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="n">time_signatures</span><span class="p">)</span>
    <span class="n">includes</span> <span class="o">=</span> <span class="p">[</span><span class="sa">rf</span><span class="s1">&#39;\include &quot;</span><span class="si">{</span><span class="n">_</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">includes</span><span class="p">]</span>
    <span class="n">lilypond_file</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">includes</span>
    <span class="n">staff</span> <span class="o">=</span> <span class="n">lilypond_file</span><span class="p">[</span><span class="s2">&quot;Staff&quot;</span><span class="p">]</span>
    <span class="n">staff</span><span class="o">.</span><span class="n">lilypond_type</span> <span class="o">=</span> <span class="s2">&quot;RhythmicStaff&quot;</span>
    <span class="n">abjad</span><span class="o">.</span><span class="n">override</span><span class="p">(</span><span class="n">staff</span><span class="p">)</span><span class="o">.</span><span class="n">Clef</span><span class="o">.</span><span class="n">stencil</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">lilypond_file</span></div>


<div class="viewcode-block" id="extract_rest_filled"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.extract_rest_filled">[docs]</a><span class="k">def</span> <span class="nf">extract_rest_filled</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts rest-filled tuplets from ``argument``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">tuplets</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tuplet</span><span class="o">.</span><span class="n">rest_filled</span><span class="p">():</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span></div>


<div class="viewcode-block" id="extract_trivial"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.extract_trivial">[docs]</a><span class="k">def</span> <span class="nf">extract_trivial</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts trivial tuplets from ``argument``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [8])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[-2:]</span>
<span class="sd">        ...     rmakers.extract_trivial(tuplets)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (3, 8), (3, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">tuplets</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tuplet</span><span class="o">.</span><span class="n">trivial</span><span class="p">():</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span></div>


<div class="viewcode-block" id="feather_beam"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.feather_beam">[docs]</a><span class="k">def</span> <span class="nf">feather_beam</span><span class="p">(</span>
    <span class="n">argument</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">beam_rests</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">stemlet_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Feather-beams leaves in ``argument``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">:</span>
        <span class="n">unbeam</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">beam</span><span class="p">(</span>
            <span class="n">leaves</span><span class="p">,</span>
            <span class="n">beam_rests</span><span class="o">=</span><span class="n">beam_rests</span><span class="p">,</span>
            <span class="n">stemlet_length</span><span class="o">=</span><span class="n">stemlet_length</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">:</span>
        <span class="n">first_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_is_accelerando</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">override</span><span class="p">(</span><span class="n">first_leaf</span><span class="p">)</span><span class="o">.</span><span class="n">Beam</span><span class="o">.</span><span class="n">grow_direction</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">RIGHT</span>
        <span class="k">elif</span> <span class="n">_is_ritardando</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">override</span><span class="p">(</span><span class="n">first_leaf</span><span class="p">)</span><span class="o">.</span><span class="n">Beam</span><span class="o">.</span><span class="n">grow_direction</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">LEFT</span></div>


<div class="viewcode-block" id="force_augmentation"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.force_augmentation">[docs]</a><span class="k">def</span> <span class="nf">force_augmentation</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Spells tuplets in ``argument`` as augmentations.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs, force_augmentation=False):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [8], extra_counts=[1])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     rmakers.force_fraction(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     if force_augmentation is True:</span>
<span class="sd">        ...         rmakers.force_augmentation(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        ...     abjad.override(score).TupletBracket.bracket_visibility = True</span>
<span class="sd">        ...     abjad.override(score).TupletBracket.staff_padding = 4.5</span>
<span class="sd">        ...     abjad.setting(score).tupletFullLength = True</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Without forced augmentation:</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs, force_augmentation=False)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">                tupletFullLength = ##t</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 2/8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        With forced augmentation:</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs, force_augmentation=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">                tupletFullLength = ##t</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 4/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 2/8</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 4/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 4/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tuplet</span><span class="o">.</span><span class="n">augmentation</span><span class="p">():</span>
            <span class="n">tuplet</span><span class="o">.</span><span class="n">toggle_prolation</span><span class="p">()</span></div>


<div class="viewcode-block" id="force_diminution"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.force_diminution">[docs]</a><span class="k">def</span> <span class="nf">force_diminution</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Spells tuplets in ``argument`` as diminutions.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs, force_diminution=False):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [1], 16, extra_counts=[0, -1])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     rmakers.force_fraction(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.swap_trivial(container)</span>
<span class="sd">        ...     if force_diminution is True:</span>
<span class="sd">        ...         rmakers.force_diminution(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        ...     abjad.override(score).TupletBracket.bracket_visibility = True</span>
<span class="sd">        ...     abjad.override(score).TupletBracket.staff_padding = 4.5</span>
<span class="sd">        ...     abjad.setting(score).tupletFullLength = True</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Without forced diminution (default):</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(1, 4), (1, 4), (1, 4), (1, 4)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs, force_diminution=False)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">                tupletFullLength = ##t</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 1/4</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 4/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 4/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        With forced diminution (default):</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(1, 4), (1, 4), (1, 4), (1, 4)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs, force_diminution=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">                tupletFullLength = ##t</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 1/4</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tuplet</span><span class="o">.</span><span class="n">diminution</span><span class="p">():</span>
            <span class="n">tuplet</span><span class="o">.</span><span class="n">toggle_prolation</span><span class="p">()</span></div>


<div class="viewcode-block" id="force_fraction"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.force_fraction">[docs]</a><span class="k">def</span> <span class="nf">force_fraction</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets ``force_fraction=True`` on tuplets in ``argument``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">tuplet</span><span class="o">.</span><span class="n">force_fraction</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="force_note"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.force_note">[docs]</a><span class="k">def</span> <span class="nf">force_note</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces leaves in ``argument`` with notes.</span>

<span class="sd">    Changes logical ties 1 and 2 to notes:</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     nested_music = rmakers.note(durations)</span>
<span class="sd">        ...     components = abjad.sequence.flatten(nested_music)</span>
<span class="sd">        ...     container = abjad.Container(components)</span>
<span class="sd">        ...     rmakers.force_rest(components)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)[1:3]</span>
<span class="sd">        ...     rmakers.force_note(logical_ties)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(7, 16), (3, 8), (7, 16), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/16</span>
<span class="sd">                        r4..</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        \time 7/16</span>
<span class="sd">                        c&#39;4..</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        r4.</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Changes leaves to notes with inverted composite pattern:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     nested_music = rmakers.note(durations)</span>
<span class="sd">        ...     components = abjad.sequence.flatten(nested_music)</span>
<span class="sd">        ...     container = abjad.Container(components)</span>
<span class="sd">        ...     leaves = abjad.select.leaves(container)</span>
<span class="sd">        ...     rmakers.force_rest(leaves)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)</span>
<span class="sd">        ...     leaves = abjad.select.get(logical_ties, [0, -1])</span>
<span class="sd">        ...     rmakers.force_note(leaves)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(7, 16), (3, 8), (7, 16), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/16</span>
<span class="sd">                        c&#39;4..</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        r4.</span>
<span class="sd">                        \time 7/16</span>
<span class="sd">                        r4..</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
    <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">note</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="s2">&quot;C4&quot;</span><span class="p">,</span> <span class="n">leaf</span><span class="o">.</span><span class="n">written_duration</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">leaf</span><span class="o">.</span><span class="n">multiplier</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">note</span><span class="o">.</span><span class="n">multiplier</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">multiplier</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="p">[</span><span class="n">note</span><span class="p">])</span></div>


<div class="viewcode-block" id="force_repeat_tie"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.force_repeat_tie">[docs]</a><span class="k">def</span> <span class="nf">force_repeat_tie</span><span class="p">(</span>
    <span class="n">argument</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">threshold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces ties in ``argument`` with repeat-ties.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [8], extra_counts=[1])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     notes = [abjad.select.note(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Attaches tie to last note in each nonlast tuplet:</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 2/8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Changes ties to repeat-ties:</span>

<span class="sd">        &gt;&gt;&gt; rmakers.force_repeat_tie(lilypond_file[&quot;Score&quot;])</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 2/8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Container</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">threshold</span><span class="p">):</span>
        <span class="n">inequality</span> <span class="o">=</span> <span class="n">threshold</span>
    <span class="k">elif</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">inequality</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">item</span> <span class="o">&lt;</span> <span class="mi">0</span>

    <span class="k">elif</span> <span class="n">threshold</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>

        <span class="k">def</span> <span class="nf">inequality</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">item</span> <span class="o">&gt;=</span> <span class="mi">0</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">inequality</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">item</span> <span class="o">&gt;=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span>

    <span class="n">attach_repeat_ties</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">has_indicator</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">):</span>
            <span class="n">next_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">next_leaf</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">next_leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Chord</span> <span class="o">|</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">has_indicator</span><span class="p">(</span><span class="n">next_leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">RepeatTie</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">inequality</span><span class="p">(</span><span class="n">duration</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">attach_repeat_ties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_leaf</span><span class="p">)</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">attach_repeat_ties</span><span class="p">:</span>
        <span class="n">repeat_tie</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">RepeatTie</span><span class="p">()</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">repeat_tie</span><span class="p">,</span> <span class="n">leaf</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span></div>


<div class="viewcode-block" id="force_rest"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.force_rest">[docs]</a><span class="k">def</span> <span class="nf">force_rest</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces leaves in ``argument`` with rests.</span>

<span class="sd">    Forces first and last logical ties to rest:</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [1, 2, 3, 4], 16)</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)</span>
<span class="sd">        ...     logical_ties = abjad.select.get(logical_ties, [0, -1])</span>
<span class="sd">        ...     rmakers.force_rest(logical_ties)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        r16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        r8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forces all logical ties to rest. Then sustains first and last logical ties:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [1, 2, 3, 4], 16)</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)</span>
<span class="sd">        ...     rmakers.force_rest(logical_ties)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)</span>
<span class="sd">        ...     logical_ties = abjad.select.get(logical_ties, [0, -1])</span>
<span class="sd">        ...     rmakers.force_note(logical_ties)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        r8</span>
<span class="sd">                        r8.</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        r4</span>
<span class="sd">                        r16</span>
<span class="sd">                        r8</span>
<span class="sd">                        r16</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        r8</span>
<span class="sd">                        r4</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        r16</span>
<span class="sd">                        r8</span>
<span class="sd">                        r8.</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forces every other tuplet to rest:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [1, 2, 3, 4], 16)</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     tuplets = abjad.select.get(tuplets, [1], 2)</span>
<span class="sd">        ...     rmakers.force_rest(tuplets)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.rewrite_rest_filled(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        r2</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        r2</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forces the first leaf and the last two leaves to rests:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [1, 2, 3, 4], 16)</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     leaves = abjad.select.leaves(container)</span>
<span class="sd">        ...     leaves = abjad.select.get(leaves, [0, -2, -1])</span>
<span class="sd">        ...     rmakers.force_rest(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        r16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        r8.</span>
<span class="sd">                        r8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forces first leaf of every tuplet to rest:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [1, 2, 3, 4], 16)</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, 0) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.force_rest(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        r16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        r4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        r8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        r16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
    <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">:</span>
        <span class="n">rest</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Rest</span><span class="p">(</span><span class="n">leaf</span><span class="o">.</span><span class="n">written_duration</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">leaf</span><span class="o">.</span><span class="n">multiplier</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rest</span><span class="o">.</span><span class="n">multiplier</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">multiplier</span>
        <span class="n">previous_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">next_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="p">[</span><span class="n">rest</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">previous_leaf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">,</span> <span class="n">previous_leaf</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">,</span> <span class="n">rest</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">RepeatTie</span><span class="p">,</span> <span class="n">rest</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">next_leaf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">RepeatTie</span><span class="p">,</span> <span class="n">next_leaf</span><span class="p">)</span></div>


<div class="viewcode-block" id="hide_skip_filled"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.hide_skip_filled">[docs]</a><span class="k">def</span> <span class="nf">hide_skip_filled</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Hides skip-filled tuplets in ``argument``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">tuplets</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Skip</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tuplet</span><span class="p">):</span>
            <span class="n">tuplet</span><span class="o">.</span><span class="n">hide</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="hide_trivial"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.hide_trivial">[docs]</a><span class="k">def</span> <span class="nf">hide_trivial</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Hides trivial tuplets in ``argument``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [8])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[-2:]</span>
<span class="sd">        ...     rmakers.hide_trivial(tuplets)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (3, 8), (3, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \scaleDurations #&#39;(1 . 1)</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \scaleDurations #&#39;(1 . 1)</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">tuplets</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tuplet</span><span class="o">.</span><span class="n">trivial</span><span class="p">():</span>
            <span class="n">tuplet</span><span class="o">.</span><span class="n">hide</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="invisible_music"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.invisible_music">[docs]</a><span class="k">def</span> <span class="nf">invisible_music</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes ``argument`` invisible.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
    <span class="n">tag_1</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="s2">&quot;INVISIBLE_MUSIC_COMMAND&quot;</span><span class="p">))</span>
    <span class="n">literal_1</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">LilyPondLiteral</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\abjad-invisible-music&quot;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="s2">&quot;before&quot;</span><span class="p">)</span>
    <span class="n">tag_2</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="s2">&quot;INVISIBLE_MUSIC_COLORING&quot;</span><span class="p">))</span>
    <span class="n">literal_2</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">LilyPondLiteral</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\abjad-invisible-music-coloring&quot;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="s2">&quot;before&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">literal_1</span><span class="p">,</span> <span class="n">leaf</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag_1</span><span class="p">,</span> <span class="n">deactivate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">literal_2</span><span class="p">,</span> <span class="n">leaf</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag_2</span><span class="p">)</span></div>


<div class="viewcode-block" id="interpolate"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.interpolate">[docs]</a><span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span>
    <span class="n">start_duration</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Duration</span><span class="p">,</span>
    <span class="n">stop_duration</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Duration</span><span class="p">,</span>
    <span class="n">written_duration</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Duration</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_classes</span><span class="o">.</span><span class="n">Interpolation</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes interpolation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_classes</span><span class="o">.</span><span class="n">Interpolation</span><span class="p">(</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">start_duration</span><span class="p">),</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">stop_duration</span><span class="p">),</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">written_duration</span><span class="p">),</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="nongrace_leaves_in_each_tuplet"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.nongrace_leaves_in_each_tuplet">[docs]</a><span class="k">def</span> <span class="nf">nongrace_leaves_in_each_tuplet</span><span class="p">(</span>
    <span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Leaf</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Selects nongrace leaves in each tuplet.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">)</span>
    <span class="n">lists</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">grace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tuplets</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">list_</span> <span class="ow">in</span> <span class="n">lists</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Leaf</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">list_</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lists</span></div>


<div class="viewcode-block" id="on_beat_grace_container"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.on_beat_grace_container">[docs]</a><span class="k">def</span> <span class="nf">on_beat_grace_container</span><span class="p">(</span>
    <span class="n">voice</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">,</span>
    <span class="n">voice_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">nongrace_leaf_lists</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Leaf</span><span class="p">]],</span>
    <span class="n">counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">grace_leaf_duration</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Duration</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">grace_polyphony_command</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">VoiceNumber</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">VoiceNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">nongrace_polyphony_command</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">VoiceNumber</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">VoiceNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">talea</span><span class="p">:</span> <span class="n">_classes</span><span class="o">.</span><span class="n">Talea</span> <span class="o">=</span> <span class="n">_classes</span><span class="o">.</span><span class="n">Talea</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="mi">8</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes on-beat grace containers.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [4], extra_counts=[2])</span>
<span class="sd">        ...     voice = abjad.Voice(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(voice)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_) for _ in tuplets]</span>
<span class="sd">        ...     notes = [abjad.select.exclude(_, [0, -1]) for _ in notes]</span>
<span class="sd">        ...     notes = abjad.select.notes(notes)</span>
<span class="sd">        ...     groups = [[_] for _ in notes]</span>
<span class="sd">        ...     rmakers.on_beat_grace_container(</span>
<span class="sd">        ...         voice,</span>
<span class="sd">        ...         &quot;RhythmMaker.Music&quot;,</span>
<span class="sd">        ...         groups,</span>
<span class="sd">        ...         [2, 4],</span>
<span class="sd">        ...         grace_leaf_duration=(1, 28)</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(voice)</span>
<span class="sd">        ...     music_voice = abjad.Voice(components, name=&quot;RhythmMaker.Music&quot;)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(</span>
<span class="sd">        ...         [music_voice], time_signatures, includes=[&quot;abjad.ily&quot;]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     staff = lilypond_file[&quot;Staff&quot;]</span>
<span class="sd">        ...     abjad.override(staff).TupletBracket.direction = abjad.UP</span>
<span class="sd">        ...     abjad.override(staff).TupletBracket.staff_padding = 5</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                    \override TupletBracket.direction = #up</span>
<span class="sd">                    \override TupletBracket.staff-padding = 5</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                        {</span>
<span class="sd">                            \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                            \times 3/5</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 3/4</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                                &lt;&lt;</span>
<span class="sd">                                    \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                                    {</span>
<span class="sd">                                        \set fontSize = #-3</span>
<span class="sd">                                        \slash</span>
<span class="sd">                                        \voiceOne</span>
<span class="sd">                                        &lt;</span>
<span class="sd">                                            \tweak font-size 0</span>
<span class="sd">                                            \tweak transparent ##t</span>
<span class="sd">                                            c&#39;</span>
<span class="sd">                                        &gt;8 * 10/21</span>
<span class="sd">                                        [</span>
<span class="sd">                                        (</span>
<span class="sd">                                        c&#39;8 * 10/21</span>
<span class="sd">                                        )</span>
<span class="sd">                                        ]</span>
<span class="sd">                                    }</span>
<span class="sd">                                    \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                                    {</span>
<span class="sd">                                        \voiceTwo</span>
<span class="sd">                                        c&#39;4</span>
<span class="sd">                                    }</span>
<span class="sd">                                &gt;&gt;</span>
<span class="sd">                                &lt;&lt;</span>
<span class="sd">                                    \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                                    {</span>
<span class="sd">                                        \set fontSize = #-3</span>
<span class="sd">                                        \slash</span>
<span class="sd">                                        \voiceOne</span>
<span class="sd">                                        &lt;</span>
<span class="sd">                                            \tweak font-size 0</span>
<span class="sd">                                            \tweak transparent ##t</span>
<span class="sd">                                            c&#39;</span>
<span class="sd">                                        &gt;8 * 10/21</span>
<span class="sd">                                        [</span>
<span class="sd">                                        (</span>
<span class="sd">                                        c&#39;8 * 10/21</span>
<span class="sd">                                        c&#39;8 * 10/21</span>
<span class="sd">                                        c&#39;8 * 10/21</span>
<span class="sd">                                        )</span>
<span class="sd">                                        ]</span>
<span class="sd">                                    }</span>
<span class="sd">                                    \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                                    {</span>
<span class="sd">                                        \voiceTwo</span>
<span class="sd">                                        c&#39;4</span>
<span class="sd">                                    }</span>
<span class="sd">                                &gt;&gt;</span>
<span class="sd">                                &lt;&lt;</span>
<span class="sd">                                    \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                                    {</span>
<span class="sd">                                        \set fontSize = #-3</span>
<span class="sd">                                        \slash</span>
<span class="sd">                                        \voiceOne</span>
<span class="sd">                                        &lt;</span>
<span class="sd">                                            \tweak font-size 0</span>
<span class="sd">                                            \tweak transparent ##t</span>
<span class="sd">                                            c&#39;</span>
<span class="sd">                                        &gt;8 * 10/21</span>
<span class="sd">                                        [</span>
<span class="sd">                                        (</span>
<span class="sd">                                        c&#39;8 * 10/21</span>
<span class="sd">                                        )</span>
<span class="sd">                                        ]</span>
<span class="sd">                                    }</span>
<span class="sd">                                    \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                                    {</span>
<span class="sd">                                        \voiceTwo</span>
<span class="sd">                                        c&#39;4</span>
<span class="sd">                                    }</span>
<span class="sd">                                &gt;&gt;</span>
<span class="sd">                                \oneVoice</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [5], 16)</span>
<span class="sd">        ...     voice = abjad.Voice(tuplets)</span>
<span class="sd">        ...     rmakers.extract_trivial(voice)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(voice)</span>
<span class="sd">        ...     rmakers.on_beat_grace_container(</span>
<span class="sd">        ...         voice,</span>
<span class="sd">        ...         &quot;RhythmMaker.Music&quot;,</span>
<span class="sd">        ...         logical_ties,</span>
<span class="sd">        ...         [6, 2],</span>
<span class="sd">        ...         grace_leaf_duration=(1, 28)</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(voice)</span>
<span class="sd">        ...     music_voice = abjad.Voice(components, name=&quot;RhythmMaker.Music&quot;)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(</span>
<span class="sd">        ...         [music_voice], time_signatures, includes=[&quot;abjad.ily&quot;]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                        {</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \set fontSize = #-3</span>
<span class="sd">                                    \slash</span>
<span class="sd">                                    \voiceOne</span>
<span class="sd">                                    &lt;</span>
<span class="sd">                                        \tweak font-size 0</span>
<span class="sd">                                        \tweak transparent ##t</span>
<span class="sd">                                        c&#39;</span>
<span class="sd">                                    &gt;8 * 2/7</span>
<span class="sd">                                    [</span>
<span class="sd">                                    (</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    )</span>
<span class="sd">                                    ]</span>
<span class="sd">                                }</span>
<span class="sd">                                \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \voiceTwo</span>
<span class="sd">                                    \time 3/4</span>
<span class="sd">                                    c&#39;4</span>
<span class="sd">                                    ~</span>
<span class="sd">                                    c&#39;16</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \set fontSize = #-3</span>
<span class="sd">                                    \slash</span>
<span class="sd">                                    \voiceOne</span>
<span class="sd">                                    &lt;</span>
<span class="sd">                                        \tweak font-size 0</span>
<span class="sd">                                        \tweak transparent ##t</span>
<span class="sd">                                        c&#39;</span>
<span class="sd">                                    &gt;8 * 2/7</span>
<span class="sd">                                    [</span>
<span class="sd">                                    (</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    )</span>
<span class="sd">                                    ]</span>
<span class="sd">                                }</span>
<span class="sd">                                \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \voiceTwo</span>
<span class="sd">                                    c&#39;4</span>
<span class="sd">                                    ~</span>
<span class="sd">                                    c&#39;16</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \set fontSize = #-3</span>
<span class="sd">                                    \slash</span>
<span class="sd">                                    \voiceOne</span>
<span class="sd">                                    &lt;</span>
<span class="sd">                                        \tweak font-size 0</span>
<span class="sd">                                        \tweak transparent ##t</span>
<span class="sd">                                        c&#39;</span>
<span class="sd">                                    &gt;8 * 2/7</span>
<span class="sd">                                    [</span>
<span class="sd">                                    (</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    )</span>
<span class="sd">                                    ]</span>
<span class="sd">                                }</span>
<span class="sd">                                \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \voiceTwo</span>
<span class="sd">                                    c&#39;8</span>
<span class="sd">                                    ~</span>
<span class="sd">                                    c&#39;8.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \set fontSize = #-3</span>
<span class="sd">                                    \slash</span>
<span class="sd">                                    \voiceOne</span>
<span class="sd">                                    &lt;</span>
<span class="sd">                                        \tweak font-size 0</span>
<span class="sd">                                        \tweak transparent ##t</span>
<span class="sd">                                        c&#39;</span>
<span class="sd">                                    &gt;8 * 2/7</span>
<span class="sd">                                    [</span>
<span class="sd">                                    (</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    )</span>
<span class="sd">                                    ]</span>
<span class="sd">                                }</span>
<span class="sd">                                \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \voiceTwo</span>
<span class="sd">                                    c&#39;4</span>
<span class="sd">                                    ~</span>
<span class="sd">                                    c&#39;16</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \set fontSize = #-3</span>
<span class="sd">                                    \slash</span>
<span class="sd">                                    \voiceOne</span>
<span class="sd">                                    &lt;</span>
<span class="sd">                                        \tweak font-size 0</span>
<span class="sd">                                        \tweak transparent ##t</span>
<span class="sd">                                        c&#39;</span>
<span class="sd">                                    &gt;8 * 2/7</span>
<span class="sd">                                    [</span>
<span class="sd">                                    (</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    c&#39;8 * 2/7</span>
<span class="sd">                                    )</span>
<span class="sd">                                    ]</span>
<span class="sd">                                }</span>
<span class="sd">                                \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \voiceTwo</span>
<span class="sd">                                    c&#39;4</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">voice</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">voice</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">voice_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">voice_name</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">talea</span><span class="p">,</span> <span class="n">_classes</span><span class="o">.</span><span class="n">Talea</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">talea</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grace_polyphony_command</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">VoiceNumber</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span>
        <span class="n">grace_polyphony_command</span>
    <span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nongrace_polyphony_command</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">VoiceNumber</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span>
        <span class="n">nongrace_polyphony_command</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">voice_name</span><span class="p">:</span>
        <span class="n">voice</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">voice_name</span>
    <span class="n">cyclic_counts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nongrace_leaves</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nongrace_leaf_lists</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Leaf</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">nongrace_leaves</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span>
            <span class="n">nongrace_leaves</span>
        <span class="p">)</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">cyclic_counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">count</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">count</span>
        <span class="n">durations</span> <span class="o">=</span> <span class="n">talea</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="n">grace_leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">makers</span><span class="o">.</span><span class="n">make_leaves</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">durations</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">on_beat_grace_container</span><span class="p">(</span>
            <span class="n">grace_leaves</span><span class="p">,</span>
            <span class="n">nongrace_leaves</span><span class="p">,</span>
            <span class="n">grace_leaf_duration</span><span class="o">=</span><span class="n">grace_leaf_duration</span><span class="p">,</span>
            <span class="n">grace_polyphony_command</span><span class="o">=</span><span class="n">grace_polyphony_command</span><span class="p">,</span>
            <span class="n">nongrace_polyphony_command</span><span class="o">=</span><span class="n">nongrace_polyphony_command</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="repeat_tie"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.repeat_tie">[docs]</a><span class="k">def</span> <span class="nf">repeat_tie</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attaches repeat-ties to leaves in ``argument``.</span>

<span class="sd">    Attaches repeat-tie to first note in each nonfirst tuplet:</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [8], extra_counts=[1])</span>
<span class="sd">        ...     voice = abjad.Voice(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(voice)[1:]</span>
<span class="sd">        ...     notes = [abjad.select.note(_, 0) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.repeat_tie(notes)</span>
<span class="sd">        ...     rmakers.beam(voice)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(voice)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 2/8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Attaches repeat-ties to nonfirst notes in each tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [8], extra_counts=[1])</span>
<span class="sd">        ...     voice = abjad.Voice(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(voice)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_)[1:] for _ in tuplets]</span>
<span class="sd">        ...     rmakers.repeat_tie(notes)</span>
<span class="sd">        ...     rmakers.beam(voice)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(voice)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 2/8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
    <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">notes</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">tie</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">RepeatTie</span><span class="p">()</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">tie</span><span class="p">,</span> <span class="n">note</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span></div>


<div class="viewcode-block" id="reduce_multiplier"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.reduce_multiplier">[docs]</a><span class="k">def</span> <span class="nf">reduce_multiplier</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reduces multipliers of tuplets in ``argument``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">fraction</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Fraction</span><span class="p">(</span><span class="o">*</span><span class="n">tuplet</span><span class="o">.</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="n">pair</span> <span class="o">=</span> <span class="n">fraction</span><span class="o">.</span><span class="n">numerator</span><span class="p">,</span> <span class="n">fraction</span><span class="o">.</span><span class="n">denominator</span>
        <span class="n">tuplet</span><span class="o">.</span><span class="n">multiplier</span> <span class="o">=</span> <span class="n">pair</span></div>


<div class="viewcode-block" id="rewrite_dots"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.rewrite_dots">[docs]</a><span class="k">def</span> <span class="nf">rewrite_dots</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rewrites dots of tuplets in ``argument``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">tuplet</span><span class="o">.</span><span class="n">rewrite_dots</span><span class="p">()</span></div>


<div class="viewcode-block" id="rewrite_meter"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.rewrite_meter">[docs]</a><span class="k">def</span> <span class="nf">rewrite_meter</span><span class="p">(</span>
    <span class="n">voice</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">boundary_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">reference_meters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Meter</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rewrites meter of components in ``voice``.</span>

<span class="sd">    Use ``rmakers.wrap_in_time_signature_staff()`` to make sure ``voice``</span>
<span class="sd">    appears together with time signature information in a staff.</span>

<span class="sd">    Rewrites meter:</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [5, 4], 16)</span>
<span class="sd">        ...     voice = rmakers.wrap_in_time_signature_staff(</span>
<span class="sd">        ...         tuplets, time_signatures)</span>
<span class="sd">        ...     rmakers.beam(voice)</span>
<span class="sd">        ...     rmakers.extract_trivial(voice)</span>
<span class="sd">        ...     rmakers.rewrite_meter(voice)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(voice)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 4), (3, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">voice</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Container</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">voice</span><span class="p">)</span>
    <span class="n">staff</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">parentage</span><span class="p">(</span><span class="n">voice</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">staff</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Staff</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">staff</span><span class="p">)</span>
    <span class="n">time_signature_voice</span> <span class="o">=</span> <span class="n">staff</span><span class="p">[</span><span class="s2">&quot;TimeSignatureVoice&quot;</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_signature_voice</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">)</span>
    <span class="n">meters</span><span class="p">,</span> <span class="n">preferred_meters</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">skip</span> <span class="ow">in</span> <span class="n">time_signature_voice</span><span class="p">:</span>
        <span class="n">time_signature</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="n">skip</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">TimeSignature</span><span class="p">)</span>
        <span class="n">meter</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Meter</span><span class="p">(</span><span class="n">time_signature</span><span class="p">)</span>
        <span class="n">meters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meter</span><span class="p">)</span>
    <span class="n">durations</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">meters</span><span class="p">]</span>
    <span class="n">reference_meters</span> <span class="o">=</span> <span class="n">reference_meters</span> <span class="ow">or</span> <span class="p">()</span>
    <span class="n">split_measures</span><span class="p">(</span><span class="n">voice</span><span class="p">,</span> <span class="n">durations</span><span class="o">=</span><span class="n">durations</span><span class="p">)</span>
    <span class="n">lists</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">group_by_measure</span><span class="p">(</span><span class="n">voice</span><span class="p">[:])</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">lists</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">lists</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">meter</span><span class="p">,</span> <span class="n">list_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">meters</span><span class="p">,</span> <span class="n">lists</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">reference_meter</span> <span class="ow">in</span> <span class="n">reference_meters</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">reference_meter</span> <span class="o">==</span> <span class="n">meter</span><span class="p">:</span>
                <span class="n">meter</span> <span class="o">=</span> <span class="n">reference_meter</span>
                <span class="k">break</span>
        <span class="n">preferred_meters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meter</span><span class="p">)</span>
        <span class="n">nontupletted_leaves</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">iterate</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">list_</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">parentage</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">):</span>
                <span class="n">nontupletted_leaves</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span>
        <span class="n">unbeam</span><span class="p">(</span><span class="n">nontupletted_leaves</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">Meter</span><span class="o">.</span><span class="n">rewrite_meter</span><span class="p">(</span>
            <span class="n">list_</span><span class="p">,</span>
            <span class="n">meter</span><span class="p">,</span>
            <span class="n">boundary_depth</span><span class="o">=</span><span class="n">boundary_depth</span><span class="p">,</span>
            <span class="n">rewrite_tuplets</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">lists</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">group_by_measure</span><span class="p">(</span><span class="n">voice</span><span class="p">[:])</span>
    <span class="k">for</span> <span class="n">meter</span><span class="p">,</span> <span class="n">list_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">preferred_meters</span><span class="p">,</span> <span class="n">lists</span><span class="p">):</span>
        <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span> <span class="n">grace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">beat_durations</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">beat_offsets</span> <span class="o">=</span> <span class="n">meter</span><span class="o">.</span><span class="n">depthwise_offset_inventory</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">nwise</span><span class="p">(</span><span class="n">beat_offsets</span><span class="p">):</span>
            <span class="n">beat_duration</span> <span class="o">=</span> <span class="n">stop</span> <span class="o">-</span> <span class="n">start</span>
            <span class="n">beat_durations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">beat_duration</span><span class="p">)</span>
        <span class="n">beamable_groups</span> <span class="o">=</span> <span class="n">_make_beamable_groups</span><span class="p">(</span><span class="n">leaves</span><span class="p">,</span> <span class="n">beat_durations</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">beamable_group</span> <span class="ow">in</span> <span class="n">beamable_groups</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">beamable_group</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">beam</span><span class="p">(</span>
                <span class="n">beamable_group</span><span class="p">,</span>
                <span class="n">beam_rests</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="rewrite_rest_filled"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.rewrite_rest_filled">[docs]</a><span class="k">def</span> <span class="nf">rewrite_rest_filled</span><span class="p">(</span>
    <span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">spelling</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rewrites rest-filled tuplets in ``argument``.</span>

<span class="sd">    Does not rewrite rest-filled tuplets:</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [-1], 16, extra_counts=[1])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(4, 16), (4, 16), (5, 16), (5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \times 4/5</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/16</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 4/5</span>
<span class="sd">                        {</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 5/6</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 5/16</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 5/6</span>
<span class="sd">                        {</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                            r16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Rewrites rest-filled tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [-1], 16, extra_counts=[1])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.rewrite_rest_filled(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(4, 16), (4, 16), (5, 16), (5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        r4</span>
<span class="sd">                        r4</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        r4</span>
<span class="sd">                        r16</span>
<span class="sd">                        r4</span>
<span class="sd">                        r16</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        With spelling specifier:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [-1], 16, extra_counts=[1])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.rewrite_rest_filled(</span>
<span class="sd">        ...         container,</span>
<span class="sd">        ...         spelling=rmakers.Spelling(increase_monotonic=True)</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(4, 16), (4, 16), (5, 16), (5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        r4</span>
<span class="sd">                        r4</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r4</span>
<span class="sd">                        r16</span>
<span class="sd">                        r4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Working with ``rewrite_rest_filled``.</span>

<span class="sd">        Makes rest-filled tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(</span>
<span class="sd">        ...         durations, [3, 3, -6, -6], 16, extra_counts=[1, 0]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 6/7</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            ]</span>
<span class="sd">                            r16</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            r4</span>
<span class="sd">                            r16</span>
<span class="sd">                            r8.</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 6/7</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            r8.</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            r4.</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Rewrites rest-filled tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(</span>
<span class="sd">        ...         durations, [3, 3, -6, -6], 16, extra_counts=[1, 0]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.rewrite_rest_filled(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 6/7</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            ]</span>
<span class="sd">                            r16</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            r2</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 6/7</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            r8.</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            r4.</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
    <span class="k">if</span> <span class="n">spelling</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">increase_monotonic</span> <span class="o">=</span> <span class="n">spelling</span><span class="o">.</span><span class="n">increase_monotonic</span>
        <span class="n">forbidden_note_duration</span> <span class="o">=</span> <span class="n">spelling</span><span class="o">.</span><span class="n">forbidden_note_duration</span>
        <span class="n">forbidden_rest_duration</span> <span class="o">=</span> <span class="n">spelling</span><span class="o">.</span><span class="n">forbidden_rest_duration</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">increase_monotonic</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">forbidden_note_duration</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">forbidden_rest_duration</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tuplet</span><span class="o">.</span><span class="n">rest_filled</span><span class="p">():</span>
            <span class="k">continue</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
        <span class="n">rests</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">makers</span><span class="o">.</span><span class="n">make_leaves</span><span class="p">(</span>
            <span class="p">[</span><span class="kc">None</span><span class="p">],</span>
            <span class="p">[</span><span class="n">duration</span><span class="p">],</span>
            <span class="n">increase_monotonic</span><span class="o">=</span><span class="n">increase_monotonic</span><span class="p">,</span>
            <span class="n">forbidden_note_duration</span><span class="o">=</span><span class="n">forbidden_note_duration</span><span class="p">,</span>
            <span class="n">forbidden_rest_duration</span><span class="o">=</span><span class="n">forbidden_rest_duration</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tuplet</span><span class="p">[:],</span> <span class="n">rests</span><span class="p">)</span>
        <span class="n">tuplet</span><span class="o">.</span><span class="n">multiplier</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="rewrite_sustained"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.rewrite_sustained">[docs]</a><span class="k">def</span> <span class="nf">rewrite_sustained</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rewrites sustained tuplets in ``argument``.</span>

<span class="sd">    Sustained tuplets generalize a class of rhythms composers are likely to rewrite:</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(</span>
<span class="sd">        ...         durations, [6, 5, 5, 4, 1], 16, extra_counts=[2, 1, 1, 1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[1:3]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(4, 16), (4, 16), (4, 16), (4, 16)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/16</span>
<span class="sd">                            c&#39;4.</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 4/5</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 4/5</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 4/5</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        The first three tuplets in the example above qualify as sustained:</span>

<span class="sd">            &gt;&gt;&gt; staff = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; for tuplet in abjad.select.tuplets(staff):</span>
<span class="sd">            ...     abjad.get.sustained(tuplet)</span>
<span class="sd">            ...</span>
<span class="sd">            True</span>
<span class="sd">            True</span>
<span class="sd">            True</span>
<span class="sd">            False</span>

<span class="sd">        Tuplets 0 and 1 each contain only a single **tuplet-initial** attack. Tuplet 2</span>
<span class="sd">        contains no attack at all. All three fill their duration completely.</span>

<span class="sd">        Tuplet 3 contains a **nonintial** attack that rearticulates the tuplet&#39;s duration</span>
<span class="sd">        midway through the course of the figure. Tuplet 3 does not qualify as sustained.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Rewrite sustained tuplets like this:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(</span>
<span class="sd">        ...         durations, [6, 5, 5, 4, 1], 16, extra_counts=[2, 1, 1, 1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[1:3]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.rewrite_sustained(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(4, 16), (4, 16), (4, 16), (4, 16)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/16</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 4/5</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Rewrite sustained tuplets -- and then extract the trivial tuplets that result --</span>
<span class="sd">        like this:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(</span>
<span class="sd">        ...         durations, [6, 5, 5, 4, 1], 16, extra_counts=[2, 1, 1, 1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[1:3]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.rewrite_sustained(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(4, 16), (4, 16), (4, 16), (4, 16)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        \times 4/5</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        With selector:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [8], extra_counts=[1])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_)[:-1] for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.rewrite_sustained(tuplets[-2:])</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 2/8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 2/2</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 2/2</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Sustains every other tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [1, 2, 3, 4], 16)</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     tuplets = abjad.select.get(tuplets, [1], 2)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_)[:-1] for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.rewrite_sustained(tuplets)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                        ~</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">sustained</span><span class="p">(</span><span class="n">tuplet</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
        <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
        <span class="n">last_leaf</span> <span class="o">=</span> <span class="n">leaves</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">has_indicator</span><span class="p">(</span><span class="n">last_leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">):</span>
            <span class="n">last_leaf_has_tie</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">last_leaf_has_tie</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">tuplet</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">last_leaf_has_tie</span><span class="p">:</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">,</span> <span class="n">tuplet</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">_set_leaf_duration</span><span class="p">(</span><span class="n">tuplet</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">duration</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="n">tuplet</span><span class="o">.</span><span class="n">multiplier</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="split_measures"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.split_measures">[docs]</a><span class="k">def</span> <span class="nf">split_measures</span><span class="p">(</span><span class="n">voice</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">durations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Splits measures in ``voice``.</span>

<span class="sd">    Uses ``durations`` when ``durations`` is not none.</span>

<span class="sd">    Tries to find time signature information (from the staff that contains ``voice``)</span>
<span class="sd">    when ``durations`` is none.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">durations</span><span class="p">:</span>
        <span class="c1"># TODO: implement abjad.get() method for measure durations</span>
        <span class="n">staff</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">parentage</span><span class="p">(</span><span class="n">voice</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">staff</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Staff</span><span class="p">)</span>
        <span class="n">voice_</span> <span class="o">=</span> <span class="n">staff</span><span class="p">[</span><span class="s2">&quot;TimeSignatureVoice&quot;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">voice_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">)</span>
        <span class="n">durations</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">voice_</span><span class="p">]</span>
    <span class="n">total_duration</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">durations</span><span class="p">)</span>
    <span class="n">music_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">voice</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">total_duration</span> <span class="o">!=</span> <span class="n">music_duration</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Total duration of splits is </span><span class="si">{</span><span class="n">total_duration</span><span class="si">!s}</span><span class="s2">&quot;</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; but duration of music is </span><span class="si">{</span><span class="n">music_duration</span><span class="si">!s}</span><span class="s2">:&quot;</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">durations: </span><span class="si">{</span><span class="n">durations</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">voice: </span><span class="si">{</span><span class="n">voice</span><span class="p">[:]</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">voice</span><span class="p">[:],</span> <span class="n">durations</span><span class="o">=</span><span class="n">durations</span><span class="p">)</span></div>


<div class="viewcode-block" id="swap_length_1"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.swap_length_1">[docs]</a><span class="k">def</span> <span class="nf">swap_length_1</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Swaps length-1 tuplets in ``argument`` with containers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">tuplets</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">container</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Container</span><span class="p">()</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="n">tuplet</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span></div>


<div class="viewcode-block" id="swap_skip_filled"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.swap_skip_filled">[docs]</a><span class="k">def</span> <span class="nf">swap_skip_filled</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Swaps skip-filled tuplets in ``argument`` with containers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">tuplets</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Skip</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tuplet</span><span class="p">):</span>
            <span class="n">container</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Container</span><span class="p">()</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="n">tuplet</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span></div>


<div class="viewcode-block" id="swap_trivial"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.swap_trivial">[docs]</a><span class="k">def</span> <span class="nf">swap_trivial</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Swaps trivial tuplets in ``argument`` with containers.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [8])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[-2:]</span>
<span class="sd">        ...     rmakers.swap_trivial(tuplets)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (3, 8), (3, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">tuplets</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tuplet</span><span class="o">.</span><span class="n">trivial</span><span class="p">():</span>
            <span class="n">container</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Container</span><span class="p">()</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="n">tuplet</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span></div>


<div class="viewcode-block" id="tie"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.tie">[docs]</a><span class="k">def</span> <span class="nf">tie</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attaches ties to notes in ``argument``.</span>

<span class="sd">    Attaches tie to last note in each nonlast tuplet:</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [8], extra_counts=[1])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     notes = [abjad.select.note(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 2/8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Ties the last leaf of nonlast tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [5, 3, 3, 3], 16)</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Ties across every other tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [5, 3, 3, 3], 16)</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     tuplets = abjad.select.get(tuplets, [0], 2)</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        TIE-CONSECUTIVE-NOTES RECIPE:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(durations, [5, -3, 3, 3], 16)</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     rmakers.untie(container)</span>
<span class="sd">        ...     runs = abjad.select.runs(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_)[:-1] for _ in runs]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        r8.</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        r8.</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>


<span class="sd">    ..  container:: example</span>

<span class="sd">        Attaches ties to nonlast notes in each tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [8], extra_counts=[1])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_)[:-1] for _ in tuplets]</span>
<span class="sd">        ...     rmakers.untie(notes)</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 2/8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
    <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">notes</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">tie</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">()</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">tie</span><span class="p">,</span> <span class="n">note</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span></div>


<div class="viewcode-block" id="time_signatures"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.time_signatures">[docs]</a><span class="k">def</span> <span class="nf">time_signatures</span><span class="p">(</span><span class="n">pairs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">TimeSignature</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes time signatures from ``pairs``.</span>

<span class="sd">    Documentation helper.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">TimeSignature</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">]</span></div>


<div class="viewcode-block" id="tremolo_container"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.tremolo_container">[docs]</a><span class="k">def</span> <span class="nf">tremolo_container</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces notes in ``argument`` with tremolo containers.</span>

<span class="sd">    Repeats figures two times each:</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [4])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_) for _ in tuplets]</span>
<span class="sd">        ...     groups = [abjad.select.get(_, [0, -1]) for _ in notes]</span>
<span class="sd">        ...     rmakers.tremolo_container(groups, 2)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     containers = abjad.select.components(components, abjad.TremoloContainer)</span>
<span class="sd">        ...     result = [abjad.slur(_) for _ in containers]</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(4, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \repeat tremolo 2 {</span>
<span class="sd">                            \time 4/4</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            (</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            )</span>
<span class="sd">                        }</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \repeat tremolo 2 {</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            (</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            )</span>
<span class="sd">                        }</span>
<span class="sd">                        \repeat tremolo 2 {</span>
<span class="sd">                            \time 3/4</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            (</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            )</span>
<span class="sd">                        }</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \repeat tremolo 2 {</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            (</span>
<span class="sd">                            c&#39;16</span>
<span class="sd">                            )</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Repeats figures four times each:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [4])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_) for _ in tuplets]</span>
<span class="sd">        ...     groups = [abjad.select.get(_, [0, -1]) for _ in notes]</span>
<span class="sd">        ...     rmakers.tremolo_container(groups, 4)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     containers = abjad.select.components(components, abjad.TremoloContainer)</span>
<span class="sd">        ...     result = [abjad.slur(_) for _ in containers]</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(4, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \repeat tremolo 4 {</span>
<span class="sd">                            \time 4/4</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            (</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            )</span>
<span class="sd">                        }</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \repeat tremolo 4 {</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            (</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            )</span>
<span class="sd">                        }</span>
<span class="sd">                        \repeat tremolo 4 {</span>
<span class="sd">                            \time 3/4</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            (</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            )</span>
<span class="sd">                        }</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \repeat tremolo 4 {</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            (</span>
<span class="sd">                            c&#39;32</span>
<span class="sd">                            )</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
    <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">notes</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">container_duration</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">written_duration</span>
        <span class="n">note_duration</span> <span class="o">=</span> <span class="n">container_duration</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">count</span><span class="p">)</span>
        <span class="n">left_note</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="s2">&quot;c&#39;&quot;</span><span class="p">,</span> <span class="n">note_duration</span><span class="p">)</span>
        <span class="n">right_note</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="s2">&quot;c&#39;&quot;</span><span class="p">,</span> <span class="n">note_duration</span><span class="p">)</span>
        <span class="n">container</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">TremoloContainer</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="p">[</span><span class="n">left_note</span><span class="p">,</span> <span class="n">right_note</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span></div>


<div class="viewcode-block" id="trivialize"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.trivialize">[docs]</a><span class="k">def</span> <span class="nf">trivialize</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Trivializes tuplets in ``argument``.</span>

<span class="sd">    Leaves trivializable tuplets as-is when no tuplet command is given. The tuplets</span>
<span class="sd">    in measures 2 and 4 can be written as trivial tuplets, but they are not:</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(</span>
<span class="sd">        ...         durations, [3, 3, 6, 6], 16, extra_counts=[0, 4]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            c&#39;4.</span>
<span class="sd">                            c&#39;4.</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            c&#39;4.</span>
<span class="sd">                            c&#39;4.</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Rewrites trivializable tuplets as trivial (1:1) tuplets when ``trivialize`` is</span>
<span class="sd">        true:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(</span>
<span class="sd">        ...         durations, [3, 3, 6, 6], 16, extra_counts=[0, 4]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     rmakers.trivialize(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        REGRESSION #907a. Rewrites trivializable tuplets even when tuplets contain</span>
<span class="sd">        multiple ties:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(</span>
<span class="sd">        ...         durations, [3, 3, 6, 6], 16, extra_counts=[0, 4]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     rmakers.trivialize(container)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        REGRESSION #907b. Rewrites trivializable tuplets even when tuplets contain very</span>
<span class="sd">        long ties:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.talea(</span>
<span class="sd">        ...         durations, [3, 3, 6, 6], 16, extra_counts=[0, 4]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     rmakers.trivialize(container)</span>
<span class="sd">        ...     notes = abjad.select.notes(container)[:-1]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            [</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/8</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            [</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8.</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 1/1</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 4/8</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">tuplet</span><span class="o">.</span><span class="n">trivialize</span><span class="p">()</span></div>


<div class="viewcode-block" id="unbeam"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.unbeam">[docs]</a><span class="k">def</span> <span class="nf">unbeam</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">smart</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Unbeams leaves in ``argument``.</span>

<span class="sd">    Adjusts adjacent start- and stop-beams when ``smart=True``.</span>

<span class="sd">    Unbeams 1 note:</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; e&#39; f&#39; g&#39; a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[0], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; e&#39; f&#39; g&#39; a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[1], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; e&#39; f&#39; g&#39; a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[2], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; e&#39; f&#39; g&#39; a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[3], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; e&#39; f&#39; g&#39; a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[4], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; e&#39; f&#39; g&#39; a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[5], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Unbeams 2 notes:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; e&#39; f&#39; g&#39; a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[:2], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; e&#39; f&#39; g&#39; a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[1:3], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; e&#39; f&#39; g&#39; a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[2:4], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; e&#39; f&#39; g&#39; a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[3:5], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; e&#39; f&#39; g&#39; a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[4:], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Unbeams 1 note:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; ] e&#39; [ f&#39; ] g&#39; [ a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[0], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; ] e&#39; [ f&#39; ] g&#39; [ a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[1], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; ] e&#39; [ f&#39; ] g&#39; [ a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[2], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; ] e&#39; [ f&#39; ] g&#39; [ a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[3], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; ] e&#39; [ f&#39; ] g&#39; [ a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[4], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; ] e&#39; [ f&#39; ] g&#39; [ a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[5], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Unbeams 2 notes:</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; ] e&#39; [ f&#39; ] g&#39; [ a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[:2], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; ] e&#39; [ f&#39; ] g&#39; [ a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[1:3], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; ] e&#39; [ f&#39; ] g&#39; [ a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[2:4], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; ] e&#39; [ f&#39; ] g&#39; [ a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[3:5], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; staff = abjad.Staff(&quot;c&#39;8 [ d&#39; ] e&#39; [ f&#39; ] g&#39; [ a&#39; ]&quot;)</span>
<span class="sd">        &gt;&gt;&gt; score = abjad.Score([staff])</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).autoBeaming = False</span>
<span class="sd">        &gt;&gt;&gt; rmakers.unbeam(staff[4:], smart=True)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(score) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \new Score</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                autoBeaming = ##f</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \new Staff</span>
<span class="sd">                {</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    d&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    e&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    f&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    g&#39;8</span>
<span class="sd">                    a&#39;8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="n">leaf</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Leaf</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">:</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">BeamCount</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">StartBeam</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">StopBeam</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">smart</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_function_name</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()))</span>
        <span class="n">unmatched_start_beam</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">leaf</span> <span class="o">=</span> <span class="n">leaves</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">leaf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">has_indicator</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">StopBeam</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">has_indicator</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">StartBeam</span><span class="p">):</span>
                <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">StartBeam</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">leaf</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">break</span>
                    <span class="k">if</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">has_indicator</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">StopBeam</span><span class="p">):</span>
                        <span class="k">break</span>
                    <span class="k">if</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">has_indicator</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">StartBeam</span><span class="p">):</span>
                        <span class="n">unmatched_start_beam</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">break</span>
        <span class="n">unmatched_stop_beam</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">leaf</span> <span class="o">=</span> <span class="n">leaves</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">leaf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">has_indicator</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">StartBeam</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">has_indicator</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">StopBeam</span><span class="p">):</span>
                <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">StopBeam</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">leaf</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">break</span>
                    <span class="k">if</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">has_indicator</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">StartBeam</span><span class="p">):</span>
                        <span class="k">break</span>
                    <span class="k">if</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">has_indicator</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">StopBeam</span><span class="p">):</span>
                        <span class="n">unmatched_stop_beam</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">break</span>
        <span class="k">if</span> <span class="n">unmatched_start_beam</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">leaf</span> <span class="o">=</span> <span class="n">leaves</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">StopBeam</span><span class="p">(),</span> <span class="n">leaf</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">unmatched_stop_beam</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">leaf</span> <span class="o">=</span> <span class="n">leaves</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">StartBeam</span><span class="p">(),</span> <span class="n">leaf</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span></div>


<div class="viewcode-block" id="untie"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.untie">[docs]</a><span class="k">def</span> <span class="nf">untie</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Unties leaves in ``argument``.</span>

<span class="sd">    Attaches ties to nonlast notes; then detaches ties from select notes:</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [8], extra_counts=[1])</span>
<span class="sd">        ...     container = abjad.Container(tuplets)</span>
<span class="sd">        ...     notes = abjad.select.notes(container)[:-1]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     notes = abjad.select.notes(container)</span>
<span class="sd">        ...     notes = abjad.select.get(notes, [0], 4)</span>
<span class="sd">        ...     rmakers.untie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 2/8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            ~</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            ~</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Attaches repeat-ties to nonfirst notes; then detaches ties from select notes:</span>

<span class="sd">        &gt;&gt;&gt; def make_lilypond_file(pairs):</span>
<span class="sd">        ...     time_signatures = rmakers.time_signatures(pairs)</span>
<span class="sd">        ...     durations = [abjad.Duration(_) for _ in time_signatures]</span>
<span class="sd">        ...     tuplets = rmakers.even_division(durations, [8], extra_counts=[1])</span>
<span class="sd">        ...     voice = abjad.Voice(tuplets)</span>
<span class="sd">        ...     notes = abjad.select.notes(voice)[1:]</span>
<span class="sd">        ...     rmakers.repeat_tie(notes)</span>
<span class="sd">        ...     notes = abjad.select.notes(voice)</span>
<span class="sd">        ...     notes = abjad.select.get(notes, [0], 4)</span>
<span class="sd">        ...     rmakers.untie(notes)</span>
<span class="sd">        ...     rmakers.beam(voice)</span>
<span class="sd">        ...     components = abjad.mutate.eject_contents(voice)</span>
<span class="sd">        ...     lilypond_file = rmakers.example(components, time_signatures)</span>
<span class="sd">        ...     return lilypond_file</span>

<span class="sd">        &gt;&gt;&gt; pairs = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = make_lilypond_file(pairs)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;Voice&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 2/8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                        }</span>
<span class="sd">                        \times 2/3</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                            \repeatTie</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">RepeatTie</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span></div>


<div class="viewcode-block" id="wrap_in_time_signature_staff"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.wrap_in_time_signature_staff">[docs]</a><span class="k">def</span> <span class="nf">wrap_in_time_signature_staff</span><span class="p">(</span>
    <span class="n">components</span><span class="p">,</span> <span class="n">time_signatures</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">TimeSignature</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wraps ``components`` in two-voice staff.</span>

<span class="sd">    One voice for ``components`` and another voice for ``time_signatures``.</span>

<span class="sd">    See ``rmakers.rewrite_meter()`` for examples of this function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Component</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">components</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">TimeSignature</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">time_signatures</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span>
        <span class="n">time_signatures</span>
    <span class="p">)</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">_make_time_signature_staff</span><span class="p">(</span><span class="n">time_signatures</span><span class="p">)</span>
    <span class="n">music_voice</span> <span class="o">=</span> <span class="n">score</span><span class="p">[</span><span class="s2">&quot;RhythmMaker.Music&quot;</span><span class="p">]</span>
    <span class="n">music_voice</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
    <span class="n">_validate_tuplets</span><span class="p">(</span><span class="n">music_voice</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">music_voice</span></div>


<div class="viewcode-block" id="written_duration"><a class="viewcode-back" href="../../../api/abjadext/rmakers/functions.html#abjadext.rmakers.functions.written_duration">[docs]</a><span class="k">def</span> <span class="nf">written_duration</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Duration</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets written duration of leaves in ``argument``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">duration_</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
    <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">:</span>
        <span class="n">old_duration</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">written_duration</span>
        <span class="k">if</span> <span class="n">duration_</span> <span class="o">==</span> <span class="n">old_duration</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">leaf</span><span class="o">.</span><span class="n">written_duration</span> <span class="o">=</span> <span class="n">duration_</span>
        <span class="n">multiplier</span> <span class="o">=</span> <span class="n">old_duration</span> <span class="o">/</span> <span class="n">duration_</span>
        <span class="n">pair</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">pair</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)</span>
        <span class="n">leaf</span><span class="o">.</span><span class="n">multiplier</span> <span class="o">=</span> <span class="n">pair</span></div>
</pre></div>

    </div>
    
    </div>
    

<footer>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

</div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>