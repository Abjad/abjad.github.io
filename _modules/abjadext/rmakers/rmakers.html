<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>abjadext.rmakers.rmakers &mdash; Abjad 3.15 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/abjad.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/uqbar.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/lightbox2/css/lightbox.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="canonical" href="https://abjad.github.io_modules/abjadext/rmakers/rmakers.html"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script defer="defer" src="../../../_static/copybutton.js"></script>
        <script src="../../../_static/ga.js"></script>
        <script defer="defer" src="../../../_static/lightbox2/js/lightbox.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #9922bb" >


    <a href="../../../index.html" class="icon icon-home" alt="Documentation
    Home"> Abjad 3.15



    <img src="../../../_static/abjad-logo.png" class="logo" alt="Logo"/>

</a>




<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">First steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../first_steps/audience.html">Audience</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../first_steps/macos.html">macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../first_steps/linux.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../first_steps/windows.html">Windows</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/containers-basic-operations-on.html">Containers, basic operations on</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/containers-retrieving-by-name.html">Containers, retrieving by name</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/containers-time-interpretation-of.html">Containers, time interpretation of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/contexts-lilypond-type-of.html">Contexts, LilyPond type of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/indicators.html">Indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/lilypond-files-preamble-of.html">LilyPond files, preamble of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../overview/lilypond-format-of-abjad-objects.html">LilyPond format, of Abjad objects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/corpus-selection.html">Corpus, figure selection from</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/design-by-dyads.html">Design, by dyads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/enumeration.html">Enumeration, of rhythmic cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/magic-square-from-twelve-tone-row.html">Magic square, from twelve-tone row</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/scales-diatonic.html">Scales, diatonic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/score-fragment-piano.html">Score fragment, piano</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All classes &amp; functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">Abjad API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/best-practices.html">Best practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/changes.html">Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/developer-installation.html">Developer installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/lilypond-context-concatenation.html">LilyPond context concatenation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/publications.html">Publications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Score gallery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../gallery-2020.html">2016-present</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gallery-2015.html">2015-11</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gallery-2010.html">2010-00</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #9922bb" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Abjad</a>
      </nav>

      <div class="wy-nav-content">

<div class="rst-content">

    


    <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    <div itemprop="articleBody">
    
  <h1>Source code for abjadext.rmakers.rmakers</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">dataclasses</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">types</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="kn">import</span> <span class="nn">abjad</span>


<span class="k">def</span> <span class="nf">_apply_ties_to_split_notes</span><span class="p">(</span>
    <span class="n">tuplets</span><span class="p">,</span>
    <span class="n">unscaled_end_counts</span><span class="p">,</span>
    <span class="n">unscaled_preamble</span><span class="p">,</span>
    <span class="n">unscaled_talea</span><span class="p">,</span>
    <span class="n">self_talea</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">tuplets</span><span class="p">)</span>
    <span class="n">written_durations</span> <span class="o">=</span> <span class="p">[</span><span class="n">leaf</span><span class="o">.</span><span class="n">written_duration</span> <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">]</span>
    <span class="n">written_durations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">written_durations</span><span class="p">)</span>
    <span class="n">total_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">written_durations</span><span class="p">)</span>
    <span class="n">preamble_weights</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">unscaled_preamble</span><span class="p">:</span>
        <span class="n">preamble_weights</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">numerator</span> <span class="ow">in</span> <span class="n">unscaled_preamble</span><span class="p">:</span>
            <span class="n">pair</span> <span class="o">=</span> <span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="n">self_talea</span><span class="o">.</span><span class="n">denominator</span><span class="p">)</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="o">*</span><span class="n">pair</span><span class="p">)</span>
            <span class="n">weight</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
            <span class="n">preamble_weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
    <span class="n">preamble_duration</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">preamble_weights</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">total_duration</span> <span class="o">&lt;=</span> <span class="n">preamble_duration</span><span class="p">:</span>
        <span class="n">preamble_parts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">partition_by_weights</span><span class="p">(</span>
            <span class="n">written_durations</span><span class="p">,</span>
            <span class="n">weights</span><span class="o">=</span><span class="n">preamble_weights</span><span class="p">,</span>
            <span class="n">allow_part_weights</span><span class="o">=</span><span class="n">abjad</span><span class="o">.</span><span class="n">MORE</span><span class="p">,</span>
            <span class="n">cyclic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">overhang</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">talea_parts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">preamble_duration</span> <span class="o">&lt;</span> <span class="n">total_duration</span>
        <span class="n">preamble_parts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">partition_by_weights</span><span class="p">(</span>
            <span class="n">written_durations</span><span class="p">,</span>
            <span class="n">weights</span><span class="o">=</span><span class="n">preamble_weights</span><span class="p">,</span>
            <span class="n">allow_part_weights</span><span class="o">=</span><span class="n">abjad</span><span class="o">.</span><span class="n">EXACT</span><span class="p">,</span>
            <span class="n">cyclic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">overhang</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">talea_weights</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">numerator</span> <span class="ow">in</span> <span class="n">unscaled_talea</span><span class="p">:</span>
            <span class="n">pair</span> <span class="o">=</span> <span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="n">self_talea</span><span class="o">.</span><span class="n">denominator</span><span class="p">)</span>
            <span class="n">weight</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="o">*</span><span class="n">pair</span><span class="p">))</span>
            <span class="n">talea_weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
        <span class="n">preamble_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">preamble_parts</span><span class="p">))</span>
        <span class="n">talea_written_durations</span> <span class="o">=</span> <span class="n">written_durations</span><span class="p">[</span><span class="n">preamble_length</span><span class="p">:]</span>
        <span class="n">talea_parts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">partition_by_weights</span><span class="p">(</span>
            <span class="n">talea_written_durations</span><span class="p">,</span>
            <span class="n">weights</span><span class="o">=</span><span class="n">talea_weights</span><span class="p">,</span>
            <span class="n">allow_part_weights</span><span class="o">=</span><span class="n">abjad</span><span class="o">.</span><span class="n">MORE</span><span class="p">,</span>
            <span class="n">cyclic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">overhang</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">preamble_parts</span> <span class="o">+</span> <span class="n">talea_parts</span>
    <span class="n">part_durations</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">part_durations</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">written_durations</span><span class="p">)</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">part</span><span class="p">)</span> <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">]</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">partition_by_counts</span><span class="p">(</span><span class="n">leaves</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">part</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">parts</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Rest</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">part</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">part</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">tie</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
    <span class="c1"># TODO: this will need to be generalized and better tested:</span>
    <span class="k">if</span> <span class="n">unscaled_end_counts</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unscaled_end_counts</span><span class="p">)</span>
        <span class="n">end_leaves</span> <span class="o">=</span> <span class="n">leaves</span><span class="p">[</span><span class="o">-</span><span class="n">total</span><span class="p">:]</span>
        <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">end_leaves</span><span class="p">):</span>
            <span class="n">previous_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">previous_leaf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">,</span> <span class="n">previous_leaf</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_do_grace_container_command</span><span class="p">(</span>
    <span class="n">argument</span><span class="p">,</span>
    <span class="n">counts</span><span class="p">,</span>
    <span class="n">beam_and_slash</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">class_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">talea</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">grace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
    <span class="n">cyclic_counts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">leaves</span><span class="p">):</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">cyclic_counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">count</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">count</span>
        <span class="n">durations</span> <span class="o">=</span> <span class="n">talea</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="n">notes</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">makers</span><span class="o">.</span><span class="n">make_leaves</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">durations</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">beam_and_slash</span><span class="p">:</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">beam</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>
            <span class="n">literal</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">LilyPondLiteral</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\slash&quot;</span><span class="p">)</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">literal</span><span class="p">,</span> <span class="n">notes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">container</span> <span class="o">=</span> <span class="n">class_</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_fix_rounding_error</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">total_duration</span><span class="p">,</span> <span class="n">interpolation</span><span class="p">):</span>
    <span class="n">selection_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">selection_duration</span> <span class="o">==</span> <span class="n">total_duration</span><span class="p">:</span>
        <span class="n">needed_duration</span> <span class="o">=</span> <span class="n">total_duration</span> <span class="o">-</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">selection</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">multiplier</span> <span class="o">=</span> <span class="n">needed_duration</span> <span class="o">/</span> <span class="n">interpolation</span><span class="o">.</span><span class="n">written_duration</span>
        <span class="n">selection</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">multiplier</span> <span class="o">=</span> <span class="n">multiplier</span>


<span class="k">def</span> <span class="nf">_get_interpolations</span><span class="p">(</span><span class="n">self_interpolations</span><span class="p">,</span> <span class="n">self_previous_state</span><span class="p">):</span>
    <span class="n">specifiers_</span> <span class="o">=</span> <span class="n">self_interpolations</span>
    <span class="k">if</span> <span class="n">specifiers_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">specifiers_</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">([</span><span class="n">Interpolation</span><span class="p">()])</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">specifiers_</span><span class="p">,</span> <span class="n">Interpolation</span><span class="p">):</span>
        <span class="n">specifiers_</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">([</span><span class="n">specifiers_</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">specifiers_</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">specifiers_</span><span class="p">)</span>
    <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;divisions_consumed&quot;</span>
    <span class="n">divisions_consumed</span> <span class="o">=</span> <span class="n">self_previous_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">specifiers_</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">specifiers_</span><span class="p">,</span> <span class="n">n</span><span class="o">=-</span><span class="n">divisions_consumed</span><span class="p">)</span>
    <span class="n">specifiers_</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">specifiers_</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">specifiers_</span>


<span class="k">def</span> <span class="nf">_incised_numeric_map_to_leaf_selections</span><span class="p">(</span>
    <span class="n">numeric_map</span><span class="p">,</span> <span class="n">lcd</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">spelling</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>
    <span class="n">selections</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">numeric_map_part</span> <span class="ow">in</span> <span class="n">numeric_map</span><span class="p">:</span>
        <span class="n">numeric_map_part</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">numeric_map_part</span> <span class="k">if</span> <span class="n">_</span> <span class="o">!=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">_make_leaves_from_talea</span><span class="p">(</span>
            <span class="n">numeric_map_part</span><span class="p">,</span>
            <span class="n">lcd</span><span class="p">,</span>
            <span class="n">forbidden_note_duration</span><span class="o">=</span><span class="n">spelling</span><span class="o">.</span><span class="n">forbidden_note_duration</span><span class="p">,</span>
            <span class="n">forbidden_rest_duration</span><span class="o">=</span><span class="n">spelling</span><span class="o">.</span><span class="n">forbidden_rest_duration</span><span class="p">,</span>
            <span class="n">increase_monotonic</span><span class="o">=</span><span class="n">spelling</span><span class="o">.</span><span class="n">increase_monotonic</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">selections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">selections</span>


<span class="k">def</span> <span class="nf">_interpolate_cosine</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="n">mu2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">mu</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">y1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mu2</span><span class="p">)</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">*</span> <span class="n">mu2</span>


<span class="k">def</span> <span class="nf">_interpolate_divide</span><span class="p">(</span>
    <span class="n">total_duration</span><span class="p">,</span> <span class="n">start_duration</span><span class="p">,</span> <span class="n">stop_duration</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="s2">&quot;cosine&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Divides ``total_duration`` into durations computed from interpolating between</span>
<span class="sd">    ``start_duration`` and ``stop_duration``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; rmakers.rmakers._interpolate_divide(</span>
<span class="sd">        ...     total_duration=10,</span>
<span class="sd">        ...     start_duration=1,</span>
<span class="sd">        ...     stop_duration=1,</span>
<span class="sd">        ...     exponent=1,</span>
<span class="sd">        ... )</span>
<span class="sd">        [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]</span>
<span class="sd">        &gt;&gt;&gt; sum(_)</span>
<span class="sd">        10.0</span>

<span class="sd">        &gt;&gt;&gt; rmakers.rmakers._interpolate_divide(</span>
<span class="sd">        ...     total_duration=10,</span>
<span class="sd">        ...     start_duration=5,</span>
<span class="sd">        ...     stop_duration=1,</span>
<span class="sd">        ... )</span>
<span class="sd">        [4.798..., 2.879..., 1.326..., 0.995...]</span>
<span class="sd">        &gt;&gt;&gt; sum(_)</span>
<span class="sd">        10.0</span>

<span class="sd">    Set ``exponent`` to ``&#39;cosine&#39;`` for cosine interpolation.</span>

<span class="sd">    Set ``exponent`` to a numeric value for exponential interpolation with</span>
<span class="sd">    ``exponent`` as the exponent.</span>

<span class="sd">    Scales resulting durations so that their sum equals ``total_duration`` exactly.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">total_duration</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Total duration must be positive.&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">start_duration</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">stop_duration</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Both &#39;start_duration&#39; and &#39;stop_duration&#39;&quot;</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot; must be positive.&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">total_duration</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">stop_duration</span> <span class="o">+</span> <span class="n">start_duration</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;too small&quot;</span>
    <span class="n">durations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">total_duration</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">total_duration</span><span class="p">)</span>
    <span class="n">partial_sum</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">while</span> <span class="n">partial_sum</span> <span class="o">&lt;</span> <span class="n">total_duration</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">exponent</span> <span class="o">==</span> <span class="s2">&quot;cosine&quot;</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">_interpolate_cosine</span><span class="p">(</span>
                <span class="n">start_duration</span><span class="p">,</span> <span class="n">stop_duration</span><span class="p">,</span> <span class="n">partial_sum</span> <span class="o">/</span> <span class="n">total_duration</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">_interpolate_exponential</span><span class="p">(</span>
                <span class="n">start_duration</span><span class="p">,</span>
                <span class="n">stop_duration</span><span class="p">,</span>
                <span class="n">partial_sum</span> <span class="o">/</span> <span class="n">total_duration</span><span class="p">,</span>
                <span class="n">exponent</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">durations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
        <span class="n">partial_sum</span> <span class="o">+=</span> <span class="n">duration</span>
    <span class="n">durations</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span> <span class="o">*</span> <span class="n">total_duration</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">durations</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">durations</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">durations</span>


<span class="k">def</span> <span class="nf">_interpolate_divide_multiple</span><span class="p">(</span>
    <span class="n">total_durations</span><span class="p">,</span> <span class="n">reference_durations</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="s2">&quot;cosine&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Interpolates ``reference_durations`` such that the sum of the resulting</span>
<span class="sd">    interpolated values equals the given ``total_durations``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; durations = rmakers.rmakers._interpolate_divide_multiple(</span>
<span class="sd">        ...     total_durations=[100, 50],</span>
<span class="sd">        ...     reference_durations=[20, 10, 20],</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; for duration in durations:</span>
<span class="sd">        ...     duration</span>
<span class="sd">        19.448...</span>
<span class="sd">        18.520...</span>
<span class="sd">        16.227...</span>
<span class="sd">        13.715...</span>
<span class="sd">        11.748...</span>
<span class="sd">        10.487...</span>
<span class="sd">        9.8515...</span>
<span class="sd">        9.5130...</span>
<span class="sd">        10.421...</span>
<span class="sd">        13.073...</span>
<span class="sd">        16.991...</span>

<span class="sd">    Precondition: ``len(totals_durations) == len(reference_durations)-1``.</span>

<span class="sd">    Set ``exponent`` to ``cosine`` for cosine interpolation. Set ``exponent`` to a</span>
<span class="sd">    number for exponential interpolation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">total_durations</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">reference_durations</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">durations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">total_durations</span><span class="p">)):</span>
        <span class="n">durations_</span> <span class="o">=</span> <span class="n">_interpolate_divide</span><span class="p">(</span>
            <span class="n">total_durations</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">reference_durations</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">reference_durations</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">exponent</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">duration_</span> <span class="ow">in</span> <span class="n">durations_</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">duration_</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
            <span class="n">durations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">duration_</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">durations</span>


<span class="k">def</span> <span class="nf">_interpolate_exponential</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Interpolates between ``y1`` and ``y2`` at position ``mu``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Exponents equal to 1 leave durations unscaled:</span>

<span class="sd">        &gt;&gt;&gt; for mu in (0, 0.25, 0.5, 0.75, 1):</span>
<span class="sd">        ...     rmakers.rmakers._interpolate_exponential(100, 200, mu, exponent=1)</span>
<span class="sd">        ...</span>
<span class="sd">        100</span>
<span class="sd">        125.0</span>
<span class="sd">        150.0</span>
<span class="sd">        175.0</span>
<span class="sd">        200</span>

<span class="sd">        Exponents greater than 1 generate ritardandi:</span>

<span class="sd">        &gt;&gt;&gt; for mu in (0, 0.25, 0.5, 0.75, 1):</span>
<span class="sd">        ...     rmakers.rmakers._interpolate_exponential(100, 200, mu, exponent=2)</span>
<span class="sd">        ...</span>
<span class="sd">        100</span>
<span class="sd">        106.25</span>
<span class="sd">        125.0</span>
<span class="sd">        156.25</span>
<span class="sd">        200</span>

<span class="sd">        Exponents less than 1 generate accelerandi:</span>

<span class="sd">        &gt;&gt;&gt; for mu in (0, 0.25, 0.5, 0.75, 1):</span>
<span class="sd">        ...     rmakers.rmakers._interpolate_exponential(100, 200, mu, exponent=0.5)</span>
<span class="sd">        ...</span>
<span class="sd">        100.0</span>
<span class="sd">        150.0</span>
<span class="sd">        170.71067811865476</span>
<span class="sd">        186.60254037844388</span>
<span class="sd">        200.0</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mu</span><span class="o">**</span><span class="n">exponent</span><span class="p">)</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">*</span> <span class="n">mu</span><span class="o">**</span><span class="n">exponent</span>
    <span class="k">return</span> <span class="n">result</span>


<span class="k">def</span> <span class="nf">_is_accelerando</span><span class="p">(</span><span class="n">selection</span><span class="p">):</span>
    <span class="n">first_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">last_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">first_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">first_leaf</span><span class="p">)</span>
    <span class="n">last_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">last_leaf</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">last_duration</span> <span class="o">&lt;</span> <span class="n">first_duration</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>


<span class="k">def</span> <span class="nf">_is_ritardando</span><span class="p">(</span><span class="n">selection</span><span class="p">):</span>
    <span class="n">first_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">last_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">first_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">first_leaf</span><span class="p">)</span>
    <span class="n">last_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">last_leaf</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">first_duration</span> <span class="o">&lt;</span> <span class="n">last_duration</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>


<span class="k">def</span> <span class="nf">_make_accelerando</span><span class="p">(</span>
    <span class="n">total_duration</span><span class="p">,</span> <span class="n">interpolations</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes notes with LilyPond multipliers equal to ``total_duration``.</span>

<span class="sd">    Total number of notes not specified: total duration is specified instead.</span>

<span class="sd">    Selects interpolation specifier at ``index`` in ``interpolations``.</span>

<span class="sd">    Computes duration multipliers interpolated from interpolation specifier start to</span>
<span class="sd">    stop.</span>

<span class="sd">    Sets note written durations according to interpolation specifier.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">total_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">total_duration</span><span class="p">)</span>
    <span class="n">interpolation</span> <span class="o">=</span> <span class="n">interpolations</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="n">durations</span> <span class="o">=</span> <span class="n">_interpolate_divide</span><span class="p">(</span>
        <span class="n">total_duration</span><span class="o">=</span><span class="n">total_duration</span><span class="p">,</span>
        <span class="n">start_duration</span><span class="o">=</span><span class="n">interpolation</span><span class="o">.</span><span class="n">start_duration</span><span class="p">,</span>
        <span class="n">stop_duration</span><span class="o">=</span><span class="n">interpolation</span><span class="o">.</span><span class="n">stop_duration</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">durations</span> <span class="o">==</span> <span class="s2">&quot;too small&quot;</span><span class="p">:</span>
        <span class="n">notes</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">makers</span><span class="o">.</span><span class="n">make_notes</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">total_duration</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="n">tuplet</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">notes</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tuplet</span>
    <span class="n">durations</span> <span class="o">=</span> <span class="n">_round_durations</span><span class="p">(</span><span class="n">durations</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">notes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">duration</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">durations</span><span class="p">):</span>
        <span class="n">written_duration</span> <span class="o">=</span> <span class="n">interpolation</span><span class="o">.</span><span class="n">written_duration</span>
        <span class="n">multiplier</span> <span class="o">=</span> <span class="n">duration</span> <span class="o">/</span> <span class="n">written_duration</span>
        <span class="n">note</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">written_duration</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">=</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="n">notes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>
    <span class="n">_fix_rounding_error</span><span class="p">(</span><span class="n">notes</span><span class="p">,</span> <span class="n">total_duration</span><span class="p">,</span> <span class="n">interpolation</span><span class="p">)</span>
    <span class="n">tuplet</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">notes</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tuplet</span>


<span class="k">def</span> <span class="nf">_make_accelerando_rhythm_maker_music</span><span class="p">(</span>
    <span class="n">divisions</span><span class="p">,</span>
    <span class="o">*</span><span class="n">self_interpolations</span><span class="p">,</span>
    <span class="n">self_previous_state</span><span class="p">,</span>
    <span class="n">self_spelling</span><span class="p">,</span>
    <span class="n">self_tag</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">interpolations</span> <span class="o">=</span> <span class="n">_get_interpolations</span><span class="p">(</span><span class="n">self_interpolations</span><span class="p">,</span> <span class="n">self_previous_state</span><span class="p">)</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">division</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">divisions</span><span class="p">):</span>
        <span class="n">tuplet</span> <span class="o">=</span> <span class="n">_make_accelerando</span><span class="p">(</span><span class="n">division</span><span class="p">,</span> <span class="n">interpolations</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">self_tag</span><span class="p">)</span>
        <span class="n">tuplets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tuplets</span>


<span class="k">def</span> <span class="nf">_make_beamable_groups</span><span class="p">(</span><span class="n">components</span><span class="p">,</span> <span class="n">durations</span><span class="p">):</span>
    <span class="n">music_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">music_duration</span> <span class="o">!=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">durations</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;music duration </span><span class="si">{</span><span class="n">music_duration</span><span class="si">}</span><span class="s2"> does not equal&quot;</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; total duration </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">durations</span><span class="p">)</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;   </span><span class="si">{</span><span class="n">components</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;   </span><span class="si">{</span><span class="n">durations</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="n">component_to_timespan</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">start_offset</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="n">stop_offset</span> <span class="o">=</span> <span class="n">start_offset</span> <span class="o">+</span> <span class="n">duration</span>
        <span class="n">timespan</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Timespan</span><span class="p">(</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="p">)</span>
        <span class="n">pair</span> <span class="o">=</span> <span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span>
        <span class="n">component_to_timespan</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
        <span class="n">start_offset</span> <span class="o">=</span> <span class="n">stop_offset</span>
    <span class="n">group_to_target_duration</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">start_offset</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Offset</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">target_duration</span> <span class="ow">in</span> <span class="n">durations</span><span class="p">:</span>
        <span class="n">stop_offset</span> <span class="o">=</span> <span class="n">start_offset</span> <span class="o">+</span> <span class="n">target_duration</span>
        <span class="n">group_timespan</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Timespan</span><span class="p">(</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">stop_offset</span><span class="p">)</span>
        <span class="n">start_offset</span> <span class="o">=</span> <span class="n">stop_offset</span>
        <span class="n">group</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">component</span><span class="p">,</span> <span class="n">component_timespan</span> <span class="ow">in</span> <span class="n">component_to_timespan</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">component_timespan</span> <span class="ow">in</span> <span class="n">group_timespan</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="n">pair</span> <span class="o">=</span> <span class="p">([</span><span class="n">group</span><span class="p">],</span> <span class="n">target_duration</span><span class="p">)</span>
        <span class="n">group_to_target_duration</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
    <span class="n">beamable_groups</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">target_duration</span> <span class="ow">in</span> <span class="n">group_to_target_duration</span><span class="p">:</span>
        <span class="n">group_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">group_duration</span> <span class="o">&lt;=</span> <span class="n">target_duration</span>
        <span class="k">if</span> <span class="n">group_duration</span> <span class="o">==</span> <span class="n">target_duration</span><span class="p">:</span>
            <span class="n">beamable_groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">beamable_groups</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
    <span class="k">return</span> <span class="n">beamable_groups</span>


<span class="k">def</span> <span class="nf">_make_division_incised_numeric_map</span><span class="p">(</span>
    <span class="n">divisions</span><span class="p">,</span>
    <span class="n">prefix_talea</span><span class="p">,</span>
    <span class="n">prefix_counts</span><span class="p">,</span>
    <span class="n">suffix_talea</span><span class="p">,</span>
    <span class="n">suffix_counts</span><span class="p">,</span>
    <span class="n">extra_counts</span><span class="p">,</span>
    <span class="n">incise</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">numeric_map</span><span class="p">,</span> <span class="n">prefix_talea_index</span><span class="p">,</span> <span class="n">suffix_talea_index</span> <span class="o">=</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">pair_index</span><span class="p">,</span> <span class="n">division</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">divisions</span><span class="p">):</span>
        <span class="n">prefix_length</span> <span class="o">=</span> <span class="n">prefix_counts</span><span class="p">[</span><span class="n">pair_index</span><span class="p">]</span>
        <span class="n">suffix_length</span> <span class="o">=</span> <span class="n">suffix_counts</span><span class="p">[</span><span class="n">pair_index</span><span class="p">]</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">prefix_talea_index</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">prefix_talea_index</span> <span class="o">+</span> <span class="n">prefix_length</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix_talea</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">suffix_talea_index</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">suffix_talea_index</span> <span class="o">+</span> <span class="n">suffix_length</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="n">suffix_talea</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="n">prefix_talea_index</span> <span class="o">+=</span> <span class="n">prefix_length</span>
        <span class="n">suffix_talea_index</span> <span class="o">+=</span> <span class="n">suffix_length</span>
        <span class="n">prolation_addendum</span> <span class="o">=</span> <span class="n">extra_counts</span><span class="p">[</span><span class="n">pair_index</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">division</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">numerator</span> <span class="o">=</span> <span class="n">division</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">prolation_addendum</span> <span class="o">%</span> <span class="n">division</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">numerator</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">numerator</span> <span class="o">+</span> <span class="p">(</span><span class="n">prolation_addendum</span> <span class="o">%</span> <span class="n">division</span><span class="o">.</span><span class="n">numerator</span><span class="p">)</span>
        <span class="n">numeric_map_part</span> <span class="o">=</span> <span class="n">_make_numeric_map_part</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span><span class="p">,</span> <span class="n">incise</span><span class="p">)</span>
        <span class="n">numeric_map</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numeric_map_part</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">numeric_map</span>


<span class="k">def</span> <span class="nf">_make_even_division_rhythm_maker_music</span><span class="p">(</span>
    <span class="n">divisions</span><span class="p">,</span>
    <span class="n">self_denominators</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">self_denominator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">self_extra_counts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">self_previous_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">self_spelling</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">self_tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">self_previous_state</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
    <span class="n">divisions_consumed</span> <span class="o">=</span> <span class="n">self_previous_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;divisions_consumed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">divisions</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">NonreducedFraction</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">divisions</span><span class="p">]</span>
    <span class="n">denominators_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">self_denominators</span><span class="p">)</span>
    <span class="n">denominators_</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">denominators_</span><span class="p">,</span> <span class="o">-</span><span class="n">divisions_consumed</span><span class="p">)</span>
    <span class="n">denominators</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">denominators_</span><span class="p">)</span>
    <span class="n">extra_counts_</span> <span class="o">=</span> <span class="n">self_extra_counts</span> <span class="ow">or</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">extra_counts__</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">extra_counts_</span><span class="p">)</span>
    <span class="n">extra_counts__</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">extra_counts__</span><span class="p">,</span> <span class="o">-</span><span class="n">divisions_consumed</span><span class="p">)</span>
    <span class="n">extra_counts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">extra_counts__</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">division</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">divisions</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">abjad</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">is_positive_integer_power_of_two</span><span class="p">(</span><span class="n">division</span><span class="o">.</span><span class="n">denominator</span><span class="p">):</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;non-power-of-two divisions not implemented:&quot;</span>
            <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">division</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="n">denominator_</span> <span class="o">=</span> <span class="n">denominators</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">extra_count</span> <span class="o">=</span> <span class="n">extra_counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">basic_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">denominator_</span><span class="p">)</span>
        <span class="n">unprolated_note_count</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">division</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">basic_duration</span><span class="p">:</span>
            <span class="n">notes</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">makers</span><span class="o">.</span><span class="n">make_notes</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">division</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="n">self_tag</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unprolated_note_count</span> <span class="o">=</span> <span class="n">division</span> <span class="o">/</span> <span class="n">basic_duration</span>
            <span class="n">unprolated_note_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">unprolated_note_count</span><span class="p">)</span>
            <span class="n">unprolated_note_count</span> <span class="o">=</span> <span class="n">unprolated_note_count</span> <span class="ow">or</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">extra_count</span><span class="p">:</span>
                <span class="n">modulus</span> <span class="o">=</span> <span class="n">unprolated_note_count</span>
                <span class="n">extra_count</span> <span class="o">=</span> <span class="n">extra_count</span> <span class="o">%</span> <span class="n">modulus</span>
            <span class="k">elif</span> <span class="n">extra_count</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">modulus</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">unprolated_note_count</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">))</span>
                <span class="n">extra_count</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">extra_count</span><span class="p">)</span> <span class="o">%</span> <span class="n">modulus</span>
                <span class="n">extra_count</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">note_count</span> <span class="o">=</span> <span class="n">unprolated_note_count</span> <span class="o">+</span> <span class="n">extra_count</span>
            <span class="n">durations</span> <span class="o">=</span> <span class="n">note_count</span> <span class="o">*</span> <span class="p">[</span><span class="n">basic_duration</span><span class="p">]</span>
            <span class="n">notes</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">makers</span><span class="o">.</span><span class="n">make_notes</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">durations</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">self_tag</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">written_duration</span><span class="o">.</span><span class="n">denominator</span> <span class="o">==</span> <span class="n">denominator_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">notes</span><span class="p">)</span>
        <span class="n">tuplet_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">division</span><span class="p">)</span>
        <span class="n">tuplet</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="o">.</span><span class="n">from_duration</span><span class="p">(</span><span class="n">tuplet_duration</span><span class="p">,</span> <span class="n">notes</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">self_tag</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">self_denominator</span> <span class="o">==</span> <span class="s2">&quot;from_counts&quot;</span> <span class="ow">and</span> <span class="n">unprolated_note_count</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">denominator</span> <span class="o">=</span> <span class="n">unprolated_note_count</span>
            <span class="n">tuplet</span><span class="o">.</span><span class="n">denominator</span> <span class="o">=</span> <span class="n">denominator</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">self_denominator</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">tuplet</span><span class="o">.</span><span class="n">denominator</span> <span class="o">=</span> <span class="n">self_denominator</span>
        <span class="n">tuplets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tuplets</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">tuplets</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tuplets</span>


<span class="k">def</span> <span class="nf">_make_incised_rhythm_maker_music</span><span class="p">(</span>
    <span class="n">divisions</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">extra_counts</span><span class="p">,</span> <span class="n">incise</span><span class="p">,</span> <span class="n">spelling</span><span class="p">,</span> <span class="n">tag</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">]:</span>
    <span class="n">prepared</span> <span class="o">=</span> <span class="n">_prepare_incised_input</span><span class="p">(</span><span class="n">incise</span><span class="p">,</span> <span class="n">extra_counts</span><span class="p">)</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">SimpleNamespace</span><span class="p">(</span>
        <span class="n">prefix_talea</span><span class="o">=</span><span class="n">prepared</span><span class="o">.</span><span class="n">prefix_talea</span><span class="p">,</span>
        <span class="n">suffix_talea</span><span class="o">=</span><span class="n">prepared</span><span class="o">.</span><span class="n">suffix_talea</span><span class="p">,</span>
        <span class="n">extra_counts</span><span class="o">=</span><span class="n">prepared</span><span class="o">.</span><span class="n">extra_counts</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">talea_denominator</span> <span class="o">=</span> <span class="n">incise</span><span class="o">.</span><span class="n">talea_denominator</span>
    <span class="n">scaled</span> <span class="o">=</span> <span class="n">_scale_rhythm_maker_input</span><span class="p">(</span><span class="n">divisions</span><span class="p">,</span> <span class="n">talea_denominator</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">incise</span><span class="o">.</span><span class="n">outer_divisions_only</span><span class="p">:</span>
        <span class="n">numeric_map</span> <span class="o">=</span> <span class="n">_make_division_incised_numeric_map</span><span class="p">(</span>
            <span class="n">scaled</span><span class="o">.</span><span class="n">divisions</span><span class="p">,</span>
            <span class="n">scaled</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">prefix_talea</span><span class="p">,</span>
            <span class="n">prepared</span><span class="o">.</span><span class="n">prefix_counts</span><span class="p">,</span>
            <span class="n">scaled</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">suffix_talea</span><span class="p">,</span>
            <span class="n">prepared</span><span class="o">.</span><span class="n">suffix_counts</span><span class="p">,</span>
            <span class="n">scaled</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">extra_counts</span><span class="p">,</span>
            <span class="n">incise</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">incise</span><span class="o">.</span><span class="n">outer_divisions_only</span>
        <span class="n">numeric_map</span> <span class="o">=</span> <span class="n">_make_output_incised_numeric_map</span><span class="p">(</span>
            <span class="n">scaled</span><span class="o">.</span><span class="n">divisions</span><span class="p">,</span>
            <span class="n">scaled</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">prefix_talea</span><span class="p">,</span>
            <span class="n">prepared</span><span class="o">.</span><span class="n">prefix_counts</span><span class="p">,</span>
            <span class="n">scaled</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">suffix_talea</span><span class="p">,</span>
            <span class="n">prepared</span><span class="o">.</span><span class="n">suffix_counts</span><span class="p">,</span>
            <span class="n">scaled</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">extra_counts</span><span class="p">,</span>
            <span class="n">incise</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">selections</span> <span class="o">=</span> <span class="n">_incised_numeric_map_to_leaf_selections</span><span class="p">(</span>
        <span class="n">numeric_map</span><span class="p">,</span> <span class="n">scaled</span><span class="o">.</span><span class="n">lcd</span><span class="p">,</span> <span class="n">spelling</span><span class="o">=</span><span class="n">spelling</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span>
    <span class="p">)</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">_make_talea_rhythm_maker_tuplets</span><span class="p">(</span><span class="n">scaled</span><span class="o">.</span><span class="n">divisions</span><span class="p">,</span> <span class="n">selections</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tuplets</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tuplets</span>


<span class="k">def</span> <span class="nf">_make_leaves_from_talea</span><span class="p">(</span>
    <span class="n">talea</span><span class="p">,</span>
    <span class="n">talea_denominator</span><span class="p">,</span>
    <span class="n">increase_monotonic</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">forbidden_note_duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">forbidden_rest_duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">(),</span>
<span class="p">):</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">_</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">talea</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">talea</span><span class="p">)</span>
    <span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Leaf</span> <span class="o">|</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pitches</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">note_value</span> <span class="ow">in</span> <span class="n">talea</span><span class="p">:</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">note_value</span><span class="p">:</span>
            <span class="n">pitches</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pitches</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="n">division</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">note_value</span><span class="p">),</span> <span class="n">talea_denominator</span><span class="p">)</span>
        <span class="n">durations</span> <span class="o">=</span> <span class="p">[</span><span class="n">division</span><span class="p">]</span>
        <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">makers</span><span class="o">.</span><span class="n">make_leaves</span><span class="p">(</span>
            <span class="n">pitches</span><span class="p">,</span>
            <span class="n">durations</span><span class="p">,</span>
            <span class="n">increase_monotonic</span><span class="o">=</span><span class="n">increase_monotonic</span><span class="p">,</span>
            <span class="n">forbidden_note_duration</span><span class="o">=</span><span class="n">forbidden_note_duration</span><span class="p">,</span>
            <span class="n">forbidden_rest_duration</span><span class="o">=</span><span class="n">forbidden_rest_duration</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">leaves</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">logical_tie</span><span class="p">(</span><span class="n">leaves</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">is_trivial</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">leaves</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Rest</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">tie</span><span class="p">(</span><span class="n">leaves</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">leaves</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>


<span class="k">def</span> <span class="nf">_make_middle_of_numeric_map_part</span><span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="n">incise</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">incise</span><span class="p">,</span> <span class="n">Incise</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">incise</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">incise</span><span class="o">.</span><span class="n">fill_with_rests</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">incise</span><span class="o">.</span><span class="n">outer_divisions_only</span><span class="p">:</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">middle</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">incise</span><span class="o">.</span><span class="n">body_ratio</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">shards</span> <span class="o">=</span> <span class="n">middle</span> <span class="o">/</span> <span class="n">incise</span><span class="o">.</span><span class="n">body_ratio</span>
                    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">shards</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">(</span><span class="n">middle</span><span class="p">,)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">()</span>
        <span class="k">elif</span> <span class="n">incise</span><span class="o">.</span><span class="n">outer_divisions_only</span><span class="p">:</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">middle</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">middle</span><span class="p">,)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;must incise divisions or output.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">incise</span><span class="o">.</span><span class="n">outer_divisions_only</span><span class="p">:</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">middle</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">middle</span><span class="p">),)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">()</span>
        <span class="k">elif</span> <span class="n">incise</span><span class="o">.</span><span class="n">outer_divisions_only</span><span class="p">:</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">middle</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">middle</span><span class="p">),)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;must incise divisions or output.&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_make_note_rhythm_maker_music</span><span class="p">(</span>
    <span class="n">divisions</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">spelling</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Leaf</span> <span class="o">|</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">]]:</span>
    <span class="n">selections</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">divisions</span><span class="p">:</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">makers</span><span class="o">.</span><span class="n">make_leaves</span><span class="p">(</span>
            <span class="n">pitches</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">durations</span><span class="o">=</span><span class="p">[</span><span class="n">division</span><span class="p">],</span>
            <span class="n">increase_monotonic</span><span class="o">=</span><span class="n">spelling</span><span class="o">.</span><span class="n">increase_monotonic</span><span class="p">,</span>
            <span class="n">forbidden_note_duration</span><span class="o">=</span><span class="n">spelling</span><span class="o">.</span><span class="n">forbidden_note_duration</span><span class="p">,</span>
            <span class="n">forbidden_rest_duration</span><span class="o">=</span><span class="n">spelling</span><span class="o">.</span><span class="n">forbidden_rest_duration</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">selections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">selection</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">selections</span>


<span class="k">def</span> <span class="nf">_make_numeric_map</span><span class="p">(</span>
    <span class="n">divisions</span><span class="p">,</span> <span class="n">preamble</span><span class="p">,</span> <span class="n">talea</span><span class="p">,</span> <span class="n">extra_counts</span><span class="p">,</span> <span class="n">end_counts</span><span class="p">,</span> <span class="n">read_talea_once_only</span>
<span class="p">):</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">end_counts</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">end_counts</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">preamble</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">preamble</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">talea</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">count</span> <span class="ow">in</span> <span class="s2">&quot;+-&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">talea</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;+&quot;</span> <span class="ow">in</span> <span class="n">talea</span> <span class="ow">or</span> <span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">talea</span><span class="p">:</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">preamble</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">preamble</span><span class="p">)</span>
    <span class="n">prolated_divisions</span> <span class="o">=</span> <span class="n">_make_prolated_divisions</span><span class="p">(</span><span class="n">divisions</span><span class="p">,</span> <span class="n">extra_counts</span><span class="p">)</span>
    <span class="n">prolated_divisions</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">NonreducedFraction</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">prolated_divisions</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">preamble</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">talea</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">prolated_divisions</span><span class="p">,</span> <span class="kc">None</span>
    <span class="n">prolated_numerators</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="o">.</span><span class="n">numerator</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">prolated_divisions</span><span class="p">]</span>
    <span class="n">expanded_talea</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">talea</span> <span class="ow">or</span> <span class="s2">&quot;+&quot;</span> <span class="ow">in</span> <span class="n">talea</span><span class="p">:</span>
        <span class="n">total_weight</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prolated_numerators</span><span class="p">)</span>
        <span class="n">talea_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">talea</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">talea</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">talea_</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">talea_</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
        <span class="n">talea_</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">explicit_weight</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">talea_</span><span class="p">])</span>
        <span class="n">implicit_weight</span> <span class="o">=</span> <span class="n">total_weight</span> <span class="o">-</span> <span class="n">explicit_weight</span>
        <span class="k">if</span> <span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">talea</span><span class="p">:</span>
            <span class="n">implicit_weight</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">talea_</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">implicit_weight</span>
        <span class="n">expanded_talea</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">talea_</span><span class="p">)</span>
        <span class="n">talea</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">expanded_talea</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_split_talea_extended_to_weights</span><span class="p">(</span>
        <span class="n">preamble</span><span class="p">,</span> <span class="n">read_talea_once_only</span><span class="p">,</span> <span class="n">talea</span><span class="p">,</span> <span class="n">prolated_numerators</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">end_counts</span><span class="p">:</span>
        <span class="n">end_counts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">end_counts</span><span class="p">)</span>
        <span class="n">end_weight</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">end_counts</span><span class="p">)</span>
        <span class="n">division_weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="n">counts_weight</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">end_weight</span> <span class="o">&lt;=</span> <span class="n">counts_weight</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">end_counts</span><span class="p">)</span>
        <span class="n">left</span> <span class="o">=</span> <span class="n">counts_weight</span> <span class="o">-</span> <span class="n">end_weight</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">end_weight</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="p">[</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">])</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">end_counts</span>
        <span class="k">assert</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span> <span class="o">==</span> <span class="n">counts_weight</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">partition_by_weights</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">division_weights</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">expanded_talea</span>


<span class="k">def</span> <span class="nf">_make_numeric_map_part</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span><span class="p">,</span> <span class="n">incise</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">is_note_filled</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">prefix_weight</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
    <span class="n">suffix_weight</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span>
    <span class="n">middle</span> <span class="o">=</span> <span class="n">numerator</span> <span class="o">-</span> <span class="n">prefix_weight</span> <span class="o">-</span> <span class="n">suffix_weight</span>
    <span class="k">if</span> <span class="n">numerator</span> <span class="o">&lt;</span> <span class="n">prefix_weight</span><span class="p">:</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">numerator</span><span class="p">]</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">cyclic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">middle</span> <span class="o">=</span> <span class="n">_make_middle_of_numeric_map_part</span><span class="p">(</span><span class="n">middle</span><span class="p">,</span> <span class="n">incise</span><span class="p">)</span>
    <span class="n">suffix_space</span> <span class="o">=</span> <span class="n">numerator</span> <span class="o">-</span> <span class="n">prefix_weight</span>
    <span class="k">if</span> <span class="n">suffix_space</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="p">()</span>
    <span class="k">elif</span> <span class="n">suffix_space</span> <span class="o">&lt;</span> <span class="n">suffix_weight</span><span class="p">:</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">suffix_space</span><span class="p">]</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">suffix</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">cyclic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">numeric_map_part</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">middle</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">numeric_map_part</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_make_output_incised_numeric_map</span><span class="p">(</span>
    <span class="n">divisions</span><span class="p">,</span>
    <span class="n">prefix_talea</span><span class="p">,</span>
    <span class="n">prefix_counts</span><span class="p">,</span>
    <span class="n">suffix_talea</span><span class="p">,</span>
    <span class="n">suffix_counts</span><span class="p">,</span>
    <span class="n">extra_counts</span><span class="p">,</span>
    <span class="n">incise</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">numeric_map</span><span class="p">,</span> <span class="n">prefix_talea_index</span><span class="p">,</span> <span class="n">suffix_talea_index</span> <span class="o">=</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">prefix_length</span><span class="p">,</span> <span class="n">suffix_length</span> <span class="o">=</span> <span class="n">prefix_counts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">suffix_counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">prefix_talea_index</span>
    <span class="n">stop</span> <span class="o">=</span> <span class="n">prefix_talea_index</span> <span class="o">+</span> <span class="n">prefix_length</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix_talea</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">suffix_talea_index</span>
    <span class="n">stop</span> <span class="o">=</span> <span class="n">suffix_talea_index</span> <span class="o">+</span> <span class="n">suffix_length</span>
    <span class="n">suffix</span> <span class="o">=</span> <span class="n">suffix_talea</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">divisions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">prolation_addendum</span> <span class="o">=</span> <span class="n">extra_counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">divisions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">abjad</span><span class="o">.</span><span class="n">NonreducedFraction</span><span class="p">):</span>
            <span class="n">numerator</span> <span class="o">=</span> <span class="n">divisions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numerator</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">numerator</span> <span class="o">=</span> <span class="n">divisions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">numerator</span> <span class="o">+=</span> <span class="n">prolation_addendum</span> <span class="o">%</span> <span class="n">numerator</span>
        <span class="n">numeric_map_part</span> <span class="o">=</span> <span class="n">_make_numeric_map_part</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span><span class="p">,</span> <span class="n">incise</span><span class="p">)</span>
        <span class="n">numeric_map</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numeric_map_part</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">prolation_addendum</span> <span class="o">=</span> <span class="n">extra_counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">divisions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">numerator</span> <span class="o">=</span> <span class="n">divisions</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">numerator</span> <span class="o">=</span> <span class="n">divisions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numerator</span>
        <span class="n">numerator</span> <span class="o">+=</span> <span class="n">prolation_addendum</span> <span class="o">%</span> <span class="n">numerator</span>
        <span class="n">numeric_map_part</span> <span class="o">=</span> <span class="n">_make_numeric_map_part</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="p">(),</span> <span class="n">incise</span><span class="p">)</span>
        <span class="n">numeric_map</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numeric_map_part</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">division</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">divisions</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">prolation_addendum</span> <span class="o">=</span> <span class="n">extra_counts</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">division</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">numerator</span> <span class="o">=</span> <span class="n">division</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">numerator</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">numerator</span>
            <span class="n">numerator</span> <span class="o">+=</span> <span class="n">prolation_addendum</span> <span class="o">%</span> <span class="n">numerator</span>
            <span class="n">numeric_map_part</span> <span class="o">=</span> <span class="n">_make_numeric_map_part</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="p">(),</span> <span class="p">(),</span> <span class="n">incise</span><span class="p">)</span>
            <span class="n">numeric_map</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numeric_map_part</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span>
            <span class="n">prolation_addendum</span> <span class="o">=</span> <span class="n">extra_counts</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span>
            <span class="n">prolation_addendum</span> <span class="o">=</span> <span class="n">extra_counts</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">divisions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">numerator</span> <span class="o">=</span> <span class="n">divisions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">numerator</span> <span class="o">=</span> <span class="n">divisions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">numerator</span>
        <span class="n">numerator</span> <span class="o">+=</span> <span class="n">prolation_addendum</span> <span class="o">%</span> <span class="n">numerator</span>
        <span class="n">numeric_map_part</span> <span class="o">=</span> <span class="n">_make_numeric_map_part</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="p">(),</span> <span class="n">suffix</span><span class="p">,</span> <span class="n">incise</span><span class="p">)</span>
        <span class="n">numeric_map</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numeric_map_part</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">numeric_map</span>


<span class="k">def</span> <span class="nf">_make_prolated_divisions</span><span class="p">(</span><span class="n">divisions</span><span class="p">,</span> <span class="n">extra_counts</span><span class="p">):</span>
    <span class="n">prolated_divisions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">division</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">divisions</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">extra_counts</span><span class="p">:</span>
            <span class="n">prolated_divisions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">division</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">prolation_addendum</span> <span class="o">=</span> <span class="n">extra_counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">numerator</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">numerator</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">numerator</span> <span class="o">=</span> <span class="n">division</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">prolation_addendum</span><span class="p">:</span>
            <span class="n">prolation_addendum</span> <span class="o">%=</span> <span class="n">numerator</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># NOTE: do not remove the following (nonfunctional) if-else;</span>
            <span class="c1">#       preserved for backwards compatability.</span>
            <span class="n">use_old_extra_counts_logic</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">use_old_extra_counts_logic</span><span class="p">:</span>
                <span class="n">prolation_addendum</span> <span class="o">%=</span> <span class="n">numerator</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prolation_addendum</span> <span class="o">%=</span> <span class="o">-</span><span class="n">numerator</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">division</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">numerator</span><span class="p">,</span> <span class="n">denominator</span> <span class="o">=</span> <span class="n">division</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">numerator</span><span class="p">,</span> <span class="n">denominator</span> <span class="o">=</span> <span class="n">division</span><span class="o">.</span><span class="n">pair</span>
        <span class="n">prolated_division</span> <span class="o">=</span> <span class="p">(</span><span class="n">numerator</span> <span class="o">+</span> <span class="n">prolation_addendum</span><span class="p">,</span> <span class="n">denominator</span><span class="p">)</span>
        <span class="n">prolated_divisions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prolated_division</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">prolated_divisions</span>


<span class="k">def</span> <span class="nf">_make_state_dictionary</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">divisions_consumed</span><span class="p">,</span>
    <span class="n">logical_ties_produced</span><span class="p">,</span>
    <span class="n">previous_divisions_consumed</span><span class="p">,</span>
    <span class="n">previous_incomplete_last_note</span><span class="p">,</span>
    <span class="n">previous_logical_ties_produced</span><span class="p">,</span>
    <span class="n">state</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">divisions_consumed_</span> <span class="o">=</span> <span class="n">previous_divisions_consumed</span> <span class="o">+</span> <span class="n">divisions_consumed</span>
    <span class="n">state</span><span class="p">[</span><span class="s2">&quot;divisions_consumed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">divisions_consumed_</span>
    <span class="n">logical_ties_produced_</span> <span class="o">=</span> <span class="n">previous_logical_ties_produced</span> <span class="o">+</span> <span class="n">logical_ties_produced</span>
    <span class="k">if</span> <span class="n">previous_incomplete_last_note</span><span class="p">:</span>
        <span class="n">logical_ties_produced_</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="n">state</span><span class="p">[</span><span class="s2">&quot;logical_ties_produced&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">logical_ties_produced_</span>
    <span class="n">state</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">state</span>


<span class="k">def</span> <span class="nf">_make_talea_rhythm_make_leaf_lists</span><span class="p">(</span><span class="n">numeric_map</span><span class="p">,</span> <span class="n">talea_denominator</span><span class="p">,</span> <span class="n">spelling</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
    <span class="n">leaf_lists</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">map_division</span> <span class="ow">in</span> <span class="n">numeric_map</span><span class="p">:</span>
        <span class="n">leaf_list</span> <span class="o">=</span> <span class="n">_make_leaves_from_talea</span><span class="p">(</span>
            <span class="n">map_division</span><span class="p">,</span>
            <span class="n">talea_denominator</span><span class="p">,</span>
            <span class="n">increase_monotonic</span><span class="o">=</span><span class="n">spelling</span><span class="o">.</span><span class="n">increase_monotonic</span><span class="p">,</span>
            <span class="n">forbidden_note_duration</span><span class="o">=</span><span class="n">spelling</span><span class="o">.</span><span class="n">forbidden_note_duration</span><span class="p">,</span>
            <span class="n">forbidden_rest_duration</span><span class="o">=</span><span class="n">spelling</span><span class="o">.</span><span class="n">forbidden_rest_duration</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">leaf_lists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leaf_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">leaf_lists</span>


<span class="k">def</span> <span class="nf">_make_talea_rhythm_maker_music</span><span class="p">(</span>
    <span class="n">divisions</span><span class="p">,</span>
    <span class="n">self_extra_counts</span><span class="p">,</span>
    <span class="n">self_previous_state</span><span class="p">,</span>
    <span class="n">self_read_talea_once_only</span><span class="p">,</span>
    <span class="n">self_spelling</span><span class="p">,</span>
    <span class="n">self_state</span><span class="p">,</span>
    <span class="n">self_talea</span><span class="p">,</span>
    <span class="n">self_tag</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">prepared</span> <span class="o">=</span> <span class="n">_prepare_talea_rhythm_maker_input</span><span class="p">(</span>
        <span class="n">self_extra_counts</span><span class="p">,</span> <span class="n">self_previous_state</span><span class="p">,</span> <span class="n">self_talea</span>
    <span class="p">)</span>
    <span class="n">divisions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">divisions</span><span class="p">)</span>
    <span class="n">scaled</span> <span class="o">=</span> <span class="n">_scale_rhythm_maker_input</span><span class="p">(</span><span class="n">divisions</span><span class="p">,</span> <span class="n">self_talea</span><span class="o">.</span><span class="n">denominator</span><span class="p">,</span> <span class="n">prepared</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">scaled</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">talea</span>
    <span class="k">if</span> <span class="n">scaled</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">talea</span><span class="p">:</span>
        <span class="n">numeric_map</span><span class="p">,</span> <span class="n">expanded_talea</span> <span class="o">=</span> <span class="n">_make_numeric_map</span><span class="p">(</span>
            <span class="n">scaled</span><span class="o">.</span><span class="n">divisions</span><span class="p">,</span>
            <span class="n">scaled</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">preamble</span><span class="p">,</span>
            <span class="n">scaled</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">talea</span><span class="p">,</span>
            <span class="n">scaled</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">extra_counts</span><span class="p">,</span>
            <span class="n">scaled</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">end_counts</span><span class="p">,</span>
            <span class="n">self_read_talea_once_only</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">expanded_talea</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unscaled_talea</span> <span class="o">=</span> <span class="n">expanded_talea</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unscaled_talea</span> <span class="o">=</span> <span class="n">prepared</span><span class="o">.</span><span class="n">talea</span>
        <span class="n">talea_weight_consumed</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">numeric_map</span><span class="p">)</span>
        <span class="n">leaf_lists</span> <span class="o">=</span> <span class="n">_make_talea_rhythm_make_leaf_lists</span><span class="p">(</span>
            <span class="n">numeric_map</span><span class="p">,</span> <span class="n">scaled</span><span class="o">.</span><span class="n">lcd</span><span class="p">,</span> <span class="n">self_spelling</span><span class="p">,</span> <span class="n">self_tag</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">scaled</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">extra_counts</span><span class="p">:</span>
            <span class="n">tuplets</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">leaf_lists</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tuplets</span> <span class="o">=</span> <span class="n">_make_talea_rhythm_maker_tuplets</span><span class="p">(</span>
                <span class="n">scaled</span><span class="o">.</span><span class="n">divisions</span><span class="p">,</span> <span class="n">leaf_lists</span><span class="p">,</span> <span class="n">self_tag</span>
            <span class="p">)</span>
        <span class="n">_apply_ties_to_split_notes</span><span class="p">(</span>
            <span class="n">tuplets</span><span class="p">,</span>
            <span class="n">prepared</span><span class="o">.</span><span class="n">end_counts</span><span class="p">,</span>
            <span class="n">prepared</span><span class="o">.</span><span class="n">preamble</span><span class="p">,</span>
            <span class="n">unscaled_talea</span><span class="p">,</span>
            <span class="n">self_talea</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">iterate</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">tuplets</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">):</span>
        <span class="n">tuplet</span><span class="o">.</span><span class="n">normalize_multiplier</span><span class="p">()</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">self_state</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
    <span class="n">advanced_talea</span> <span class="o">=</span> <span class="n">Talea</span><span class="p">(</span>
        <span class="n">counts</span><span class="o">=</span><span class="n">prepared</span><span class="o">.</span><span class="n">talea</span><span class="p">,</span>
        <span class="n">denominator</span><span class="o">=</span><span class="n">self_talea</span><span class="o">.</span><span class="n">denominator</span><span class="p">,</span>
        <span class="n">end_counts</span><span class="o">=</span><span class="n">prepared</span><span class="o">.</span><span class="n">end_counts</span><span class="p">,</span>
        <span class="n">preamble</span><span class="o">=</span><span class="n">prepared</span><span class="o">.</span><span class="n">preamble</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;+&quot;</span> <span class="ow">in</span> <span class="n">prepared</span><span class="o">.</span><span class="n">talea</span> <span class="ow">or</span> <span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">prepared</span><span class="o">.</span><span class="n">talea</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">talea_weight_consumed</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">advanced_talea</span><span class="p">:</span>
        <span class="n">last_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">tuplets</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">):</span>
            <span class="n">self_state</span><span class="p">[</span><span class="s2">&quot;incomplete_last_note&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;talea_weight_consumed&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">self_previous_state</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
    <span class="n">self_state</span><span class="p">[</span><span class="n">string</span><span class="p">]</span> <span class="o">=</span> <span class="n">self_previous_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">self_state</span><span class="p">[</span><span class="n">string</span><span class="p">]</span> <span class="o">+=</span> <span class="n">talea_weight_consumed</span>
    <span class="k">return</span> <span class="n">tuplets</span>


<span class="k">def</span> <span class="nf">_make_talea_rhythm_maker_tuplets</span><span class="p">(</span><span class="n">divisions</span><span class="p">,</span> <span class="n">leaf_lists</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">divisions</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">leaf_lists</span><span class="p">)</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">division</span><span class="p">,</span> <span class="n">leaf_list</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">divisions</span><span class="p">,</span> <span class="n">leaf_lists</span><span class="p">):</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">division</span><span class="p">)</span>
        <span class="n">tuplet</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="o">.</span><span class="n">from_duration</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="n">leaf_list</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="n">tuplets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tuplets</span>


<span class="k">def</span> <span class="nf">_make_time_signature_staff</span><span class="p">(</span><span class="n">time_signatures</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">time_signatures</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">time_signatures</span><span class="p">)</span>
    <span class="n">staff</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Staff</span><span class="p">(</span><span class="n">simultaneous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">time_signature_voice</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;TimeSignatureVoice&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">time_signature</span> <span class="ow">in</span> <span class="n">time_signatures</span><span class="p">:</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">time_signature</span><span class="o">.</span><span class="n">pair</span>
        <span class="n">skip</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Skip</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">=</span><span class="n">duration</span><span class="p">)</span>
        <span class="n">time_signature_voice</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">skip</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">time_signature</span><span class="p">,</span> <span class="n">skip</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s2">&quot;Staff&quot;</span><span class="p">)</span>
    <span class="n">staff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time_signature_voice</span><span class="p">)</span>
    <span class="n">staff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;RhythmMaker.Music&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">staff</span>


<span class="k">def</span> <span class="nf">_make_tuplet_rhythm_maker_music</span><span class="p">(</span>
    <span class="n">divisions</span><span class="p">,</span>
    <span class="n">self_tuplet_ratios</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">self_tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tuplet_ratios</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">self_tuplet_ratios</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">division</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">divisions</span><span class="p">):</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="n">tuplet_ratios</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">tuplet</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">makers</span><span class="o">.</span><span class="n">tuplet_from_duration_and_ratio</span><span class="p">(</span>
            <span class="n">division</span><span class="p">,</span> <span class="n">ratio</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">self_tag</span>
        <span class="p">)</span>
        <span class="n">tuplets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tuplets</span>


<span class="k">def</span> <span class="nf">_prepare_incised_input</span><span class="p">(</span><span class="n">incise</span><span class="p">,</span> <span class="n">extra_counts</span><span class="p">):</span>
    <span class="n">cyclic_prefix_talea</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">incise</span><span class="o">.</span><span class="n">prefix_talea</span><span class="p">)</span>
    <span class="n">cyclic_prefix_counts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">incise</span><span class="o">.</span><span class="n">prefix_counts</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
    <span class="n">cyclic_suffix_talea</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">incise</span><span class="o">.</span><span class="n">suffix_talea</span><span class="p">)</span>
    <span class="n">cyclic_suffix_counts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">incise</span><span class="o">.</span><span class="n">suffix_counts</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
    <span class="n">cyclic_extra_counts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">extra_counts</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
    <span class="k">return</span> <span class="n">types</span><span class="o">.</span><span class="n">SimpleNamespace</span><span class="p">(</span>
        <span class="n">prefix_talea</span><span class="o">=</span><span class="n">cyclic_prefix_talea</span><span class="p">,</span>
        <span class="n">prefix_counts</span><span class="o">=</span><span class="n">cyclic_prefix_counts</span><span class="p">,</span>
        <span class="n">suffix_talea</span><span class="o">=</span><span class="n">cyclic_suffix_talea</span><span class="p">,</span>
        <span class="n">suffix_counts</span><span class="o">=</span><span class="n">cyclic_suffix_counts</span><span class="p">,</span>
        <span class="n">extra_counts</span><span class="o">=</span><span class="n">cyclic_extra_counts</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">_prepare_talea_rhythm_maker_input</span><span class="p">(</span>
    <span class="n">self_extra_counts</span><span class="p">,</span> <span class="n">self_previous_state</span><span class="p">,</span> <span class="n">self_talea</span>
<span class="p">):</span>
    <span class="n">talea_weight_consumed</span> <span class="o">=</span> <span class="n">self_previous_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;talea_weight_consumed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">talea</span> <span class="o">=</span> <span class="n">self_talea</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="n">talea_weight_consumed</span><span class="p">)</span>
    <span class="n">end_counts</span> <span class="o">=</span> <span class="n">talea</span><span class="o">.</span><span class="n">end_counts</span> <span class="ow">or</span> <span class="p">()</span>
    <span class="n">preamble</span> <span class="o">=</span> <span class="n">talea</span><span class="o">.</span><span class="n">preamble</span> <span class="ow">or</span> <span class="p">()</span>
    <span class="n">talea</span> <span class="o">=</span> <span class="n">talea</span><span class="o">.</span><span class="n">counts</span> <span class="ow">or</span> <span class="p">()</span>
    <span class="n">talea</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">talea</span><span class="p">)</span>
    <span class="n">extra_counts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">self_extra_counts</span> <span class="ow">or</span> <span class="p">[])</span>
    <span class="n">divisions_consumed</span> <span class="o">=</span> <span class="n">self_previous_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;divisions_consumed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">extra_counts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">extra_counts</span><span class="p">,</span> <span class="o">-</span><span class="n">divisions_consumed</span><span class="p">)</span>
    <span class="n">extra_counts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">extra_counts</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">types</span><span class="o">.</span><span class="n">SimpleNamespace</span><span class="p">(</span>
        <span class="n">end_counts</span><span class="o">=</span><span class="n">end_counts</span><span class="p">,</span>
        <span class="n">extra_counts</span><span class="o">=</span><span class="n">extra_counts</span><span class="p">,</span>
        <span class="n">preamble</span><span class="o">=</span><span class="n">preamble</span><span class="p">,</span>
        <span class="n">talea</span><span class="o">=</span><span class="n">talea</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">_round_durations</span><span class="p">(</span><span class="n">durations</span><span class="p">,</span> <span class="n">denominator</span><span class="p">):</span>
    <span class="n">durations_</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">duration</span> <span class="ow">in</span> <span class="n">durations</span><span class="p">:</span>
        <span class="n">numerator</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="n">denominator</span><span class="p">))</span>
        <span class="n">duration_</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="n">denominator</span><span class="p">)</span>
        <span class="n">durations_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">duration_</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">durations_</span>


<span class="k">def</span> <span class="nf">_scale_rhythm_maker_input</span><span class="p">(</span><span class="n">divisions</span><span class="p">,</span> <span class="n">talea_denominator</span><span class="p">,</span> <span class="n">counts</span><span class="p">):</span>
    <span class="n">talea_denominator</span> <span class="o">=</span> <span class="n">talea_denominator</span> <span class="ow">or</span> <span class="mi">1</span>
    <span class="n">scaled_divisions</span> <span class="o">=</span> <span class="n">divisions</span><span class="p">[:]</span>
    <span class="n">dummy_division</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">talea_denominator</span><span class="p">)</span>
    <span class="n">scaled_divisions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dummy_division</span><span class="p">)</span>
    <span class="n">scaled_divisions</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="o">.</span><span class="n">durations_to_nonreduced_fractions</span><span class="p">(</span>
        <span class="n">scaled_divisions</span>
    <span class="p">)</span>
    <span class="n">dummy_division</span> <span class="o">=</span> <span class="n">scaled_divisions</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="n">lcd</span> <span class="o">=</span> <span class="n">dummy_division</span><span class="o">.</span><span class="n">denominator</span>
    <span class="n">multiplier</span> <span class="o">=</span> <span class="n">lcd</span> <span class="o">/</span> <span class="n">talea_denominator</span>
    <span class="k">assert</span> <span class="n">abjad</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">is_integer_equivalent</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)</span>
    <span class="n">multiplier</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)</span>
    <span class="n">scaled_counts</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">SimpleNamespace</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">vector</span> <span class="ow">in</span> <span class="n">counts</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">vector</span> <span class="o">=</span> <span class="p">[</span><span class="n">multiplier</span> <span class="o">*</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">vector</span><span class="p">]</span>
        <span class="n">cyclic_vector</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">scaled_counts</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">cyclic_vector</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">scaled_divisions</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">divisions</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">scaled_counts</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">counts</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">types</span><span class="o">.</span><span class="n">SimpleNamespace</span><span class="p">(</span>
        <span class="n">divisions</span><span class="o">=</span><span class="n">scaled_divisions</span><span class="p">,</span> <span class="n">lcd</span><span class="o">=</span><span class="n">lcd</span><span class="p">,</span> <span class="n">counts</span><span class="o">=</span><span class="n">scaled_counts</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">_split_talea_extended_to_weights</span><span class="p">(</span><span class="n">preamble</span><span class="p">,</span> <span class="n">read_talea_once_only</span><span class="p">,</span> <span class="n">talea</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">abjad</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">all_are_positive_integers</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">preamble_weight</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">preamble</span><span class="p">)</span>
    <span class="n">talea_weight</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">talea</span><span class="p">)</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">read_talea_once_only</span> <span class="ow">and</span> <span class="n">preamble_weight</span> <span class="o">+</span> <span class="n">talea_weight</span> <span class="o">&lt;</span> <span class="n">weight</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">preamble</span><span class="si">!s}</span><span class="s2"> + </span><span class="si">{</span><span class="n">talea</span><span class="si">!s}</span><span class="s2"> is too short&quot;</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; to read </span><span class="si">{</span><span class="n">weights</span><span class="si">}</span><span class="s2"> once.&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">weight</span> <span class="o">&lt;=</span> <span class="n">preamble_weight</span><span class="p">:</span>
        <span class="n">talea</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">preamble</span><span class="p">)</span>
        <span class="n">talea</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="n">talea</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">weight</span> <span class="o">-=</span> <span class="n">preamble_weight</span>
        <span class="n">talea</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">repeat_to_weight</span><span class="p">(</span><span class="n">talea</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
        <span class="n">talea</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">preamble</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">talea</span><span class="p">)</span>
    <span class="n">talea</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">talea</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">cyclic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">talea</span>


<span class="k">def</span> <span class="nf">_validate_tuplets</span><span class="p">(</span><span class="n">selections</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">iterate</span><span class="o">.</span><span class="n">components</span><span class="p">(</span><span class="n">selections</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Multiplier</span><span class="p">(</span><span class="n">tuplet</span><span class="o">.</span><span class="n">multiplier</span><span class="p">)</span><span class="o">.</span><span class="n">normalized</span><span class="p">(),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tuplet</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>


<span class="c1"># CLASSES</span>


<div class="viewcode-block" id="Incise"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.Incise">[docs]</a><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unsafe_hash</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Incise</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    See ``rmakers.incised()`` for examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">body_ratio</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Ratio</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Ratio</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">fill_with_rests</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">outer_divisions_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">prefix_counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">prefix_talea</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">suffix_counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">suffix_talea</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">talea_denominator</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">__documentation_section__</span> <span class="o">=</span> <span class="s2">&quot;Specifiers&quot;</span>

<div class="viewcode-block" id="Incise.__post_init__"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.Incise.__post_init__">[docs]</a>    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix_talea</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix_talea</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_integer_tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix_talea</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix_counts</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix_counts</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_length_tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix_counts</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefix_talea</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefix_counts</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suffix_talea</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suffix_talea</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_integer_tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suffix_talea</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suffix_counts</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suffix_counts</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_length_tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suffix_counts</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">suffix_talea</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">suffix_counts</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">talea_denominator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">abjad</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">is_nonnegative_integer_power_of_two</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">talea_denominator</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefix_talea</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">suffix_talea</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">talea_denominator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body_ratio</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Ratio</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body_ratio</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_with_rests</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_with_rests</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_divisions_only</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outer_divisions_only</span>
        <span class="p">)</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_is_integer_tuple</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">argument</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_is_length_tuple</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">argument</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">abjad</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">all_are_nonnegative_integer_equivalent_numbers</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">tuple</span> <span class="o">|</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_reverse_tuple</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">argument</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">argument</span><span class="p">))</span></div>


<div class="viewcode-block" id="Interpolation"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.Interpolation">[docs]</a><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unsafe_hash</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Interpolation</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    See ``rmakers.accelerando()`` for examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">start_duration</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
    <span class="n">stop_duration</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="n">written_duration</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

    <span class="n">__documentation_section__</span> <span class="o">=</span> <span class="s2">&quot;Specifiers&quot;</span>

<div class="viewcode-block" id="Interpolation.__post_init__"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.Interpolation.__post_init__">[docs]</a>    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_duration</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_duration</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_duration</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_duration</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">written_duration</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">written_duration</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Interpolation.reverse"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.Interpolation.reverse">[docs]</a>    <span class="k">def</span> <span class="nf">reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Interpolation&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Swaps start duration and stop duration of interpolation specifier.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Changes accelerando specifier to ritardando specifier:</span>

<span class="sd">            &gt;&gt;&gt; specifier = rmakers.Interpolation(</span>
<span class="sd">            ...     start_duration=abjad.Duration(1, 4),</span>
<span class="sd">            ...     stop_duration=abjad.Duration(1, 16),</span>
<span class="sd">            ...     written_duration=abjad.Duration(1, 16),</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; specifier.reverse()</span>
<span class="sd">            Interpolation(start_duration=Duration(1, 16), stop_duration=Duration(1, 4), written_duration=Duration(1, 16))</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Changes ritardando specifier to accelerando specifier:</span>

<span class="sd">            &gt;&gt;&gt; specifier = rmakers.Interpolation(</span>
<span class="sd">            ...     start_duration=abjad.Duration(1, 16),</span>
<span class="sd">            ...     stop_duration=abjad.Duration(1, 4),</span>
<span class="sd">            ...     written_duration=abjad.Duration(1, 16),</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; specifier.reverse()</span>
<span class="sd">            Interpolation(start_duration=Duration(1, 4), stop_duration=Duration(1, 16), written_duration=Duration(1, 16))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span>
            <span class="n">start_duration</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_duration</span><span class="p">,</span>
            <span class="n">stop_duration</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">start_duration</span><span class="p">,</span>
            <span class="n">written_duration</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">written_duration</span><span class="p">,</span>
        <span class="p">)</span></div></div>


<div class="viewcode-block" id="Spelling"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.Spelling">[docs]</a><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unsafe_hash</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Spelling</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Duration spelling specifier.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Decreases monotically:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         [5],</span>
<span class="sd">        ...         16,</span>
<span class="sd">        ...         spelling=rmakers.Spelling(increase_monotonic=False),</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Increases monotically:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         [5],</span>
<span class="sd">        ...         16,</span>
<span class="sd">        ...         spelling=rmakers.Spelling(increase_monotonic=True),</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forbids note durations equal to ``1/4`` or greater:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         [1, 1, 1, 1, 4, -4],</span>
<span class="sd">        ...         16,</span>
<span class="sd">        ...         spelling=rmakers.Spelling(forbidden_note_duration=abjad.Duration(1, 4)),</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    r4</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    r4</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forbids rest durations equal to ``1/4`` or greater:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         [1, 1, 1, 1, 4, -4],</span>
<span class="sd">        ...         16,</span>
<span class="sd">        ...         spelling=rmakers.Spelling(forbidden_rest_duration=abjad.Duration(1, 4)),</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    r8</span>
<span class="sd">                    r8</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    r8</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">forbidden_note_duration</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">forbidden_rest_duration</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">increase_monotonic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">__documentation_section__</span> <span class="o">=</span> <span class="s2">&quot;Specifiers&quot;</span>

<div class="viewcode-block" id="Spelling.__post_init__"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.Spelling.__post_init__">[docs]</a>    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_note_duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forbidden_note_duration</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_note_duration</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_rest_duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forbidden_rest_duration</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_rest_duration</span>
            <span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">increase_monotonic</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">increase_monotonic</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Talea"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.Talea">[docs]</a><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unsafe_hash</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Talea</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Talea specifier.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; talea = rmakers.Talea(</span>
<span class="sd">        ...     [2, 1, 3, 2, 4, 1, 1],</span>
<span class="sd">        ...     16,</span>
<span class="sd">        ...     preamble=[1, 1, 1, 1],</span>
<span class="sd">        ... )</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Equal to weight of counts:</span>

<span class="sd">        &gt;&gt;&gt; rmakers.Talea([1, 2, 3, 4], 16).period</span>
<span class="sd">        10</span>

<span class="sd">        Rests make no difference:</span>

<span class="sd">        &gt;&gt;&gt; rmakers.Talea([1, 2, -3, 4], 16).period</span>
<span class="sd">        10</span>

<span class="sd">        Denominator makes no difference:</span>

<span class="sd">        &gt;&gt;&gt; rmakers.Talea([1, 2, -3, 4], 32).period</span>
<span class="sd">        10</span>

<span class="sd">        Preamble makes no difference:</span>

<span class="sd">        &gt;&gt;&gt; talea = rmakers.Talea(</span>
<span class="sd">        ...     [1, 2, -3, 4],</span>
<span class="sd">        ...     32,</span>
<span class="sd">        ...     preamble=[1, 1, 1],</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; talea.period</span>
<span class="sd">        10</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; talea = rmakers.Talea(</span>
<span class="sd">        ...     [2, 1, 3, 2, 4, 1, 1],</span>
<span class="sd">        ...     16,</span>
<span class="sd">        ...     preamble=[1, 1, 1, 1],</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; talea.preamble</span>
<span class="sd">        [1, 1, 1, 1]</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; talea = rmakers.Talea(</span>
<span class="sd">        ...     [16, -4, 16],</span>
<span class="sd">        ...     16,</span>
<span class="sd">        ...     preamble=[1],</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; for i, duration in enumerate(talea):</span>
<span class="sd">        ...     duration</span>
<span class="sd">        ...</span>
<span class="sd">        Duration(1, 16)</span>
<span class="sd">        Duration(1, 1)</span>
<span class="sd">        Duration(-1, 4)</span>
<span class="sd">        Duration(1, 1)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span>
    <span class="n">denominator</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">end_counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">preamble</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>

    <span class="n">__documentation_section__</span> <span class="o">=</span> <span class="s2">&quot;Specifiers&quot;</span>

<div class="viewcode-block" id="Talea.__post_init__"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.Talea.__post_init__">[docs]</a>    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">count</span> <span class="ow">in</span> <span class="s2">&quot;+-&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">abjad</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">is_nonnegative_integer_power_of_two</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_counts</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_counts</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_counts</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preamble</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preamble</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preamble</span><span class="p">)</span></div>

<div class="viewcode-block" id="Talea.__contains__"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.Talea.__contains__">[docs]</a>    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is true when talea contains ``argument``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            With preamble:</span>

<span class="sd">            &gt;&gt;&gt; talea = rmakers.Talea(</span>
<span class="sd">            ...     [10],</span>
<span class="sd">            ...     16,</span>
<span class="sd">            ...     preamble=[1, -1, 1],</span>
<span class="sd">            ...     )</span>

<span class="sd">            &gt;&gt;&gt; for i in range(1, 23 + 1):</span>
<span class="sd">            ...     i, i in talea</span>
<span class="sd">            ...</span>
<span class="sd">            (1, True)</span>
<span class="sd">            (2, True)</span>
<span class="sd">            (3, True)</span>
<span class="sd">            (4, False)</span>
<span class="sd">            (5, False)</span>
<span class="sd">            (6, False)</span>
<span class="sd">            (7, False)</span>
<span class="sd">            (8, False)</span>
<span class="sd">            (9, False)</span>
<span class="sd">            (10, False)</span>
<span class="sd">            (11, False)</span>
<span class="sd">            (12, False)</span>
<span class="sd">            (13, True)</span>
<span class="sd">            (14, False)</span>
<span class="sd">            (15, False)</span>
<span class="sd">            (16, False)</span>
<span class="sd">            (17, False)</span>
<span class="sd">            (18, False)</span>
<span class="sd">            (19, False)</span>
<span class="sd">            (20, False)</span>
<span class="sd">            (21, False)</span>
<span class="sd">            (22, False)</span>
<span class="sd">            (23, True)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">argument</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preamble</span><span class="p">:</span>
            <span class="n">preamble</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preamble</span><span class="p">]</span>
            <span class="n">cumulative</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">cumulative_sums</span><span class="p">(</span><span class="n">preamble</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">if</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">cumulative</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="n">preamble_weight</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">preamble</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">preamble_weight</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">counts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cumulative</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">cumulative_sums</span><span class="p">(</span><span class="n">counts</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">argument</span> <span class="o">-=</span> <span class="n">preamble_weight</span>
        <span class="n">argument</span> <span class="o">%=</span> <span class="bp">self</span><span class="o">.</span><span class="n">period</span>
        <span class="k">return</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">cumulative</span></div>

<div class="viewcode-block" id="Talea.__getitem__"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.Talea.__getitem__">[docs]</a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">argument</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">abjad</span><span class="o">.</span><span class="n">NonreducedFraction</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">NonreducedFraction</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets item or slice identified by ``argument``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets item at index:</span>

<span class="sd">            &gt;&gt;&gt; talea = rmakers.Talea(</span>
<span class="sd">            ...     [2, 1, 3, 2, 4, 1, 1],</span>
<span class="sd">            ...     16,</span>
<span class="sd">            ...     preamble=[1, 1, 1, 1],</span>
<span class="sd">            ... )</span>

<span class="sd">            &gt;&gt;&gt; talea[0]</span>
<span class="sd">            NonreducedFraction(1, 16)</span>

<span class="sd">            &gt;&gt;&gt; talea[1]</span>
<span class="sd">            NonreducedFraction(1, 16)</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Gets items in slice:</span>

<span class="sd">            &gt;&gt;&gt; for duration in talea[:6]:</span>
<span class="sd">            ...     duration</span>
<span class="sd">            ...</span>
<span class="sd">            NonreducedFraction(1, 16)</span>
<span class="sd">            NonreducedFraction(1, 16)</span>
<span class="sd">            NonreducedFraction(1, 16)</span>
<span class="sd">            NonreducedFraction(1, 16)</span>
<span class="sd">            NonreducedFraction(2, 16)</span>
<span class="sd">            NonreducedFraction(1, 16)</span>

<span class="sd">            &gt;&gt;&gt; for duration in talea[2:8]:</span>
<span class="sd">            ...     duration</span>
<span class="sd">            ...</span>
<span class="sd">            NonreducedFraction(1, 16)</span>
<span class="sd">            NonreducedFraction(1, 16)</span>
<span class="sd">            NonreducedFraction(2, 16)</span>
<span class="sd">            NonreducedFraction(1, 16)</span>
<span class="sd">            NonreducedFraction(3, 16)</span>
<span class="sd">            NonreducedFraction(2, 16)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">preamble</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preamble</span><span class="p">)</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">)</span>
        <span class="n">counts_</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">preamble</span> <span class="o">+</span> <span class="n">counts</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">counts_</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">abjad</span><span class="o">.</span><span class="n">NonreducedFraction</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">counts_</span> <span class="o">=</span> <span class="n">counts_</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">abjad</span><span class="o">.</span><span class="n">NonreducedFraction</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">)</span> <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">counts_</span>
            <span class="p">]</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span></div>

<div class="viewcode-block" id="Talea.__iter__"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.Talea.__iter__">[docs]</a>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterates talea.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; talea = rmakers.Talea(</span>
<span class="sd">            ...     [2, 1, 3, 2, 4, 1, 1],</span>
<span class="sd">            ...     16,</span>
<span class="sd">            ...     preamble=[1, 1, 1, 1],</span>
<span class="sd">            ... )</span>

<span class="sd">            &gt;&gt;&gt; for duration in talea:</span>
<span class="sd">            ...     duration</span>
<span class="sd">            ...</span>
<span class="sd">            Duration(1, 16)</span>
<span class="sd">            Duration(1, 16)</span>
<span class="sd">            Duration(1, 16)</span>
<span class="sd">            Duration(1, 16)</span>
<span class="sd">            Duration(1, 8)</span>
<span class="sd">            Duration(1, 16)</span>
<span class="sd">            Duration(3, 16)</span>
<span class="sd">            Duration(1, 8)</span>
<span class="sd">            Duration(1, 4)</span>
<span class="sd">            Duration(1, 16)</span>
<span class="sd">            Duration(1, 16)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preamble</span> <span class="ow">or</span> <span class="p">[]:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">duration</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="ow">or</span> <span class="p">[]:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">duration</span></div>

<div class="viewcode-block" id="Talea.__len__"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.Talea.__len__">[docs]</a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets length.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; len(rmakers.Talea([2, 1, 3, 2, 4, 1, 1], 16))</span>
<span class="sd">            7</span>

<span class="sd">        Defined equal to length of counts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="ow">or</span> <span class="p">[])</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">period</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets period of talea.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            Equal to weight of counts:</span>

<span class="sd">            &gt;&gt;&gt; rmakers.Talea([1, 2, 3, 4], 16).period</span>
<span class="sd">            10</span>

<span class="sd">            Rests make no difference:</span>

<span class="sd">            &gt;&gt;&gt; rmakers.Talea([1, 2, -3, 4], 16).period</span>
<span class="sd">            10</span>

<span class="sd">            Denominator makes no difference:</span>

<span class="sd">            &gt;&gt;&gt; rmakers.Talea([1, 2, -3, 4], 32).period</span>
<span class="sd">            10</span>

<span class="sd">            Preamble makes no difference:</span>

<span class="sd">            &gt;&gt;&gt; talea = rmakers.Talea(</span>
<span class="sd">            ...     [1, 2, -3, 4],</span>
<span class="sd">            ...     32,</span>
<span class="sd">            ...     preamble=[1, 1, 1],</span>
<span class="sd">            ... )</span>

<span class="sd">            &gt;&gt;&gt; talea.period</span>
<span class="sd">            10</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">)</span>

<div class="viewcode-block" id="Talea.advance"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.Talea.advance">[docs]</a>    <span class="k">def</span> <span class="nf">advance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weight</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Talea&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Advances talea by ``weight``.</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            &gt;&gt;&gt; talea = rmakers.Talea(</span>
<span class="sd">            ...     [2, 1, 3, 2, 4, 1, 1],</span>
<span class="sd">            ...     16,</span>
<span class="sd">            ...     preamble=[1, 1, 1, 1],</span>
<span class="sd">            ... )</span>

<span class="sd">            &gt;&gt;&gt; talea.advance(0)</span>
<span class="sd">            Talea(counts=[2, 1, 3, 2, 4, 1, 1], denominator=16, end_counts=(), preamble=[1, 1, 1, 1])</span>

<span class="sd">            &gt;&gt;&gt; talea.advance(1)</span>
<span class="sd">            Talea(counts=[2, 1, 3, 2, 4, 1, 1], denominator=16, end_counts=(), preamble=[1, 1, 1])</span>

<span class="sd">            &gt;&gt;&gt; talea.advance(2)</span>
<span class="sd">            Talea(counts=[2, 1, 3, 2, 4, 1, 1], denominator=16, end_counts=(), preamble=[1, 1])</span>

<span class="sd">            &gt;&gt;&gt; talea.advance(3)</span>
<span class="sd">            Talea(counts=[2, 1, 3, 2, 4, 1, 1], denominator=16, end_counts=(), preamble=[1])</span>

<span class="sd">            &gt;&gt;&gt; talea.advance(4)</span>
<span class="sd">            Talea(counts=[2, 1, 3, 2, 4, 1, 1], denominator=16, end_counts=(), preamble=())</span>

<span class="sd">            &gt;&gt;&gt; talea.advance(5)</span>
<span class="sd">            Talea(counts=[2, 1, 3, 2, 4, 1, 1], denominator=16, end_counts=(), preamble=[1, 1, 3, 2, 4, 1, 1])</span>

<span class="sd">            &gt;&gt;&gt; talea.advance(6)</span>
<span class="sd">            Talea(counts=[2, 1, 3, 2, 4, 1, 1], denominator=16, end_counts=(), preamble=[1, 3, 2, 4, 1, 1])</span>

<span class="sd">            &gt;&gt;&gt; talea.advance(7)</span>
<span class="sd">            Talea(counts=[2, 1, 3, 2, 4, 1, 1], denominator=16, end_counts=(), preamble=[3, 2, 4, 1, 1])</span>

<span class="sd">            &gt;&gt;&gt; talea.advance(8)</span>
<span class="sd">            Talea(counts=[2, 1, 3, 2, 4, 1, 1], denominator=16, end_counts=(), preamble=[2, 2, 4, 1, 1])</span>

<span class="sd">        ..  container:: example</span>

<span class="sd">            REGRESSION. Works when talea advances by period of talea:</span>

<span class="sd">            &gt;&gt;&gt; talea = rmakers.Talea([1, 2, 3, 4], 16)</span>
<span class="sd">            &gt;&gt;&gt; talea</span>
<span class="sd">            Talea(counts=[1, 2, 3, 4], denominator=16, end_counts=(), preamble=())</span>

<span class="sd">            &gt;&gt;&gt; talea.advance(10)</span>
<span class="sd">            Talea(counts=[1, 2, 3, 4], denominator=16, end_counts=(), preamble=())</span>

<span class="sd">            &gt;&gt;&gt; talea.advance(20)</span>
<span class="sd">            Talea(counts=[1, 2, 3, 4], denominator=16, end_counts=(), preamble=())</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">weight</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;weight </span><span class="si">{</span><span class="n">weight</span><span class="si">}</span><span class="s2"> must be nonnegative.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">weight</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">preamble</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preamble</span><span class="p">)</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">weight</span> <span class="o">&lt;</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">preamble</span><span class="p">):</span>
            <span class="n">consumed</span><span class="p">,</span> <span class="n">remaining</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
                <span class="n">preamble</span><span class="p">,</span> <span class="p">[</span><span class="n">weight</span><span class="p">],</span> <span class="n">overhang</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="n">preamble_</span> <span class="o">=</span> <span class="n">remaining</span>
        <span class="k">elif</span> <span class="n">weight</span> <span class="o">==</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">preamble</span><span class="p">):</span>
            <span class="n">preamble_</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">preamble</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">weight</span>
            <span class="n">weight</span> <span class="o">-=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">preamble</span><span class="p">)</span>
            <span class="n">preamble</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[:]</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">weight</span> <span class="o">&lt;=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">preamble</span><span class="p">):</span>
                    <span class="k">break</span>
                <span class="n">preamble</span> <span class="o">+=</span> <span class="n">counts</span>
            <span class="k">if</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">weight</span><span class="p">(</span><span class="n">preamble</span><span class="p">)</span> <span class="o">==</span> <span class="n">weight</span><span class="p">:</span>
                <span class="n">consumed</span><span class="p">,</span> <span class="n">remaining</span> <span class="o">=</span> <span class="n">preamble</span><span class="p">[:],</span> <span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">consumed</span><span class="p">,</span> <span class="n">remaining</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
                    <span class="n">preamble</span><span class="p">,</span> <span class="p">[</span><span class="n">weight</span><span class="p">],</span> <span class="n">overhang</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="n">preamble_</span> <span class="o">=</span> <span class="n">remaining</span>
        <span class="k">return</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">counts</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span>
            <span class="n">denominator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">,</span>
            <span class="n">preamble</span><span class="o">=</span><span class="n">preamble_</span><span class="p">,</span>
        <span class="p">)</span></div></div>


<span class="c1"># FUNCTIONS</span>


<div class="viewcode-block" id="accelerando"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.accelerando">[docs]</a><span class="k">def</span> <span class="nf">accelerando</span><span class="p">(</span>
    <span class="n">divisions</span><span class="p">,</span>
    <span class="o">*</span><span class="n">interpolations</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Duration</span><span class="p">],</span>
    <span class="n">previous_state</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">spelling</span><span class="p">:</span> <span class="n">Spelling</span> <span class="o">=</span> <span class="n">Spelling</span><span class="p">(),</span>
    <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">(),</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes accelerando figures in ``divisions``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes accelerandi:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.accelerando(</span>
<span class="sd">        ...         divisions, [(1, 8), (1, 20), (1, 16)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.feather_beam(container)</span>
<span class="sd">        ...     rmakers.duration_bracket(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes ritardandi:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.accelerando(</span>
<span class="sd">        ...         divisions, [(1, 20), (1, 8), (1, 16)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.feather_beam(container)</span>
<span class="sd">        ...     rmakers.duration_bracket(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #left</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 3/4</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 25/32</span>
<span class="sd">                        c&#39;16 * 7/8</span>
<span class="sd">                        c&#39;16 * 65/64</span>
<span class="sd">                        c&#39;16 * 79/64</span>
<span class="sd">                        c&#39;16 * 49/32</span>
<span class="sd">                        c&#39;16 * 29/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #left</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 5/8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 43/64</span>
<span class="sd">                        c&#39;16 * 51/64</span>
<span class="sd">                        c&#39;16 * 65/64</span>
<span class="sd">                        c&#39;16 * 85/64</span>
<span class="sd">                        c&#39;16 * 25/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #left</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 3/4</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 25/32</span>
<span class="sd">                        c&#39;16 * 7/8</span>
<span class="sd">                        c&#39;16 * 65/64</span>
<span class="sd">                        c&#39;16 * 79/64</span>
<span class="sd">                        c&#39;16 * 49/32</span>
<span class="sd">                        c&#39;16 * 29/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #left</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 5/8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 43/64</span>
<span class="sd">                        c&#39;16 * 51/64</span>
<span class="sd">                        c&#39;16 * 65/64</span>
<span class="sd">                        c&#39;16 * 85/64</span>
<span class="sd">                        c&#39;16 * 25/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Sets duration bracket with no beams:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.accelerando(</span>
<span class="sd">        ...         divisions, [(1, 8), (1, 20), (1, 16)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.duration_bracket(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>


<span class="sd">    ..  container:: example</span>

<span class="sd">        Beams tuplets together without feathering:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.accelerando(</span>
<span class="sd">        ...         divisions, [(1, 8), (1, 20), (1, 16)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.beam_groups(tuplets)</span>
<span class="sd">        ...     rmakers.duration_bracket(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \set stemLeftBeamCount = 0</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        [</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 1</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \set stemLeftBeamCount = 1</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 1</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \set stemLeftBeamCount = 1</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 1</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \set stemLeftBeamCount = 1</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 2</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        \set stemLeftBeamCount = 2</span>
<span class="sd">                        \set stemRightBeamCount = 0</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Leave feathering turned off here because LilyPond feathers conjoint beams poorly.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Ties across tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.accelerando(</span>
<span class="sd">        ...         divisions, [(1, 8), (1, 20), (1, 16)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.duration_bracket(container)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.feather_beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Ties across every other tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.accelerando(</span>
<span class="sd">        ...         divisions, [(1, 8), (1, 20), (1, 16)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.duration_bracket(container)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     tuplets = abjad.select.get(tuplets, [0], 2)</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.feather_beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forces rests at first and last leaves:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.accelerando(</span>
<span class="sd">        ...         divisions, [(1, 8), (1, 20), (1, 16)], [(1, 20), (1, 8), (1, 16)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     leaves = abjad.select.leaves(container)</span>
<span class="sd">        ...     leaves = abjad.select.get(leaves, [0, -1])</span>
<span class="sd">        ...     rmakers.force_rest(leaves)</span>
<span class="sd">        ...     rmakers.feather_beam(</span>
<span class="sd">        ...         container, beam_rests=True, stemlet_length=0.75</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     rmakers.duration_bracket(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \override Staff.Stem.stemlet-length = 0.75</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        r16 * 63/32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        \revert Staff.Stem.stemlet-length</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #left</span>
<span class="sd">                        \override Staff.Stem.stemlet-length = 0.75</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 5/8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 43/64</span>
<span class="sd">                        c&#39;16 * 51/64</span>
<span class="sd">                        c&#39;16 * 65/64</span>
<span class="sd">                        c&#39;16 * 85/64</span>
<span class="sd">                        \revert Staff.Stem.stemlet-length</span>
<span class="sd">                        c&#39;16 * 25/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \override Staff.Stem.stemlet-length = 0.75</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        \revert Staff.Stem.stemlet-length</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #left</span>
<span class="sd">                        \override Staff.Stem.stemlet-length = 0.75</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 5/8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 43/64</span>
<span class="sd">                        c&#39;16 * 51/64</span>
<span class="sd">                        c&#39;16 * 65/64</span>
<span class="sd">                        c&#39;16 * 85/64</span>
<span class="sd">                        \revert Staff.Stem.stemlet-length</span>
<span class="sd">                        r16 * 25/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forces rests in every other tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.accelerando(</span>
<span class="sd">        ...         divisions, [(1, 8), (1, 20), (1, 16)],</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     tuplets = abjad.select.get(tuplets, [1], 2)</span>
<span class="sd">        ...     rmakers.force_rest(tuplets)</span>
<span class="sd">        ...     rmakers.rewrite_rest_filled(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     rmakers.duration_bracket(container)</span>
<span class="sd">        ...     rmakers.feather_beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    r4.</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    r4.</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Alternates accelerandi and ritardandi:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.accelerando(</span>
<span class="sd">        ...         divisions, [(1, 8), (1, 20), (1, 16)], [(1, 20), (1, 8), (1, 16)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.duration_bracket(container)</span>
<span class="sd">        ...     rmakers.feather_beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #left</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 5/8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 43/64</span>
<span class="sd">                        c&#39;16 * 51/64</span>
<span class="sd">                        c&#39;16 * 65/64</span>
<span class="sd">                        c&#39;16 * 85/64</span>
<span class="sd">                        c&#39;16 * 25/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #left</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 5/8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 43/64</span>
<span class="sd">                        c&#39;16 * 51/64</span>
<span class="sd">                        c&#39;16 * 65/64</span>
<span class="sd">                        c&#39;16 * 85/64</span>
<span class="sd">                        c&#39;16 * 25/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes a single note in short division:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.accelerando(</span>
<span class="sd">        ...         divisions, [(1, 8), (1, 20), (1, 16)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.duration_bracket(container)</span>
<span class="sd">        ...     rmakers.feather_beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 8), (3, 8), (1, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                    ~</span>
<span class="sd">                                    c&#39;8</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 5/8</span>
<span class="sd">                        c&#39;16 * 61/32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        c&#39;16 * 49/32</span>
<span class="sd">                        c&#39;16 * 5/4</span>
<span class="sd">                        c&#39;16 * 33/32</span>
<span class="sd">                        c&#39;16 * 57/64</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        c&#39;16 * 25/32</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \time 1/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Consumes 3 divisions:</span>

<span class="sd">        &gt;&gt;&gt; def make_statal_accelerandi(divisions, previous_state=None):</span>
<span class="sd">        ...     if previous_state is None:</span>
<span class="sd">        ...         previous_state = {}</span>
<span class="sd">        ...     state = {}</span>
<span class="sd">        ...     nested_music = rmakers.accelerando(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         [(1, 8), (1, 20), (1, 16)], [(1, 20), (1, 8), (1, 16)],</span>
<span class="sd">        ...         previous_state=previous_state,</span>
<span class="sd">        ...         state=state,</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.duration_bracket(container)</span>
<span class="sd">        ...     rmakers.feather_beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music, state</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music, state = make_statal_accelerandi(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #left</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 3/4</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 25/32</span>
<span class="sd">                        c&#39;16 * 7/8</span>
<span class="sd">                        c&#39;16 * 65/64</span>
<span class="sd">                        c&#39;16 * 79/64</span>
<span class="sd">                        c&#39;16 * 49/32</span>
<span class="sd">                        c&#39;16 * 29/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; state</span>
<span class="sd">        {&#39;divisions_consumed&#39;: 3, &#39;logical_ties_produced&#39;: 17}</span>

<span class="sd">        Advances 3 divisions; then consumes another 3 divisions:</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music, state = make_statal_accelerandi(divisions, previous_state=state)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #left</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 3/4</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 25/32</span>
<span class="sd">                        c&#39;16 * 7/8</span>
<span class="sd">                        c&#39;16 * 65/64</span>
<span class="sd">                        c&#39;16 * 79/64</span>
<span class="sd">                        c&#39;16 * 49/32</span>
<span class="sd">                        c&#39;16 * 29/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #left</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 3/4</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 25/32</span>
<span class="sd">                        c&#39;16 * 7/8</span>
<span class="sd">                        c&#39;16 * 65/64</span>
<span class="sd">                        c&#39;16 * 79/64</span>
<span class="sd">                        c&#39;16 * 49/32</span>
<span class="sd">                        c&#39;16 * 29/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; state</span>
<span class="sd">        {&#39;divisions_consumed&#39;: 6, &#39;logical_ties_produced&#39;: 36}</span>

<span class="sd">        Advances 6 divisions; then consumes another 3 divisions:</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music, state = make_statal_accelerandi(divisions, previous_state=state)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #left</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16 * 3/4</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 25/32</span>
<span class="sd">                        c&#39;16 * 7/8</span>
<span class="sd">                        c&#39;16 * 65/64</span>
<span class="sd">                        c&#39;16 * 79/64</span>
<span class="sd">                        c&#39;16 * 49/32</span>
<span class="sd">                        c&#39;16 * 29/16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; state</span>
<span class="sd">        {&#39;divisions_consumed&#39;: 9, &#39;logical_ties_produced&#39;: 53}</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Tags LilyPond output:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     tag = abjad.Tag(&quot;ACCELERANDO_RHYTHM_MAKER&quot;)</span>
<span class="sd">        ...     nested_music = rmakers.accelerando(</span>
<span class="sd">        ...         divisions, [(1, 8), (1, 20), (1, 16)], tag=tag</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.feather_beam(container, tag=tag)</span>
<span class="sd">        ...     rmakers.duration_bracket(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score, tags=True)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        [</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        ]</span>
<span class="sd">                    %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        [</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        ]</span>
<span class="sd">                    %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;2</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 63/32</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        [</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 115/64</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 91/64</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 35/32</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 29/32</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        ]</span>
<span class="sd">                    %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                    \override TupletNumber.text = \markup \scale #&#39;(0.75 . 0.75) \score</span>
<span class="sd">                        {</span>
<span class="sd">                            \context Score = &quot;Score&quot;</span>
<span class="sd">                            \with</span>
<span class="sd">                            {</span>
<span class="sd">                                \override SpacingSpanner.spacing-increment = 0.5</span>
<span class="sd">                                proportionalNotationDuration = ##f</span>
<span class="sd">                            }</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context RhythmicStaff = &quot;Rhythmic_Staff&quot;</span>
<span class="sd">                                \with</span>
<span class="sd">                                {</span>
<span class="sd">                                    \remove Time_signature_engraver</span>
<span class="sd">                                    \remove Staff_symbol_engraver</span>
<span class="sd">                                    \override Stem.direction = #up</span>
<span class="sd">                                    \override Stem.length = 5</span>
<span class="sd">                                    \override TupletBracket.bracket-visibility = ##t</span>
<span class="sd">                                    \override TupletBracket.direction = #up</span>
<span class="sd">                                    \override TupletBracket.minimum-length = 4</span>
<span class="sd">                                    \override TupletBracket.padding = 1.25</span>
<span class="sd">                                    \override TupletBracket.shorten-pair = #&#39;(-1 . -1.5)</span>
<span class="sd">                                    \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="sd">                                    \override TupletNumber.font-size = 0</span>
<span class="sd">                                    \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="sd">                                    tupletFullLength = ##t</span>
<span class="sd">                                }</span>
<span class="sd">                                {</span>
<span class="sd">                                    c&#39;4.</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \layout</span>
<span class="sd">                            {</span>
<span class="sd">                                indent = 0</span>
<span class="sd">                                ragged-right = ##t</span>
<span class="sd">                            }</span>
<span class="sd">                        }</span>
<span class="sd">                    %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                    {</span>
<span class="sd">                        \once \override Beam.grow-direction = #right</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 117/64</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        [</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 99/64</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 69/64</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 13/16</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16 * 47/64</span>
<span class="sd">                        %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                        ]</span>
<span class="sd">                    %! ACCELERANDO_RHYTHM_MAKER</span>
<span class="sd">                    }</span>
<span class="sd">                    \revert TupletNumber.text</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    Set interpolations&#39; ``written_duration`` to ``1/16`` or less for multiple beams.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">interpolations_</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">interpolation</span> <span class="ow">in</span> <span class="n">interpolations</span><span class="p">:</span>
        <span class="n">interpolation_durations</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">interpolation</span><span class="p">]</span>
        <span class="n">interpolation_</span> <span class="o">=</span> <span class="n">Interpolation</span><span class="p">(</span><span class="o">*</span><span class="n">interpolation_durations</span><span class="p">)</span>
        <span class="n">interpolations_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">interpolation_</span><span class="p">)</span>
    <span class="n">previous_state</span> <span class="o">=</span> <span class="n">previous_state</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">_make_accelerando_rhythm_maker_music</span><span class="p">(</span>
        <span class="n">divisions</span><span class="p">,</span>
        <span class="o">*</span><span class="n">interpolations_</span><span class="p">,</span>
        <span class="n">self_previous_state</span><span class="o">=</span><span class="n">previous_state</span><span class="p">,</span>
        <span class="n">self_spelling</span><span class="o">=</span><span class="n">spelling</span><span class="p">,</span>
        <span class="n">self_tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">voice</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">(</span><span class="n">tuplets</span><span class="p">)</span>
    <span class="n">logical_ties_produced</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">logical_ties</span><span class="p">(</span><span class="n">voice</span><span class="p">))</span>
    <span class="n">new_state</span> <span class="o">=</span> <span class="n">_make_state_dictionary</span><span class="p">(</span>
        <span class="n">divisions_consumed</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">divisions</span><span class="p">),</span>
        <span class="n">logical_ties_produced</span><span class="o">=</span><span class="n">logical_ties_produced</span><span class="p">,</span>
        <span class="n">previous_divisions_consumed</span><span class="o">=</span><span class="n">previous_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;divisions_consumed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">previous_incomplete_last_note</span><span class="o">=</span><span class="n">previous_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;incomplete_last_note&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">previous_logical_ties_produced</span><span class="o">=</span><span class="n">previous_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;logical_ties_produced&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">eject_contents</span><span class="p">(</span><span class="n">voice</span><span class="p">)</span>
    <span class="n">state</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">state</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_state</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tuplets</span></div>


<div class="viewcode-block" id="after_grace_container"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.after_grace_container">[docs]</a><span class="k">def</span> <span class="nf">after_grace_container</span><span class="p">(</span>
    <span class="n">argument</span><span class="p">,</span>
    <span class="n">counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">beam_and_slash</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">talea</span><span class="p">:</span> <span class="n">Talea</span> <span class="o">=</span> <span class="n">Talea</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="mi">8</span><span class="p">),</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes after-grace containers.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Single after-graces with slurs applied manually:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [4], extra_counts=[2]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.note(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.after_grace_container(notes, [1])</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; staff = lilypond_file[&quot;Staff&quot;]</span>
<span class="sd">        &gt;&gt;&gt; containers = abjad.select.components(staff, abjad.AfterGraceContainer)</span>
<span class="sd">        &gt;&gt;&gt; groups = [abjad.select.with_next_leaf(_) for _ in containers]</span>
<span class="sd">        &gt;&gt;&gt; result = [abjad.slur(_) for _ in groups]</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            (</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        )</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        {</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            )</span>
<span class="sd">                            (</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Multiple after-graces with ``beam_and_slash=True`` and with slurs applied</span>
<span class="sd">        manually:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [4], extra_counts=[2]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.note(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.after_grace_container(</span>
<span class="sd">        ...         notes, [2, 4], beam_and_slash=True</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; staff = lilypond_file[&quot;Staff&quot;]</span>
<span class="sd">        &gt;&gt;&gt; containers = abjad.select.components(staff, abjad.AfterGraceContainer)</span>
<span class="sd">        &gt;&gt;&gt; groups = [abjad.select.with_next_leaf(_) for _ in containers]</span>
<span class="sd">        &gt;&gt;&gt; result = [abjad.slur(_) for _ in groups]</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        {</span>
<span class="sd">                            \slash</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            (</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        )</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \afterGrace</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        {</span>
<span class="sd">                            \slash</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            (</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            )</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_do_grace_container_command</span><span class="p">(</span>
        <span class="n">argument</span><span class="p">,</span>
        <span class="n">counts</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span>
        <span class="n">beam_and_slash</span><span class="o">=</span><span class="n">beam_and_slash</span><span class="p">,</span>
        <span class="n">class_</span><span class="o">=</span><span class="n">abjad</span><span class="o">.</span><span class="n">AfterGraceContainer</span><span class="p">,</span>
        <span class="n">talea</span><span class="o">=</span><span class="n">talea</span><span class="p">,</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="beam"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.beam">[docs]</a><span class="k">def</span> <span class="nf">beam</span><span class="p">(</span>
    <span class="n">argument</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">beam_lone_notes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">beam_rests</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">stemlet_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="s2">&quot;rmakers.beam()&quot;</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calls ``abjad.beam()`` on leaves in ``argument``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">selection</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">:</span>
        <span class="n">unbeam</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
        <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">beam</span><span class="p">(</span>
            <span class="n">leaves</span><span class="p">,</span>
            <span class="n">beam_lone_notes</span><span class="o">=</span><span class="n">beam_lone_notes</span><span class="p">,</span>
            <span class="n">beam_rests</span><span class="o">=</span><span class="n">beam_rests</span><span class="p">,</span>
            <span class="n">stemlet_length</span><span class="o">=</span><span class="n">stemlet_length</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="beam_groups"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.beam_groups">[docs]</a><span class="k">def</span> <span class="nf">beam_groups</span><span class="p">(</span>
    <span class="n">argument</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">beam_lone_notes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">beam_rests</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">stemlet_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="s2">&quot;rmakers.beam_groups()&quot;</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Beams ``argument`` groups.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">unbeam</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="n">durations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">components</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Component</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">selection</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">:</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
        <span class="n">durations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">selection</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">):</span>
            <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">components</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
    <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
    <span class="n">abjad</span><span class="o">.</span><span class="n">beam</span><span class="p">(</span>
        <span class="n">leaves</span><span class="p">,</span>
        <span class="n">beam_lone_notes</span><span class="o">=</span><span class="n">beam_lone_notes</span><span class="p">,</span>
        <span class="n">beam_rests</span><span class="o">=</span><span class="n">beam_rests</span><span class="p">,</span>
        <span class="n">durations</span><span class="o">=</span><span class="n">durations</span><span class="p">,</span>
        <span class="n">span_beam_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">stemlet_length</span><span class="o">=</span><span class="n">stemlet_length</span><span class="p">,</span>
        <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="before_grace_container"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.before_grace_container">[docs]</a><span class="k">def</span> <span class="nf">before_grace_container</span><span class="p">(</span>
    <span class="n">argument</span><span class="p">,</span>
    <span class="n">counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">beam_and_slash</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">talea</span><span class="p">:</span> <span class="n">Talea</span> <span class="o">=</span> <span class="n">Talea</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="mi">8</span><span class="p">),</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes before-grace containers.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [4], extra_counts=[2]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_) for _ in tuplets]</span>
<span class="sd">        ...     notes = [abjad.select.exclude(_, [0, -1]) for _ in notes]</span>
<span class="sd">        ...     rmakers.before_grace_container(notes, [2, 4])</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; staff = lilypond_file[&quot;Staff&quot;]</span>
<span class="sd">        &gt;&gt;&gt; containers = abjad.select.components(staff, abjad.BeforeGraceContainer)</span>
<span class="sd">        &gt;&gt;&gt; result = [abjad.beam(_) for _ in containers]</span>
<span class="sd">        &gt;&gt;&gt; groups = [abjad.select.with_next_leaf(_) for _ in containers]</span>
<span class="sd">        &gt;&gt;&gt; result = [abjad.slur(_) for _ in groups]</span>
<span class="sd">        &gt;&gt;&gt; slash = abjad.LilyPondLiteral(r&quot;\slash&quot;)</span>
<span class="sd">        &gt;&gt;&gt; result = [abjad.attach(slash, _[0]) for _ in containers]</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            \slash</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            (</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        )</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            \slash</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            (</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        )</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            \slash</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            (</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        )</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            \slash</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            (</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        )</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            \slash</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            (</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        )</span>
<span class="sd">                        \grace {</span>
<span class="sd">                            \slash</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            [</span>
<span class="sd">                            (</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            c&#39;8</span>
<span class="sd">                            ]</span>
<span class="sd">                        }</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        )</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_do_grace_container_command</span><span class="p">(</span>
        <span class="n">argument</span><span class="p">,</span>
        <span class="n">counts</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span>
        <span class="n">beam_and_slash</span><span class="o">=</span><span class="n">beam_and_slash</span><span class="p">,</span>
        <span class="n">class_</span><span class="o">=</span><span class="n">abjad</span><span class="o">.</span><span class="n">BeforeGraceContainer</span><span class="p">,</span>
        <span class="n">talea</span><span class="o">=</span><span class="n">talea</span><span class="p">,</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="denominator"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.denominator">[docs]</a><span class="k">def</span> <span class="nf">denominator</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">denominator</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Duration</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets denominator of every tuplet in ``argument`` to ``denominator``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Tuplet numerators and denominators are reduced to numbers that are relatively</span>
<span class="sd">        prime when ``denominator`` is set to none. This means that ratios like ``6:4``</span>
<span class="sd">        and ``10:8`` do not arise:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(divisions, [(1, 4)])</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(score).TupletBracket.staff_padding = 4.5</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/16</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 8/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        The preferred denominator of each tuplet is set in terms of a unit duration when</span>
<span class="sd">        ``denominator`` is set to a duration. The setting does not affect the first</span>
<span class="sd">        tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(divisions, [(1, 4)])</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     rmakers.denominator(container, (1, 16))</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(score).TupletBracket.staff_padding = 4.5</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/16</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 8/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Sets the preferred denominator of each tuplet in terms 32nd notes. The setting</span>
<span class="sd">        affects all tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(divisions, [(1, 4)])</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     rmakers.denominator(container, (1, 32))</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(score).TupletBracket.staff_padding = 4.5</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/16</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 12/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 16/20</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 8/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Sets the preferred denominator each tuplet in terms 64th notes. The setting</span>
<span class="sd">        affects all tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(divisions, [(1, 4)])</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     rmakers.denominator(container, (1, 64))</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(score).TupletBracket.staff_padding = 4.5</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 8/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/16</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 16/20</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 24/20</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 32/40</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 8/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        The preferred denominator of each tuplet is set directly when ``denominator`` is</span>
<span class="sd">        set to a positive integer. This example sets the preferred denominator of each</span>
<span class="sd">        tuplet to ``8``. Setting does not affect the third tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(divisions, [(1, 4)])</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     rmakers.denominator(container, 8)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(score).TupletBracket.staff_padding = 4.5</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 8/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/16</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 8/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Sets the preferred denominator of each tuplet to ``12``. Setting affects all</span>
<span class="sd">        tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(divisions, [(1, 4)])</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     rmakers.denominator(container, 12)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(score).TupletBracket.staff_padding = 4.5</span>
<span class="sd">        &gt;&gt;&gt; abjad.setting(score).proportionalNotationDuration = &quot;#(ly:make-moment 1 28)&quot;</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">                proportionalNotationDuration = #(ly:make-moment 1 28)</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 12/15</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/16</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 12/15</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 12/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 12/15</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 8/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Sets the preferred denominator of each tuplet to ``13``. Setting does not affect</span>
<span class="sd">        any tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(divisions, [(1, 4)])</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     rmakers.denominator(container, 13)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(score).TupletBracket.staff_padding = 4.5</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            \with</span>
<span class="sd">            {</span>
<span class="sd">                \override TupletBracket.staff-padding = 4.5</span>
<span class="sd">            }</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/16</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 8/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">denominator</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">denominator</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">denominator</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">denominator</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">):</span>
            <span class="n">unit_duration</span> <span class="o">=</span> <span class="n">denominator</span>
            <span class="k">assert</span> <span class="n">unit_duration</span><span class="o">.</span><span class="n">numerator</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
            <span class="n">denominator_</span> <span class="o">=</span> <span class="n">unit_duration</span><span class="o">.</span><span class="n">denominator</span>
            <span class="n">nonreduced_fraction</span> <span class="o">=</span> <span class="n">duration</span><span class="o">.</span><span class="n">with_denominator</span><span class="p">(</span><span class="n">denominator_</span><span class="p">)</span>
            <span class="n">tuplet</span><span class="o">.</span><span class="n">denominator</span> <span class="o">=</span> <span class="n">nonreduced_fraction</span><span class="o">.</span><span class="n">numerator</span>
        <span class="k">elif</span> <span class="n">abjad</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">is_positive_integer</span><span class="p">(</span><span class="n">denominator</span><span class="p">):</span>
            <span class="n">tuplet</span><span class="o">.</span><span class="n">denominator</span> <span class="o">=</span> <span class="n">denominator</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;invalid preferred denominator: </span><span class="si">{</span><span class="n">denominator</span><span class="si">!r}</span><span class="s2">.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="duration_bracket"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.duration_bracket">[docs]</a><span class="k">def</span> <span class="nf">duration_bracket</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies durtaion bracket to tuplets in ``argument``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">duration_</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
        <span class="n">notes</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">makers</span><span class="o">.</span><span class="n">make_leaves</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">duration_</span><span class="p">])</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">illustrators</span><span class="o">.</span><span class="n">selection_to_score_markup_string</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;\markup \scale #&#39;(0.75 . 0.75) </span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">override</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span><span class="o">.</span><span class="n">TupletNumber</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">string</span></div>


<div class="viewcode-block" id="even_division"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.even_division">[docs]</a><span class="k">def</span> <span class="nf">even_division</span><span class="p">(</span>
    <span class="n">divisions</span><span class="p">,</span>
    <span class="n">denominators</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">denominator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="s2">&quot;from_counts&quot;</span><span class="p">,</span>
    <span class="n">extra_counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span>
    <span class="n">previous_state</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">spelling</span><span class="p">:</span> <span class="n">Spelling</span> <span class="o">=</span> <span class="n">Spelling</span><span class="p">(),</span>
    <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">(),</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes even-division tuplets in ``divisions``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forces tuplet diminution:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8], extra_counts=[0, 0, 1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.force_diminution(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 16), (6, 16), (6, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 5/8</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 6/16</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Forces tuplet augmentation:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8], extra_counts=[0, 0, 1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.force_augmentation(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 16), (6, 16), (6, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 5/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 6/16</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/2</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>


<span class="sd">    ..  container:: example</span>

<span class="sd">        Ties nonlast tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        (Equivalent to earlier tie-across-divisions pattern.)</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forces rest at every third logical tie:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(divisions, [8])</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)</span>
<span class="sd">        ...     logical_ties = abjad.select.get(logical_ties, [0], 3)</span>
<span class="sd">        ...     rmakers.force_rest(logical_ties)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        r8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        r8</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        r8</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        r8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        r8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Forces rest at every fourth logical tie:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(divisions, [8])</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)</span>
<span class="sd">        ...     logical_ties = abjad.select.get(logical_ties, [3], 4)</span>
<span class="sd">        ...     rmakers.force_rest(logical_ties)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        r8</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        r8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        r8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        (Forcing rests at the fourth logical tie produces two rests. Forcing rests at the</span>
<span class="sd">        eighth logical tie produces only one rest.)</span>

<span class="sd">        Forces rest at leaf 0 of every tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(divisions, [8])</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, 0) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.force_rest(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        r8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        r8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        r8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        r8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forces rest and rewrites every other tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8], extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     tuplets = abjad.select.get(tuplets, [0], 2)</span>
<span class="sd">        ...     rmakers.force_rest(tuplets)</span>
<span class="sd">        ...     rmakers.rewrite_rest_filled(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r2</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r2</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        (Equivalent to ealier silence pattern.)</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Ties and rewrites every other tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8], extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     tuplets = abjad.select.get(tuplets, [0], 2)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_)[:-1] for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.rewrite_sustained(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        (Equivalent to earlier sustain pattern.)</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        No preferred denominator:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [16], extra_counts=[4], denominator=None</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Expresses tuplet ratios in the usual way with numerator and denominator</span>
<span class="sd">        relatively prime.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Preferred denominator equal to 4:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [16], extra_counts=[4], denominator=4</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/6</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/6</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Preferred denominator equal to 8:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [16], extra_counts=[4], denominator=8</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 8/12</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/12</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Preferred denominator equal to 16:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [16], extra_counts=[4], denominator=16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 16/24</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 16/24</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Preferred denominator taken from count of elements in tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [16], extra_counts=[4], denominator=&quot;from_counts&quot;</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 8/12</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/12</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Fills tuplets with 16th notes and 8th notes, alternately:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [16, 8]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 16), (3, 8), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Fills tuplets with 8th notes:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 16), (3, 8), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/16</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        (Fills tuplets less than twice the duration of an eighth note with a single</span>
<span class="sd">        attack.)</span>

<span class="sd">        Fills tuplets with quarter notes:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [4]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 16), (3, 8), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/16</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        (Fills tuplets less than twice the duration of a quarter note with a single</span>
<span class="sd">        attack.)</span>

<span class="sd">        Fills tuplets with half notes:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [2]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 16), (3, 8), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/16</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;2.</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        (Fills tuplets less than twice the duration of a half note with a single</span>
<span class="sd">        attack.)</span>


<span class="sd">    ..  container:: example</span>

<span class="sd">        Adds extra counts to tuplets according to a pattern of three elements:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [16], extra_counts=[0, 1, 2]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (3, 8), (3, 8), (3, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/8</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        **Modular handling of positive values.** Denote by ``unprolated_note_count``</span>
<span class="sd">        the number counts included in a tuplet when ``extra_counts`` is set to zero.</span>
<span class="sd">        Then extra counts equals ``extra_counts % unprolated_note_count`` when</span>
<span class="sd">        ``extra_counts`` is positive.</span>

<span class="sd">        This is likely to be intuitive; compare with the handling of negative values,</span>
<span class="sd">        below.</span>

<span class="sd">        For positive extra counts, the modulus of transformation of a tuplet with six</span>
<span class="sd">        notes is six:</span>

<span class="sd">        &gt;&gt;&gt; import math</span>
<span class="sd">        &gt;&gt;&gt; unprolated_note_count = 6</span>
<span class="sd">        &gt;&gt;&gt; modulus = unprolated_note_count</span>
<span class="sd">        &gt;&gt;&gt; extra_counts = list(range(12))</span>
<span class="sd">        &gt;&gt;&gt; labels = []</span>
<span class="sd">        &gt;&gt;&gt; for count in extra_counts:</span>
<span class="sd">        ...     modular_count = count % modulus</span>
<span class="sd">        ...     label = rf&quot;\markup {{ {count:3} becomes {modular_count:2} }}&quot;</span>
<span class="sd">        ...     labels.append(label)</span>

<span class="sd">        Which produces the following pattern of changes:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions, extra_counts):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [16], extra_counts=extra_counts</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = 12 * [(6, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions, extra_counts)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; staff = lilypond_file[&quot;Staff&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(staff).TextScript.staff_padding = 7</span>
<span class="sd">        &gt;&gt;&gt; leaves = abjad.select.leaves(staff)</span>
<span class="sd">        &gt;&gt;&gt; groups = abjad.select.group_by_measure(leaves)</span>
<span class="sd">        &gt;&gt;&gt; for group, label in zip(groups, labels):</span>
<span class="sd">        ...     markup = abjad.Markup(label)</span>
<span class="sd">        ...     abjad.attach(markup, group[0], direction=abjad.UP)</span>
<span class="sd">        ...</span>

<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                    \override TextScript.staff-padding = 7</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 6/16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ^ \markup {   0 becomes  0 }</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ^ \markup {   1 becomes  1 }</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/8</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ^ \markup {   2 becomes  2 }</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 6/9</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ^ \markup {   3 becomes  3 }</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ^ \markup {   4 becomes  4 }</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/11</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ^ \markup {   5 becomes  5 }</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 6/16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ^ \markup {   6 becomes  0 }</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ^ \markup {   7 becomes  1 }</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/8</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ^ \markup {   8 becomes  2 }</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 6/9</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ^ \markup {   9 becomes  3 }</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ^ \markup {  10 becomes  4 }</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/11</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ^ \markup {  11 becomes  5 }</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        This modular formula ensures that rhythm-maker ``denominators`` are always</span>
<span class="sd">        respected: a very large number of extra counts never causes a</span>
<span class="sd">        ``16``-denominated tuplet to result in 32nd- or 64th-note rhythms.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        **Modular handling of negative values.** Denote by ``unprolated_note_count``</span>
<span class="sd">        the number of counts included in a tuplet when ``extra_counts`` is set to</span>
<span class="sd">        zero. Further, let ``modulus = ceiling(unprolated_note_count / 2)``. Then</span>
<span class="sd">        extra counts equals ``-(abs(extra_counts) % modulus)`` when ``extra_counts``</span>
<span class="sd">        is negative.</span>

<span class="sd">        For negative extra counts, the modulus of transformation of a tuplet with six</span>
<span class="sd">        notes is three:</span>

<span class="sd">        &gt;&gt;&gt; import math</span>
<span class="sd">        &gt;&gt;&gt; unprolated_note_count = 6</span>
<span class="sd">        &gt;&gt;&gt; modulus = math.ceil(unprolated_note_count / 2)</span>
<span class="sd">        &gt;&gt;&gt; extra_counts = [0, -1, -2, -3, -4, -5, -6, -7, -8]</span>
<span class="sd">        &gt;&gt;&gt; labels = []</span>
<span class="sd">        &gt;&gt;&gt; for count in extra_counts:</span>
<span class="sd">        ...     modular_count = -(abs(count) % modulus)</span>
<span class="sd">        ...     label = rf&quot;\markup {{ {count:3} becomes {modular_count:2} }}&quot;</span>
<span class="sd">        ...     labels.append(label)</span>

<span class="sd">        Which produces the following pattern of changes:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions, extra_counts):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [16], extra_counts=extra_counts</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = 9 * [(6, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions, extra_counts)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; staff = lilypond_file[&quot;Staff&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(staff).TextScript.staff_padding = 8</span>
<span class="sd">        &gt;&gt;&gt; leaves = abjad.select.leaves(staff)</span>
<span class="sd">        &gt;&gt;&gt; groups = abjad.select.group_by_measure(leaves)</span>
<span class="sd">        &gt;&gt;&gt; for group, label in zip(groups, labels):</span>
<span class="sd">        ...     markup = abjad.Markup(label)</span>
<span class="sd">        ...     abjad.attach(markup, group[0], direction=abjad.UP)</span>
<span class="sd">        ...</span>

<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                    \override TextScript.staff-padding = 8</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 6/16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ^ \markup {   0 becomes  0 }</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ^ \markup {  -1 becomes -1 }</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ^ \markup {  -2 becomes -2 }</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 6/16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ^ \markup {  -3 becomes  0 }</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ^ \markup {  -4 becomes -1 }</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ^ \markup {  -5 becomes -2 }</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 6/16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ^ \markup {  -6 becomes  0 }</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ^ \markup {  -7 becomes -1 }</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ^ \markup {  -8 becomes -2 }</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        This modular formula ensures that rhythm-maker ``denominators`` are always</span>
<span class="sd">        respected: a very small number of extra counts never causes a ``16``-denominated</span>
<span class="sd">        tuplet to result in 8th- or quarter-note rhythms.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Fills divisions with 16th, 8th, quarter notes. Consumes 5:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions, *, previous_state=None):</span>
<span class="sd">        ...     state = {}</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [16, 8, 4], extra_counts=[0, 1],</span>
<span class="sd">        ...         previous_state=previous_state, state=state</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music, state</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music, state = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; state</span>
<span class="sd">        {&#39;divisions_consumed&#39;: 5, &#39;logical_ties_produced&#39;: 15}</span>

<span class="sd">        Advances 5 divisions; then consumes another 5 divisions:</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music, state = make_rhythm(divisions, previous_state=state)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; state</span>
<span class="sd">        {&#39;divisions_consumed&#39;: 10, &#39;logical_ties_produced&#39;: 29}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">previous_state</span> <span class="o">=</span> <span class="n">previous_state</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">_make_even_division_rhythm_maker_music</span><span class="p">(</span>
        <span class="n">divisions</span><span class="p">,</span>
        <span class="n">denominators</span><span class="p">,</span>
        <span class="n">self_denominator</span><span class="o">=</span><span class="n">denominator</span><span class="p">,</span>
        <span class="n">self_extra_counts</span><span class="o">=</span><span class="n">extra_counts</span><span class="p">,</span>
        <span class="n">self_previous_state</span><span class="o">=</span><span class="n">previous_state</span><span class="p">,</span>
        <span class="n">self_spelling</span><span class="o">=</span><span class="n">spelling</span><span class="p">,</span>
        <span class="n">self_tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">voice</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">(</span><span class="n">tuplets</span><span class="p">)</span>
    <span class="n">logical_ties_produced</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">logical_ties</span><span class="p">(</span><span class="n">voice</span><span class="p">))</span>
    <span class="n">new_state</span> <span class="o">=</span> <span class="n">_make_state_dictionary</span><span class="p">(</span>
        <span class="n">divisions_consumed</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">divisions</span><span class="p">),</span>
        <span class="n">logical_ties_produced</span><span class="o">=</span><span class="n">logical_ties_produced</span><span class="p">,</span>
        <span class="n">previous_divisions_consumed</span><span class="o">=</span><span class="n">previous_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;divisions_consumed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">previous_incomplete_last_note</span><span class="o">=</span><span class="n">previous_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;incomplete_last_note&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">previous_logical_ties_produced</span><span class="o">=</span><span class="n">previous_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;logical_ties_produced&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">eject_contents</span><span class="p">(</span><span class="n">voice</span><span class="p">)</span>
    <span class="n">state</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">state</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_state</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tuplets</span></div>


<div class="viewcode-block" id="example"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.example">[docs]</a><span class="k">def</span> <span class="nf">example</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">time_signatures</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">includes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes example LilyPond file for documentation examples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lilypond_file</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">illustrators</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span>
        <span class="n">selection</span><span class="p">,</span>
        <span class="n">time_signatures</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">includes</span> <span class="o">=</span> <span class="p">[</span><span class="sa">rf</span><span class="s1">&#39;\include &quot;</span><span class="si">{</span><span class="n">_</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">includes</span> <span class="ow">or</span> <span class="p">[]]</span>
    <span class="n">lilypond_file</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">includes</span>
    <span class="n">staff</span> <span class="o">=</span> <span class="n">lilypond_file</span><span class="p">[</span><span class="s2">&quot;Staff&quot;</span><span class="p">]</span>
    <span class="n">staff</span><span class="o">.</span><span class="n">lilypond_type</span> <span class="o">=</span> <span class="s2">&quot;RhythmicStaff&quot;</span>
    <span class="n">abjad</span><span class="o">.</span><span class="n">override</span><span class="p">(</span><span class="n">staff</span><span class="p">)</span><span class="o">.</span><span class="n">Clef</span><span class="o">.</span><span class="n">stencil</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">lilypond_file</span></div>


<div class="viewcode-block" id="extract_trivial"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.extract_trivial">[docs]</a><span class="k">def</span> <span class="nf">extract_trivial</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts trivial tuplets from ``argument``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        With selector:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(divisions, [8])</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[-2:]</span>
<span class="sd">        ...     rmakers.extract_trivial(tuplets)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (3, 8), (3, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">tuplets</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tuplet</span><span class="o">.</span><span class="n">trivial</span><span class="p">():</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span></div>


<div class="viewcode-block" id="feather_beam"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.feather_beam">[docs]</a><span class="k">def</span> <span class="nf">feather_beam</span><span class="p">(</span>
    <span class="n">argument</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">beam_rests</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">stemlet_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Feather-beams leaves in ``argument``.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">selection</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">:</span>
        <span class="n">unbeam</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
        <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">beam</span><span class="p">(</span>
            <span class="n">leaves</span><span class="p">,</span>
            <span class="n">beam_rests</span><span class="o">=</span><span class="n">beam_rests</span><span class="p">,</span>
            <span class="n">stemlet_length</span><span class="o">=</span><span class="n">stemlet_length</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">selection</span> <span class="ow">in</span> <span class="n">argument</span><span class="p">:</span>
        <span class="n">first_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_is_accelerando</span><span class="p">(</span><span class="n">selection</span><span class="p">):</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">override</span><span class="p">(</span><span class="n">first_leaf</span><span class="p">)</span><span class="o">.</span><span class="n">Beam</span><span class="o">.</span><span class="n">grow_direction</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">RIGHT</span>
        <span class="k">elif</span> <span class="n">_is_ritardando</span><span class="p">(</span><span class="n">selection</span><span class="p">):</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">override</span><span class="p">(</span><span class="n">first_leaf</span><span class="p">)</span><span class="o">.</span><span class="n">Beam</span><span class="o">.</span><span class="n">grow_direction</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">LEFT</span></div>


<div class="viewcode-block" id="force_augmentation"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.force_augmentation">[docs]</a><span class="k">def</span> <span class="nf">force_augmentation</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Forces each tuplet in ``argument`` to notate as an augmentation.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Without forced augmentation:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8], extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.force_fraction(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        With forced augmentation:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8], extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.force_augmentation(container)</span>
<span class="sd">        ...     rmakers.force_fraction(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tuplet</span><span class="o">.</span><span class="n">augmentation</span><span class="p">():</span>
            <span class="n">tuplet</span><span class="o">.</span><span class="n">toggle_prolation</span><span class="p">()</span></div>


<div class="viewcode-block" id="force_diminution"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.force_diminution">[docs]</a><span class="k">def</span> <span class="nf">force_diminution</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Forces each tuplet in ``argument`` to notate as a diminution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tuplet</span><span class="o">.</span><span class="n">diminution</span><span class="p">():</span>
            <span class="n">tuplet</span><span class="o">.</span><span class="n">toggle_prolation</span><span class="p">()</span></div>


<div class="viewcode-block" id="force_fraction"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.force_fraction">[docs]</a><span class="k">def</span> <span class="nf">force_fraction</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets ``force_fraction=True`` on all tuplets in ``argument``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">tuplet</span><span class="o">.</span><span class="n">force_fraction</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="force_note"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.force_note">[docs]</a><span class="k">def</span> <span class="nf">force_note</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces leaves in ``argument`` with notes.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Changes logical ties 1 and 2 to notes:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     leaves = abjad.select.leaves(container)</span>
<span class="sd">        ...     rmakers.force_rest(leaves)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)[1:3]</span>
<span class="sd">        ...     rmakers.force_note(logical_ties)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(7, 16), (3, 8), (7, 16), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 7/16</span>
<span class="sd">                    r4..</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    \time 7/16</span>
<span class="sd">                    c&#39;4..</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    r4.</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Changes patterned selection of leaves to notes. Works inverted composite pattern:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     leaves = abjad.select.leaves(container)</span>
<span class="sd">        ...     rmakers.force_rest(leaves)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)</span>
<span class="sd">        ...     leaves = abjad.select.get(logical_ties, [0, -1])</span>
<span class="sd">        ...     rmakers.force_note(leaves)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(7, 16), (3, 8), (7, 16), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 7/16</span>
<span class="sd">                    c&#39;4..</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    r4.</span>
<span class="sd">                    \time 7/16</span>
<span class="sd">                    r4..</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">note</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="s2">&quot;C4&quot;</span><span class="p">,</span> <span class="n">leaf</span><span class="o">.</span><span class="n">written_duration</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">leaf</span><span class="o">.</span><span class="n">multiplier</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">note</span><span class="o">.</span><span class="n">multiplier</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">multiplier</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="p">[</span><span class="n">note</span><span class="p">])</span></div>


<div class="viewcode-block" id="force_repeat_tie"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.force_repeat_tie">[docs]</a><span class="k">def</span> <span class="nf">force_repeat_tie</span><span class="p">(</span>
    <span class="n">argument</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">threshold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Changes all ties in argument to repeat-ties.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Container</span><span class="p">),</span> <span class="n">argument</span>
    <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">threshold</span><span class="p">):</span>
        <span class="n">inequality</span> <span class="o">=</span> <span class="n">threshold</span>
    <span class="k">elif</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">inequality</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">item</span> <span class="o">&lt;</span> <span class="mi">0</span>

    <span class="k">elif</span> <span class="n">threshold</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>

        <span class="k">def</span> <span class="nf">inequality</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">item</span> <span class="o">&gt;=</span> <span class="mi">0</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">inequality</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">item</span> <span class="o">&gt;=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span>

    <span class="n">attach_repeat_ties</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">has_indicator</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">):</span>
            <span class="n">next_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">next_leaf</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">next_leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Chord</span> <span class="o">|</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">has_indicator</span><span class="p">(</span><span class="n">next_leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">RepeatTie</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">inequality</span><span class="p">(</span><span class="n">duration</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">attach_repeat_ties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_leaf</span><span class="p">)</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">attach_repeat_ties</span><span class="p">:</span>
        <span class="n">repeat_tie</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">RepeatTie</span><span class="p">()</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">repeat_tie</span><span class="p">,</span> <span class="n">leaf</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span></div>


<div class="viewcode-block" id="force_rest"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.force_rest">[docs]</a><span class="k">def</span> <span class="nf">force_rest</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces leaves in ``argument`` with rests.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Changes logical ties 1 and 2 to rests:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)[1:3]</span>
<span class="sd">        ...     rmakers.force_rest(logical_ties)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(7, 16), (3, 8), (7, 16), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 7/16</span>
<span class="sd">                    c&#39;4..</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    r4.</span>
<span class="sd">                    \time 7/16</span>
<span class="sd">                    r4..</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Changes logical ties -1 and -2 to rests:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)[-2:]</span>
<span class="sd">        ...     rmakers.force_rest(logical_ties)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(7, 16), (3, 8), (7, 16), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 7/16</span>
<span class="sd">                    c&#39;4..</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    \time 7/16</span>
<span class="sd">                    r4..</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    r4.</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Changes patterned selection of logical ties to rests:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)[1:-1]</span>
<span class="sd">        ...     rmakers.force_rest(logical_ties)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(7, 16), (3, 8), (7, 16), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 7/16</span>
<span class="sd">                    c&#39;4..</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    r4.</span>
<span class="sd">                    \time 7/16</span>
<span class="sd">                    r4..</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">:</span>
        <span class="n">rest</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Rest</span><span class="p">(</span><span class="n">leaf</span><span class="o">.</span><span class="n">written_duration</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">leaf</span><span class="o">.</span><span class="n">multiplier</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rest</span><span class="o">.</span><span class="n">multiplier</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">multiplier</span>
        <span class="n">previous_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">next_leaf</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">leaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span> <span class="p">[</span><span class="n">rest</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">previous_leaf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">,</span> <span class="n">previous_leaf</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">,</span> <span class="n">rest</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">RepeatTie</span><span class="p">,</span> <span class="n">rest</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">next_leaf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">RepeatTie</span><span class="p">,</span> <span class="n">next_leaf</span><span class="p">)</span></div>


<div class="viewcode-block" id="incised"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.incised">[docs]</a><span class="k">def</span> <span class="nf">incised</span><span class="p">(</span>
    <span class="n">divisions</span><span class="p">,</span>
    <span class="n">extra_counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">body_ratio</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Ratio</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Ratio</span><span class="p">((</span><span class="mi">1</span><span class="p">,)),</span>
    <span class="n">fill_with_rests</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">outer_divisions_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">prefix_talea</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">prefix_counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">suffix_talea</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">suffix_counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">talea_denominator</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">spelling</span><span class="p">:</span> <span class="n">Spelling</span> <span class="o">=</span> <span class="n">Spelling</span><span class="p">(),</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">(),</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes incised tuplets in ``divisions``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Specifies one sixteenth rest cut out of the beginning of every division:</span>

<span class="sd">        &gt;&gt;&gt; specifier = rmakers.Incise(</span>
<span class="sd">        ...     prefix_talea=[-1],</span>
<span class="sd">        ...     prefix_counts=[1],</span>
<span class="sd">        ...     talea_denominator=16,</span>
<span class="sd">        ... )</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Specifies sixteenth rests cut out of the beginning and end of each division:</span>

<span class="sd">        &gt;&gt;&gt; specifier = rmakers.Incise(</span>
<span class="sd">        ...     prefix_talea=[-1],</span>
<span class="sd">        ...     prefix_counts=[1],</span>
<span class="sd">        ...     suffix_talea=[-1],</span>
<span class="sd">        ...     suffix_counts=[1],</span>
<span class="sd">        ...     talea_denominator=16,</span>
<span class="sd">        ... )</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Divides middle part of every division ``1:1``:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.incised(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         prefix_talea=[-1],</span>
<span class="sd">        ...         prefix_counts=[0, 1],</span>
<span class="sd">        ...         suffix_talea=[-1],</span>
<span class="sd">        ...         suffix_counts=[1],</span>
<span class="sd">        ...         talea_denominator=16,</span>
<span class="sd">        ...         body_ratio=abjad.Ratio((1, 1)),</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions =  4 * [(5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 5/16</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    r16</span>
<span class="sd">                    \time 5/16</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16.</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16.</span>
<span class="sd">                    ]</span>
<span class="sd">                    r16</span>
<span class="sd">                    \time 5/16</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    r16</span>
<span class="sd">                    \time 5/16</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16.</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16.</span>
<span class="sd">                    ]</span>
<span class="sd">                    r16</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forces rest at every other tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.incised(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         outer_divisions_only=True,</span>
<span class="sd">        ...         prefix_talea=[-1],</span>
<span class="sd">        ...         prefix_counts=[1],</span>
<span class="sd">        ...         suffix_talea=[-1],</span>
<span class="sd">        ...         suffix_counts=[1],</span>
<span class="sd">        ...         talea_denominator=16,</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)</span>
<span class="sd">        ...     logical_ties = abjad.select.get(logical_ties, [1], 2)</span>
<span class="sd">        ...     rmakers.force_rest(logical_ties)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r16</span>
<span class="sd">                    r4..</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r2</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r16</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Ties nonlast tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.incised(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         outer_divisions_only=True,</span>
<span class="sd">        ...         prefix_talea=[-1],</span>
<span class="sd">        ...         prefix_counts=[1],</span>
<span class="sd">        ...         suffix_talea=[-1],</span>
<span class="sd">        ...         suffix_counts=[1],</span>
<span class="sd">        ...         talea_denominator=8,</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(8, 8), (4, 8), (6, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 8/8</span>
<span class="sd">                    r8</span>
<span class="sd">                    c&#39;2..</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 6/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Repeat-ties nonfirst tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.incised(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         outer_divisions_only=True,</span>
<span class="sd">        ...         prefix_talea=[-1],</span>
<span class="sd">        ...         prefix_counts=[1],</span>
<span class="sd">        ...         suffix_talea=[-1],</span>
<span class="sd">        ...         suffix_counts=[1],</span>
<span class="sd">        ...         talea_denominator=8,</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[1:]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, 0) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.repeat_tie(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(8, 8), (4, 8), (6, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 8/8</span>
<span class="sd">                    r8</span>
<span class="sd">                    c&#39;2..</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    \repeatTie</span>
<span class="sd">                    \time 6/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    \repeatTie</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Add one extra count per tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.incised(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         extra_counts=[1],</span>
<span class="sd">        ...         outer_divisions_only=True,</span>
<span class="sd">        ...         prefix_talea=[-1],</span>
<span class="sd">        ...         prefix_counts=[1],</span>
<span class="sd">        ...         suffix_talea=[-1],</span>
<span class="sd">        ...         suffix_counts=[1],</span>
<span class="sd">        ...         talea_denominator=8,</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.force_augmentation(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(8, 8), (4, 8), (6, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 16/9</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 8/8</span>
<span class="sd">                        r16</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 8/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 12/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        r16</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.incised(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         prefix_talea=[-1],</span>
<span class="sd">        ...         prefix_counts=[0, 1],</span>
<span class="sd">        ...         suffix_talea=[-1],</span>
<span class="sd">        ...         suffix_counts=[1],</span>
<span class="sd">        ...         talea_denominator=16,</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = 4 * [(5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 5/16</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    r16</span>
<span class="sd">                    \time 5/16</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    r16</span>
<span class="sd">                    \time 5/16</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    r16</span>
<span class="sd">                    \time 5/16</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    r16</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Fills divisions with notes. Incises outer divisions only:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.incised(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         outer_divisions_only=True,</span>
<span class="sd">        ...         prefix_talea=[-8, -7],</span>
<span class="sd">        ...         prefix_counts=[2],</span>
<span class="sd">        ...         suffix_talea=[-3],</span>
<span class="sd">        ...         suffix_counts=[4],</span>
<span class="sd">        ...         talea_denominator=32,</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 8), (5, 8), (5, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    r4</span>
<span class="sd">                    r8..</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;32</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    r16.</span>
<span class="sd">                    r16.</span>
<span class="sd">                    r16.</span>
<span class="sd">                    r16.</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Fills divisions with rests. Incises outer divisions only:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.incised(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         fill_with_rests=True,</span>
<span class="sd">        ...         outer_divisions_only=True,</span>
<span class="sd">        ...         prefix_talea=[7, 8],</span>
<span class="sd">        ...         prefix_counts=[2],</span>
<span class="sd">        ...         suffix_talea=[3],</span>
<span class="sd">        ...         suffix_counts=[4],</span>
<span class="sd">        ...         talea_denominator=32,</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 8), (5, 8), (5, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    c&#39;8..</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    r8</span>
<span class="sd">                    r32</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    r2</span>
<span class="sd">                    r8</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    r4</span>
<span class="sd">                    c&#39;16.</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16.</span>
<span class="sd">                    c&#39;16.</span>
<span class="sd">                    c&#39;16.</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Spells durations with the fewest number of glyphs:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.incised(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         outer_divisions_only=True,</span>
<span class="sd">        ...         prefix_talea=[-1],</span>
<span class="sd">        ...         prefix_counts=[1],</span>
<span class="sd">        ...         suffix_talea=[-1],</span>
<span class="sd">        ...         suffix_counts=[1],</span>
<span class="sd">        ...         talea_denominator=8,</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(8, 8), (4, 8), (6, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 8/8</span>
<span class="sd">                    r8</span>
<span class="sd">                    c&#39;2..</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    \time 6/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forbids notes with written duration greater than or equal to ``1/2``:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.incised(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         outer_divisions_only=True,</span>
<span class="sd">        ...         prefix_talea=[-1],</span>
<span class="sd">        ...         prefix_counts=[1],</span>
<span class="sd">        ...         spelling=rmakers.Spelling(forbidden_note_duration=abjad.Duration(1, 2)),</span>
<span class="sd">        ...         suffix_talea=[-1],</span>
<span class="sd">        ...         suffix_counts=[1],</span>
<span class="sd">        ...         talea_denominator=8,</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(8, 8), (4, 8), (6, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 8/8</span>
<span class="sd">                    r8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 6/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Rewrites meter:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.incised(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         outer_divisions_only=True,</span>
<span class="sd">        ...         prefix_talea=[-1],</span>
<span class="sd">        ...         prefix_counts=[1],</span>
<span class="sd">        ...         suffix_talea=[-1],</span>
<span class="sd">        ...         suffix_counts=[1],</span>
<span class="sd">        ...         talea_denominator=8,</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     voice = rmakers.wrap_in_time_signature_staff(nested_music, divisions)</span>
<span class="sd">        ...     rmakers.beam(voice)</span>
<span class="sd">        ...     rmakers.extract_trivial(voice)</span>
<span class="sd">        ...     rmakers.rewrite_meter(voice)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(voice)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(8, 8), (4, 8), (6, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 8/8</span>
<span class="sd">                    r8</span>
<span class="sd">                    c&#39;2..</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    \time 6/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes augmentations:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     tag = abjad.Tag(&quot;INCISED_RHYTHM_MAKER&quot;)</span>
<span class="sd">        ...     nested_music = rmakers.incised(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         extra_counts=[1],</span>
<span class="sd">        ...         outer_divisions_only=True,</span>
<span class="sd">        ...         prefix_talea=[-1],</span>
<span class="sd">        ...         prefix_counts=[1],</span>
<span class="sd">        ...         suffix_talea=[-1],</span>
<span class="sd">        ...         suffix_counts=[1],</span>
<span class="sd">        ...         talea_denominator=8,</span>
<span class="sd">        ...         tag=tag,</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.force_augmentation(container)</span>
<span class="sd">        ...     rmakers.beam(container, tag=tag)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(8, 8), (4, 8), (6, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score, tags=True)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                    \times 16/9</span>
<span class="sd">                    %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 8/8</span>
<span class="sd">                        %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                        r16</span>
<span class="sd">                        %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                    }</span>
<span class="sd">                    %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                    \times 8/5</span>
<span class="sd">                    %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                    %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                    }</span>
<span class="sd">                    %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                    \times 12/7</span>
<span class="sd">                    %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/8</span>
<span class="sd">                        %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                        r16</span>
<span class="sd">                    %! INCISED_RHYTHM_MAKER</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">divisions_</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">NonreducedFraction</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">divisions</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">_make_incised_rhythm_maker_music</span><span class="p">(</span>
        <span class="n">divisions_</span><span class="p">,</span>
        <span class="n">extra_counts</span><span class="o">=</span><span class="n">extra_counts</span><span class="p">,</span>
        <span class="n">incise</span><span class="o">=</span><span class="n">Incise</span><span class="p">(</span>
            <span class="n">body_ratio</span><span class="o">=</span><span class="n">body_ratio</span><span class="p">,</span>
            <span class="n">fill_with_rests</span><span class="o">=</span><span class="n">fill_with_rests</span><span class="p">,</span>
            <span class="n">outer_divisions_only</span><span class="o">=</span><span class="n">outer_divisions_only</span><span class="p">,</span>
            <span class="n">prefix_talea</span><span class="o">=</span><span class="n">prefix_talea</span><span class="p">,</span>
            <span class="n">prefix_counts</span><span class="o">=</span><span class="n">prefix_counts</span><span class="p">,</span>
            <span class="n">suffix_talea</span><span class="o">=</span><span class="n">suffix_talea</span><span class="p">,</span>
            <span class="n">suffix_counts</span><span class="o">=</span><span class="n">suffix_counts</span><span class="p">,</span>
            <span class="n">talea_denominator</span><span class="o">=</span><span class="n">talea_denominator</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">spelling</span><span class="o">=</span><span class="n">spelling</span><span class="p">,</span>
        <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="invisible_music"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.invisible_music">[docs]</a><span class="k">def</span> <span class="nf">invisible_music</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes ``argument`` invisible.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag_1</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="s2">&quot;INVISIBLE_MUSIC_COMMAND&quot;</span><span class="p">))</span>
    <span class="n">literal_1</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">LilyPondLiteral</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\abjad-invisible-music&quot;</span><span class="p">)</span>
    <span class="n">tag_2</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="s2">&quot;INVISIBLE_MUSIC_COLORING&quot;</span><span class="p">))</span>
    <span class="n">literal_2</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">LilyPondLiteral</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\abjad-invisible-music-coloring&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">literal_1</span><span class="p">,</span> <span class="n">leaf</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag_1</span><span class="p">,</span> <span class="n">deactivate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">literal_2</span><span class="p">,</span> <span class="n">leaf</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag_2</span><span class="p">)</span></div>


<div class="viewcode-block" id="interpolate"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.interpolate">[docs]</a><span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span>
    <span class="n">start_duration</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Duration</span><span class="p">,</span>
    <span class="n">stop_duration</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Duration</span><span class="p">,</span>
    <span class="n">written_duration</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Duration</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Interpolation</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes interpolation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Interpolation</span><span class="p">(</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">start_duration</span><span class="p">),</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">stop_duration</span><span class="p">),</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">written_duration</span><span class="p">),</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="multiplied_duration"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.multiplied_duration">[docs]</a><span class="k">def</span> <span class="nf">multiplied_duration</span><span class="p">(</span>
    <span class="n">divisions</span><span class="p">,</span>
    <span class="n">prototype</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">duration</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Duration</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">spelling</span><span class="p">:</span> <span class="n">Spelling</span> <span class="o">=</span> <span class="n">Spelling</span><span class="p">(),</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Leaf</span><span class="p">]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes one multiplied duration for each division in ``divisions``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 4), (3, 16), (5, 8), (1, 3)]</span>
<span class="sd">        &gt;&gt;&gt; music = rmakers.multiplied_duration(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 1/4</span>
<span class="sd">                    c&#39;1 * 1/4</span>
<span class="sd">                    \time 3/16</span>
<span class="sd">                    c&#39;1 * 3/16</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    c&#39;1 * 5/8</span>
<span class="sd">                    #(ly:expect-warning &quot;strange time signature found&quot;)</span>
<span class="sd">                    \time 1/3</span>
<span class="sd">                    c&#39;1 * 1/3</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes multiplied-duration whole notes when ``duration`` is unset:</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 4), (3, 16), (5, 8), (1, 3)]</span>
<span class="sd">        &gt;&gt;&gt; music = rmakers.multiplied_duration(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 1/4</span>
<span class="sd">                    c&#39;1 * 1/4</span>
<span class="sd">                    \time 3/16</span>
<span class="sd">                    c&#39;1 * 3/16</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    c&#39;1 * 5/8</span>
<span class="sd">                    #(ly:expect-warning &quot;strange time signature found&quot;)</span>
<span class="sd">                    \time 1/3</span>
<span class="sd">                    c&#39;1 * 1/3</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Makes multiplied-duration half notes when ``duration=(1, 2)``:</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 4), (3, 16), (5, 8), (1, 3)]</span>
<span class="sd">        &gt;&gt;&gt; music = rmakers.multiplied_duration(divisions, duration=(1, 2))</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 1/4</span>
<span class="sd">                    c&#39;2 * 2/4</span>
<span class="sd">                    \time 3/16</span>
<span class="sd">                    c&#39;2 * 6/16</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    c&#39;2 * 10/8</span>
<span class="sd">                    #(ly:expect-warning &quot;strange time signature found&quot;)</span>
<span class="sd">                    \time 1/3</span>
<span class="sd">                    c&#39;2 * 2/3</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Makes multiplied-duration quarter notes when ``duration=(1, 4)``:</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 4), (3, 16), (5, 8), (1, 3)]</span>
<span class="sd">        &gt;&gt;&gt; music = rmakers.multiplied_duration(divisions, duration=(1, 4))</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 1/4</span>
<span class="sd">                    c&#39;4 * 4/4</span>
<span class="sd">                    \time 3/16</span>
<span class="sd">                    c&#39;4 * 12/16</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    c&#39;4 * 20/8</span>
<span class="sd">                    #(ly:expect-warning &quot;strange time signature found&quot;)</span>
<span class="sd">                    \time 1/3</span>
<span class="sd">                    c&#39;4 * 4/3</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes multiplied-duration notes when ``prototype`` is unset:</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 4), (3, 16), (5, 8), (1, 3)]</span>
<span class="sd">        &gt;&gt;&gt; music = rmakers.multiplied_duration(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 1/4</span>
<span class="sd">                    c&#39;1 * 1/4</span>
<span class="sd">                    \time 3/16</span>
<span class="sd">                    c&#39;1 * 3/16</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    c&#39;1 * 5/8</span>
<span class="sd">                    #(ly:expect-warning &quot;strange time signature found&quot;)</span>
<span class="sd">                    \time 1/3</span>
<span class="sd">                    c&#39;1 * 1/3</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes multiplied-duration rests when ``prototype=abjad.Rest``:</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 4), (3, 16), (5, 8), (1, 3)]</span>
<span class="sd">        &gt;&gt;&gt; music = rmakers.multiplied_duration(divisions, abjad.Rest)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 1/4</span>
<span class="sd">                    r1 * 1/4</span>
<span class="sd">                    \time 3/16</span>
<span class="sd">                    r1 * 3/16</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    r1 * 5/8</span>
<span class="sd">                    #(ly:expect-warning &quot;strange time signature found&quot;)</span>
<span class="sd">                    \time 1/3</span>
<span class="sd">                    r1 * 1/3</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes multiplied-duration multimeasures rests when</span>
<span class="sd">        ``prototype=abjad.MultimeasureRest``:</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 4), (3, 16), (5, 8), (1, 3)]</span>
<span class="sd">        &gt;&gt;&gt; music = rmakers.multiplied_duration(divisions, abjad.MultimeasureRest)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 1/4</span>
<span class="sd">                    R1 * 1/4</span>
<span class="sd">                    \time 3/16</span>
<span class="sd">                    R1 * 3/16</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    R1 * 5/8</span>
<span class="sd">                    #(ly:expect-warning &quot;strange time signature found&quot;)</span>
<span class="sd">                    \time 1/3</span>
<span class="sd">                    R1 * 1/3</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes multiplied-duration skips when ``prototype=abjad.Skip``:</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 4), (3, 16), (5, 8), (1, 3)]</span>
<span class="sd">        &gt;&gt;&gt; music = rmakers.multiplied_duration(divisions, abjad.Skip)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 1/4</span>
<span class="sd">                    s1 * 1/4</span>
<span class="sd">                    \time 3/16</span>
<span class="sd">                    s1 * 3/16</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    s1 * 5/8</span>
<span class="sd">                    #(ly:expect-warning &quot;strange time signature found&quot;)</span>
<span class="sd">                    \time 1/3</span>
<span class="sd">                    s1 * 1/3</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
    <span class="n">component</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Leaf</span>
    <span class="n">components</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">division</span> <span class="ow">in</span> <span class="n">divisions</span><span class="p">:</span>
        <span class="n">division</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">NonreducedFraction</span><span class="p">(</span><span class="n">division</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">division</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">NonreducedFraction</span><span class="p">)</span>
        <span class="n">multiplier</span> <span class="o">=</span> <span class="n">division</span> <span class="o">/</span> <span class="n">duration</span>
        <span class="k">if</span> <span class="n">prototype</span> <span class="ow">is</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">:</span>
            <span class="n">component</span> <span class="o">=</span> <span class="n">prototype</span><span class="p">(</span><span class="s2">&quot;c&#39;&quot;</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">=</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">component</span> <span class="o">=</span> <span class="n">prototype</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">=</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">components</span></div>


<div class="viewcode-block" id="nongrace_leaves_in_each_tuplet"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.nongrace_leaves_in_each_tuplet">[docs]</a><span class="k">def</span> <span class="nf">nongrace_leaves_in_each_tuplet</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Selects nongrace leaves in each tuplet.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">)</span>
    <span class="n">leaves</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">grace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tuplets</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">leaves</span></div>


<div class="viewcode-block" id="note"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.note">[docs]</a><span class="k">def</span> <span class="nf">note</span><span class="p">(</span>
    <span class="n">divisions</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">spelling</span><span class="p">:</span> <span class="n">Spelling</span> <span class="o">=</span> <span class="n">Spelling</span><span class="p">(),</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Leaf</span> <span class="o">|</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">]]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes one note for every division in ``divisions``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Silences every other logical tie:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)</span>
<span class="sd">        ...     logical_ties = abjad.select.get(logical_ties, [0], 2)</span>
<span class="sd">        ...     rmakers.force_rest(logical_ties)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r2</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r2</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forces rest at every logical tie:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)</span>
<span class="sd">        ...     rmakers.force_rest(logical_ties)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (5, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r2</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    r4.</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r2</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    r2</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Silences every other output division except for the first and last:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)</span>
<span class="sd">        ...     logical_ties = abjad.select.get(logical_ties, [0], 2)[1:-1]</span>
<span class="sd">        ...     rmakers.force_rest(logical_ties)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r2</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Beams each division:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container, pitched=True)</span>
<span class="sd">        ...     rmakers.beam(logical_ties)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 32), (5, 32)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 5/32</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;32</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 5/32</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;32</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Beams divisions together:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)</span>
<span class="sd">        ...     rmakers.beam_groups(logical_ties)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 32), (5, 32)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \set stemLeftBeamCount = 0</span>
<span class="sd">                    \set stemRightBeamCount = 1</span>
<span class="sd">                    \time 5/32</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    ~</span>
<span class="sd">                    \set stemLeftBeamCount = 3</span>
<span class="sd">                    \set stemRightBeamCount = 1</span>
<span class="sd">                    c&#39;32</span>
<span class="sd">                    \set stemLeftBeamCount = 1</span>
<span class="sd">                    \set stemRightBeamCount = 1</span>
<span class="sd">                    \time 5/32</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \set stemLeftBeamCount = 3</span>
<span class="sd">                    \set stemRightBeamCount = 0</span>
<span class="sd">                    c&#39;32</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes no beams:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 32), (5, 32)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 5/32</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;32</span>
<span class="sd">                    \time 5/32</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;32</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Does not tie across divisions:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Ties across divisions:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)[:-1]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in logical_ties]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Ties across every other logical tie:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)[:-1]</span>
<span class="sd">        ...     logical_ties = abjad.select.get(logical_ties, [0], 2)</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in logical_ties]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Strips all ties:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.untie(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(7, 16), (1, 4), (5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 7/16</span>
<span class="sd">                    c&#39;4..</span>
<span class="sd">                    \time 1/4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 5/16</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Spells tuplets as diminutions:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 14), (3, 7)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak edge-height #&#39;(0.7 . 0)</span>
<span class="sd">                    \times 8/14</span>
<span class="sd">                    {</span>
<span class="sd">                        #(ly:expect-warning &quot;strange time signature found&quot;)</span>
<span class="sd">                        \time 5/14</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak edge-height #&#39;(0.7 . 0)</span>
<span class="sd">                    \times 4/7</span>
<span class="sd">                    {</span>
<span class="sd">                        #(ly:expect-warning &quot;strange time signature found&quot;)</span>
<span class="sd">                        \time 3/7</span>
<span class="sd">                        c&#39;2.</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Spells tuplets as augmentations:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.force_augmentation(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 14), (3, 7)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \tweak edge-height #&#39;(0.7 . 0)</span>
<span class="sd">                    \times 16/14</span>
<span class="sd">                    {</span>
<span class="sd">                        #(ly:expect-warning &quot;strange time signature found&quot;)</span>
<span class="sd">                        \time 5/14</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \tweak edge-height #&#39;(0.7 . 0)</span>
<span class="sd">                    \times 8/7</span>
<span class="sd">                    {</span>
<span class="sd">                        #(ly:expect-warning &quot;strange time signature found&quot;)</span>
<span class="sd">                        \time 3/7</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forces rest in logical tie 0:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_tie = abjad.select.logical_tie(container, 0)</span>
<span class="sd">        ...     rmakers.force_rest(logical_tie)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 8), (2, 8), (2, 8), (5, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    r2</span>
<span class="sd">                    r8</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forces rests in first two logical ties:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_tie = abjad.select.logical_ties(container)[:2]</span>
<span class="sd">        ...     rmakers.force_rest(logical_tie)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 8), (2, 8), (2, 8), (5, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    r2</span>
<span class="sd">                    r8</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    r4</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forces rests in first and last logical ties:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)</span>
<span class="sd">        ...     logical_ties = abjad.select.get(logical_ties, [0, -1])</span>
<span class="sd">        ...     rmakers.force_rest(logical_ties)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 8), (2, 8), (2, 8), (5, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    r2</span>
<span class="sd">                    r8</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    r2</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Rewrites meter:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.note(divisions)</span>
<span class="sd">        ...     voice = rmakers.wrap_in_time_signature_staff(nested_music, divisions)</span>
<span class="sd">        ...     rmakers.rewrite_meter(voice)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(voice)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 4), (6, 16), (9, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;2.</span>
<span class="sd">                    \time 6/16</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    \time 9/16</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">_make_note_rhythm_maker_music</span><span class="p">(</span><span class="n">divisions</span><span class="p">,</span> <span class="n">spelling</span><span class="o">=</span><span class="n">spelling</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span></div>


<div class="viewcode-block" id="on_beat_grace_container"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.on_beat_grace_container">[docs]</a><span class="k">def</span> <span class="nf">on_beat_grace_container</span><span class="p">(</span>
    <span class="n">voice</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">,</span>
    <span class="n">voice_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">argument</span><span class="p">,</span>
    <span class="n">counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">leaf_duration</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Duration</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="c1"># TODO: activate tag</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">talea</span><span class="p">:</span> <span class="n">Talea</span> <span class="o">=</span> <span class="n">Talea</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="mi">8</span><span class="p">),</span>
<span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes on-beat grace containers.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [4], extra_counts=[2]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     voice = abjad.Voice(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(voice)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_) for _ in tuplets]</span>
<span class="sd">        ...     notes = [abjad.select.exclude(_, [0, -1]) for _ in notes]</span>
<span class="sd">        ...     notes = abjad.select.notes(notes)</span>
<span class="sd">        ...     groups = [[_] for _ in notes]</span>
<span class="sd">        ...     rmakers.on_beat_grace_container(</span>
<span class="sd">        ...         voice,</span>
<span class="sd">        ...         &quot;RhythmMaker.Music&quot;,</span>
<span class="sd">        ...         groups,</span>
<span class="sd">        ...         [2, 4],</span>
<span class="sd">        ...         leaf_duration=(1, 28)</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(voice)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; music_voice = abjad.Voice(music, name=&quot;RhythmMaker.Music&quot;)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(</span>
<span class="sd">        ...     [music_voice], divisions, includes=[&quot;abjad.ily&quot;]</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; staff = lilypond_file[&quot;Staff&quot;]</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(staff).TupletBracket.direction = abjad.UP</span>
<span class="sd">        &gt;&gt;&gt; abjad.override(staff).TupletBracket.staff_padding = 5</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                    \override TupletBracket.direction = #up</span>
<span class="sd">                    \override TupletBracket.staff-padding = 5</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/5</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \set fontSize = #-3</span>
<span class="sd">                                    \slash</span>
<span class="sd">                                    \voiceOne</span>
<span class="sd">                                    &lt;</span>
<span class="sd">                                        \tweak font-size 0</span>
<span class="sd">                                        \tweak transparent ##t</span>
<span class="sd">                                        c&#39;</span>
<span class="sd">                                    &gt;8 * 10/21</span>
<span class="sd">                                    [</span>
<span class="sd">                                    (</span>
<span class="sd">                                    c&#39;8 * 10/21</span>
<span class="sd">                                    )</span>
<span class="sd">                                    ]</span>
<span class="sd">                                }</span>
<span class="sd">                                \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \voiceTwo</span>
<span class="sd">                                    c&#39;4</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \set fontSize = #-3</span>
<span class="sd">                                    \slash</span>
<span class="sd">                                    \voiceOne</span>
<span class="sd">                                    &lt;</span>
<span class="sd">                                        \tweak font-size 0</span>
<span class="sd">                                        \tweak transparent ##t</span>
<span class="sd">                                        c&#39;</span>
<span class="sd">                                    &gt;8 * 10/21</span>
<span class="sd">                                    [</span>
<span class="sd">                                    (</span>
<span class="sd">                                    c&#39;8 * 10/21</span>
<span class="sd">                                    c&#39;8 * 10/21</span>
<span class="sd">                                    c&#39;8 * 10/21</span>
<span class="sd">                                    )</span>
<span class="sd">                                    ]</span>
<span class="sd">                                }</span>
<span class="sd">                                \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \voiceTwo</span>
<span class="sd">                                    c&#39;4</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \set fontSize = #-3</span>
<span class="sd">                                    \slash</span>
<span class="sd">                                    \voiceOne</span>
<span class="sd">                                    &lt;</span>
<span class="sd">                                        \tweak font-size 0</span>
<span class="sd">                                        \tweak transparent ##t</span>
<span class="sd">                                        c&#39;</span>
<span class="sd">                                    &gt;8 * 10/21</span>
<span class="sd">                                    [</span>
<span class="sd">                                    (</span>
<span class="sd">                                    c&#39;8 * 10/21</span>
<span class="sd">                                    )</span>
<span class="sd">                                    ]</span>
<span class="sd">                                }</span>
<span class="sd">                                \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \voiceTwo</span>
<span class="sd">                                    c&#39;4</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \oneVoice</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                        \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                        \times 3/5</span>
<span class="sd">                        {</span>
<span class="sd">                            \time 3/4</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \set fontSize = #-3</span>
<span class="sd">                                    \slash</span>
<span class="sd">                                    \voiceOne</span>
<span class="sd">                                    &lt;</span>
<span class="sd">                                        \tweak font-size 0</span>
<span class="sd">                                        \tweak transparent ##t</span>
<span class="sd">                                        c&#39;</span>
<span class="sd">                                    &gt;8 * 10/21</span>
<span class="sd">                                    [</span>
<span class="sd">                                    (</span>
<span class="sd">                                    c&#39;8 * 10/21</span>
<span class="sd">                                    c&#39;8 * 10/21</span>
<span class="sd">                                    c&#39;8 * 10/21</span>
<span class="sd">                                    )</span>
<span class="sd">                                    ]</span>
<span class="sd">                                }</span>
<span class="sd">                                \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \voiceTwo</span>
<span class="sd">                                    c&#39;4</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \set fontSize = #-3</span>
<span class="sd">                                    \slash</span>
<span class="sd">                                    \voiceOne</span>
<span class="sd">                                    &lt;</span>
<span class="sd">                                        \tweak font-size 0</span>
<span class="sd">                                        \tweak transparent ##t</span>
<span class="sd">                                        c&#39;</span>
<span class="sd">                                    &gt;8 * 10/21</span>
<span class="sd">                                    [</span>
<span class="sd">                                    (</span>
<span class="sd">                                    c&#39;8 * 10/21</span>
<span class="sd">                                    )</span>
<span class="sd">                                    ]</span>
<span class="sd">                                }</span>
<span class="sd">                                \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \voiceTwo</span>
<span class="sd">                                    c&#39;4</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            &lt;&lt;</span>
<span class="sd">                                \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \set fontSize = #-3</span>
<span class="sd">                                    \slash</span>
<span class="sd">                                    \voiceOne</span>
<span class="sd">                                    &lt;</span>
<span class="sd">                                        \tweak font-size 0</span>
<span class="sd">                                        \tweak transparent ##t</span>
<span class="sd">                                        c&#39;</span>
<span class="sd">                                    &gt;8 * 10/21</span>
<span class="sd">                                    [</span>
<span class="sd">                                    (</span>
<span class="sd">                                    c&#39;8 * 10/21</span>
<span class="sd">                                    c&#39;8 * 10/21</span>
<span class="sd">                                    c&#39;8 * 10/21</span>
<span class="sd">                                    )</span>
<span class="sd">                                    ]</span>
<span class="sd">                                }</span>
<span class="sd">                                \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                                {</span>
<span class="sd">                                    \voiceTwo</span>
<span class="sd">                                    c&#39;4</span>
<span class="sd">                                }</span>
<span class="sd">                            &gt;&gt;</span>
<span class="sd">                            \oneVoice</span>
<span class="sd">                            c&#39;4</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(divisions, [5], 16)</span>
<span class="sd">        ...     voice = abjad.Voice(nested_music)</span>
<span class="sd">        ...     rmakers.extract_trivial(voice)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(voice)</span>
<span class="sd">        ...     rmakers.on_beat_grace_container(</span>
<span class="sd">        ...         voice,</span>
<span class="sd">        ...         &quot;RhythmMaker.Music&quot;,</span>
<span class="sd">        ...         logical_ties,</span>
<span class="sd">        ...         [6, 2],</span>
<span class="sd">        ...         leaf_duration=(1, 28)</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(voice)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; music_voice = abjad.Voice(music, name=&quot;RhythmMaker.Music&quot;)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(</span>
<span class="sd">        ...     [music_voice], divisions, includes=[&quot;abjad.ily&quot;]</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                    {</span>
<span class="sd">                        &lt;&lt;</span>
<span class="sd">                            \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \set fontSize = #-3</span>
<span class="sd">                                \slash</span>
<span class="sd">                                \voiceOne</span>
<span class="sd">                                &lt;</span>
<span class="sd">                                    \tweak font-size 0</span>
<span class="sd">                                    \tweak transparent ##t</span>
<span class="sd">                                    c&#39;</span>
<span class="sd">                                &gt;8 * 2/7</span>
<span class="sd">                                [</span>
<span class="sd">                                (</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                )</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \time 3/4</span>
<span class="sd">                                \voiceTwo</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                                ~</span>
<span class="sd">                                c&#39;16</span>
<span class="sd">                            }</span>
<span class="sd">                        &gt;&gt;</span>
<span class="sd">                        &lt;&lt;</span>
<span class="sd">                            \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \set fontSize = #-3</span>
<span class="sd">                                \slash</span>
<span class="sd">                                \voiceOne</span>
<span class="sd">                                &lt;</span>
<span class="sd">                                    \tweak font-size 0</span>
<span class="sd">                                    \tweak transparent ##t</span>
<span class="sd">                                    c&#39;</span>
<span class="sd">                                &gt;8 * 2/7</span>
<span class="sd">                                [</span>
<span class="sd">                                (</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                )</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \voiceTwo</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                                ~</span>
<span class="sd">                                c&#39;16</span>
<span class="sd">                            }</span>
<span class="sd">                        &gt;&gt;</span>
<span class="sd">                        &lt;&lt;</span>
<span class="sd">                            \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \set fontSize = #-3</span>
<span class="sd">                                \slash</span>
<span class="sd">                                \voiceOne</span>
<span class="sd">                                &lt;</span>
<span class="sd">                                    \tweak font-size 0</span>
<span class="sd">                                    \tweak transparent ##t</span>
<span class="sd">                                    c&#39;</span>
<span class="sd">                                &gt;8 * 2/7</span>
<span class="sd">                                [</span>
<span class="sd">                                (</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                )</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \voiceTwo</span>
<span class="sd">                                c&#39;8</span>
<span class="sd">                                ~</span>
<span class="sd">                                \time 3/4</span>
<span class="sd">                                c&#39;8.</span>
<span class="sd">                            }</span>
<span class="sd">                        &gt;&gt;</span>
<span class="sd">                        &lt;&lt;</span>
<span class="sd">                            \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \set fontSize = #-3</span>
<span class="sd">                                \slash</span>
<span class="sd">                                \voiceOne</span>
<span class="sd">                                &lt;</span>
<span class="sd">                                    \tweak font-size 0</span>
<span class="sd">                                    \tweak transparent ##t</span>
<span class="sd">                                    c&#39;</span>
<span class="sd">                                &gt;8 * 2/7</span>
<span class="sd">                                [</span>
<span class="sd">                                (</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                )</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \voiceTwo</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                                ~</span>
<span class="sd">                                c&#39;16</span>
<span class="sd">                            }</span>
<span class="sd">                        &gt;&gt;</span>
<span class="sd">                        &lt;&lt;</span>
<span class="sd">                            \context Voice = &quot;On_Beat_Grace_Container&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \set fontSize = #-3</span>
<span class="sd">                                \slash</span>
<span class="sd">                                \voiceOne</span>
<span class="sd">                                &lt;</span>
<span class="sd">                                    \tweak font-size 0</span>
<span class="sd">                                    \tweak transparent ##t</span>
<span class="sd">                                    c&#39;</span>
<span class="sd">                                &gt;8 * 2/7</span>
<span class="sd">                                [</span>
<span class="sd">                                (</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                c&#39;8 * 2/7</span>
<span class="sd">                                )</span>
<span class="sd">                                ]</span>
<span class="sd">                            }</span>
<span class="sd">                            \context Voice = &quot;RhythmMaker.Music&quot;</span>
<span class="sd">                            {</span>
<span class="sd">                                \voiceTwo</span>
<span class="sd">                                c&#39;4</span>
<span class="sd">                            }</span>
<span class="sd">                        &gt;&gt;</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">voice</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">voice</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">voice_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">voice_name</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">talea</span><span class="p">,</span> <span class="n">Talea</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">talea</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">voice</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">voice</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">voice_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">voice_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">voice_name</span><span class="p">:</span>
        <span class="n">voice</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">voice_name</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">talea</span><span class="p">,</span> <span class="n">Talea</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">talea</span><span class="p">)</span>
    <span class="n">cyclic_counts</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">CyclicTuple</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">selection</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">cyclic_counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">count</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">count</span>
        <span class="n">durations</span> <span class="o">=</span> <span class="n">talea</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="n">notes</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">makers</span><span class="o">.</span><span class="n">make_leaves</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">durations</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">on_beat_grace_container</span><span class="p">(</span>
            <span class="n">notes</span><span class="p">,</span>
            <span class="n">selection</span><span class="p">,</span>
            <span class="n">anchor_voice_number</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">grace_voice_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">leaf_duration</span><span class="o">=</span><span class="n">leaf_duration</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="repeat_tie"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.repeat_tie">[docs]</a><span class="k">def</span> <span class="nf">repeat_tie</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attaches repeat-tie to each leaf in ``argument``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        TIE-ACROSS-DIVISIONS RECIPE. Attaches repeat-ties to first note in nonfirst</span>
<span class="sd">        tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8], extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[1:]</span>
<span class="sd">        ...     notes = [abjad.select.note(_, 0) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.repeat_tie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        With pattern:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8], extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     tuplets = abjad.select.get(tuplets, [1], 2)</span>
<span class="sd">        ...     notes = [abjad.select.note(_, 0) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.repeat_tie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">notes</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">tie</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">RepeatTie</span><span class="p">()</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">tie</span><span class="p">,</span> <span class="n">note</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span></div>


<div class="viewcode-block" id="reduce_multiplier"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.reduce_multiplier">[docs]</a><span class="k">def</span> <span class="nf">reduce_multiplier</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reduces multipliers of tuplets in ``argument``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">fraction</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Fraction</span><span class="p">(</span><span class="o">*</span><span class="n">tuplet</span><span class="o">.</span><span class="n">multiplier</span><span class="o">.</span><span class="n">pair</span><span class="p">)</span>
        <span class="n">tuplet</span><span class="o">.</span><span class="n">multiplier</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">NonreducedFraction</span><span class="p">(</span><span class="n">fraction</span><span class="p">)</span></div>


<div class="viewcode-block" id="rewrite_dots"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.rewrite_dots">[docs]</a><span class="k">def</span> <span class="nf">rewrite_dots</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rewrites dots of tuplets in ``argument``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">tuplet</span><span class="o">.</span><span class="n">rewrite_dots</span><span class="p">()</span></div>


<div class="viewcode-block" id="rewrite_meter"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.rewrite_meter">[docs]</a><span class="k">def</span> <span class="nf">rewrite_meter</span><span class="p">(</span>
    <span class="n">voice</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">boundary_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">reference_meters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Meter</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rewrites meter of material in ``voice``.</span>

<span class="sd">    Use ``rmakers.wrap_in_time_signature_staff()`` to make sure ``voice``</span>
<span class="sd">    appears together with time signature information in a staff.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">voice</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Container</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">voice</span><span class="p">)</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="ow">or</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">()</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="s2">&quot;rmakers.RewriteMeterCommand.__call__&quot;</span><span class="p">))</span>
    <span class="n">staff</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">parentage</span><span class="p">(</span><span class="n">voice</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">staff</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Staff</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">staff</span><span class="p">)</span>
    <span class="n">time_signature_voice</span> <span class="o">=</span> <span class="n">staff</span><span class="p">[</span><span class="s2">&quot;TimeSignatureVoice&quot;</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_signature_voice</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">)</span>
    <span class="n">meters</span><span class="p">,</span> <span class="n">preferred_meters</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">skip</span> <span class="ow">in</span> <span class="n">time_signature_voice</span><span class="p">:</span>
        <span class="n">time_signature</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">indicator</span><span class="p">(</span><span class="n">skip</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">TimeSignature</span><span class="p">)</span>
        <span class="n">meter</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Meter</span><span class="p">(</span><span class="n">time_signature</span><span class="p">)</span>
        <span class="n">meters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meter</span><span class="p">)</span>
    <span class="n">durations</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">meters</span><span class="p">]</span>
    <span class="n">reference_meters</span> <span class="o">=</span> <span class="n">reference_meters</span> <span class="ow">or</span> <span class="p">()</span>
    <span class="n">split_measures</span><span class="p">(</span><span class="n">voice</span><span class="p">,</span> <span class="n">durations</span><span class="o">=</span><span class="n">durations</span><span class="p">)</span>
    <span class="n">selections</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">group_by_measure</span><span class="p">(</span><span class="n">voice</span><span class="p">[:])</span>
    <span class="k">for</span> <span class="n">meter</span><span class="p">,</span> <span class="n">selection</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">meters</span><span class="p">,</span> <span class="n">selections</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">reference_meter</span> <span class="ow">in</span> <span class="n">reference_meters</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">reference_meter</span> <span class="o">==</span> <span class="n">meter</span><span class="p">:</span>
                <span class="n">meter</span> <span class="o">=</span> <span class="n">reference_meter</span>
                <span class="k">break</span>
        <span class="n">preferred_meters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meter</span><span class="p">)</span>
        <span class="n">nontupletted_leaves</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">iterate</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">selection</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">parentage</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">):</span>
                <span class="n">nontupletted_leaves</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span>
        <span class="n">unbeam</span><span class="p">(</span><span class="n">nontupletted_leaves</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">Meter</span><span class="o">.</span><span class="n">rewrite_meter</span><span class="p">(</span>
            <span class="n">selection</span><span class="p">,</span>
            <span class="n">meter</span><span class="p">,</span>
            <span class="n">boundary_depth</span><span class="o">=</span><span class="n">boundary_depth</span><span class="p">,</span>
            <span class="n">rewrite_tuplets</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">selections</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">group_by_measure</span><span class="p">(</span><span class="n">voice</span><span class="p">[:])</span>
    <span class="k">for</span> <span class="n">meter</span><span class="p">,</span> <span class="n">selection</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">preferred_meters</span><span class="p">,</span> <span class="n">selections</span><span class="p">):</span>
        <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">grace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">beat_durations</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">beat_offsets</span> <span class="o">=</span> <span class="n">meter</span><span class="o">.</span><span class="n">depthwise_offset_inventory</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">nwise</span><span class="p">(</span><span class="n">beat_offsets</span><span class="p">):</span>
            <span class="n">beat_duration</span> <span class="o">=</span> <span class="n">stop</span> <span class="o">-</span> <span class="n">start</span>
            <span class="n">beat_durations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">beat_duration</span><span class="p">)</span>
        <span class="n">beamable_groups</span> <span class="o">=</span> <span class="n">_make_beamable_groups</span><span class="p">(</span><span class="n">leaves</span><span class="p">,</span> <span class="n">beat_durations</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">beamable_group</span> <span class="ow">in</span> <span class="n">beamable_groups</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">beamable_group</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">beam</span><span class="p">(</span>
                <span class="n">beamable_group</span><span class="p">,</span>
                <span class="n">beam_rests</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="rewrite_rest_filled"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.rewrite_rest_filled">[docs]</a><span class="k">def</span> <span class="nf">rewrite_rest_filled</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">spelling</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rewrites rest-filled tuplets in ``argument``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Does not rewrite rest-filled tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [-1], 16, extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 16), (4, 16), (5, 16), (5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 5/6</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 5/6</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                        r16</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Rewrites rest-filled tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [-1], 16, extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.rewrite_rest_filled(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 16), (4, 16), (5, 16), (5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 4/16</span>
<span class="sd">                    r4</span>
<span class="sd">                    \time 4/16</span>
<span class="sd">                    r4</span>
<span class="sd">                    \time 5/16</span>
<span class="sd">                    r4</span>
<span class="sd">                    r16</span>
<span class="sd">                    \time 5/16</span>
<span class="sd">                    r4</span>
<span class="sd">                    r16</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        With spelling specifier:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [-1], 16, extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.rewrite_rest_filled(</span>
<span class="sd">        ...         container,</span>
<span class="sd">        ...         spelling=rmakers.Spelling(increase_monotonic=True)</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 16), (4, 16), (5, 16), (5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 4/16</span>
<span class="sd">                    r4</span>
<span class="sd">                    \time 4/16</span>
<span class="sd">                    r4</span>
<span class="sd">                    \time 5/16</span>
<span class="sd">                    r16</span>
<span class="sd">                    r4</span>
<span class="sd">                    \time 5/16</span>
<span class="sd">                    r16</span>
<span class="sd">                    r4</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">spelling</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">increase_monotonic</span> <span class="o">=</span> <span class="n">spelling</span><span class="o">.</span><span class="n">increase_monotonic</span>
        <span class="n">forbidden_note_duration</span> <span class="o">=</span> <span class="n">spelling</span><span class="o">.</span><span class="n">forbidden_note_duration</span>
        <span class="n">forbidden_rest_duration</span> <span class="o">=</span> <span class="n">spelling</span><span class="o">.</span><span class="n">forbidden_rest_duration</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">increase_monotonic</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">forbidden_note_duration</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">forbidden_rest_duration</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tuplet</span><span class="o">.</span><span class="n">rest_filled</span><span class="p">():</span>
            <span class="k">continue</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
        <span class="n">rests</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">makers</span><span class="o">.</span><span class="n">make_leaves</span><span class="p">(</span>
            <span class="p">[</span><span class="kc">None</span><span class="p">],</span>
            <span class="p">[</span><span class="n">duration</span><span class="p">],</span>
            <span class="n">increase_monotonic</span><span class="o">=</span><span class="n">increase_monotonic</span><span class="p">,</span>
            <span class="n">forbidden_note_duration</span><span class="o">=</span><span class="n">forbidden_note_duration</span><span class="p">,</span>
            <span class="n">forbidden_rest_duration</span><span class="o">=</span><span class="n">forbidden_rest_duration</span><span class="p">,</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tuplet</span><span class="p">[:],</span> <span class="n">rests</span><span class="p">)</span>
        <span class="n">tuplet</span><span class="o">.</span><span class="n">multiplier</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">NonreducedFraction</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="rewrite_sustained"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.rewrite_sustained">[docs]</a><span class="k">def</span> <span class="nf">rewrite_sustained</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rewrites sustained tuplets in ``argument``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Sustained tuplets generalize a class of rhythms composers are likely to rewrite:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [6, 5, 5, 4, 1], 16, extra_counts=[2, 1, 1, 1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[1:3]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 16), (4, 16), (4, 16), (4, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        The first three tuplets in the example above qualify as sustained:</span>

<span class="sd">            &gt;&gt;&gt; staff = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; for tuplet in abjad.select.tuplets(staff):</span>
<span class="sd">            ...     abjad.get.sustained(tuplet)</span>
<span class="sd">            ...</span>
<span class="sd">            True</span>
<span class="sd">            True</span>
<span class="sd">            True</span>
<span class="sd">            False</span>

<span class="sd">        Tuplets 0 and 1 each contain only a single **tuplet-initial** attack. Tuplet 2</span>
<span class="sd">        contains no attack at all. All three fill their duration completely.</span>

<span class="sd">        Tuplet 3 contains a **nonintial** attack that rearticulates the tuplet&#39;s duration</span>
<span class="sd">        midway through the course of the figure. Tuplet 3 does not qualify as sustained.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Rewrite sustained tuplets like this:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [6, 5, 5, 4, 1], 16, extra_counts=[2, 1, 1, 1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[1:3]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.rewrite_sustained(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 16), (4, 16), (4, 16), (4, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Rewrite sustained tuplets -- and then extract the trivial tuplets that result --</span>
<span class="sd">        like this:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [6, 5, 5, 4, 1], 16, extra_counts=[2, 1, 1, 1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[1:3]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.rewrite_sustained(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 16), (4, 16), (4, 16), (4, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 4/16</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 4/16</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 4/16</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        With selector:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8], extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_)[:-1] for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.rewrite_sustained(tuplets[-2:])</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 2/2</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 2/2</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">sustained</span><span class="p">(</span><span class="n">tuplet</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
        <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
        <span class="n">last_leaf</span> <span class="o">=</span> <span class="n">leaves</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">has_indicator</span><span class="p">(</span><span class="n">last_leaf</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">):</span>
            <span class="n">last_leaf_has_tie</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">last_leaf_has_tie</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">tuplet</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">tuplet</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">last_leaf_has_tie</span><span class="p">:</span>
            <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">,</span> <span class="n">tuplet</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">_set_leaf_duration</span><span class="p">(</span><span class="n">tuplet</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">duration</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="n">tuplet</span><span class="o">.</span><span class="n">multiplier</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">NonreducedFraction</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="split_measures"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.split_measures">[docs]</a><span class="k">def</span> <span class="nf">split_measures</span><span class="p">(</span><span class="n">voice</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">durations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Splits measures in ``voice``.</span>

<span class="sd">    Uses ``durations`` when ``durations`` is not none.</span>

<span class="sd">    Tries to find time signature information (from the staff that contains ``voice``)</span>
<span class="sd">    when ``durations`` is none.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">durations</span><span class="p">:</span>
        <span class="c1"># TODO: implement abjad.get() method for measure durations</span>
        <span class="n">staff</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">parentage</span><span class="p">(</span><span class="n">voice</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">staff</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Staff</span><span class="p">)</span>
        <span class="n">voice_</span> <span class="o">=</span> <span class="n">staff</span><span class="p">[</span><span class="s2">&quot;TimeSignatureVoice&quot;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">voice_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">)</span>
        <span class="n">durations</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">voice_</span><span class="p">]</span>
    <span class="n">total_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">durations</span><span class="p">)</span>
    <span class="n">music_duration</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">voice</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">total_duration</span> <span class="o">!=</span> <span class="n">music_duration</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Total duration of splits is </span><span class="si">{</span><span class="n">total_duration</span><span class="si">!s}</span><span class="s2">&quot;</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; but duration of music is </span><span class="si">{</span><span class="n">music_duration</span><span class="si">!s}</span><span class="s2">:&quot;</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">durations: </span><span class="si">{</span><span class="n">durations</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="n">message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">voice: </span><span class="si">{</span><span class="n">voice</span><span class="p">[:]</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">voice</span><span class="p">[:],</span> <span class="n">durations</span><span class="o">=</span><span class="n">durations</span><span class="p">)</span></div>


<div class="viewcode-block" id="talea"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.talea">[docs]</a><span class="k">def</span> <span class="nf">talea</span><span class="p">(</span>
    <span class="n">divisions</span><span class="p">,</span>
    <span class="n">counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">denominator</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">advance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">end_counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">extra_counts</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">preamble</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">previous_state</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">read_talea_once_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">spelling</span><span class="p">:</span> <span class="n">Spelling</span> <span class="o">=</span> <span class="n">Spelling</span><span class="p">(),</span>
    <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads ``counts`` cyclically and makes one tuplet for each division in ``divisions``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Repeats talea of 1/16, 2/16, 3/16, 4/16:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(divisions, [1, 2, 3, 4], 16)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Silences first and last logical ties:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(divisions, [1, 2, 3, 4], 16)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)</span>
<span class="sd">        ...     logical_ties = abjad.select.get(logical_ties, [0, -1])</span>
<span class="sd">        ...     rmakers.force_rest(logical_ties)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Silences all logical ties. Then sustains first and last logical ties:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(divisions, [1, 2, 3, 4], 16)</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)</span>
<span class="sd">        ...     rmakers.force_rest(logical_ties)</span>
<span class="sd">        ...     logical_ties = abjad.select.logical_ties(container)</span>
<span class="sd">        ...     logical_ties = abjad.select.get(logical_ties, [0, -1])</span>
<span class="sd">        ...     rmakers.force_note(logical_ties)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r8</span>
<span class="sd">                    r8.</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r4</span>
<span class="sd">                    r16</span>
<span class="sd">                    r8</span>
<span class="sd">                    r16</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    r8</span>
<span class="sd">                    r4</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r16</span>
<span class="sd">                    r8</span>
<span class="sd">                    r8.</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        REGRESSION. Spells tuplet denominator in terms of duration when denominator is</span>
<span class="sd">        given as a duration:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 2, 3, 4], 16, extra_counts=[1, 1, 2, 2]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.denominator(container, (1, 16))</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/9</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/8</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Beams each division:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Beams tuplets together:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.beam_groups(tuplets)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \set stemLeftBeamCount = 0</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 1</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 1</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 1</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 1</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 1</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 1</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 2</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \set stemLeftBeamCount = 2</span>
<span class="sd">                    \set stemRightBeamCount = 0</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Beams nothing:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Does not beam rests:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 1, 1, -1], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    r16</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    r16</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Does beam rests:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 1, 1, -1], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container, beam_rests=True)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r16</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Beams rests with stemlets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 1, 1, -1], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container, beam_rests=True, stemlet_length=0.75)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \override Staff.Stem.stemlet-length = 0.75</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \revert Staff.Stem.stemlet-length</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \override Staff.Stem.stemlet-length = 0.75</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \revert Staff.Stem.stemlet-length</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \override Staff.Stem.stemlet-length = 0.75</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \revert Staff.Stem.stemlet-length</span>
<span class="sd">                    r16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \override Staff.Stem.stemlet-length = 0.75</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \revert Staff.Stem.stemlet-length</span>
<span class="sd">                    r16</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Does not tie across divisions:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [5, 3, 3, 3], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Ties across divisions:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [5, 3, 3, 3], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Ties across every other tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [5, 3, 3, 3], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     tuplets = abjad.select.get(tuplets, [0], 2)</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        TIE-CONSECUTIVE-NOTES RECIPE:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [5, -3, 3, 3], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.untie(container)</span>
<span class="sd">        ...     runs = abjad.select.runs(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_)[:-1] for _ in runs]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (3, 8), (4, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r8.</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    [</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    r8.</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    [</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Working with ``denominator``.</span>

<span class="sd">        Reduces terms in tuplet ratio to relative primes when no tuplet command is given:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 2, 3, 4], 16, extra_counts=[1, 1, 2, 2]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/9</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        REGRESSION. Spells tuplet denominator in terms of duration when denominator is</span>
<span class="sd">        given as a duration:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 2, 3, 4], 16, extra_counts=[1, 1, 2, 2]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.denominator(container, (1, 16))</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/9</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/8</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Working with ``diminution``.</span>

<span class="sd">        Makes diminished tuplets when ``diminution`` is true (or when no tuplet command</span>
<span class="sd">        is given):</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1], 16, extra_counts=[0, -1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 1/4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 1/4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 1/4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 1/4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 1/4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 1/4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Forces augmented tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1], 16, extra_counts=[0, -1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.force_augmentation(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 4), (1, 4), (1, 4), (1, 4), (1, 4), (1, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 1/4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 1/4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 1/4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 1/4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 1/4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 1/4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Working with ``trivialize``.</span>

<span class="sd">        Leaves trivializable tuplets as-is when no tuplet command is given. The tuplets</span>
<span class="sd">        in measures 2 and 4 can be written as trivial tuplets, but they are not:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [3, 3, 6, 6], 16, extra_counts=[0, 4]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Rewrites trivializable tuplets as trivial (1:1) tuplets when ``trivialize`` is</span>
<span class="sd">        true:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [3, 3, 6, 6], 16, extra_counts=[0, 4]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.trivialize(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        REGRESSION #907a. Rewrites trivializable tuplets even when tuplets contain</span>
<span class="sd">        multiple ties:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [3, 3, 6, 6], 16, extra_counts=[0, 4]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.trivialize(container)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        REGRESSION #907b. Rewrites trivializable tuplets even when tuplets contain very</span>
<span class="sd">        long ties:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [3, 3, 6, 6], 16, extra_counts=[0, 4]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.trivialize(container)</span>
<span class="sd">        ...     notes = abjad.select.notes(container)[:-1]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Working with ``rewrite_rest_filled``.</span>

<span class="sd">        Makes rest-filled tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [3, 3, -6, -6], 16, extra_counts=[1, 0]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        r16</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        r4</span>
<span class="sd">                        r16</span>
<span class="sd">                        r8.</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        r8.</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        r4.</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Rewrites rest-filled tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [3, 3, -6, -6], 16, extra_counts=[1, 0]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.rewrite_rest_filled(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        r16</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        r2</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        r8.</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        r4.</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        No rest commands:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 2, 3, 4], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Silences every other output division:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 2, 3, 4], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     tuplets = abjad.select.get(tuplets, [1], 2)</span>
<span class="sd">        ...     rmakers.force_rest(tuplets)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.rewrite_rest_filled(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r2</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r2</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Sustains every other output division:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 2, 3, 4], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     tuplets = abjad.select.get(tuplets, [1], 2)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_)[:-1] for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.rewrite_sustained(tuplets)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forces the first leaf and the last two leaves to be rests:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 2, 3, 4], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     leaves = abjad.select.leaves(container)</span>
<span class="sd">        ...     leaves = abjad.select.get(leaves, [0, -2, -1])</span>
<span class="sd">        ...     rmakers.force_rest(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    r8.</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forces rest at first leaf of every tuplet:</span>


<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 2, 3, 4], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, 0) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.force_rest(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    r8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r16</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Spells nonassignable durations with monontonically decreasing durations:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         [5],</span>
<span class="sd">        ...         16,</span>
<span class="sd">        ...         spelling=rmakers.Spelling(increase_monotonic=False),</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 8), (5, 8), (5, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Spells nonassignable durations with monontonically increasing durations:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions,</span>
<span class="sd">        ...         [5],</span>
<span class="sd">        ...         16,</span>
<span class="sd">        ...         spelling=rmakers.Spelling(increase_monotonic=True),</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 8), (5, 8), (5, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 5/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forbids no durations:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 1, 1, 1, 4, 4], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Forbids durations equal to ``1/4`` or greater:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 1, 1, 1, 4, 4], 16,</span>
<span class="sd">        ...         spelling=rmakers.Spelling(forbidden_note_duration=abjad.Duration(1, 4)),</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Rewrites forbidden durations with smaller durations tied together.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Rewrites meter:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [5, 4], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     voice = rmakers.wrap_in_time_signature_staff(nested_music, divisions)</span>
<span class="sd">        ...     rmakers.beam(voice)</span>
<span class="sd">        ...     rmakers.extract_trivial(voice)</span>
<span class="sd">        ...     rmakers.rewrite_meter(voice)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(voice)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 4), (3, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/4</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        No extra counts:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 2, 3, 4], 16,</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Adds one extra count to every other division:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 2, 3, 4], 16, extra_counts=[0, 1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/9</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/9</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Adds two extra counts to every other division:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 2, 3, 4], 16, extra_counts=[0, 2]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        The duration of each added count equals the duration of each count in the</span>
<span class="sd">        rhythm-maker&#39;s input talea.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Removes one count from every other division:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 2, 3, 4], 16, extra_counts=[0, -1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 8/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 8/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Reads talea cyclically:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 2, 3, 4], 16</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (3, 8), (3, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ]</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        **Reading talea once only.** Set ``read_talea_once_only=True`` to</span>
<span class="sd">        ensure talea is long enough to cover all divisions without repeating.</span>
<span class="sd">        Provides way of using talea noncyclically when, for example,</span>
<span class="sd">        interpolating from short durations to long durations:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 2, 3, 4], 16, read_talea_once_only=True</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        Code below raises an exception because talea would need to be read</span>
<span class="sd">        multiple times to handle all divisions:</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (3, 8), (3, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        Exception: CyclicTuple(items=()) + CyclicTuple(items=(1, 2, 3, 4)) is too short to read [6, 6, 6, 6] once.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        **Examples showing state.** Consumes 4 divisions and 31 counts:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions, *, previous_state=None):</span>
<span class="sd">        ...     state = {}</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [4], 16, extra_counts=[0, 1, 2],</span>
<span class="sd">        ...         previous_state=previous_state,</span>
<span class="sd">        ...         state=state,</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music, state</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music, state = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \times 8/9</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; state</span>
<span class="sd">        {&#39;divisions_consumed&#39;: 4, &#39;incomplete_last_note&#39;: True, &#39;logical_ties_produced&#39;: 8, &#39;talea_weight_consumed&#39;: 31}</span>

<span class="sd">        Advances 4 divisions and 31 counts; then consumes another 4 divisions and 31</span>
<span class="sd">        counts:</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music, state = make_rhythm(divisions, previous_state=state)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \times 8/9</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; state</span>
<span class="sd">        {&#39;divisions_consumed&#39;: 8, &#39;incomplete_last_note&#39;: True, &#39;logical_ties_produced&#39;: 16, &#39;talea_weight_consumed&#39;: 63}</span>

<span class="sd">        Advances 8 divisions and 62 counts; then consumes 4 divisions and 31 counts:</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music, state = make_rhythm(divisions, previous_state=state)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;8.</span>
<span class="sd">                    ~</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        &gt;&gt;&gt; state</span>
<span class="sd">        {&#39;divisions_consumed&#39;: 12, &#39;logical_ties_produced&#39;: 24, &#39;talea_weight_consumed&#39;: 96}</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     tag = abjad.Tag(&quot;TALEA_RHYTHM_MAKER&quot;)</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [1, 2, 3, 4], 16, extra_counts=[0, 1], tag=tag</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container, tag=tag)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score, tags=True)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        [</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        ]</span>
<span class="sd">                    %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                    }</span>
<span class="sd">                    %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                    \times 8/9</span>
<span class="sd">                    %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        [</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                    }</span>
<span class="sd">                    %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                    %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                    }</span>
<span class="sd">                    %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                    \times 8/9</span>
<span class="sd">                    %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        [</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        ]</span>
<span class="sd">                        %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    %! TALEA_RHYTHM_MAKER</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Working with ``preamble``.</span>

<span class="sd">        Preamble less than total duration:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [8, -4, 8], 32, preamble=[1, 1, 1, 1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;32</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;32</span>
<span class="sd">                    c&#39;32</span>
<span class="sd">                    c&#39;32</span>
<span class="sd">                    ]</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    r8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    r8</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Preamble more than total duration; ignores counts:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [8, -4, 8], 32, preamble=[32, 32, 32, 32]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;2</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Working with ``end_counts``.</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [8, -4, 8], 32, end_counts=[1, 1, 1, 1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    r8</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    r8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    r8</span>
<span class="sd">                    c&#39;32</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;32</span>
<span class="sd">                    c&#39;32</span>
<span class="sd">                    c&#39;32</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        REGRESSION. End counts leave 5-durated tie in tact:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.talea(</span>
<span class="sd">        ...         divisions, [6], 16, end_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4.</span>
<span class="sd">                    \time 3/8</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;16</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">talea</span> <span class="o">=</span> <span class="n">Talea</span><span class="p">(</span>
        <span class="n">counts</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span>
        <span class="n">denominator</span><span class="o">=</span><span class="n">denominator</span><span class="p">,</span>
        <span class="n">end_counts</span><span class="o">=</span><span class="n">end_counts</span><span class="p">,</span>
        <span class="n">preamble</span><span class="o">=</span><span class="n">preamble</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">talea</span> <span class="o">=</span> <span class="n">talea</span><span class="o">.</span><span class="n">advance</span><span class="p">(</span><span class="n">advance</span><span class="p">)</span>
    <span class="n">previous_state</span> <span class="o">=</span> <span class="n">previous_state</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">_make_talea_rhythm_maker_music</span><span class="p">(</span>
        <span class="n">divisions</span><span class="p">,</span>
        <span class="n">extra_counts</span><span class="p">,</span>
        <span class="n">previous_state</span><span class="p">,</span>
        <span class="n">read_talea_once_only</span><span class="p">,</span>
        <span class="n">spelling</span><span class="p">,</span>
        <span class="n">state</span><span class="p">,</span>
        <span class="n">talea</span><span class="p">,</span>
        <span class="n">tag</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">voice</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">(</span><span class="n">tuplets</span><span class="p">)</span>
    <span class="n">logical_ties_produced</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">logical_ties</span><span class="p">(</span><span class="n">voice</span><span class="p">))</span>
    <span class="n">new_state</span> <span class="o">=</span> <span class="n">_make_state_dictionary</span><span class="p">(</span>
        <span class="n">divisions_consumed</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">divisions</span><span class="p">),</span>
        <span class="n">logical_ties_produced</span><span class="o">=</span><span class="n">logical_ties_produced</span><span class="p">,</span>
        <span class="n">previous_divisions_consumed</span><span class="o">=</span><span class="n">previous_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;divisions_consumed&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">previous_incomplete_last_note</span><span class="o">=</span><span class="n">previous_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;incomplete_last_note&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">previous_logical_ties_produced</span><span class="o">=</span><span class="n">previous_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;logical_ties_produced&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">tuplets</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">eject_contents</span><span class="p">(</span><span class="n">voice</span><span class="p">)</span>
    <span class="n">state</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">state</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_state</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tuplets</span></div>


<div class="viewcode-block" id="tie"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.tie">[docs]</a><span class="k">def</span> <span class="nf">tie</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attaches one tie to each notes in ``argument``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        TIE-CONSECUTIVE-NOTES RECIPE. Attaches ties notes in selection:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8], extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = abjad.select.notes(container)[5:15]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        TIE-ACROSS-DIVISIONS RECIPE. Attaches ties to last note in nonlast tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8], extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     notes = [abjad.select.note(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        With pattern:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8], extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     tuplets = abjad.select.get(tuplets, [0], 2)</span>
<span class="sd">        ...     notes = [abjad.select.note(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        TIE-ACROSS-DIVISIONS RECIPE:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(divisions, [(5, 2)])</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     notes = [abjad.select.note(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 8), (4, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/7</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        TIE-WITHIN-DIVISIONS RECIPE:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8], extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_)[:-1] for _ in tuplets]</span>
<span class="sd">        ...     rmakers.untie(notes)</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        With pattern:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8], extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     tuplets = abjad.select.get(tuplets, [0], 2)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_)[:-1] for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">notes</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">tie</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">()</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">tie</span><span class="p">,</span> <span class="n">note</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span></div>


<div class="viewcode-block" id="tremolo_container"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.tremolo_container">[docs]</a><span class="k">def</span> <span class="nf">tremolo_container</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Replaces each note in ``argument`` with a tremolo container.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Repeats figures two times each:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(divisions, [4])</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_) for _ in tuplets]</span>
<span class="sd">        ...     groups = [abjad.select.get(_, [0, -1]) for _ in notes]</span>
<span class="sd">        ...     rmakers.tremolo_container(groups, 2)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; containers = abjad.select.components(music, abjad.TremoloContainer)</span>
<span class="sd">        &gt;&gt;&gt; result = [abjad.slur(_) for _ in containers]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \repeat tremolo 2 {</span>
<span class="sd">                        \time 4/4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        (</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        )</span>
<span class="sd">                    }</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \repeat tremolo 2 {</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        (</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        )</span>
<span class="sd">                    }</span>
<span class="sd">                    \repeat tremolo 2 {</span>
<span class="sd">                        \time 3/4</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        (</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        )</span>
<span class="sd">                    }</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \repeat tremolo 2 {</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        (</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        )</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        Repeats figures four times each:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(divisions, [4])</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     notes = [abjad.select.notes(_) for _ in tuplets]</span>
<span class="sd">        ...     groups = [abjad.select.get(_, [0, -1]) for _ in notes]</span>
<span class="sd">        ...     rmakers.tremolo_container(groups, 4)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(4, 4), (3, 4)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; containers = abjad.select.components(music, abjad.TremoloContainer)</span>
<span class="sd">        &gt;&gt;&gt; result = [abjad.slur(_) for _ in containers]</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \repeat tremolo 4 {</span>
<span class="sd">                        \time 4/4</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        (</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        )</span>
<span class="sd">                    }</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \repeat tremolo 4 {</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        (</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        )</span>
<span class="sd">                    }</span>
<span class="sd">                    \repeat tremolo 4 {</span>
<span class="sd">                        \time 3/4</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        (</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        )</span>
<span class="sd">                    }</span>
<span class="sd">                    c&#39;4</span>
<span class="sd">                    \repeat tremolo 4 {</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        (</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        )</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">notes</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">container_duration</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">written_duration</span>
        <span class="n">note_duration</span> <span class="o">=</span> <span class="n">container_duration</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">count</span><span class="p">)</span>
        <span class="n">left_note</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="s2">&quot;c&#39;&quot;</span><span class="p">,</span> <span class="n">note_duration</span><span class="p">)</span>
        <span class="n">right_note</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="s2">&quot;c&#39;&quot;</span><span class="p">,</span> <span class="n">note_duration</span><span class="p">)</span>
        <span class="n">container</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">TremoloContainer</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="p">[</span><span class="n">left_note</span><span class="p">,</span> <span class="n">right_note</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span></div>


<div class="viewcode-block" id="trivialize"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.trivialize">[docs]</a><span class="k">def</span> <span class="nf">trivialize</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Trivializes each tuplet in ``argument``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tuplet</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">tuplets</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">tuplet</span><span class="o">.</span><span class="n">trivialize</span><span class="p">()</span></div>


<div class="viewcode-block" id="tuplet"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.tuplet">[docs]</a><span class="k">def</span> <span class="nf">tuplet</span><span class="p">(</span>
    <span class="n">divisions</span><span class="p">,</span>
    <span class="n">tuplet_ratios</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Ratio</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="c1"># TODO: is &#39;denominator&#39; unused?</span>
    <span class="c1"># TODO: remove in favor of dedicated denominator control commands:</span>
    <span class="n">denominator</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="c1"># TODO: is &#39;spelling&#39; unused?</span>
    <span class="n">spelling</span><span class="p">:</span> <span class="n">Spelling</span> <span class="o">=</span> <span class="n">Spelling</span><span class="p">(),</span>
    <span class="n">tag</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Tag</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tuplet</span><span class="p">]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes one tuplet for each division in ``divisions``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes tuplets with ``3:2`` ratios:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(3, 2)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 2), (3, 8), (5, 16), (5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 1/2</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes tuplets with alternating ``1:-1`` and ``3:1`` ratios:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1, -1), (3, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 2), (3, 8), (5, 16), (5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 1/2</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        r4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 5/6</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        r8.</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 5/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Beams each division:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1, 1, 1, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 8), (3, 8), (6, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 5/6</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Beams each division:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1, 1, 1, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 8), (3, 8), (6, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 5/6</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Beams tuplets together:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1, 1, 2, 1, 1), (3, 1, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     rmakers.beam_groups(tuplets)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(5, 8), (3, 8), (6, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 5/9</span>
<span class="sd">                    {</span>
<span class="sd">                        \set stemLeftBeamCount = 0</span>
<span class="sd">                        \set stemRightBeamCount = 1</span>
<span class="sd">                        \time 5/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        \set stemLeftBeamCount = 1</span>
<span class="sd">                        \set stemRightBeamCount = 0</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        \set stemLeftBeamCount = 0</span>
<span class="sd">                        \set stemRightBeamCount = 1</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        \set stemLeftBeamCount = 1</span>
<span class="sd">                        \set stemRightBeamCount = 0</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        \set stemLeftBeamCount = 0</span>
<span class="sd">                        \set stemRightBeamCount = 1</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        \set stemLeftBeamCount = 1</span>
<span class="sd">                        \set stemRightBeamCount = 1</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \set stemLeftBeamCount = 1</span>
<span class="sd">                        \set stemRightBeamCount = 1</span>
<span class="sd">                        \time 6/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \set stemLeftBeamCount = 1</span>
<span class="sd">                        \set stemRightBeamCount = 0</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        \set stemLeftBeamCount = 0</span>
<span class="sd">                        \set stemRightBeamCount = 1</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        \set stemLeftBeamCount = 1</span>
<span class="sd">                        \set stemRightBeamCount = 0</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        \set stemLeftBeamCount = 0</span>
<span class="sd">                        \set stemRightBeamCount = 1</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        \set stemLeftBeamCount = 1</span>
<span class="sd">                        \set stemRightBeamCount = 0</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Ties nothing:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(2, 3), (1, -2, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 2), (3, 8), (5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 1/2</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                        r8.</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Ties across all divisions:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(2, 3), (1, -2, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 2), (3, 8), (5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 1/2</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                        r8.</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Ties across every other division:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(2, 3), (1, -2, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     tuplets = abjad.select.get(tuplets, [0], 2)</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 2), (3, 8), (5, 16), (5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 1/2</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                        r8.</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 5/6</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                        r8.</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes diminished tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(2, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.force_diminution(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (2, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes augmented tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(2, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.force_augmentation(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (2, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 4/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes diminished tuplets and does not rewrite dots:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.force_diminution(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (3, 8), (7, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/16</span>
<span class="sd">                        c&#39;8..</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8..</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes diminished tuplets and rewrites dots:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     rmakers.force_diminution(container)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (3, 8), (7, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 7/8</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes augmented tuplets and does not rewrite dots:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.force_augmentation(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (3, 8), (7, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/16</span>
<span class="sd">                        c&#39;8..</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8..</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes augmented tuplets and rewrites dots:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     rmakers.force_augmentation(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (3, 8), (7, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/2</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 7/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 7/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Leaves trivializable tuplets as-is when ``trivialize`` is false:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(3, -2), (1,), (-2, 3), (1, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (3, 8), (3, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        r4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/2</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        r4</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/2</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Rewrites trivializable tuplets when ``trivialize`` is true. Measures 2 and 4</span>
<span class="sd">        contain trivial tuplets with 1:1 ratios. To remove these trivial tuplets, set</span>
<span class="sd">        ``extract_trivial`` as shown in the next example:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(3, -2), (1,), (-2, 3), (1, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.trivialize(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (3, 8), (3, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        r4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        r4</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        REGRESSION: Ignores ``trivialize`` and respects ``rewrite_dots`` when both are</span>
<span class="sd">        true. Measures 2 and 4 are first rewritten as trivial but then supplied again</span>
<span class="sd">        with nontrivial prolation when removing dots. The result is that measures 2 and 4</span>
<span class="sd">        carry nontrivial prolation with no dots:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(3, -2), (1,), (-2, 3), (1, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.trivialize(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (3, 8), (3, 8), (3, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        r4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/2</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        r4</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/2</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Leaves trivial tuplets as-is when ``extract_trivial`` is false:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(2, 3), (1, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (2, 8), (3, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Extracts trivial tuplets when ``extract_trivial`` is true. Measures 2 and 4 in</span>
<span class="sd">        the example below now contain only a flat list of notes:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(2, 3), (1, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)[:-1]</span>
<span class="sd">        ...     leaves = [abjad.select.leaf(_, -1) for _ in tuplets]</span>
<span class="sd">        ...     rmakers.tie(leaves)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (2, 8), (3, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">        .. note:: Flattening trivial tuplets makes it possible</span>
<span class="sd">            subsequently to rewrite the meter of the untupletted notes.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        REGRESSION: Very long ties are preserved when ``extract_trivial`` is true:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(2, 3), (1, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     notes = abjad.select.notes(container)[:-1]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (2, 8), (3, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                    ~</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 2/8</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    [</span>
<span class="sd">                    ~</span>
<span class="sd">                    c&#39;8</span>
<span class="sd">                    ]</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Masks every other output division:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(4, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     tuplets = abjad.select.tuplets(container)</span>
<span class="sd">        ...     tuplets = abjad.select.get(tuplets, [1], 2)</span>
<span class="sd">        ...     rmakers.force_rest(tuplets)</span>
<span class="sd">        ...     rmakers.rewrite_rest_filled(container)</span>
<span class="sd">        ...     rmakers.extract_trivial(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(3, 8), (4, 8), (3, 8), (4, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r2</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        c&#39;16.</span>
<span class="sd">                    }</span>
<span class="sd">                    \time 4/8</span>
<span class="sd">                    r2</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>


<span class="sd">    ..  container:: example</span>

<span class="sd">        Tuplet numerators and denominators are reduced to numbers that are relatively</span>
<span class="sd">        prime when ``denominator`` is set to none. This means that ratios like</span>
<span class="sd">        ``6:4`` and ``10:8`` do not arise:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1, 4)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/16</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 8/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        The preferred denominator of each tuplet is set in terms of a unit duration</span>
<span class="sd">        when ``denominator`` is set to a duration. The setting does not affect the</span>
<span class="sd">        first tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1, 4)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     rmakers.denominator(container, (1, 16))</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/16</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 8/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Sets the preferred denominator of each tuplet in terms 32nd notes. The</span>
<span class="sd">        setting affects all tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1, 4)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     rmakers.denominator(container, (1, 32))</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/16</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 12/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 16/20</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 8/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Sets the preferred denominator each tuplet in terms 64th notes. The setting</span>
<span class="sd">        affects all tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1, 4)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     rmakers.denominator(container, (1, 64))</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 8/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/16</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 16/20</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 24/20</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 32/40</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 8/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        The preferred denominator of each tuplet is set directly when ``denominator``</span>
<span class="sd">        is set to a positive integer. This example sets the preferred denominator of</span>
<span class="sd">        each tuplet to ``8``. Setting does not affect the third tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1, 4)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     rmakers.denominator(container, 8)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 8/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/16</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 8/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 8/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Sets the preferred denominator of each tuplet to ``12``. Setting affects all</span>
<span class="sd">        tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1, 4)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     rmakers.denominator(container, 12)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 12/15</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/16</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 12/15</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 12/10</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 12/15</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 8/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Sets the preferred denominator of each tuplet to ``13``. Setting does not</span>
<span class="sd">        affect any tuplet:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1, 4)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     rmakers.rewrite_dots(container)</span>
<span class="sd">        ...     rmakers.denominator(container, 13)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 16), (4, 16), (6, 16), (8, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/16</span>
<span class="sd">                        c&#39;32</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 4/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 6/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 6/16</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 8/16</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;2</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     tag = abjad.Tag(&quot;TUPLET_RHYTHM_MAKER&quot;)</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(3, 2)], tag=tag</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container, tag=tag)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 2), (3, 8), (5, 16), (5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score, tags=True)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 1/2</span>
<span class="sd">                        %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                    }</span>
<span class="sd">                    %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                    }</span>
<span class="sd">                    %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                        [</span>
<span class="sd">                        %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                        ]</span>
<span class="sd">                    %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                    }</span>
<span class="sd">                    %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                        [</span>
<span class="sd">                        %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                        ]</span>
<span class="sd">                    %! TUPLET_RHYTHM_MAKER</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes tuplets with ``3:2`` ratios:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(3, 2)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 2), (3, 8), (5, 16), (5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 1/2</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/5</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes tuplets with alternating ``1:-1`` and ``3:1`` ratios:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1, -1), (3, 1)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 2), (3, 8), (5, 16), (5, 16)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 1/2</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                        r4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 3/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 3/8</span>
<span class="sd">                        c&#39;4.</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 5/6</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        r8.</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 5/4</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 5/16</span>
<span class="sd">                        c&#39;8.</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;16</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Makes length-1 tuplets:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.tuplet(</span>
<span class="sd">        ...         divisions, [(1,)]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(1, 5), (1, 4), (1, 6), (7, 9)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \tweak edge-height #&#39;(0.7 . 0)</span>
<span class="sd">                    \times 4/5</span>
<span class="sd">                    {</span>
<span class="sd">                        #(ly:expect-warning &quot;strange time signature found&quot;)</span>
<span class="sd">                        \time 1/5</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak text #tuplet-number::calc-fraction-text</span>
<span class="sd">                    \times 1/1</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 1/4</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak edge-height #&#39;(0.7 . 0)</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        #(ly:expect-warning &quot;strange time signature found&quot;)</span>
<span class="sd">                        \time 1/6</span>
<span class="sd">                        c&#39;4</span>
<span class="sd">                    }</span>
<span class="sd">                    \tweak edge-height #&#39;(0.7 . 0)</span>
<span class="sd">                    \times 8/9</span>
<span class="sd">                    {</span>
<span class="sd">                        #(ly:expect-warning &quot;strange time signature found&quot;)</span>
<span class="sd">                        \time 7/9</span>
<span class="sd">                        c&#39;2..</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tuplet_ratios_</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Ratio</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tuplet_ratios</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">_make_tuplet_rhythm_maker_music</span><span class="p">(</span>
        <span class="n">divisions</span><span class="p">,</span>
        <span class="n">tuplet_ratios_</span><span class="p">,</span>
        <span class="c1"># denominator=denominator,</span>
        <span class="c1"># spelling=spelling,</span>
        <span class="n">self_tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="unbeam"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.unbeam">[docs]</a><span class="k">def</span> <span class="nf">unbeam</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Unbeams each leaf in ``argument``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">:</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">BeamCount</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">StartBeam</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">StopBeam</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span></div>


<div class="viewcode-block" id="untie"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.untie">[docs]</a><span class="k">def</span> <span class="nf">untie</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deatches ties from each leaf in ``argument``.</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Attaches ties to nonlast notes; then detaches ties from select notes:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8], extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     notes = abjad.select.notes(container)[:-1]</span>
<span class="sd">        ...     rmakers.tie(notes)</span>
<span class="sd">        ...     notes = abjad.select.notes(container)</span>
<span class="sd">        ...     notes = abjad.select.get(notes, [0], 4)</span>
<span class="sd">        ...     rmakers.untie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        ~</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        ~</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    ..  container:: example</span>

<span class="sd">        Attaches repeat-ties to nonfirst notes; then detaches ties from select notes:</span>

<span class="sd">        &gt;&gt;&gt; def make_rhythm(divisions):</span>
<span class="sd">        ...     nested_music = rmakers.even_division(</span>
<span class="sd">        ...         divisions, [8], extra_counts=[1]</span>
<span class="sd">        ...     )</span>
<span class="sd">        ...     container = abjad.Container(nested_music)</span>
<span class="sd">        ...     notes = abjad.select.notes(container)[1:]</span>
<span class="sd">        ...     rmakers.repeat_tie(notes)</span>
<span class="sd">        ...     notes = abjad.select.notes(container)</span>
<span class="sd">        ...     notes = abjad.select.get(notes, [0], 4)</span>
<span class="sd">        ...     rmakers.untie(notes)</span>
<span class="sd">        ...     rmakers.beam(container)</span>
<span class="sd">        ...     music = abjad.mutate.eject_contents(container)</span>
<span class="sd">        ...     return music</span>

<span class="sd">        &gt;&gt;&gt; divisions = [(2, 8), (2, 8), (2, 8), (2, 8), (2, 8), (2, 8)]</span>
<span class="sd">        &gt;&gt;&gt; music = make_rhythm(divisions)</span>
<span class="sd">        &gt;&gt;&gt; lilypond_file = rmakers.example(music, divisions)</span>
<span class="sd">        &gt;&gt;&gt; abjad.show(lilypond_file) # doctest: +SKIP</span>

<span class="sd">        ..  docs::</span>

<span class="sd">            &gt;&gt;&gt; score = lilypond_file[&quot;Score&quot;]</span>
<span class="sd">            &gt;&gt;&gt; string = abjad.lilypond(score)</span>
<span class="sd">            &gt;&gt;&gt; print(string)</span>
<span class="sd">            \context Score = &quot;Score&quot;</span>
<span class="sd">            &lt;&lt;</span>
<span class="sd">                \context RhythmicStaff = &quot;Staff&quot;</span>
<span class="sd">                \with</span>
<span class="sd">                {</span>
<span class="sd">                    \override Clef.stencil = ##f</span>
<span class="sd">                }</span>
<span class="sd">                {</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                    }</span>
<span class="sd">                    \times 2/3</span>
<span class="sd">                    {</span>
<span class="sd">                        \time 2/8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        [</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        c&#39;8</span>
<span class="sd">                        ]</span>
<span class="sd">                        \repeatTie</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">            &gt;&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">Tie</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span>
        <span class="n">abjad</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="n">abjad</span><span class="o">.</span><span class="n">RepeatTie</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span></div>


<div class="viewcode-block" id="wrap_in_time_signature_staff"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.wrap_in_time_signature_staff">[docs]</a><span class="k">def</span> <span class="nf">wrap_in_time_signature_staff</span><span class="p">(</span><span class="n">music</span><span class="p">,</span> <span class="n">divisions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes staff with two voices: one voice for ``music`` and another voice</span>
<span class="sd">    with time signatures (equal to divisions).</span>

<span class="sd">    See ``rmakers.rewrite_meter()`` for examples of this function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">music</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">music</span><span class="p">,</span> <span class="n">depth</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Component</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">music</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">music</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">music</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">music</span><span class="p">)</span>
    <span class="n">time_signatures</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">TimeSignature</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">divisions</span><span class="p">]</span>
    <span class="n">staff</span> <span class="o">=</span> <span class="n">_make_time_signature_staff</span><span class="p">(</span><span class="n">time_signatures</span><span class="p">)</span>
    <span class="n">music_voice</span> <span class="o">=</span> <span class="n">staff</span><span class="p">[</span><span class="s2">&quot;RhythmMaker.Music&quot;</span><span class="p">]</span>
    <span class="n">music_voice</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">music</span><span class="p">)</span>
    <span class="n">_validate_tuplets</span><span class="p">(</span><span class="n">music_voice</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">music_voice</span></div>


<div class="viewcode-block" id="written_duration"><a class="viewcode-back" href="../../../api/abjadext/rmakers/rmakers.html#abjadext.rmakers.rmakers.written_duration">[docs]</a><span class="k">def</span> <span class="nf">written_duration</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="n">abjad</span><span class="o">.</span><span class="n">typings</span><span class="o">.</span><span class="n">Duration</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets written duration of each leaf in ``argument`` to ``duration``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">duration_</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Duration</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
    <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">:</span>
        <span class="n">old_duration</span> <span class="o">=</span> <span class="n">leaf</span><span class="o">.</span><span class="n">written_duration</span>
        <span class="k">if</span> <span class="n">duration_</span> <span class="o">==</span> <span class="n">old_duration</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">leaf</span><span class="o">.</span><span class="n">written_duration</span> <span class="o">=</span> <span class="n">duration_</span>
        <span class="n">multiplier</span> <span class="o">=</span> <span class="n">old_duration</span> <span class="o">/</span> <span class="n">duration_</span>
        <span class="n">leaf</span><span class="o">.</span><span class="n">multiplier</span> <span class="o">=</span> <span class="n">multiplier</span></div>
</pre></div>

    </div>
    
    </div>
    

<footer>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>

</div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>