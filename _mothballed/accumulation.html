

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Accumulation, of cells &mdash; Abjad 3.23 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/abjad.css?v=1f187528" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/uqbar.css?v=e6773f5c" />
      <link rel="stylesheet" type="text/css" href="../_static/lightbox2/css/lightbox.css?v=d2ef71d2" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="canonical" href="https://abjad.github.io_mothballed/accumulation.html"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=01f62dc6"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/ga.js?v=c455bbd5"></script>
      <script src="../_static/toggleprompt.js?v=5801b3bb"></script>
      <script defer="defer" src="../_static/lightbox2/js/lightbox.js?v=bc25c2e6"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #332211" >


    <a href="../index.html" class="icon icon-home" alt="Documentation
    Home"> Abjad 3.23



</a>




<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">First steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../first_steps/audience.html">Audience</a></li>
<li class="toctree-l1"><a class="reference internal" href="../first_steps/macos.html">macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../first_steps/linux.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../first_steps/windows.html">Windows</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/containers-basic-operations-on.html">Containers, basic operations on</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/containers-retrieving-by-name.html">Containers, retrieving by name</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/containers-time-interpretation-of.html">Containers, time interpretation of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/contexts-lilypond-type-of.html">Contexts, LilyPond type of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/indicators.html">Indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/lilypond-files-preamble-of.html">LilyPond files, preamble of</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/lilypond-format-of-abjad-objects.html">LilyPond format, of Abjad objects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/corpus-selection.html">Corpus, figure selection from</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/design-by-dyads.html">Design, by dyads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/enumeration.html">Enumeration, of rhythmic cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/magic-square-from-twelve-tone-row.html">Magic square, from twelve-tone row</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/scales-diatonic.html">Scales, diatonic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/score-fragment-piano.html">Score fragment, piano</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All classes &amp; functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Abjad API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendices/best-practices.html">Best practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/changes.html">Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/developer-installation.html">Developer installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/lilypond-context-concatenation.html">LilyPond context concatenation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/publications.html">Publications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Score gallery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gallery-2020.html">2016-present</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery-2015.html">2015-11</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery-2010.html">2010-00</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #332211" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Abjad</a>
      </nav>

      <div class="wy-nav-content">

<div class="rst-content style-external-links">

    


    <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
    <div itemprop="articleBody">
    
  <section id="accumulation-of-cells">
<h1>Accumulation, of cells<a class="headerlink" href="#accumulation-of-cells" title="Link to this heading"></a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
</pre></div>
</div>
<p>This example demonstrates one way of modeling composition as an accumulation of musical
cells. The piece that concerns us here is “Désordre” (1986) from the first book of György
Ligeti’s piano etudes. We’ll model the first two systems of the score. We model each cell
as two voices inside a simultaneous container. The top voice will hold the octave. The
lower voice will hold the eighth-note run:</p>
<p>The functions we’ll use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">make_cell</span><span class="p">(</span><span class="n">pitches</span><span class="p">,</span> <span class="n">hand</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">pitches</span> <span class="o">=</span> <span class="n">pitches</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">notes</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">pitch</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="k">for</span> <span class="n">pitch</span> <span class="ow">in</span> <span class="n">pitches</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">rh_lower_voice</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">(</span><span class="n">notes</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hand</span><span class="si">}</span><span class="s2">_Lower_Voice&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">abjad</span><span class="o">.</span><span class="n">beam</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">abjad</span><span class="o">.</span><span class="n">slur</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">dynamic</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Dynamic</span><span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">dynamic</span><span class="p">,</span> <span class="n">notes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">... </span>    <span class="n">dynamic</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Dynamic</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">dynamic</span><span class="p">,</span> <span class="n">notes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">... </span>    <span class="n">command</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">VoiceNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">notes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">... </span>    <span class="n">numerator</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pitches</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">duration</span> <span class="o">=</span> <span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">lower_pitch</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">NamedPitch</span><span class="p">(</span><span class="n">pitches</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">... </span>    <span class="n">upper_pitch</span> <span class="o">=</span> <span class="n">lower_pitch</span> <span class="o">+</span> <span class="n">abjad</span><span class="o">.</span><span class="n">NamedInterval</span><span class="p">(</span><span class="s2">&quot;P8&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">octave_pitches</span> <span class="o">=</span> <span class="p">[</span><span class="n">lower_pitch</span><span class="p">,</span> <span class="n">upper_pitch</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">chord</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Chord</span><span class="p">(</span><span class="n">octave_pitches</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">articulation</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Articulation</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">articulation</span><span class="p">,</span> <span class="n">chord</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">command</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">VoiceNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">chord</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">rh_upper_voice</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">([</span><span class="n">chord</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hand</span><span class="si">}</span><span class="s2">_Upper_Voice&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">voices</span> <span class="o">=</span> <span class="p">[</span><span class="n">rh_lower_voice</span><span class="p">,</span> <span class="n">rh_upper_voice</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">container</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">voices</span><span class="p">,</span> <span class="n">simultaneous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">rh_lower_voice</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
<span class="gp">... </span>        <span class="n">bar_line</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">BarLine</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">bar_line</span><span class="p">,</span> <span class="n">leaf</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">container</span>
<span class="gp">... </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">make_measure</span><span class="p">(</span><span class="n">pitches</span><span class="p">,</span> <span class="n">hand</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">measure</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Container</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">duration</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">... </span>    <span class="n">sublists</span> <span class="o">=</span> <span class="n">pitches</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">sublists</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">container</span> <span class="o">=</span> <span class="n">make_cell</span><span class="p">(</span><span class="n">sublist</span><span class="p">,</span> <span class="n">hand</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">duration</span> <span class="o">+=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">measure</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">pair</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">with_denominator</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">time_signature</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">TimeSignature</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">first_note</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">note</span><span class="p">(</span><span class="n">measure</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">time_signature</span><span class="p">,</span> <span class="n">first_note</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">measure</span>
<span class="gp">... </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">make_staff</span><span class="p">(</span><span class="n">pitches</span><span class="p">,</span> <span class="n">hand</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">staff</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Staff</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hand</span><span class="si">}</span><span class="s2">_Staff&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">pitches</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">measure</span> <span class="o">=</span> <span class="n">make_measure</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">hand</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">staff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">measure</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">staff</span>
<span class="gp">... </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">make_score</span><span class="p">(</span><span class="n">rh_pitches</span><span class="p">,</span> <span class="n">lh_pitches</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">rh_staff</span> <span class="o">=</span> <span class="n">make_staff</span><span class="p">(</span><span class="n">rh_pitches</span><span class="p">,</span> <span class="s2">&quot;RH&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">lh_staff</span> <span class="o">=</span> <span class="n">make_staff</span><span class="p">(</span><span class="n">lh_pitches</span><span class="p">,</span> <span class="s2">&quot;LH&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">leaves</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">lh_staff</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">abjad</span><span class="o">.</span><span class="n">iterpitches</span><span class="o">.</span><span class="n">respell_with_sharps</span><span class="p">(</span><span class="n">leaves</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">staves</span> <span class="o">=</span> <span class="p">[</span><span class="n">rh_staff</span><span class="p">,</span> <span class="n">lh_staff</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">piano_staff</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">StaffGroup</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">staves</span><span class="p">,</span> <span class="n">lilypond_type</span><span class="o">=</span><span class="s2">&quot;PianoStaff&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Piano_Staff&quot;</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span>    <span class="n">score</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Score</span><span class="p">([</span><span class="n">piano_staff</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Score&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">first_note</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">note</span><span class="p">(</span><span class="n">lh_staff</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">clef</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Clef</span><span class="p">(</span><span class="s2">&quot;bass&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">clef</span><span class="p">,</span> <span class="n">first_note</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">key_signature</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">KeySignature</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">abjad</span><span class="o">.</span><span class="n">NamedPitchClass</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">),</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Mode</span><span class="p">(</span><span class="s2">&quot;major&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span>    <span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">key_signature</span><span class="p">,</span> <span class="n">first_note</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">score</span>
<span class="gp">... </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">preamble</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;#(set-default-paper-size &quot;a4&quot; &#39;letter)</span>
<span class="gp">... </span><span class="s2">#(set-global-staff-size 10)</span>
<span class="gp">... </span>
<span class="gp">... </span><span class="s2">\layout {</span>
<span class="gp">... </span><span class="s2">    indent = #0</span>
<span class="gp">... </span><span class="s2">    ragged-right = ##t</span>
<span class="gp">... </span><span class="s2">    merge-differently-dotted = ##t</span>
<span class="gp">... </span><span class="s2">    merge-differently-headed = ##t</span>
<span class="gp">... </span><span class="s2">    \context {</span>
<span class="gp">... </span><span class="s2">        \Score</span>
<span class="gp">... </span><span class="s2">        \remove Bar_number_engraver</span>
<span class="gp">... </span><span class="s2">        \remove Default_bar_line_engraver</span>
<span class="gp">... </span><span class="s2">        \remove Timing_translator</span>
<span class="gp">... </span><span class="s2">        \override Beam.breakable = ##t</span>
<span class="gp">... </span><span class="s2">        \override Glissando.breakable = ##t</span>
<span class="gp">... </span><span class="s2">        \override NoteColumn.ignore-collision = ##t</span>
<span class="gp">... </span><span class="s2">        \override SpacingSpanner.uniform-stretching = ##t</span>
<span class="gp">... </span><span class="s2">        \override TextScript.staff-padding = #4</span>
<span class="gp">... </span><span class="s2">        \override TextSpanner.breakable = ##t</span>
<span class="gp">... </span><span class="s2">        \override TimeSignature.stencil = ##f</span>
<span class="gp">... </span><span class="s2">        \override TupletBracket.bracket-visibility = ##t</span>
<span class="gp">... </span><span class="s2">        \override TupletBracket.minimum-length = #3</span>
<span class="gp">... </span><span class="s2">        \override TupletBracket.padding = #2</span>
<span class="gp">... </span><span class="s2">        \override TupletBracket.springs-and-rods = #ly:spanner::set-spacing-rods</span>
<span class="gp">... </span><span class="s2">        \override TupletNumber.text = #tuplet-number::calc-fraction-text</span>
<span class="gp">... </span><span class="s2">        autoBeaming = ##f</span>
<span class="gp">... </span><span class="s2">        proportionalNotationDuration = \musicLength 8</span>
<span class="gp">... </span><span class="s2">        tupletFullLength = ##t</span>
<span class="gp">... </span><span class="s2">    }</span>
<span class="gp">... </span><span class="s2">    \context {</span>
<span class="gp">... </span><span class="s2">        \Staff</span>
<span class="gp">... </span><span class="s2">        \consists Timing_translator</span>
<span class="gp">... </span><span class="s2">        \consists Default_bar_line_engraver</span>
<span class="gp">... </span><span class="s2">        \override TimeSignature.style = #&#39;numbered</span>
<span class="gp">... </span><span class="s2">    }</span>
<span class="gp">... </span><span class="s2">    \context {</span>
<span class="gp">... </span><span class="s2">        \Voice</span>
<span class="gp">... </span><span class="s2">        \remove Forbid_line_break_engraver</span>
<span class="gp">... </span><span class="s2">    }</span>
<span class="gp">... </span><span class="s2">}&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Observe the following characteristics of the cell:</p>
<ol class="arabic simple">
<li><p>Each cell comprises an octave followed by an eighth-note run.</p></li>
<li><p>Octave stems point up while the stems of eighth notes point down.</p></li>
<li><p>All eighth-note runs are beamed and slurred.</p></li>
<li><p>The first note of each cell is marked forte; the following notes are played piano.</p></li>
<li><p>The duration of each cell varies from 3 to 8 eighth notes.</p></li>
</ol>
<p>First the eighth notes. The notes belonging to the eighth note run are first beamed and
slurred. Then we add the dynamics to the first two notes, and finally we put them inside
a Voice. After naming the voice we attach a LilyPond <code class="docutils literal notranslate"><span class="pre">\voiceTwo</span></code> command so that the
stems of the notes point down.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pitches</span> <span class="o">=</span> <span class="s2">&quot;b e&#39; f&#39;&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">notes</span> <span class="o">=</span> <span class="p">[</span><span class="n">abjad</span><span class="o">.</span><span class="n">Note</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">pitches</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rh_lower_voice</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">(</span><span class="n">notes</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;RH_Lower_Voice&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">beam</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">slur</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dynamic</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Dynamic</span><span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">dynamic</span><span class="p">,</span> <span class="n">notes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dynamic</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Dynamic</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">dynamic</span><span class="p">,</span> <span class="n">notes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">command</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">VoiceNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">notes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">rh_lower_voice</span><span class="p">)</span>
</pre></div>
</div>
<div class="uqbar-book">
    <a href="../_images/lilypond-8c30cfbc2d42c233161c4ab2fdf9472f060a60f9ab327c73e454a2d8482f383a.ly"><img src="../_images/lilypond-8c30cfbc2d42c233161c4ab2fdf9472f060a60f9ab327c73e454a2d8482f383a.cropped.svg"/></a>
</div><p>Now we construct the octave. The duration of the chord is half the duration of the
running eighth notes if the duration of the running notes is divisible by two. Otherwise
the duration of the chord is the next integer greater than this half.  We add the
articulation marking and finally add the chord to a voice. We attach a LilyPond
<code class="docutils literal notranslate"><span class="pre">\voiceOne</span></code> command so that the stem of the octave point up:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lower_pitch</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">NamedPitch</span><span class="p">(</span><span class="n">pitches</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">upper_pitch</span> <span class="o">=</span> <span class="n">lower_pitch</span> <span class="o">+</span> <span class="n">abjad</span><span class="o">.</span><span class="n">NamedInterval</span><span class="p">(</span><span class="s2">&quot;P8&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">octave_pitches</span> <span class="o">=</span> <span class="p">[</span><span class="n">lower_pitch</span><span class="p">,</span> <span class="n">upper_pitch</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numerator</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pitches</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">duration</span> <span class="o">=</span> <span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chord</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Chord</span><span class="p">(</span><span class="n">octave_pitches</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">articulation</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Articulation</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">articulation</span><span class="p">,</span> <span class="n">chord</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rh_upper_voice</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Voice</span><span class="p">([</span><span class="n">chord</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;RH_Upper_Voice&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">command</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">VoiceNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">rh_upper_voice</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">rh_upper_voice</span><span class="p">)</span>
</pre></div>
</div>
<div class="uqbar-book">
    <a href="../_images/lilypond-2cbb971542a7e9e8772f8dd921fd7069c881ebe80ffff585cbb9f587beb57c03.ly"><img src="../_images/lilypond-2cbb971542a7e9e8772f8dd921fd7069c881ebe80ffff585cbb9f587beb57c03.cropped.svg"/></a>
</div><p>Finally we combine the two voices in a simultaneous container:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">voices</span> <span class="o">=</span> <span class="p">[</span><span class="n">rh_lower_voice</span><span class="p">,</span> <span class="n">rh_upper_voice</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">container</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="n">voices</span><span class="p">,</span> <span class="n">simultaneous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">staff</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Staff</span><span class="p">([</span><span class="n">container</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;RH_Staff&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">staff</span><span class="p">)</span>
</pre></div>
</div>
<div class="uqbar-book">
    <a href="../_images/lilypond-f6850395e7ec6d880ea2b3f47634c8f9c9e4268de4aa40a05212ebc27434d546.ly"><img src="../_images/lilypond-f6850395e7ec6d880ea2b3f47634c8f9c9e4268de4aa40a05212ebc27434d546.cropped.svg"/></a>
</div><p>Because this cell appears over and over again, we want to reuse this code to generate any
number of these cells. We here encapsulate it in a function that will take only a list of
pitches:</p>
<p>Now we define a function to create a measure from a list of lists of numbers. The
function is very simple. It simply creates a measure and then populates it with
cells that are created internally with the function previously defined. The function
takes pitch input in the form of a list of lists (e.g., <code class="docutils literal notranslate"><span class="pre">[[1,</span> <span class="pre">2,</span> <span class="pre">3],</span> <span class="pre">[2,</span> <span class="pre">3,</span> <span class="pre">4]]</span></code>. The
input is iterated to create each of the cells to be appended to the measure. We
could have defined the function to take ready made cells directly, but we are building
the hierarchy of functions so that we can pass simple lists of lists of numbers to
generate the full structure.  To construct a Ligeti measure we would call the function
like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pitches</span> <span class="o">=</span> <span class="s2">&quot;c&#39; e&#39; g&#39; | c&#39; e&#39; g&#39; a&#39; | e&#39; g&#39; a&#39; c&#39;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">measure</span> <span class="o">=</span> <span class="n">make_measure</span><span class="p">(</span><span class="n">pitches</span><span class="p">,</span> <span class="s2">&quot;RH&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">staff</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Staff</span><span class="p">([</span><span class="n">measure</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;RH_Staff&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">staff</span><span class="p">)</span>
</pre></div>
</div>
<div class="uqbar-book">
    <a href="../_images/lilypond-aac931fbc89a02236b4ab9468828de043c9158b9b9898f809f7a62a05c69e0ca.ly"><img src="../_images/lilypond-aac931fbc89a02236b4ab9468828de043c9158b9b9898f809f7a62a05c69e0ca.cropped.svg"/></a>
</div><p>Now we move up to the next level, the staff. The function again takes a plain list as
argument. The list must be a list of lists (for measures) of lists (for cells) of
pitches. The function simply constructs the Ligeti measures internally by calling our
previously defined function and puts them inside a Staff.  As with measures, we can now
create full measure sequences with this new function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pitches</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;b e&#39; f&#39; | b e&#39; f&#39; g&#39; a&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;c&#39; g&#39; a&#39; | b e&#39; f&#39; g&#39; a&#39;&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">staff</span> <span class="o">=</span> <span class="n">make_staff</span><span class="p">(</span><span class="n">pitches</span><span class="p">,</span> <span class="s2">&quot;RH&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">staff</span><span class="p">)</span>
</pre></div>
</div>
<div class="uqbar-book">
    <a href="../_images/lilypond-3d23e20f8673514e948555086d4d15b4588c4fa96db330a97a2592953cb35e0d.ly"><img src="../_images/lilypond-3d23e20f8673514e948555086d4d15b4588c4fa96db330a97a2592953cb35e0d.cropped.svg"/></a>
</div><p>Finally a function that will generate the score. The function creates a piano staff,
constructs staves with Ligeti music and then appends these to the empty piano staff.
Finally it sets the clef and key signature of the lower staff to match the original
score.  The argument of the function is a list of length 2, depth 3. The first element in
the list corresponds to the upper staff, the second to the lower staff. Now that we have
the redundant aspect of the piece compactly expressed and encapsulated, we can play
around with it by changing the sequence of pitches:</p>
<p>In order for each staff to carry its own sequence of independent measure changes,
LilyPond requires some special setup prior to rendering. Specifically, one must move the
LilyPond <code class="docutils literal notranslate"><span class="pre">Timing_translator</span></code> out from the score context and into the staff context.
(You can refer to the LilyPond documentation on <a class="reference external" href="http://lilypond.org/doc/v2.12/Documentation/user/lilypond/Displaying-rhythms#Polymetric-notation">Polymetric notation</a>
to learn all about how this works. In this example we defined a custom function to set up
our LilyPond file automatically.</p>
<p>The final result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rh_pitches</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="s2">&quot;b e&#39; f&#39; | b e&#39; f&#39; g&#39; a&#39;&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;c&#39; g&#39; a&#39; | b e&#39; f&#39; g&#39; a&#39;&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;d&#39; e&#39; f&#39; g&#39; a&#39; | c&#39; f&#39; g&#39;&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;a b c&#39; d&#39; e&#39; f&#39; g&#39;&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;a d&#39; e&#39; | a d&#39; e&#39; f&#39; g&#39;&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;d&#39; f&#39; g&#39; | a a&#39; b&#39; c&#39;&#39; d&#39;&#39;&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;e&#39; f&#39; g&#39; a&#39; b&#39; | d&#39; e&#39; f&#39;&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;g e&#39;&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lh_pitches</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="s2">&quot;ds gs as | ds gs as cs&#39; ds&#39;&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;fs as cs&#39; | ds gs as cs&#39; ds&#39;&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;gs as cs&#39; ds&#39; fs&#39; | gs as cs&#39;&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;ds fs gs as cs&#39; ds&#39; fs&#39; cs&#39;&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;fs as cs&#39; | fs as cs&#39; ds&#39; as&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;gs cs&#39; ds&#39; | fs ds&#39; fs&#39; fs gs&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;as, cs ds fs gs | as, cs ds&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score</span> <span class="o">=</span> <span class="n">make_score</span><span class="p">(</span><span class="n">rh_pitches</span><span class="p">,</span> <span class="n">lh_pitches</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lilypond_file</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">LilyPondFile</span><span class="p">([</span><span class="n">preamble</span><span class="p">,</span> <span class="n">score</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">lilypond_file</span><span class="p">)</span>
</pre></div>
</div>
<div class="uqbar-book">
    <a href="../_images/lilypond-b3622043c92cc9e8be194bd45f3f3d6f78a0bfdfd4b5f00818b22bc093588043.ly"><img src="../_images/lilypond-b3622043c92cc9e8be194bd45f3f3d6f78a0bfdfd4b5f00818b22bc093588043.cropped.svg"/></a>
</div><p><span class="author">[Adán (2.0), Bača (3.2)]</span></p>
</section>


    </div>
    
    </div>
    

<footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2008-2025, Trevor Bača &amp; Joséphine Oberholtzer.
      <span class="lastupdated">
        Last updated on Apr 04, 2025.
      </span>

    </p>
  </div> 

</footer>

</div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>