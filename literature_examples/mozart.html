

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Mozart: Musikalisches Würfelspiel &mdash; Abjad 3.1.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script defer="defer" type="text/javascript" src="../_static/copybutton.js"></script>
        <script type="text/javascript" src="../_static/ga.js"></script>
        <script defer="defer" type="text/javascript" src="../_static/lightbox2/js/lightbox.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/abjad.css" type="text/css" />
  <link rel="stylesheet" href="../_static/uqbar.css" type="text/css" />
  <link rel="stylesheet" href="../_static/lightbox2/css/lightbox.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Pärt: Cantus in Memory of Benjamin Britten" href="part.html" />
    <link rel="prev" title="Ligeti: “Désordre”" href="ligeti.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Abjad
          

          
            
            <img src="../_static/abjad-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gallery.html">Score gallery</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../for_beginners/index.html">For beginners</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Literature examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bartok.html">Bartók: <em>Mikrokosmos</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="ferneyhough.html">Ferneyhough: <em>Unsichtbare Farben</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="ligeti.html">Ligeti: “Désordre”</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Mozart: <em>Musikalisches Würfelspiel</em></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-materials">The materials</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-structure">The structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-score">The score</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-document">The document</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="part.html">Pärt: <em>Cantus in Memory of Benjamin Britten</em></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../core_concepts/index.html">Core concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_manual/index.html">Reference manual</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Abjad API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendices/index.html">Appendices</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Abjad</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Literature examples</a> &raquo;</li>
        
      <li>Mozart: <em>Musikalisches Würfelspiel</em></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/literature_examples/mozart.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mozart-musikalisches-wurfelspiel">
<h1>Mozart: <em>Musikalisches Würfelspiel</em><a class="headerlink" href="#mozart-musikalisches-wurfelspiel" title="Permalink to this headline">¶</a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">abjad</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">abjad.demos</span> <span class="kn">import</span> <span class="n">mozart</span>
</pre></div>
</div>
<p>Mozart’s dice game is a method for aleatorically generating
sixteen-measure-long minuets.  For each measure, two six-sided dice are rolled,
and the sum of the dice used to look up a measure number in one of two tables
(one for each half of the minuet).  The measure number then locates a single
measure from a collection of musical fragments.  The fragments are concatenated
together, and “music” results.</p>
<p>Implementing the dice game in a composition environment is somewhat akin to
(although also somewhat more complicated than) the ubiquitous <a class="reference external" href="http://en.wikipedia.org/wiki/Hello_world_program">hello world
program</a> which every
programming language uses to demonstrate its basic syntax.</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="../_images/mozart-tables.png"><img alt="../_images/mozart-tables.png" src="../_images/mozart-tables.png" style="width: 640px;" /></a>
<p class="caption"><span class="caption-text"><em>Part of a pen-and-paper implementation from the 20th century.</em></span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The musical dice game in question (<em>k516f</em>) has long been attributed to
Mozart, albeit inconclusively.  Its actual provenance is a musicological
problem with which we are unconcerned here.</p>
</div>
<div class="section" id="the-materials">
<h2>The materials<a class="headerlink" href="#the-materials" title="Permalink to this headline">¶</a></h2>
<p>At the heart of the dice game is a large collection, <em>or corpus</em>, of musical
fragments.  Each fragment is a single 3/8 measure, consisting of a treble voice
and a bass voice.  Traditionally, these fragments are stored in a “score”, or
“table of measures”, and located via two tables of measure numbers, which act
as lookups, indexing into that collection.</p>
<p>Duplicate measures in the original corpus are common.  Notably, the 8th measure
- actually a pair of measures represent the first and second alternate ending
of the first half of the minuet - are always identical.  The last measure of
the piece is similarly limited - there are only two possibilities rather than
the usual eleven (for the numbers 2 to 12, being all the possible sums of two
6-sided dice).</p>
<p>How might we store this corpus compactly?</p>
<p>Some basic musical information in Abjad can be stored as strings, rather than
actual collections of class instances.  Abjad can parse simple LilyPond strings
via <code class="xref py py-func docutils literal notranslate"><span class="pre">p</span></code>, which interprets a subset of LilyPond
syntax, and understands basic concepts like notes, chords, rests and skips, as
well as beams, slurs, ties, and articulations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">staff</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Staff</span><span class="p">(</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="sd">    c&#39;4 ( d&#39;4 &lt;cs&#39; e&#39;&gt;8 ) -. r8</span>
<span class="gp">... </span><span class="sd">    &lt;g&#39; b&#39; d&#39;&#39;&gt;4 ^ \marcato ~ &lt;g&#39; b&#39; d&#39;&#39;&gt;1</span>
<span class="gp">... </span><span class="sd">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">staff</span><span class="p">)</span>
<span class="go">\new Staff</span>
<span class="go">{</span>
<span class="go">    c&#39;4</span>
<span class="go">    (</span>
<span class="go">    d&#39;4</span>
<span class="go">    &lt;cs&#39; e&#39;&gt;8</span>
<span class="go">    - \staccato</span>
<span class="go">    )</span>
<span class="go">    r8</span>
<span class="go">    &lt;g&#39; b&#39; d&#39;&#39;&gt;4</span>
<span class="go">    ^ \marcato</span>
<span class="go">    ~</span>
<span class="go">    &lt;g&#39; b&#39; d&#39;&#39;&gt;1</span>
<span class="go">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">staff</span><span class="p">)</span>
</pre></div>
</div>
<div class="uqbar-book">
    <a href="../_images/lilypond-4856800ab604371a4f1503f806b96bf0670c7575beec7ec4657b5b4a2136ed5a.ly"><img src="../_images/lilypond-4856800ab604371a4f1503f806b96bf0670c7575beec7ec4657b5b4a2136ed5a.cropped.svg"/></a>
</div><p>So, instead of storing our musical information as Abjad components, we’ll
represent each fragment in the corpus as a pair of strings: one representing
the bass voice contents, and the other representing the treble.  This pair of
strings can be packaged together into a collection.  For this implementation,
we’ll package them into a dictionary.  Python dictionaries are cheap, and often
provide more clarity than lists; the composer does not have to rely on
remembering a convention for what data should appear in which position in a
list - they can simply label that data semantically.  In our musical
dictionary, the treble voice will use the key ‘t’ and the bass voice will use
the key ‘b’.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fragment</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;t&quot;</span><span class="p">:</span> <span class="s2">&quot;g&#39;&#39;8 ( e&#39;&#39;8 c&#39;&#39;8 )&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;c e&gt;4 r8&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Instead of relying on measure number tables to find our fragments - as in the
original implementation, we’ll package our fragment dictionaries into a list of
lists of fragment dictionaries.  That is to say, each of the sixteen measures
in the piece will be represented by a list of fragment dictionaries.
Furthermore, the 8th measure, which breaks the pattern, will simply be a list
of two fragment dictionaries.  Structuring our information in this way lets us
avoid using measure number tables entirely; Python’s list-indexing affordances
will take care of that for us.  The complete corpus looks like this.</p>
<p>We can then use the <code class="xref py py-func docutils literal notranslate"><span class="pre">p()</span></code> function we saw
earlier to “build” the treble and bass components of a measure like this:</p>
<p>Let’s try with a measure-definition of our own:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_measure_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;c4 ^\trill r8&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">:</span> <span class="s2">&quot;e&#39;&#39;8 ( c&#39;&#39;8 g&#39;8 )&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">treble</span><span class="p">,</span> <span class="n">bass</span> <span class="o">=</span> <span class="n">mozart</span><span class="o">.</span><span class="n">make_mozart_measure</span><span class="p">(</span><span class="n">my_measure_dict</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">treble</span><span class="p">))</span>
<span class="go">{</span>
<span class="go">    e&#39;&#39;8</span>
<span class="go">    (</span>
<span class="go">    c&#39;&#39;8</span>
<span class="go">    g&#39;8</span>
<span class="go">    )</span>
<span class="go">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">bass</span><span class="p">))</span>
<span class="go">{</span>
<span class="go">    c4</span>
<span class="go">    ^ \trill</span>
<span class="go">    r8</span>
<span class="go">}</span>
</pre></div>
</div>
<p>Now with one from the Mozart measure collection defined earlier.
We’ll grab the very last choice for the very last measure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_measure_dict</span> <span class="o">=</span> <span class="n">mozart</span><span class="o">.</span><span class="n">make_mozart_measure_corpus</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">treble</span><span class="p">,</span> <span class="n">bass</span> <span class="o">=</span> <span class="n">mozart</span><span class="o">.</span><span class="n">make_mozart_measure</span><span class="p">(</span><span class="n">my_measure_dict</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">treble</span><span class="p">))</span>
<span class="go">{</span>
<span class="go">    c&#39;&#39;8</span>
<span class="go">    c&#39;8</span>
<span class="go">    r8</span>
<span class="go">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">bass</span><span class="p">))</span>
<span class="go">{</span>
<span class="go">    c4</span>
<span class="go">    c,8</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<div class="section" id="the-structure">
<h2>The structure<a class="headerlink" href="#the-structure" title="Permalink to this headline">¶</a></h2>
<p>After storing all of the musical fragments into a corpus, concatenating those
elements into a musical structure is relatively trivial.  We’ll use the
<a class="reference external" href="https://docs.python.org/3.6/library/random.html#random.choice" title="(in Python v3.6)"><code class="xref py py-func docutils literal notranslate"><span class="pre">choice()</span></code></a> function from Python’s <cite>random</cite> module.
<a class="reference external" href="https://docs.python.org/3.6/library/random.html#random.choice" title="(in Python v3.6)"><code class="xref py py-func docutils literal notranslate"><span class="pre">random.choice()</span></code></a> randomly selects one element from an input list.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">list_</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">[&#39;b&#39;, &#39;b&#39;, 1, &#39;b&#39;, 3, &#39;b&#39;, &#39;b&#39;, &#39;b&#39;, &#39;b&#39;, &#39;b&#39;, 3, 1, 3, 1, &#39;b&#39;, 1, 1, 3, &#39;b&#39;, 3]</span>
</pre></div>
</div>
<p>Our corpus is a list comprising sixteen sublists, one for each measure in the
minuet.  To build our musical structure, we can simply iterate through the
corpus and call <cite>choice</cite> on each sublist, appending the chosen results to
another list.  The only catch is that the <em>eighth</em> measure of our minuet is
actually the first-and-second-ending for the repeat of the first phrase.  The
sublist of the corpus for measure eight contains <em>only</em> the first and second
ending definitions, and both of those measures should appear in the final
piece, always in the same order.  We’ll have to intercept that sublist while we
iterate through the corpus and apply some different logic.</p>
<p>The easist way to intercept measure eight is to use the Python builtin
<cite>enumerate</cite>, which allows you to iterate through a collection while also
getting the index of each element in that collection. Note that In
<cite>mozart.choose_mozart_measures()</cite> we test for index <em>7</em>, rather then <em>8</em>,
because list indices count from <em>0</em> instead of <em>1</em>.</p>
<p>The result will be a <em>seventeen</em>-item-long list of measure definitions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">choices</span> <span class="o">=</span> <span class="n">mozart</span><span class="o">.</span><span class="n">choose_mozart_measures</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">measure</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">choices</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">measure</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">0 {&#39;b&#39;: &#39;&lt;c e&gt;4 r8&#39;, &#39;t&#39;: &quot;g&#39;&#39;8 c&#39;&#39;8 e&#39;&#39;8&quot;}</span>
<span class="go">1 {&#39;b&#39;: &#39;&lt;c e&gt;4 r8&#39;, &#39;t&#39;: &quot;g&#39;&#39;8 e&#39;&#39;8 c&#39;&#39;8&quot;}</span>
<span class="go">2 {&#39;b&#39;: &#39;&lt;b, d&gt;4 r8&#39;, &#39;t&#39;: &quot;g&#39;&#39;16 fs&#39;&#39;16 g&#39;&#39;16 d&#39;&#39;16 b&#39;16 g&#39;16&quot;}</span>
<span class="go">3 {&#39;b&#39;: &#39;c4 r8&#39;, &#39;t&#39;: &quot;e&#39;&#39;16 c&#39;&#39;16 b&#39;16 c&#39;&#39;16 g&#39;8&quot;}</span>
<span class="go">4 {&#39;b&#39;: &#39;c8 c8 c8&#39;, &#39;t&#39;: &quot;&lt;fs&#39; d&#39;&#39;&gt;8 &lt;d&#39;&#39; fs&#39;&#39;&gt;8 &lt;fs&#39;&#39; a&#39;&#39;&gt;8&quot;}</span>
<span class="go">5 {&#39;b&#39;: &#39;&lt;b, d&gt;4 r8&#39;, &#39;t&#39;: &quot;g&#39;&#39;16 b&#39;&#39;16 g&#39;&#39;16 d&#39;&#39;16 b&#39;8&quot;}</span>
<span class="go">6 {&#39;b&#39;: &#39;c8 d8 d,8&#39;, &#39;t&#39;: &quot;e&#39;&#39;16 a&#39;&#39;16 g&#39;&#39;16 b&#39;&#39;16 fs&#39;&#39;16 a&#39;&#39;16&quot;}</span>
<span class="go">7 {&#39;b&#39;: &#39;g,8 g16 f16 e16 d16&#39;, &#39;t&#39;: &quot;&lt;g&#39; b&#39; d&#39;&#39; g&#39;&#39;&gt;4 r8&quot;}</span>
<span class="go">8 {&#39;b&#39;: &#39;g,8 b16 g16 fs16 e16&#39;, &#39;t&#39;: &quot;&lt;g&#39; b&#39; d&#39;&#39; g&#39;&#39;&gt;4 r8&quot;}</span>
<span class="go">9 {&#39;b&#39;: &#39;&lt;d fs&gt;4 &lt;c fs&gt;8&#39;, &#39;t&#39;: &quot;d&#39;&#39;&#39;8 a&#39;&#39;16 fs&#39;&#39;16 d&#39;&#39;16 a&#39;16&quot;}</span>
<span class="go">10 {&#39;b&#39;: &#39;&lt;b, d&gt;4 &lt;b, g&gt;8&#39;, &#39;t&#39;: &quot;g&#39;&#39;16 b&#39;&#39;16 g&#39;&#39;8 d&#39;&#39;8&quot;}</span>
<span class="go">11 {&#39;b&#39;: &#39;e4 e16 c16&#39;, &#39;t&#39;: &quot;c&#39;&#39;16 g&#39;16 c&#39;&#39;16 e&#39;&#39;16 g&#39;&#39;16 &lt;c&#39;&#39; e&#39;&#39;&gt;16&quot;}</span>
<span class="go">12 {&#39;b&#39;: &#39;g4 g,8&#39;, &#39;t&#39;: &quot;b&#39;16 d&#39;&#39;16 g&#39;&#39;16 d&#39;&#39;16 b&#39;8&quot;}</span>
<span class="go">13 {&#39;b&#39;: &#39;&lt;c e&gt;4 r8&#39;, &#39;t&#39;: &quot;g&#39;&#39;8 f&#39;&#39;16 e&#39;&#39;16 d&#39;&#39;16 c&#39;&#39;16&quot;}</span>
<span class="go">14 {&#39;b&#39;: &#39;&lt;c g&gt;4 &lt;c e&gt;8&#39;, &#39;t&#39;: &quot;e&#39;&#39;16 d&#39;&#39;16 e&#39;&#39;16 g&#39;&#39;16 c&#39;&#39;&#39;16 g&#39;&#39;16&quot;}</span>
<span class="go">15 {&#39;b&#39;: &#39;f4 g8&#39;, &#39;t&#39;: &quot;f&#39;&#39;16 a&#39;&#39;16 a&#39;8 b&#39;16 d&#39;&#39;16&quot;}</span>
<span class="go">16 {&#39;b&#39;: &#39;c8 g,8 c,8&#39;, &#39;t&#39;: &quot;c&#39;&#39;4 r8&quot;}</span>
</pre></div>
</div>
</div>
<div class="section" id="the-score">
<h2>The score<a class="headerlink" href="#the-score" title="Permalink to this headline">¶</a></h2>
<p>Now that we have our raw materials, and a way to organize them, we can start
building our score.  The tricky part here is figuring out how to implement
LilyPond’s repeat structure in Abjad.  LilyPond structures its repeats
something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">repeat</span> <span class="n">volta</span> <span class="n">n</span> <span class="p">{</span>
    <span class="n">music</span> <span class="n">to</span> <span class="n">be</span> <span class="n">repeated</span>
<span class="p">}</span>

\<span class="n">alternative</span> <span class="p">{</span>
    <span class="p">{</span> <span class="n">ending</span> <span class="mi">1</span> <span class="p">}</span>
    <span class="p">{</span> <span class="n">ending</span> <span class="mi">2</span> <span class="p">}</span>
    <span class="p">{</span> <span class="n">ending</span> <span class="n">n</span> <span class="p">}</span>
<span class="p">}</span>

<span class="o">...</span><span class="n">music</span> <span class="n">after</span> <span class="n">the</span> <span class="n">repeat</span><span class="o">...</span>
</pre></div>
</div>
<p>What you see above is really just two containers, each with a little text
(“repeat volta n” and “alternative”) prepended to their opening curly brace.
To create that structure in Abjad, we’ll need to use the
<a class="reference internal" href="../api/abjad/indicators/LilyPondLiteral.html#module-abjad.indicators.LilyPondLiteral" title="abjad.indicators.LilyPondLiteral"><code class="xref py py-class docutils literal notranslate"><span class="pre">LilyPondLiteral</span></code></a> class, which allows you to place
LilyPond literals like “break” relative to any score component:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">container</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">Container</span><span class="p">(</span><span class="s2">&quot;c&#39;4 d&#39;4 e&#39;4 f&#39;4&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">literal</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">LilyPondLiteral</span><span class="p">(</span><span class="s2">&quot;before-the-container&quot;</span><span class="p">,</span> <span class="s2">&quot;before&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">literal</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">literal</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">LilyPondLiteral</span><span class="p">(</span><span class="s2">&quot;after-the-container&quot;</span><span class="p">,</span> <span class="s2">&quot;after&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">literal</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">literal</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">LilyPondLiteral</span><span class="p">(</span><span class="s2">&quot;opening-of-the-container&quot;</span><span class="p">,</span> <span class="s2">&quot;opening&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">literal</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">literal</span> <span class="o">=</span> <span class="n">abjad</span><span class="o">.</span><span class="n">LilyPondLiteral</span><span class="p">(</span><span class="s2">&quot;closing-of-the-container&quot;</span><span class="p">,</span> <span class="s2">&quot;closing&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">literal</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
<span class="go">before-the-container</span>
<span class="go">{</span>
<span class="go">    opening-of-the-container</span>
<span class="go">    c&#39;4</span>
<span class="go">    d&#39;4</span>
<span class="go">    e&#39;4</span>
<span class="go">    f&#39;4</span>
<span class="go">    closing-of-the-container</span>
<span class="go">}</span>
<span class="go">after-the-container</span>
</pre></div>
</div>
<p>Notice the second argument to each
<a class="reference internal" href="../api/abjad/indicators/LilyPondLiteral.html#module-abjad.indicators.LilyPondLiteral" title="abjad.indicators.LilyPondLiteral"><code class="xref py py-class docutils literal notranslate"><span class="pre">LilyPondLiteral</span></code></a> above, like <cite>before</cite> and
<cite>closing</cite>.  These are format slot indications, which control where the literal
is placed in the LilyPond code relative to the score element it is attached to.
To mimic LilyPond’s repeat syntax, we’ll have to create two
<a class="reference internal" href="../api/abjad/indicators/LilyPondLiteral.html#module-abjad.indicators.LilyPondLiteral" title="abjad.indicators.LilyPondLiteral"><code class="xref py py-class docutils literal notranslate"><span class="pre">LilyPondLiteral</span></code></a> instances, both using the
“before” format slot, insuring that their literal is placed before their
container’s opening curly brace.</p>
<p>Now let’s take a look at the code that puts our score together:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">score</span> <span class="o">=</span> <span class="n">mozart</span><span class="o">.</span><span class="n">make_mozart_score</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
</pre></div>
</div>
<div class="uqbar-book">
    <a href="../_images/lilypond-7a13a83f320d6a299d3d1be97b289f680b0e2e0f8cebde1375cefbe48f293a15.ly"><img src="../_images/lilypond-7a13a83f320d6a299d3d1be97b289f680b0e2e0f8cebde1375cefbe48f293a15.cropped.svg"/></a>
</div><p>Our instrument name got cut off!  Looks like we need to do a little formatting.</p>
</div>
<div class="section" id="the-document">
<h2>The document<a class="headerlink" href="#the-document" title="Permalink to this headline">¶</a></h2>
<p>As you can see above, we’ve now got our randomized minuet.  However, we can
still go a bit further.  LilyPond provides a wide variety of settings for
controlling the overall <em>look</em> of a musical document, often through its
<cite>header</cite>, <cite>layout</cite> and <cite>paper</cite> blocks.  Abjad, in turn, gives us
object-oriented access to these settings through the its <cite>lilypondfiletools</cite>
module.</p>
<p>We’ll use <code class="xref py py-func docutils literal notranslate"><span class="pre">abjad.lilypondfile.LilyPondFile.new()</span></code> to wrap our
<a class="reference internal" href="../api/abjad/core/Score.html#module-abjad.core.Score" title="abjad.core.Score"><code class="xref py py-class docutils literal notranslate"><span class="pre">Score</span></code></a> inside a
<a class="reference internal" href="../api/abjad/lilypondfile/LilyPondFile.html#module-abjad.lilypondfile.LilyPondFile" title="abjad.lilypondfile.LilyPondFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">LilyPondFile</span></code></a> instance.  From there we can
access the other “blocks” of our document to add a title, a composer’s name,
change the global staff size, paper size, staff spacing and so forth.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lilypond_file</span> <span class="o">=</span> <span class="n">mozart</span><span class="o">.</span><span class="n">make_mozart_lilypond_file</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lilypond_file</span><span class="p">)</span>
<span class="go">LilyPondFile(comments=[], global_staff_size=12, includes=[], items=[&lt;Block(name=&#39;header&#39;)&gt;, &lt;Block(name=&#39;layout&#39;)&gt;, &lt;Block(name=&#39;paper&#39;)&gt;, &lt;Block(name=&#39;score&#39;)&gt;], lilypond_language_token=LilyPondLanguageToken(), lilypond_version_token=LilyPondVersionToken(&#39;2.19.83&#39;))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">lilypond_file</span><span class="o">.</span><span class="n">header_block</span><span class="p">))</span>
<span class="go">\header {</span>
<span class="go">    tagline = ##f</span>
<span class="go">    title = \markup {</span>
<span class="go">        \bold</span>
<span class="go">            \sans</span>
<span class="go">                &quot;Ein Musikalisches Wuerfelspiel&quot;</span>
<span class="go">        }</span>
<span class="go">    composer = #&quot;W. A. Mozart (maybe?)&quot;</span>
<span class="go">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">lilypond_file</span><span class="o">.</span><span class="n">header_block</span><span class="p">))</span>
<span class="go">\header {</span>
<span class="go">    tagline = ##f</span>
<span class="go">    title = \markup {</span>
<span class="go">        \bold</span>
<span class="go">            \sans</span>
<span class="go">                &quot;Ein Musikalisches Wuerfelspiel&quot;</span>
<span class="go">        }</span>
<span class="go">    composer = #&quot;W. A. Mozart (maybe?)&quot;</span>
<span class="go">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">lilypond_file</span><span class="o">.</span><span class="n">layout_block</span><span class="p">))</span>
<span class="go">\layout {</span>
<span class="go">    ragged-right = ##t</span>
<span class="go">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">lilypond_file</span><span class="o">.</span><span class="n">layout_block</span><span class="p">))</span>
<span class="go">\layout {</span>
<span class="go">    ragged-right = ##t</span>
<span class="go">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">lilypond_file</span><span class="o">.</span><span class="n">paper_block</span><span class="p">))</span>
<span class="go">\paper {</span>
<span class="go">    markup-system-spacing = #&#39;((basic_distance . 8))</span>
<span class="go">    paper-width = #180</span>
<span class="go">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">lilypond_file</span><span class="o">.</span><span class="n">paper_block</span><span class="p">))</span>
<span class="go">\paper {</span>
<span class="go">    markup-system-spacing = #&#39;((basic_distance . 8))</span>
<span class="go">    paper-width = #180</span>
<span class="go">}</span>
</pre></div>
</div>
<p>And now the final result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">abjad</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">lilypond_file</span><span class="p">)</span>
</pre></div>
</div>
<div class="uqbar-book">
    <a href="../_images/lilypond-907a5ff865195fcf307dab40cd007e53728d5b6e4ea734d3aa2d6e39611df6c1.ly"><img src="../_images/lilypond-907a5ff865195fcf307dab40cd007e53728d5b6e4ea734d3aa2d6e39611df6c1.cropped.svg"/></a>
</div><p>Explore the <code class="docutils literal notranslate"><span class="pre">abjad/demos/mozart/</span></code> directory for the complete code to this
example, or import it into your Python session directly with <code class="docutils literal notranslate"><span class="pre">from</span>
<span class="pre">abjad.demos</span> <span class="pre">import</span> <span class="pre">mozart</span></code>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="part.html" class="btn btn-neutral float-right" title="Pärt: Cantus in Memory of Benjamin Britten" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ligeti.html" class="btn btn-neutral float-left" title="Ligeti: “Désordre”" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2008-2019, Trevor Bača &amp; Josiah Wolf Oberholtzer
      <span class="lastupdated">
        Last updated on Dec 18, 2019.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>